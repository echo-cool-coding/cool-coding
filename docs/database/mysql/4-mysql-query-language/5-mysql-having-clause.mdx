---
title: MySQL HAVING子句
description: "了解如何在MySQL中使用HAVING子句对分组后的数据进行过滤。本教程将逐步讲解HAVING子句的概念、语法、实际应用场景，并提供代码示例和练习。"
---

# MySQL HAVING子句

在MySQL中，`HAVING`子句用于对分组后的数据进行过滤。它与`WHERE`子句类似，但`WHERE`子句用于过滤行，而`HAVING`子句用于过滤分组。通常，`HAVING`子句与`GROUP BY`子句一起使用，以便在分组后对结果进行进一步筛选。

## 什么是HAVING子句？

`HAVING`子句用于在`GROUP BY`子句之后对分组结果进行过滤。它允许你根据聚合函数（如`COUNT`、`SUM`、`AVG`等）的结果来筛选数据。与`WHERE`子句不同，`HAVING`子句可以用于过滤聚合后的数据。

### 语法

```sql
SELECT column1, column2, ..., aggregate_function(column)
FROM table_name
WHERE condition
GROUP BY column1, column2, ...
HAVING condition;
```

- `aggregate_function(column)`：聚合函数，如`COUNT`、`SUM`、`AVG`等。
- `GROUP BY column1, column2, ...`：指定分组的列。
- `HAVING condition`：过滤分组后的结果。

## 代码示例

假设我们有一个名为`orders`的表，其中包含以下数据：

| order_id | customer_id | amount |
|----------|-------------|--------|
| 1        | 101         | 100    |
| 2        | 102         | 200    |
| 3        | 101         | 150    |
| 4        | 103         | 300    |
| 5        | 102         | 250    |

我们想要找出总订单金额超过300的客户。可以使用以下查询：

```sql
SELECT customer_id, SUM(amount) AS total_amount
FROM orders
GROUP BY customer_id
HAVING total_amount > 300;
```

### 输出结果

| customer_id | total_amount |
|-------------|--------------|
| 101         | 250          |
| 102         | 450          |

在这个例子中，`HAVING`子句过滤掉了总订单金额不超过300的客户。

## 实际应用场景

### 场景1：筛选出订单数量超过一定值的客户

假设我们想要找出订单数量超过2的客户：

```sql
SELECT customer_id, COUNT(order_id) AS order_count
FROM orders
GROUP BY customer_id
HAVING order_count > 2;
```

### 场景2：筛选出平均订单金额超过一定值的客户

假设我们想要找出平均订单金额超过150的客户：

```sql
SELECT customer_id, AVG(amount) AS avg_amount
FROM orders
GROUP BY customer_id
HAVING avg_amount > 150;
```

## 总结

`HAVING`子句是MySQL中一个强大的工具，用于在分组后对数据进行过滤。它与`GROUP BY`子句一起使用，允许你根据聚合函数的结果来筛选数据。通过`HAVING`子句，你可以轻松地筛选出符合特定条件的分组数据。

:::tip
在使用`HAVING`子句时，确保你已经正确使用了`GROUP BY`子句，并且理解聚合函数的作用。
:::

## 附加资源与练习

### 练习1

假设你有一个`employees`表，其中包含以下列：`employee_id`、`department_id`、`salary`。请编写一个查询，找出每个部门的平均工资超过50000的部门。

### 练习2

假设你有一个`sales`表，其中包含以下列：`sale_id`、`product_id`、`quantity`、`price`。请编写一个查询，找出总销售额超过10000的产品。

通过完成这些练习，你将更好地理解`HAVING`子句的使用方法。