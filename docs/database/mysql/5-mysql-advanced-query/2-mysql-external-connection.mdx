---
title: MySQL 外连接
description: 了解MySQL中的外连接（Outer Join），掌握如何使用LEFT JOIN、RIGHT JOIN和FULL OUTER JOIN进行数据查询，并通过实际案例加深理解。
---

# MySQL 外连接

在MySQL中，**外连接**（Outer Join）是一种用于从多个表中检索数据的查询方式。与内连接（Inner Join）不同，外连接不仅返回匹配的行，还会返回不匹配的行。这使得外连接在处理数据时更加灵活，尤其是在需要保留所有记录的情况下。

外连接主要分为三种类型：
1. **LEFT JOIN**（左连接）
2. **RIGHT JOIN**（右连接）
3. **FULL OUTER JOIN**（全外连接）

接下来，我们将逐一介绍这些连接类型，并通过示例代码和实际案例帮助你更好地理解。

---

## 1. LEFT JOIN（左连接）

**LEFT JOIN** 返回左表中的所有记录，以及右表中与左表匹配的记录。如果右表中没有匹配的记录，则结果中右表的部分将显示为 `NULL`。

### 语法
```sql
SELECT 列名
FROM 左表
LEFT JOIN 右表
ON 左表.列名 = 右表.列名;
```

### 示例
假设我们有两个表：`students` 和 `scores`。

- `students` 表：
  | id  | name   |
  |-----|--------|
  | 1   | Alice  |
  | 2   | Bob    |
  | 3   | Charlie|

- `scores` 表：
  | student_id | score |
  |------------|-------|
  | 1          | 90    |
  | 2          | 85    |
  | 4          | 88    |

使用 `LEFT JOIN` 查询所有学生及其成绩：
```sql
SELECT students.name, scores.score
FROM students
LEFT JOIN scores
ON students.id = scores.student_id;
```

### 输出
| name   | score |
|--------|-------|
| Alice  | 90    |
| Bob    | 85    |
| Charlie| NULL  |

:::note
注意：Charlie 没有对应的成绩，因此 `score` 列显示为 `NULL`。
:::

---

## 2. RIGHT JOIN（右连接）

**RIGHT JOIN** 与 `LEFT JOIN` 相反，它返回右表中的所有记录，以及左表中与右表匹配的记录。如果左表中没有匹配的记录，则结果中左表的部分将显示为 `NULL`。

### 语法
```sql
SELECT 列名
FROM 左表
RIGHT JOIN 右表
ON 左表.列名 = 右表.列名;
```

### 示例
继续使用 `students` 和 `scores` 表，使用 `RIGHT JOIN` 查询所有成绩及其对应的学生：
```sql
SELECT students.name, scores.score
FROM students
RIGHT JOIN scores
ON students.id = scores.student_id;
```

### 输出
| name  | score |
|-------|-------|
| Alice | 90    |
| Bob   | 85    |
| NULL  | 88    |

:::note
注意：`scores` 表中有一条记录（`student_id = 4`）没有对应的学生，因此 `name` 列显示为 `NULL`。
:::

---

## 3. FULL OUTER JOIN（全外连接）

**FULL OUTER JOIN** 返回左表和右表中的所有记录。如果某一行在其中一个表中没有匹配的记录，则结果中对应的部分将显示为 `NULL`。

:::caution
注意：MySQL 本身不支持 `FULL OUTER JOIN`，但可以通过 `UNION` 实现类似的效果。
:::

### 语法
```sql
SELECT 列名
FROM 左表
LEFT JOIN 右表
ON 左表.列名 = 右表.列名
UNION
SELECT 列名
FROM 左表
RIGHT JOIN 右表
ON 左表.列名 = 右表.列名;
```

### 示例
使用 `students` 和 `scores` 表，实现 `FULL OUTER JOIN`：
```sql
SELECT students.name, scores.score
FROM students
LEFT JOIN scores
ON students.id = scores.student_id
UNION
SELECT students.name, scores.score
FROM students
RIGHT JOIN scores
ON students.id = scores.student_id;
```

### 输出
| name   | score |
|--------|-------|
| Alice  | 90    |
| Bob    | 85    |
| Charlie| NULL  |
| NULL   | 88    |

:::tip
通过 `UNION` 结合 `LEFT JOIN` 和 `RIGHT JOIN`，我们可以模拟 `FULL OUTER JOIN` 的效果。
:::

---

## 实际应用场景

假设你正在开发一个学生管理系统，需要生成一份报告，显示所有学生及其考试成绩。如果某些学生没有参加考试，或者某些考试成绩没有对应的学生，你仍然希望这些记录出现在报告中。这时，外连接就派上了用场。

### 场景示例
- 使用 `LEFT JOIN` 确保所有学生都出现在报告中，即使他们没有成绩。
- 使用 `RIGHT JOIN` 确保所有成绩都出现在报告中，即使没有对应的学生。
- 使用 `FULL OUTER JOIN`（通过 `UNION` 实现）确保所有学生和成绩都出现在报告中。

---

## 总结

- **LEFT JOIN**：返回左表的所有记录和右表的匹配记录。
- **RIGHT JOIN**：返回右表的所有记录和左表的匹配记录。
- **FULL OUTER JOIN**：返回左表和右表的所有记录（通过 `UNION` 实现）。

外连接是处理数据时非常有用的工具，尤其是在需要保留所有记录的情况下。通过实际案例和代码示例，你可以更好地理解并应用这些概念。

---

## 附加资源与练习

1. **练习**：尝试在 MySQL 中创建两个表，并使用 `LEFT JOIN`、`RIGHT JOIN` 和 `FULL OUTER JOIN` 进行查询。
2. **深入学习**：阅读 MySQL 官方文档中关于 [JOIN](https://dev.mysql.com/doc/refman/8.0/en/join.html) 的部分，了解更多高级用法。
3. **扩展思考**：在实际项目中，外连接有哪些常见的应用场景？如何优化外连接查询的性能？

:::warning
提示：外连接可能会导致查询性能下降，尤其是在处理大数据集时。请确保在必要时使用索引来优化查询。
:::