---
title: MySQL 外部表
description: 了解MySQL外部表的概念、用法及其在实际场景中的应用。本文适合初学者，包含详细的解释和代码示例。
---

# MySQL 外部表

## 介绍

MySQL外部表（External Table）是指存储在MySQL数据库之外的数据表。这些数据通常存储在外部文件或其他数据库中，但可以通过MySQL进行查询和操作。外部表的主要用途是将外部数据源与MySQL数据库集成，从而在不迁移数据的情况下实现数据的联合查询和分析。

:::note
MySQL本身并不直接支持“外部表”这一概念，但可以通过Federated存储引擎或外部工具（如MySQL的`LOAD DATA INFILE`）实现类似功能。
:::

## 使用Federated存储引擎

Federated存储引擎是MySQL提供的一种机制，允许你访问远程MySQL服务器上的表，就像访问本地表一样。以下是使用Federated存储引擎的步骤：

### 1. 启用Federated存储引擎

首先，确保MySQL服务器已启用Federated存储引擎。你可以通过以下命令检查：

```sql
SHOW ENGINES;
```

如果Federated存储引擎未启用，可以在MySQL配置文件（如`my.cnf`或`my.ini`）中添加以下行：

```ini
[mysqld]
federated
```

然后重启MySQL服务。

### 2. 创建Federated表

假设你有一个远程MySQL服务器，其中有一个表`remote_table`，你可以通过以下方式在本地创建一个Federated表：

```sql
CREATE TABLE federated_table (
    id INT(11) NOT NULL AUTO_INCREMENT,
    name VARCHAR(100) NOT NULL,
    PRIMARY KEY (id)
)
ENGINE=FEDERATED
CONNECTION='mysql://username:password@remote_host:3306/database_name/remote_table';
```

在这个例子中，`federated_table`是本地表，但它实际上是对远程表`remote_table`的引用。

### 3. 查询Federated表

创建Federated表后，你可以像查询本地表一样查询它：

```sql
SELECT * FROM federated_table;
```

## 使用`LOAD DATA INFILE`

如果你有一个CSV文件或其他格式的外部数据文件，可以使用`LOAD DATA INFILE`命令将其加载到MySQL表中。以下是一个示例：

### 1. 准备数据文件

假设你有一个名为`data.csv`的文件，内容如下：

```csv
1,John Doe
2,Jane Smith
```

### 2. 创建本地表

首先，在MySQL中创建一个表来存储这些数据：

```sql
CREATE TABLE local_table (
    id INT(11) NOT NULL,
    name VARCHAR(100) NOT NULL,
    PRIMARY KEY (id)
);
```

### 3. 加载数据

使用`LOAD DATA INFILE`命令将数据加载到表中：

```sql
LOAD DATA INFILE '/path/to/data.csv'
INTO TABLE local_table
FIELDS TERMINATED BY ','
LINES TERMINATED BY '\n'
(id, name);
```

### 4. 查询数据

加载完成后，你可以查询`local_table`来查看数据：

```sql
SELECT * FROM local_table;
```

## 实际应用场景

### 数据集成

假设你有一个电子商务网站，订单数据存储在远程MySQL服务器上，而用户数据存储在本地MySQL服务器上。你可以使用Federated存储引擎将订单数据与用户数据联合查询，从而生成报表。

### 数据迁移

在数据迁移过程中，你可能需要将外部数据文件（如CSV文件）导入到MySQL数据库中。使用`LOAD DATA INFILE`可以快速将大量数据加载到MySQL表中。

## 总结

MySQL外部表的概念虽然不直接存在，但通过Federated存储引擎和`LOAD DATA INFILE`命令，你可以实现类似的功能。这些工具使得MySQL能够与外部数据源集成，从而扩展了MySQL的应用场景。

:::tip
如果你需要频繁访问外部数据源，建议使用Federated存储引擎。如果你只需要一次性加载数据，`LOAD DATA INFILE`可能是更好的选择。
:::

## 附加资源

- [MySQL官方文档：Federated存储引擎](https://dev.mysql.com/doc/refman/8.0/en/federated-storage-engine.html)
- [MySQL官方文档：LOAD DATA INFILE](https://dev.mysql.com/doc/refman/8.0/en/load-data.html)

## 练习

1. 尝试在本地MySQL服务器上创建一个Federated表，连接到远程MySQL服务器上的一个表，并查询数据。
2. 使用`LOAD DATA INFILE`将一个CSV文件加载到MySQL表中，并查询加载的数据。
