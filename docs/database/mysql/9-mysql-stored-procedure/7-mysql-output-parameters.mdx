---
title: MySQL 输出参数
description: 了解 MySQL 存储过程中的输出参数，掌握如何定义和使用它们，并通过实际案例加深理解。
---

# MySQL 输出参数

在 MySQL 存储过程中，输出参数（OUT 参数）是一种特殊的参数类型，用于从存储过程中返回值。与输入参数（IN 参数）不同，输出参数的主要作用是将存储过程内部的计算结果传递回调用者。本文将详细介绍 MySQL 输出参数的定义、使用场景以及实际案例。

## 什么是输出参数？

输出参数是存储过程中用于返回值的参数。它们允许存储过程在执行完毕后，将结果传递回调用者。输出参数在存储过程内部被赋值，但在调用存储过程时不需要提供初始值。

:::note
输出参数的关键特点：
- 使用 `OUT` 关键字定义。
- 在存储过程内部赋值。
- 调用存储过程时不需要提供初始值。
:::

## 定义输出参数

在 MySQL 存储过程中，输出参数的定义方式如下：

```sql
CREATE PROCEDURE procedure_name(OUT param_name data_type)
BEGIN
    -- 存储过程逻辑
    SET param_name = value;
END;
```

- `OUT`：表示这是一个输出参数。
- `param_name`：参数的名称。
- `data_type`：参数的数据类型（如 `INT`、`VARCHAR` 等）。

### 示例：定义一个简单的输出参数

以下是一个简单的存储过程示例，它接受一个输出参数并返回一个整数值：

```sql
CREATE PROCEDURE GetTotalUsers(OUT total INT)
BEGIN
    SELECT COUNT(*) INTO total FROM users;
END;
```

在这个例子中，`total` 是一个输出参数，存储过程会将 `users` 表中的记录数赋值给 `total`。

## 调用带有输出参数的存储过程

调用带有输出参数的存储过程时，需要提供一个变量来接收输出参数的值。以下是调用 `GetTotalUsers` 存储过程的示例：

```sql
CALL GetTotalUsers(@total_users);
SELECT @total_users;
```

- `@total_users`：这是一个用户定义的变量，用于接收存储过程的输出参数值。
- `SELECT @total_users`：用于显示输出参数的值。

### 输出结果

假设 `users` 表中有 100 条记录，调用上述存储过程后，`@total_users` 的值将是 `100`。

## 实际应用场景

输出参数在以下场景中非常有用：

1. **返回计算结果**：例如，计算某个表中的记录数、总和或平均值。
2. **返回状态信息**：例如，返回操作是否成功的标志。
3. **返回多个值**：通过多个输出参数返回多个计算结果。

### 示例：返回多个输出参数

以下是一个存储过程示例，它返回两个输出参数：用户总数和活跃用户数。

```sql
CREATE PROCEDURE GetUserStats(OUT total_users INT, OUT active_users INT)
BEGIN
    SELECT COUNT(*) INTO total_users FROM users;
    SELECT COUNT(*) INTO active_users FROM users WHERE status = 'active';
END;
```

调用该存储过程并显示结果：

```sql
CALL GetUserStats(@total_users, @active_users);
SELECT @total_users AS TotalUsers, @active_users AS ActiveUsers;
```

### 输出结果

假设 `users` 表中有 100 条记录，其中 80 条记录的状态为 `active`，则输出结果为：

```
+------------+-------------+
| TotalUsers | ActiveUsers |
+------------+-------------+
|        100 |          80 |
+------------+-------------+
```

## 总结

MySQL 输出参数是存储过程中用于返回值的重要工具。通过定义输出参数，存储过程可以将计算结果传递回调用者，从而实现更灵活的数据处理。本文介绍了输出参数的定义、使用方法以及实际应用场景，帮助你更好地理解和应用这一概念。

:::tip
**附加练习**：
1. 创建一个存储过程，接受一个输出参数并返回某个表中的最大值。
2. 修改 `GetUserStats` 存储过程，使其返回不活跃用户数。
:::

通过不断练习和探索，你将能够熟练使用 MySQL 输出参数，并在实际项目中灵活应用。