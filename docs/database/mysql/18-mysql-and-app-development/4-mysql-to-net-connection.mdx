---
title: MySQL 与.NET连接
description: 学习如何在.NET应用程序中连接和操作MySQL数据库。本文将从基础概念开始，逐步讲解如何配置连接、执行查询和处理结果，适合初学者。
---

## 介绍

在现代应用程序开发中，数据库是不可或缺的一部分。MySQL 是一个广泛使用的关系型数据库管理系统，而 .NET 是一个强大的开发框架，支持多种编程语言（如 C#）。将 MySQL 与 .NET 连接起来，可以让你在应用程序中轻松地存储、检索和管理数据。

本文将带你了解如何在 .NET 应用程序中连接 MySQL 数据库，并执行基本的数据库操作。我们将从安装必要的工具开始，逐步讲解如何配置连接、执行查询和处理结果。

## 准备工作

在开始之前，请确保你已经安装了以下工具：

1. **.NET SDK**：用于开发和运行 .NET 应用程序。
2. **MySQL Server**：用于运行 MySQL 数据库。
3. **MySQL Connector/NET**：用于在 .NET 中连接 MySQL 数据库的官方库。

你可以通过以下命令安装 MySQL Connector/NET：

```bash
dotnet add package MySql.Data
```

## 配置 MySQL 连接

在 .NET 中连接 MySQL 数据库的第一步是配置连接字符串。连接字符串包含了连接到数据库所需的所有信息，如服务器地址、数据库名称、用户名和密码。

以下是一个典型的 MySQL 连接字符串示例：

```csharp
string connectionString = "server=localhost;user=root;password=your_password;database=your_database";
```

:::note
请确保将 `your_password` 和 `your_database` 替换为实际的数据库密码和名称。
:::

## 连接到 MySQL 数据库

在配置好连接字符串后，你可以使用 `MySqlConnection` 类来建立与 MySQL 数据库的连接。以下是一个简单的示例：

```csharp
using MySql.Data.MySqlClient;

string connectionString = "server=localhost;user=root;password=your_password;database=your_database";
MySqlConnection connection = new MySqlConnection(connectionString);

try
{
    connection.Open();
    Console.WriteLine("连接成功！");
}
catch (Exception ex)
{
    Console.WriteLine("连接失败: " + ex.Message);
}
finally
{
    connection.Close();
}
```

:::tip
在使用完数据库连接后，务必调用 `Close()` 方法关闭连接，以释放资源。
:::

## 执行 SQL 查询

连接成功后，你可以使用 `MySqlCommand` 类来执行 SQL 查询。以下是一个简单的示例，展示了如何从数据库中检索数据：

```csharp
using MySql.Data.MySqlClient;

string connectionString = "server=localhost;user=root;password=your_password;database=your_database";
MySqlConnection connection = new MySqlConnection(connectionString);

try
{
    connection.Open();
    string query = "SELECT * FROM users";
    MySqlCommand command = new MySqlCommand(query, connection);
    MySqlDataReader reader = command.ExecuteReader();

    while (reader.Read())
    {
        Console.WriteLine(reader["username"]);
    }
}
catch (Exception ex)
{
    Console.WriteLine("查询失败: " + ex.Message);
}
finally
{
    connection.Close();
}
```

在这个示例中，我们从 `users` 表中检索所有用户，并打印出每个用户的用户名。

## 插入数据

除了查询数据，你还可以使用 `MySqlCommand` 类来插入数据。以下是一个插入数据的示例：

```csharp
using MySql.Data.MySqlClient;

string connectionString = "server=localhost;user=root;password=your_password;database=your_database";
MySqlConnection connection = new MySqlConnection(connectionString);

try
{
    connection.Open();
    string query = "INSERT INTO users (username, email) VALUES (@username, @email)";
    MySqlCommand command = new MySqlCommand(query, connection);
    command.Parameters.AddWithValue("@username", "john_doe");
    command.Parameters.AddWithValue("@email", "john@example.com");

    int rowsAffected = command.ExecuteNonQuery();
    Console.WriteLine($"插入了 {rowsAffected} 行数据。");
}
catch (Exception ex)
{
    Console.WriteLine("插入失败: " + ex.Message);
}
finally
{
    connection.Close();
}
```

:::caution
在实际应用中，请避免直接将用户输入拼接到 SQL 查询中，以防止 SQL 注入攻击。始终使用参数化查询，如上面的示例所示。
:::

## 实际应用场景

假设你正在开发一个简单的用户管理系统，用户可以通过该系统注册、登录和管理他们的个人信息。你可以使用 MySQL 数据库来存储用户信息，并使用 .NET 应用程序来处理用户请求。

以下是一个简化的用户注册流程：

1. 用户在注册页面填写表单并提交。
2. .NET 应用程序接收到表单数据后，将其插入到 MySQL 数据库的 `users` 表中。
3. 如果插入成功，应用程序返回成功消息；否则，返回错误信息。

## 总结

通过本文，你已经学会了如何在 .NET 应用程序中连接 MySQL 数据库，并执行基本的数据库操作。我们介绍了如何配置连接字符串、建立连接、执行查询和插入数据。这些技能是开发数据库驱动应用程序的基础。

## 附加资源与练习

为了巩固你的知识，建议你尝试以下练习：

1. 创建一个简单的 .NET 控制台应用程序，连接到 MySQL 数据库并执行查询。
2. 扩展应用程序，使其能够插入、更新和删除数据。
3. 尝试使用参数化查询来防止 SQL 注入攻击。

你还可以参考以下资源来进一步学习：

- [MySQL 官方文档](https://dev.mysql.com/doc/)
- [.NET 官方文档](https://docs.microsoft.com/en-us/dotnet/)
- [MySQL Connector/NET 文档](https://dev.mysql.com/doc/connector-net/en/)

祝你学习愉快！