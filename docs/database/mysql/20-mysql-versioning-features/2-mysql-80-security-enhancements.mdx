---
title: MySQL 8.0 安全增强
description: 了解 MySQL 8.0 中的安全增强功能，包括密码管理、角色管理、加密改进等，帮助初学者更好地保护数据库。
---

## 介绍

MySQL 8.0 引入了多项安全增强功能，旨在帮助开发者和数据库管理员更好地保护数据库免受潜在威胁。这些增强功能包括密码管理、角色管理、加密改进等。本文将逐步介绍这些功能，并通过实际案例展示它们的应用场景。

## 密码管理

### 密码策略

MySQL 8.0 引入了更严格的密码策略，以确保用户设置的密码足够安全。默认情况下，MySQL 8.0 要求密码至少包含一个大写字母、一个小写字母、一个数字和一个特殊字符，并且长度至少为8个字符。

```sql
-- 查看当前密码策略
SHOW VARIABLES LIKE 'validate_password%';
```

:::note
**注意**：`validate_password` 插件默认未启用。如果需要使用密码策略，请先启用该插件。
:::

### 密码过期

MySQL 8.0 允许管理员设置用户密码的过期时间。过期后，用户必须更改密码才能继续访问数据库。

```sql
-- 设置用户密码过期时间为90天
ALTER USER 'username'@'localhost' PASSWORD EXPIRE INTERVAL 90 DAY;
```

## 角色管理

### 创建角色

MySQL 8.0 引入了角色管理功能，允许管理员创建角色并将权限分配给角色，然后将角色分配给用户。这样可以简化权限管理。

```sql
-- 创建角色
CREATE ROLE 'read_only';

-- 授予角色权限
GRANT SELECT ON database_name.* TO 'read_only';

-- 将角色分配给用户
GRANT 'read_only' TO 'username'@'localhost';
```

### 激活角色

默认情况下，角色不会自动激活。用户需要手动激活角色才能使用其权限。

```sql
-- 激活角色
SET ROLE 'read_only';
```

:::tip
**提示**：可以通过 `SET DEFAULT ROLE` 命令设置默认激活的角色。
:::

## 加密改进

### 默认加密

MySQL 8.0 默认启用了 `caching_sha2_password` 插件，提供了更强的密码加密方式。与之前的 `mysql_native_password` 相比，`caching_sha2_password` 提供了更高的安全性。

```sql
-- 查看当前认证插件
SHOW VARIABLES LIKE 'default_authentication_plugin';
```

### 数据加密

MySQL 8.0 支持对表空间进行加密，以保护存储在磁盘上的数据。

```sql
-- 创建加密表空间
CREATE TABLESPACE `encrypted_ts` ADD DATAFILE 'encrypted_ts.ibd' ENCRYPTION='Y';

-- 创建表并使用加密表空间
CREATE TABLE encrypted_table (id INT PRIMARY KEY) TABLESPACE `encrypted_ts`;
```

## 实际案例

### 案例1：企业数据库安全

假设你是一家企业的数据库管理员，需要为不同部门的员工分配不同的数据库访问权限。通过使用角色管理功能，你可以创建 `read_only` 和 `read_write` 角色，并将这些角色分配给相应的用户。

```sql
-- 创建角色
CREATE ROLE 'read_only';
CREATE ROLE 'read_write';

-- 授予权限
GRANT SELECT ON company_db.* TO 'read_only';
GRANT SELECT, INSERT, UPDATE, DELETE ON company_db.* TO 'read_write';

-- 分配角色
GRANT 'read_only' TO 'employee1'@'localhost';
GRANT 'read_write' TO 'manager1'@'localhost';
```

### 案例2：密码策略实施

在一个需要高安全性的环境中，你可以启用 `validate_password` 插件，并设置严格的密码策略。

```sql
-- 启用密码策略插件
INSTALL PLUGIN validate_password SONAME 'validate_password.so';

-- 设置密码策略
SET GLOBAL validate_password.policy = 2;  -- 强密码策略
```

## 总结

MySQL 8.0 的安全增强功能为数据库管理员提供了更多工具来保护数据库。通过密码管理、角色管理和加密改进，你可以更好地控制数据库的访问权限，并确保数据的安全性。

## 附加资源

- [MySQL 8.0 官方文档](https://dev.mysql.com/doc/refman/8.0/en/)
- [MySQL 安全指南](https://dev.mysql.com/doc/refman/8.0/en/security.html)

## 练习

1. 创建一个名为 `auditor` 的角色，并授予其只读权限。
2. 启用 `validate_password` 插件，并设置密码策略为强密码策略。
3. 创建一个加密表空间，并在其中创建一个表。

通过完成这些练习，你将更好地理解 MySQL 8.0 的安全增强功能。