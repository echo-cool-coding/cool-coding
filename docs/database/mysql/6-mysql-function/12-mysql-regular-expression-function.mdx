---
title: MySQL 正则表达式函数
description: 了解MySQL中的正则表达式函数，掌握如何使用它们进行模式匹配和数据提取。
---

# MySQL 正则表达式函数

正则表达式（Regular Expression，简称Regex）是一种强大的工具，用于匹配和处理文本数据。在MySQL中，正则表达式函数可以帮助我们在查询中进行复杂的模式匹配和数据提取。本文将详细介绍MySQL中的正则表达式函数，并通过示例展示它们的实际应用。

## 什么是正则表达式？

正则表达式是一种用于描述字符串模式的语法。它可以帮助我们匹配、查找和替换文本中的特定模式。例如，你可以使用正则表达式来查找所有以字母“a”开头的单词，或者匹配符合特定格式的电子邮件地址。

## MySQL 中的正则表达式函数

MySQL提供了几个内置的正则表达式函数，用于在查询中进行模式匹配。以下是常用的正则表达式函数：

1. **REGEXP**：用于检查字符串是否匹配指定的正则表达式模式。
2. **NOT REGEXP**：用于检查字符串是否不匹配指定的正则表达式模式。
3. **REGEXP_LIKE**：与`REGEXP`类似，用于检查字符串是否匹配指定的正则表达式模式。
4. **REGEXP_REPLACE**：用于替换字符串中匹配正则表达式的部分。
5. **REGEXP_INSTR**：返回字符串中匹配正则表达式的起始位置。
6. **REGEXP_SUBSTR**：返回字符串中匹配正则表达式的子字符串。

### 1. REGEXP 和 NOT REGEXP

`REGEXP`和`NOT REGEXP`是最常用的正则表达式函数。它们用于在`WHERE`子句中进行模式匹配。

#### 示例1：查找以字母“a”开头的单词

```sql
SELECT * FROM words WHERE word REGEXP '^a';
```

**输入：**
```plaintext
words 表：
+-------+
| word  |
+-------+
| apple |
| banana|
| apricot|
| orange|
+-------+
```

**输出：**
```plaintext
+-------+
| word  |
+-------+
| apple |
| apricot|
+-------+
```

#### 示例2：查找不以字母“a”开头的单词

```sql
SELECT * FROM words WHERE word NOT REGEXP '^a';
```

**输出：**
```plaintext
+-------+
| word  |
+-------+
| banana|
| orange|
+-------+
```

### 2. REGEXP_LIKE

`REGEXP_LIKE`函数与`REGEXP`类似，但它可以用于更复杂的条件判断。

#### 示例3：查找包含“an”的单词

```sql
SELECT * FROM words WHERE REGEXP_LIKE(word, 'an');
```

**输出：**
```plaintext
+-------+
| word  |
+-------+
| banana|
| orange|
+-------+
```

### 3. REGEXP_REPLACE

`REGEXP_REPLACE`函数用于替换字符串中匹配正则表达式的部分。

#### 示例4：将单词中的“an”替换为“xx”

```sql
SELECT REGEXP_REPLACE(word, 'an', 'xx') AS replaced_word FROM words;
```

**输出：**
```plaintext
+--------------+
| replaced_word|
+--------------+
| apple        |
| bxxana       |
| apricot      |
| orxxge       |
+--------------+
```

### 4. REGEXP_INSTR

`REGEXP_INSTR`函数返回字符串中匹配正则表达式的起始位置。

#### 示例5：查找“an”在单词中的起始位置

```sql
SELECT word, REGEXP_INSTR(word, 'an') AS position FROM words;
```

**输出：**
```plaintext
+-------+----------+
| word  | position |
+-------+----------+
| apple | 0        |
| banana| 2        |
| apricot| 0       |
| orange| 2        |
+-------+----------+
```

### 5. REGEXP_SUBSTR

`REGEXP_SUBSTR`函数返回字符串中匹配正则表达式的子字符串。

#### 示例6：提取单词中的“an”

```sql
SELECT word, REGEXP_SUBSTR(word, 'an') AS matched_substring FROM words;
```

**输出：**
```plaintext
+-------+------------------+
| word  | matched_substring|
+-------+------------------+
| apple | NULL             |
| banana| an               |
| apricot| NULL            |
| orange| an               |
+-------+------------------+
```

## 实际应用场景

### 场景1：验证电子邮件格式

假设我们有一个用户表，其中包含用户的电子邮件地址。我们可以使用正则表达式来验证这些电子邮件地址是否符合标准格式。

```sql
SELECT email FROM users WHERE email REGEXP '^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,}$';
```

### 场景2：提取URL中的域名

假设我们有一个包含URL的表，我们可以使用正则表达式来提取URL中的域名部分。

```sql
SELECT url, REGEXP_SUBSTR(url, 'https?://([^/]+)') AS domain FROM urls;
```

## 总结

MySQL中的正则表达式函数为我们在查询中进行复杂的模式匹配和数据提取提供了强大的工具。通过掌握这些函数，你可以更高效地处理和分析文本数据。

:::tip
正则表达式的语法非常丰富，建议初学者多练习，逐步掌握各种模式匹配的技巧。
:::

## 附加资源

- [MySQL官方文档 - 正则表达式](https://dev.mysql.com/doc/refman/8.0/en/regexp.html)
- [正则表达式在线测试工具](https://regex101.com/)

## 练习

1. 编写一个查询，查找所有以“com”结尾的电子邮件地址。
2. 使用`REGEXP_REPLACE`函数，将字符串中的所有数字替换为“#”。
3. 编写一个查询，提取URL中的路径部分（即域名之后的部分）。

通过完成这些练习，你将更好地理解MySQL中的正则表达式函数及其应用。