---
title: ORDER BY 排序
description: 了解如何在 HiveQL 中使用 ORDER BY 对查询结果进行排序。本文适合初学者，包含代码示例、实际案例和总结。
---

# ORDER BY 排序

在 HiveQL 中，`ORDER BY` 是一个非常重要的子句，用于对查询结果进行排序。无论你是想按升序还是降序排列数据，`ORDER BY` 都能帮助你轻松实现。本文将详细介绍 `ORDER BY` 的用法，并通过示例帮助你更好地理解。

## 什么是 ORDER BY？

`ORDER BY` 是 HiveQL 中的一个子句，用于对查询结果进行排序。它可以按照一个或多个列对数据进行排序，并且支持升序（`ASC`）和降序（`DESC`）两种排序方式。

:::note
`ORDER BY` 会对整个数据集进行排序，因此在大数据场景下可能会消耗较多的计算资源。如果你只需要对部分数据进行排序，可以考虑使用 `SORT BY` 或 `DISTRIBUTE BY`。
:::

## 基本语法

`ORDER BY` 的基本语法如下：

```sql
SELECT column1, column2, ...
FROM table_name
ORDER BY column1 [ASC|DESC], column2 [ASC|DESC], ...;
```

- `column1, column2, ...`：要排序的列。
- `ASC`：升序排序（默认）。
- `DESC`：降序排序。

## 示例

假设我们有一个名为 `employees` 的表，包含以下数据：

| id  | name   | salary | department |
|-----|--------|--------|------------|
| 1   | Alice  | 5000   | HR         |
| 2   | Bob    | 6000   | IT         |
| 3   | Charlie| 4500   | HR         |
| 4   | David  | 7000   | IT         |
| 5   | Eve    | 5500   | Finance    |

### 示例 1：按单列排序

我们想按 `salary` 列对员工进行升序排序：

```sql
SELECT id, name, salary, department
FROM employees
ORDER BY salary ASC;
```

**输出结果：**

| id  | name   | salary | department |
|-----|--------|--------|------------|
| 3   | Charlie| 4500   | HR         |
| 1   | Alice  | 5000   | HR         |
| 5   | Eve    | 5500   | Finance    |
| 2   | Bob    | 6000   | IT         |
| 4   | David  | 7000   | IT         |

### 示例 2：按多列排序

我们想先按 `department` 列升序排序，再按 `salary` 列降序排序：

```sql
SELECT id, name, salary, department
FROM employees
ORDER BY department ASC, salary DESC;
```

**输出结果：**

| id  | name   | salary | department |
|-----|--------|--------|------------|
| 5   | Eve    | 5500   | Finance    |
| 1   | Alice  | 5000   | HR         |
| 3   | Charlie| 4500   | HR         |
| 4   | David  | 7000   | IT         |
| 2   | Bob    | 6000   | IT         |

## 实际应用场景

### 场景 1：销售数据分析

假设你有一个销售数据表 `sales`，包含以下列：`product_id`、`sales_date`、`sales_amount`。你想找出每个产品在最近一次销售中的销售额，并按销售额从高到低排序。

```sql
SELECT product_id, MAX(sales_date) AS last_sale_date, sales_amount
FROM sales
GROUP BY product_id, sales_amount
ORDER BY sales_amount DESC;
```

### 场景 2：学生成绩排名

假设你有一个学生成绩表 `student_scores`，包含以下列：`student_id`、`subject`、`score`。你想按科目对学生的成绩进行排名，并按分数从高到低排序。

```sql
SELECT student_id, subject, score
FROM student_scores
ORDER BY subject ASC, score DESC;
```

## 总结

`ORDER BY` 是 HiveQL 中用于对查询结果进行排序的强大工具。通过本文的学习，你应该已经掌握了如何使用 `ORDER BY` 对单列或多列进行排序，并了解了它在实际应用中的一些常见场景。

:::tip
在使用 `ORDER BY` 时，请确保你了解数据的大小和排序的复杂性，以避免不必要的性能开销。
:::

## 附加资源

- [Hive 官方文档](https://cwiki.apache.org/confluence/display/Hive/LanguageManual+SortBy)
- [HiveQL 教程](https://www.tutorialspoint.com/hive/hiveql_order_by.htm)

## 练习

1. 使用 `ORDER BY` 对 `employees` 表中的 `name` 列进行降序排序。
2. 尝试对 `sales` 表中的 `sales_date` 列进行升序排序，并观察结果。
3. 在 `student_scores` 表中，按 `subject` 列升序排序，再按 `student_id` 列升序排序。

通过完成这些练习，你将更加熟练地掌握 `ORDER BY` 的使用。