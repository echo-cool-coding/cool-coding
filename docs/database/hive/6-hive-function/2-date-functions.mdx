---
title: 日期函数
description: 了解 Hive 中的日期函数，掌握如何操作和处理日期数据。
---

# 日期函数

在数据分析和处理中，日期和时间是常见的数据类型。Hive 提供了丰富的日期函数，帮助开发者轻松处理日期数据。本文将详细介绍 Hive 中的日期函数，并通过示例展示其使用方法。

## 介绍

日期函数用于处理和操作日期数据。Hive 支持多种日期函数，包括日期格式化、日期加减、日期比较等。这些函数可以帮助我们从日期数据中提取有用的信息，或者对日期进行各种操作。

## 常用日期函数

### 1. `current_date()`

`current_date()` 函数返回当前日期。

```sql
SELECT current_date();
```

**输出：**
```
2023-10-05
```

### 2. `date_add(date, days)`

`date_add(date, days)` 函数将指定日期加上指定的天数。

```sql
SELECT date_add('2023-10-05', 7);
```

**输出：**
```
2023-10-12
```

### 3. `date_sub(date, days)`

`date_sub(date, days)` 函数将指定日期减去指定的天数。

```sql
SELECT date_sub('2023-10-05', 7);
```

**输出：**
```
2023-09-28
```

### 4. `datediff(enddate, startdate)`

`datediff(enddate, startdate)` 函数返回两个日期之间的天数差。

```sql
SELECT datediff('2023-10-12', '2023-10-05');
```

**输出：**
```
7
```

### 5. `year(date)`

`year(date)` 函数返回指定日期的年份。

```sql
SELECT year('2023-10-05');
```

**输出：**
```
2023
```

### 6. `month(date)`

`month(date)` 函数返回指定日期的月份。

```sql
SELECT month('2023-10-05');
```

**输出：**
```
10
```

### 7. `day(date)`

`day(date)` 函数返回指定日期的日。

```sql
SELECT day('2023-10-05');
```

**输出：**
```
5
```

### 8. `from_unixtime(unix_time, format)`

`from_unixtime(unix_time, format)` 函数将 Unix 时间戳转换为指定格式的日期字符串。

```sql
SELECT from_unixtime(1696521600, 'yyyy-MM-dd');
```

**输出：**
```
2023-10-05
```

### 9. `unix_timestamp(date, format)`

`unix_timestamp(date, format)` 函数将指定格式的日期字符串转换为 Unix 时间戳。

```sql
SELECT unix_timestamp('2023-10-05', 'yyyy-MM-dd');
```

**输出：**
```
1696521600
```

## 实际案例

假设我们有一个订单表 `orders`，其中包含订单日期 `order_date`。我们想要计算每个订单的交付日期，假设交付时间为订单日期后的 3 天。

```sql
SELECT order_id, order_date, date_add(order_date, 3) AS delivery_date
FROM orders;
```

**输出：**
| order_id | order_date | delivery_date |
|----------|------------|---------------|
| 1        | 2023-10-01 | 2023-10-04    |
| 2        | 2023-10-02 | 2023-10-05    |
| 3        | 2023-10-03 | 2023-10-06    |

## 总结

Hive 提供了丰富的日期函数，帮助开发者轻松处理日期数据。通过本文的介绍和示例，你应该已经掌握了如何使用这些函数来处理日期数据。在实际应用中，日期函数可以帮助你从日期数据中提取有用的信息，或者对日期进行各种操作。

## 附加资源

- [Hive 官方文档](https://cwiki.apache.org/confluence/display/Hive/LanguageManual+UDF)
- [Hive 日期函数参考](https://cwiki.apache.org/confluence/display/Hive/LanguageManual+UDF#LanguageManualUDF-DateFunctions)

## 练习

1. 使用 `date_add()` 函数计算当前日期 10 天后的日期。
2. 使用 `datediff()` 函数计算两个日期之间的天数差。
3. 使用 `from_unixtime()` 函数将 Unix 时间戳 `1696521600` 转换为 `yyyy-MM-dd HH:mm:ss` 格式的日期字符串。

通过完成这些练习，你将更加熟悉 Hive 中的日期函数。