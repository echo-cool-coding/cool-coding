---
title: SQL 插入查询结果
description: 学习如何使用SQL将查询结果插入到表中。本文详细介绍了INSERT INTO SELECT语句的用法，并通过示例和实际案例帮助初学者掌握这一重要技能。
---

# SQL 插入查询结果

在SQL中，`INSERT INTO SELECT`语句允许我们将一个查询的结果插入到另一个表中。这在需要将数据从一个表复制到另一个表，或者将筛选后的数据插入到新表时非常有用。本文将逐步介绍如何使用这一功能，并通过示例帮助你理解其实际应用。

## 1. 基本语法

`INSERT INTO SELECT`语句的基本语法如下：

```sql
INSERT INTO 目标表 (列1, 列2, 列3, ...)
SELECT 列1, 列2, 列3, ...
FROM 源表
WHERE 条件;
```

- **目标表**：你想要插入数据的表。
- **源表**：你从中选择数据的表。
- **列1, 列2, 列3, ...**：目标表和源表中对应的列名。如果列名相同，可以省略列名部分。

:::note
目标表和源表的列数和数据类型必须匹配，否则会导致插入失败。
:::

## 2. 示例：将查询结果插入到新表

假设我们有两个表：`employees` 和 `new_employees`。我们希望将`employees`表中所有工资大于5000的员工插入到`new_employees`表中。

### 表结构

```sql
CREATE TABLE employees (
    id INT PRIMARY KEY,
    name VARCHAR(100),
    salary DECIMAL(10, 2)
);

CREATE TABLE new_employees (
    id INT PRIMARY KEY,
    name VARCHAR(100),
    salary DECIMAL(10, 2)
);
```

### 插入数据

```sql
INSERT INTO new_employees (id, name, salary)
SELECT id, name, salary
FROM employees
WHERE salary > 5000;
```

### 结果

执行上述语句后，`new_employees`表将包含`employees`表中所有工资大于5000的员工记录。

## 3. 实际应用场景

### 场景1：数据备份

假设你需要定期备份某个表的数据。你可以使用`INSERT INTO SELECT`语句将数据复制到备份表中。

```sql
INSERT INTO employees_backup
SELECT * FROM employees;
```

### 场景2：数据迁移

在数据迁移过程中，你可能需要将部分数据从一个数据库迁移到另一个数据库。通过`INSERT INTO SELECT`，你可以轻松地将筛选后的数据插入到目标数据库中。

```sql
INSERT INTO new_database.employees
SELECT * FROM old_database.employees
WHERE department = 'IT';
```

## 4. 注意事项

- **主键冲突**：如果目标表有主键约束，插入的数据可能会导致主键冲突。你需要确保插入的数据不会违反主键约束。
- **数据类型匹配**：确保源表和目标表的列数据类型一致，否则会导致插入失败。
- **性能问题**：如果源表数据量很大，`INSERT INTO SELECT`可能会导致性能问题。在这种情况下，可以考虑分批插入数据。

:::caution
在执行`INSERT INTO SELECT`之前，建议先备份数据，以防止意外数据丢失。
:::

## 5. 总结

`INSERT INTO SELECT`是SQL中一个非常强大的工具，它允许你将查询结果插入到另一个表中。通过本文的学习，你应该能够理解其基本语法，并能够在实际场景中应用这一功能。

## 6. 附加资源与练习

### 练习1
创建一个新表`high_salary_employees`，并将`employees`表中工资大于10000的员工插入到该表中。

### 练习2
假设你有一个`orders`表和一个`archived_orders`表，请将`orders`表中所有已完成（status = 'completed'）的订单插入到`archived_orders`表中。

### 附加资源
- [SQL INSERT INTO SELECT 文档](https://www.w3schools.com/sql/sql_insert_into_select.asp)
- [SQL 数据类型](https://www.w3schools.com/sql/sql_datatypes.asp)

通过不断练习和探索，你将更加熟练地掌握SQL数据操作技能。祝你学习愉快！