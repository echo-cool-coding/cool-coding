---
title: SQL 优先级规则
description: 了解SQL中的优先级规则，掌握如何正确使用运算符和条件来过滤数据。
---

# SQL 优先级规则

在SQL中，优先级规则决定了表达式中运算符和条件的执行顺序。理解这些规则对于编写高效且准确的查询至关重要。本文将详细介绍SQL中的优先级规则，并通过实际案例帮助你掌握这一概念。

## 什么是SQL优先级规则？

SQL优先级规则定义了在表达式中运算符和条件的执行顺序。当SQL查询中包含多个运算符或条件时，优先级规则决定了哪些部分会先被计算。如果没有正确理解这些规则，可能会导致查询结果与预期不符。

## 常见的SQL运算符优先级

以下是SQL中常见运算符的优先级（从高到低）：

1. **括号 `()`**：括号内的表达式总是优先计算。
2. **算术运算符**：`*`（乘法）、`/`（除法）、`%`（取模）优先于 `+`（加法）和 `-`（减法）。
3. **比较运算符**：`=`、`!=`、`>`、`<`、`>=`、`<=` 等。
4. **逻辑运算符**：`NOT` 优先于 `AND`，`AND` 优先于 `OR`。

:::tip
使用括号可以显式地改变表达式的计算顺序，即使在不必要的情况下，使用括号也能提高代码的可读性。
:::

## 代码示例

假设我们有一个名为 `employees` 的表，其中包含以下数据：

| id  | name   | age | salary |
|-----|--------|-----|--------|
| 1   | Alice  | 30  | 50000  |
| 2   | Bob    | 25  | 45000  |
| 3   | Charlie| 35  | 60000  |
| 4   | David  | 40  | 70000  |

### 示例1：算术运算符优先级

```sql
SELECT name, salary * 1.1 + 1000 AS new_salary
FROM employees;
```

在这个查询中，`salary * 1.1` 会先被计算，然后再加 `1000`。这是因为乘法运算符 `*` 的优先级高于加法运算符 `+`。

### 示例2：逻辑运算符优先级

```sql
SELECT name
FROM employees
WHERE age > 30 AND salary > 50000 OR name = 'Alice';
```

在这个查询中，`age > 30 AND salary > 50000` 会先被计算，然后再与 `name = 'Alice'` 进行 `OR` 运算。这是因为 `AND` 的优先级高于 `OR`。

### 示例3：使用括号改变优先级

```sql
SELECT name
FROM employees
WHERE (age > 30 OR salary > 50000) AND name != 'Bob';
```

在这个查询中，括号内的 `age > 30 OR salary > 50000` 会先被计算，然后再与 `name != 'Bob'` 进行 `AND` 运算。括号显式地改变了表达式的计算顺序。

## 实际应用场景

假设你正在为一个电商网站编写SQL查询，需要筛选出满足以下条件的用户：

- 年龄大于25岁 **或者** 年收入大于50000美元。
- 并且，用户不是VIP会员。

你可以使用以下查询：

```sql
SELECT user_id, name
FROM users
WHERE (age > 25 OR annual_income > 50000) AND is_vip = FALSE;
```

在这个查询中，括号确保了 `age > 25 OR annual_income > 50000` 先被计算，然后再与 `is_vip = FALSE` 进行 `AND` 运算。

## 总结

理解SQL中的优先级规则是编写高效且准确查询的关键。通过掌握运算符的优先级，并合理使用括号，你可以确保查询的逻辑正确无误。在实际应用中，优先级的正确使用可以避免许多潜在的错误。

## 附加资源

- [SQL运算符优先级官方文档](https://www.sql.org/sql-priority.html)
- [SQL基础教程](https://www.sql-tutorial.com)

## 练习

1. 编写一个SQL查询，筛选出 `employees` 表中年龄大于30岁且工资大于50000美元，或者名字为 "Alice" 的员工。
2. 修改上述查询，使其只筛选出年龄大于30岁且工资大于50000美元，或者名字为 "Alice" 且工资大于45000美元的员工。

通过完成这些练习，你将更好地掌握SQL优先级规则的应用。