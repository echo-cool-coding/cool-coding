---
title: SQL 输入参数
description: 了解 SQL 存储过程中的输入参数，掌握如何定义和使用它们来增强存储过程的灵活性和可重用性。
---

# SQL 输入参数

在 SQL 存储过程中，输入参数是一个非常重要的概念。它们允许你将数据传递给存储过程，从而使存储过程能够根据不同的输入执行不同的操作。输入参数不仅提高了代码的灵活性，还增强了存储过程的可重用性。

## 什么是 SQL 输入参数？

输入参数是存储过程中用于接收外部数据的变量。它们允许你在调用存储过程时传递值，这些值可以在存储过程内部使用。通过使用输入参数，你可以编写更加通用和灵活的存储过程，而不必为每个特定的值编写不同的存储过程。

### 输入参数的基本语法

在 SQL 中，输入参数通常在存储过程的定义中声明。以下是一个简单的示例，展示了如何定义一个带有输入参数的存储过程：

```sql
CREATE PROCEDURE GetEmployeeDetails
    @EmployeeID INT
AS
BEGIN
    SELECT * FROM Employees WHERE EmployeeID = @EmployeeID;
END;
```

在这个示例中，`@EmployeeID` 是一个输入参数，它的数据类型是 `INT`。当调用这个存储过程时，你需要传递一个整数值给 `@EmployeeID`，存储过程将根据这个值返回相应的员工信息。

## 如何使用输入参数

### 调用带有输入参数的存储过程

要调用带有输入参数的存储过程，你需要在调用时提供相应的参数值。以下是如何调用上面定义的 `GetEmployeeDetails` 存储过程的示例：

```sql
EXEC GetEmployeeDetails @EmployeeID = 1;
```

在这个示例中，我们传递了 `1` 作为 `@EmployeeID` 的值。存储过程将返回 `EmployeeID` 为 `1` 的员工信息。

### 多个输入参数

存储过程可以有多个输入参数。以下是一个带有两个输入参数的存储过程示例：

```sql
CREATE PROCEDURE GetEmployeesByDepartmentAndSalary
    @DepartmentID INT,
    @MinSalary DECIMAL(18, 2)
AS
BEGIN
    SELECT * FROM Employees WHERE DepartmentID = @DepartmentID AND Salary >= @MinSalary;
END;
```

在这个示例中，存储过程 `GetEmployeesByDepartmentAndSalary` 有两个输入参数：`@DepartmentID` 和 `@MinSalary`。你可以通过以下方式调用这个存储过程：

```sql
EXEC GetEmployeesByDepartmentAndSalary @DepartmentID = 2, @MinSalary = 50000;
```

这个调用将返回 `DepartmentID` 为 `2` 且工资大于或等于 `50000` 的所有员工信息。

## 实际应用场景

### 动态查询

输入参数的一个常见用途是创建动态查询。例如，你可能需要根据用户输入的不同条件来查询数据库。通过使用输入参数，你可以编写一个通用的存储过程，根据不同的输入返回不同的结果。

```sql
CREATE PROCEDURE SearchEmployees
    @FirstName NVARCHAR(50) = NULL,
    @LastName NVARCHAR(50) = NULL,
    @DepartmentID INT = NULL
AS
BEGIN
    SELECT * FROM Employees
    WHERE (FirstName = @FirstName OR @FirstName IS NULL)
      AND (LastName = @LastName OR @LastName IS NULL)
      AND (DepartmentID = @DepartmentID OR @DepartmentID IS NULL);
END;
```

在这个示例中，存储过程 `SearchEmployees` 可以根据 `FirstName`、`LastName` 和 `DepartmentID` 的不同组合来查询员工信息。如果某个参数为 `NULL`，则该条件将被忽略。

### 数据验证

输入参数还可以用于数据验证。你可以在存储过程中检查输入参数的值，并根据需要执行不同的操作。例如：

```sql
CREATE PROCEDURE UpdateEmployeeSalary
    @EmployeeID INT,
    @NewSalary DECIMAL(18, 2)
AS
BEGIN
    IF @NewSalary < 0
    BEGIN
        RAISERROR('Salary cannot be negative.', 16, 1);
        RETURN;
    END

    UPDATE Employees SET Salary = @NewSalary WHERE EmployeeID = @EmployeeID;
END;
```

在这个示例中，存储过程 `UpdateEmployeeSalary` 会检查 `@NewSalary` 是否为负数。如果是负数，存储过程将抛出一个错误并终止执行。

## 总结

SQL 输入参数是存储过程中非常强大的工具，它们允许你将数据传递给存储过程，从而使存储过程更加灵活和可重用。通过使用输入参数，你可以编写通用的存储过程，根据不同的输入执行不同的操作。

在实际应用中，输入参数可以用于动态查询、数据验证等多种场景。掌握输入参数的使用，将帮助你编写更加高效和灵活的 SQL 代码。

## 附加资源与练习

- **练习 1**: 编写一个存储过程，接受一个 `ProductID` 作为输入参数，并返回该产品的详细信息。
- **练习 2**: 修改 `SearchEmployees` 存储过程，使其能够根据 `Salary` 范围进行查询。
- **附加资源**: 阅读 SQL Server 官方文档中关于存储过程和输入参数的部分，深入了解其高级用法。

通过不断练习和探索，你将能够更好地理解和应用 SQL 输入参数。