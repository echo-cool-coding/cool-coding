---
title: SQL 输出参数
description: 了解 SQL 存储过程中的输出参数，掌握其定义、使用方法以及实际应用场景。
---

## 介绍

在 SQL 存储过程中，输出参数（Output Parameters）是一种用于从存储过程返回数据的方式。与输入参数不同，输出参数允许存储过程在执行完成后将结果传递回调用者。这对于需要返回多个值的场景非常有用，例如计算某些值并将其返回给调用者。

在本教程中，我们将详细介绍 SQL 输出参数的概念、语法以及如何在存储过程中使用它们。我们还将通过实际案例来展示输出参数的应用场景。

## 什么是输出参数？

输出参数是存储过程中用于返回数据的参数。它们与输入参数不同，输入参数用于向存储过程传递数据，而输出参数则用于从存储过程返回数据。输出参数在存储过程执行完成后，会将值传递回调用者。

输出参数通常用于以下场景：
- 需要返回多个值的存储过程。
- 需要返回计算结果或状态信息的存储过程。

## 输出参数的语法

在 SQL 中，输出参数的定义与输入参数类似，但在参数名前使用 `OUTPUT` 关键字来标识它是一个输出参数。以下是输出参数的基本语法：

```sql
CREATE PROCEDURE ProcedureName
    @InputParameter INT,
    @OutputParameter INT OUTPUT
AS
BEGIN
    -- 存储过程的逻辑
    SET @OutputParameter = @InputParameter * 2
END
```

在上面的示例中，`@OutputParameter` 是一个输出参数，存储过程将其值设置为输入参数的两倍。

## 使用输出参数的示例

让我们通过一个简单的示例来演示如何使用输出参数。假设我们有一个存储过程，它接受一个整数作为输入，并返回该整数的平方作为输出。

```sql
CREATE PROCEDURE CalculateSquare
    @InputNumber INT,
    @OutputSquare INT OUTPUT
AS
BEGIN
    SET @OutputSquare = @InputNumber * @InputNumber
END
```

要调用这个存储过程并获取输出参数的值，可以使用以下 SQL 语句：

```sql
DECLARE @Result INT
EXEC CalculateSquare @InputNumber = 5, @OutputSquare = @Result OUTPUT
SELECT @Result AS SquareResult
```

在这个示例中，存储过程 `CalculateSquare` 接受一个输入参数 `@InputNumber` 并返回其平方值。调用存储过程后，`@Result` 变量将包含输出参数的值，即 `25`。

## 实际应用场景

输出参数在实际应用中有很多用途。以下是一个常见的场景：

### 场景：计算订单总金额

假设我们有一个存储过程，用于计算某个订单的总金额，并将结果返回给调用者。我们可以使用输出参数来实现这一点。

```sql
CREATE PROCEDURE CalculateOrderTotal
    @OrderID INT,
    @TotalAmount DECIMAL(10, 2) OUTPUT
AS
BEGIN
    SELECT @TotalAmount = SUM(Quantity * UnitPrice)
    FROM OrderDetails
    WHERE OrderID = @OrderID
END
```

在这个示例中，存储过程 `CalculateOrderTotal` 接受一个订单 ID 作为输入，并计算该订单的总金额。计算结果通过输出参数 `@TotalAmount` 返回给调用者。

调用存储过程的 SQL 语句如下：

```sql
DECLARE @OrderTotal DECIMAL(10, 2)
EXEC CalculateOrderTotal @OrderID = 12345, @TotalAmount = @OrderTotal OUTPUT
SELECT @OrderTotal AS OrderTotalAmount
```

在这个场景中，输出参数 `@TotalAmount` 用于返回订单的总金额，调用者可以通过 `@OrderTotal` 变量获取该值。

## 总结

输出参数是 SQL 存储过程中非常有用的功能，它允许存储过程在执行完成后将数据返回给调用者。通过使用输出参数，我们可以轻松地返回多个值或计算结果，从而增强存储过程的功能。

在本教程中，我们介绍了输出参数的基本概念、语法以及实际应用场景。通过示例代码，我们展示了如何在存储过程中定义和使用输出参数，并演示了如何调用存储过程以获取输出参数的值。

## 附加资源与练习

为了进一步巩固你对输出参数的理解，建议你尝试以下练习：

1. 创建一个存储过程，接受两个整数作为输入，并返回它们的和与积作为输出参数。
2. 修改现有的存储过程，使其能够处理 NULL 值并返回适当的默认值。

通过这些练习，你将更深入地理解输出参数的使用方法，并能够在实际项目中灵活应用它们。