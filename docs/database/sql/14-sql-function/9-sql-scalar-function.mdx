---
title: SQL 标量函数
description: 了解SQL标量函数的基本概念、使用方法及其在实际场景中的应用。本文适合初学者，包含详细的代码示例和实际案例。
---

# SQL 标量函数

SQL标量函数是SQL中一种重要的函数类型，它接受一个或多个输入值，并返回一个单一的值。与聚合函数不同，标量函数对每一行数据都进行计算，并返回一个结果。标量函数可以用于SELECT语句、WHERE子句、ORDER BY子句等地方，是SQL查询中不可或缺的一部分。

## 什么是标量函数？

标量函数（Scalar Function）是一种SQL函数，它对每一行数据进行操作，并返回一个单一的值。标量函数可以接受一个或多个参数，但始终返回一个值。常见的标量函数包括字符串函数、数学函数、日期函数等。

### 标量函数的特点
- **单值返回**：标量函数始终返回一个单一的值。
- **逐行操作**：标量函数对每一行数据进行操作，而不是对整个数据集进行操作。
- **广泛应用**：标量函数可以用于SELECT语句、WHERE子句、ORDER BY子句等。

## 常见的标量函数

### 1. 字符串函数

字符串函数用于处理文本数据。以下是一些常见的字符串函数：

- `LENGTH()`：返回字符串的长度。
- `UPPER()`：将字符串转换为大写。
- `LOWER()`：将字符串转换为小写。
- `SUBSTRING()`：从字符串中提取子字符串。

#### 示例

```sql
SELECT LENGTH('Hello World') AS length;
```

**输出：**
```
length
-------
11
```

```sql
SELECT UPPER('hello') AS upper_case;
```

**输出：**
```
upper_case
-----------
HELLO
```

### 2. 数学函数

数学函数用于执行数学运算。以下是一些常见的数学函数：

- `ABS()`：返回绝对值。
- `ROUND()`：四舍五入到指定的小数位数。
- `CEIL()`：向上取整。
- `FLOOR()`：向下取整。

#### 示例

```sql
SELECT ABS(-10) AS absolute_value;
```

**输出：**
```
absolute_value
--------------
10
```

```sql
SELECT ROUND(3.14159, 2) AS rounded_value;
```

**输出：**
```
rounded_value
-------------
3.14
```

### 3. 日期函数

日期函数用于处理日期和时间数据。以下是一些常见的日期函数：

- `NOW()`：返回当前日期和时间。
- `DATE()`：提取日期部分。
- `YEAR()`：提取年份。
- `MONTH()`：提取月份。

#### 示例

```sql
SELECT NOW() AS current_datetime;
```

**输出：**
```
current_datetime
----------------
2023-10-05 12:34:56
```

```sql
SELECT YEAR('2023-10-05') AS year;
```

**输出：**
```
year
-----
2023
```

## 实际应用场景

### 场景1：格式化用户姓名

假设我们有一个用户表 `users`，其中包含用户的姓名（`first_name` 和 `last_name`）。我们希望将用户的姓名格式化为全大写，并在中间加上一个空格。

```sql
SELECT UPPER(first_name) || ' ' || UPPER(last_name) AS full_name
FROM users;
```

**输出：**
```
full_name
---------
JOHN DOE
JANE SMITH
```

### 场景2：计算订单的总金额

假设我们有一个订单表 `orders`，其中包含订单的金额（`amount`）和折扣（`discount`）。我们希望计算每个订单的实际支付金额。

```sql
SELECT amount, discount, amount * (1 - discount) AS final_amount
FROM orders;
```

**输出：**
```
amount | discount | final_amount
-------|----------|--------------
100    | 0.1      | 90
200    | 0.2      | 160
```

## 总结

SQL标量函数是SQL查询中非常重要的一部分，它们可以对每一行数据进行操作，并返回一个单一的值。通过使用标量函数，我们可以轻松地处理字符串、数学运算和日期时间等数据。掌握标量函数的使用，将大大提高我们在SQL查询中的灵活性和效率。

## 附加资源与练习

- **练习1**：编写一个SQL查询，使用 `SUBSTRING()` 函数提取用户邮箱地址的域名部分。
- **练习2**：编写一个SQL查询，使用 `DATE()` 和 `NOW()` 函数计算用户的年龄。

:::tip
建议初学者多动手实践，尝试在不同的场景中使用标量函数，以加深理解。
:::