---
title: SQL 全外连接
description: 了解SQL中的全外连接（FULL OUTER JOIN），掌握如何将两个表中的所有记录合并，即使某些记录在另一个表中没有匹配项。
---

# SQL 全外连接

在SQL中，**全外连接（FULL OUTER JOIN）** 是一种用于合并两个表的连接方式。它返回两个表中所有记录的组合，即使某些记录在另一个表中没有匹配项。如果某个表中的记录在另一个表中没有匹配项，结果集中将显示 `NULL` 值。

## 什么是全外连接？

全外连接是左外连接（LEFT OUTER JOIN）和右外连接（RIGHT OUTER JOIN）的结合。它返回两个表中所有记录的组合，无论它们是否有匹配项。如果某个表中的记录在另一个表中没有匹配项，结果集中将显示 `NULL` 值。

### 语法

```sql
SELECT 列名
FROM 表1
FULL OUTER JOIN 表2
ON 表1.列名 = 表2.列名;
```

## 示例

假设我们有两个表：`Customers` 和 `Orders`。

### 表结构

```sql
CREATE TABLE Customers (
    CustomerID INT PRIMARY KEY,
    CustomerName VARCHAR(100)
);

CREATE TABLE Orders (
    OrderID INT PRIMARY KEY,
    CustomerID INT,
    OrderDate DATE
);
```

### 插入数据

```sql
INSERT INTO Customers (CustomerID, CustomerName) VALUES
(1, 'Alice'),
(2, 'Bob'),
(3, 'Charlie');

INSERT INTO Orders (OrderID, CustomerID, OrderDate) VALUES
(101, 1, '2023-01-01'),
(102, 2, '2023-02-01'),
(103, 4, '2023-03-01');
```

### 执行全外连接

```sql
SELECT Customers.CustomerID, Customers.CustomerName, Orders.OrderID, Orders.OrderDate
FROM Customers
FULL OUTER JOIN Orders
ON Customers.CustomerID = Orders.CustomerID;
```

### 输出结果

| CustomerID | CustomerName | OrderID | OrderDate  |
|------------|--------------|---------|------------|
| 1          | Alice        | 101     | 2023-01-01 |
| 2          | Bob          | 102     | 2023-02-01 |
| 3          | Charlie      | NULL    | NULL       |
| NULL       | NULL         | 103     | 2023-03-01 |

### 解释

- **Alice** 和 **Bob** 在 `Customers` 表和 `Orders` 表中都有匹配的记录，因此它们的记录被合并。
- **Charlie** 在 `Customers` 表中有记录，但在 `Orders` 表中没有匹配的记录，因此 `OrderID` 和 `OrderDate` 显示为 `NULL`。
- `Orders` 表中有一个订单（`OrderID = 103`）对应的 `CustomerID = 4`，但在 `Customers` 表中没有匹配的记录，因此 `CustomerID` 和 `CustomerName` 显示为 `NULL`。

## 实际应用场景

全外连接在实际应用中非常有用，特别是在需要分析两个数据集之间的完整关系时。例如：

- **客户与订单分析**：分析所有客户及其订单，包括那些没有订单的客户和没有对应客户的订单。
- **员工与部门分析**：分析所有员工及其所属部门，包括那些没有分配部门的员工和没有员工的部门。

## 总结

全外连接是一种强大的工具，可以帮助你合并两个表中的所有记录，即使某些记录在另一个表中没有匹配项。通过使用全外连接，你可以更全面地分析数据，确保不会遗漏任何重要信息。

## 附加资源与练习

- **练习**：尝试在你的数据库中创建两个表，并使用全外连接合并它们。观察结果，并理解 `NULL` 值的含义。
- **进一步学习**：了解更多关于SQL连接的知识，包括内连接（INNER JOIN）、左外连接（LEFT OUTER JOIN）和右外连接（RIGHT OUTER JOIN）。

:::tip
记住，全外连接在某些数据库系统中可能不被支持（例如MySQL不支持全外连接）。在这种情况下，你可以通过联合左外连接和右外连接来模拟全外连接。
:::