---
title: PostgreSQL 表继承
description: 了解PostgreSQL中的表继承功能，掌握如何使用继承创建和管理表之间的关系。
---

# PostgreSQL 表继承

PostgreSQL的表继承功能允许你创建一个表，并从另一个表中继承结构和数据。这种功能在数据库设计中非常有用，尤其是在需要共享某些字段或逻辑时。本文将详细介绍PostgreSQL表继承的概念、用法以及实际应用场景。

## 什么是表继承？

表继承是PostgreSQL中的一项功能，允许你创建一个新表（子表），并从现有表（父表）中继承所有列。子表不仅继承了父表的结构，还可以拥有自己的额外列。这种机制类似于面向对象编程中的类继承。

:::note
表继承是PostgreSQL独有的功能，其他数据库管理系统（如MySQL或SQL Server）并不支持。
:::

## 创建继承表

要创建一个继承表，可以使用 `INHERITS` 关键字。以下是一个简单的示例：

```sql
-- 创建父表
CREATE TABLE vehicles (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    speed INT
);

-- 创建子表并继承父表
CREATE TABLE cars (
    fuel_type VARCHAR(50)
) INHERITS (vehicles);
```

在这个例子中，`cars` 表继承了 `vehicles` 表的所有列（`id`, `name`, `speed`），并且还添加了一个新的列 `fuel_type`。

## 查询继承表

当你查询父表时，PostgreSQL会自动包含所有子表的数据。例如：

```sql
-- 插入数据
INSERT INTO vehicles (name, speed) VALUES ('Vehicle 1', 100);
INSERT INTO cars (name, speed, fuel_type) VALUES ('Car 1', 120, 'Gasoline');

-- 查询父表
SELECT * FROM vehicles;
```

输出结果将包括 `vehicles` 表和 `cars` 表中的所有数据：

```
 id |    name    | speed
----+------------+-------
  1 | Vehicle 1  |   100
  2 | Car 1      |   120
```

:::tip
如果你只想查询父表的数据，可以使用 `ONLY` 关键字：
```sql
SELECT * FROM ONLY vehicles;
```
:::

## 实际应用场景

### 1. 数据分区

表继承可以用于数据分区。例如，你可以为每个月的数据创建一个子表，并从父表中继承结构。这样可以提高查询性能，并简化数据管理。

```sql
-- 创建父表
CREATE TABLE sales (
    id SERIAL PRIMARY KEY,
    sale_date DATE,
    amount NUMERIC
);

-- 创建子表并继承父表
CREATE TABLE sales_2023_01 () INHERITS (sales);
CREATE TABLE sales_2023_02 () INHERITS (sales);
```

### 2. 多态数据存储

在某些情况下，你可能需要存储不同类型的数据，但这些数据共享一些公共字段。表继承可以帮助你实现这一点。

```sql
-- 创建父表
CREATE TABLE products (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    price NUMERIC
);

-- 创建子表并继承父表
CREATE TABLE electronics (
    warranty_period INT
) INHERITS (products);

CREATE TABLE books (
    author VARCHAR(100)
) INHERITS (products);
```

## 总结

PostgreSQL的表继承功能为数据库设计提供了强大的灵活性。通过继承，你可以轻松地共享表结构，并在子表中添加额外的字段。这种机制在数据分区和多态数据存储等场景中尤为有用。

:::caution
虽然表继承功能强大，但在使用时需要注意查询性能和数据一致性。确保在设计数据库时充分考虑这些因素。
:::

## 附加资源

- [PostgreSQL官方文档 - 表继承](https://www.postgresql.org/docs/current/ddl-inherit.html)
- 练习：尝试创建一个父表和多个子表，并插入数据。然后查询父表，观察结果。

通过本文的学习，你应该对PostgreSQL的表继承有了初步的了解。继续实践和探索，你将能够更好地掌握这一功能。