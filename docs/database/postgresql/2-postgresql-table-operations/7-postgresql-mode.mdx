---
title: PostgreSQL 模式
description: 了解 PostgreSQL 模式的概念、用途以及如何在数据库中使用模式来组织和管理表。
---

## 介绍

在 PostgreSQL 中，**模式（Schema）** 是一个命名空间，用于组织数据库对象（如表、视图、函数等）。模式可以帮助你更好地管理数据库中的对象，尤其是在数据库中有大量表或对象时。通过使用模式，你可以将相关的表分组，避免命名冲突，并提高数据库的可维护性。

默认情况下，PostgreSQL 会为每个数据库创建一个名为 `public` 的模式。所有用户都可以访问这个模式，并且在没有指定模式的情况下，表和其他对象会被创建在 `public` 模式中。

## 创建模式

要创建一个新的模式，可以使用 `CREATE SCHEMA` 语句。以下是一个简单的示例：

```sql
CREATE SCHEMA my_schema;
```

这将创建一个名为 `my_schema` 的模式。你可以在这个模式中创建表、视图等对象。

## 在模式中创建表

在创建表时，你可以指定表所属的模式。例如：

```sql
CREATE TABLE my_schema.my_table (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL
);
```

这将在 `my_schema` 模式中创建一个名为 `my_table` 的表。

## 访问模式中的表

要访问特定模式中的表，你需要使用模式的名称作为前缀。例如：

```sql
SELECT * FROM my_schema.my_table;
```

如果你没有指定模式名称，PostgreSQL 会默认在 `public` 模式中查找表。

## 设置默认模式

你可以通过设置 `search_path` 来指定默认的模式。`search_path` 是一个配置参数，它决定了 PostgreSQL 在查找表和其他对象时应该搜索哪些模式。例如：

```sql
SET search_path TO my_schema, public;
```

这将使 PostgreSQL 首先在 `my_schema` 中查找对象，如果找不到，再在 `public` 模式中查找。

## 实际应用场景

假设你正在开发一个多租户应用程序，每个租户的数据需要隔离。你可以为每个租户创建一个单独的模式，并在该模式中存储租户的表和数据。这样，你可以轻松地管理每个租户的数据，而不会相互干扰。

例如：

```sql
CREATE SCHEMA tenant1;
CREATE SCHEMA tenant2;

CREATE TABLE tenant1.customers (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL
);

CREATE TABLE tenant2.customers (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL
);
```

在这个例子中，`tenant1` 和 `tenant2` 是两个不同的租户，每个租户都有自己的 `customers` 表。

## 总结

PostgreSQL 模式是一个强大的工具，可以帮助你更好地组织和管理数据库中的对象。通过使用模式，你可以避免命名冲突，提高数据库的可维护性，并在多租户应用程序中实现数据隔离。

## 附加资源

- [PostgreSQL 官方文档 - 模式](https://www.postgresql.org/docs/current/ddl-schemas.html)
- [PostgreSQL 模式管理教程](https://www.postgresqltutorial.com/postgresql-schema/)

## 练习

1. 创建一个名为 `inventory` 的模式，并在其中创建一个名为 `products` 的表。
2. 设置 `search_path`，使 PostgreSQL 默认在 `inventory` 模式中查找表。
3. 尝试在 `public` 模式和 `inventory` 模式中创建同名的表，并观察 PostgreSQL 如何处理命名冲突。
