---
title: PostgreSQL 网络地址
description: 了解 PostgreSQL 中的网络地址数据类型及其实际应用场景。本文适合初学者，涵盖基本概念、代码示例和实际案例。
---

# PostgreSQL 网络地址

PostgreSQL 提供了多种数据类型来处理网络地址，这些数据类型非常适合存储和操作 IP 地址、MAC 地址等网络相关的信息。本文将详细介绍 PostgreSQL 中的网络地址数据类型，并通过示例展示其用法。

## 网络地址数据类型简介

PostgreSQL 支持以下几种网络地址数据类型：

- `inet`：用于存储 IPv4 或 IPv6 地址及其子网掩码。
- `cidr`：用于存储 IPv4 或 IPv6 网络地址及其子网掩码。
- `macaddr`：用于存储 MAC 地址。

这些数据类型不仅能够存储网络地址，还提供了一系列操作符和函数来方便地处理这些数据。

## `inet` 数据类型

`inet` 数据类型用于存储 IPv4 或 IPv6 地址及其子网掩码。它可以表示单个主机地址或整个网络地址。

### 示例

```sql
CREATE TABLE devices (
    id SERIAL PRIMARY KEY,
    name TEXT,
    ip_address INET
);

INSERT INTO devices (name, ip_address) VALUES
('Router', '192.168.1.1'),
('Server', '2001:db8::1/64');
```

### 查询示例

```sql
SELECT * FROM devices WHERE ip_address << '192.168.1.0/24';
```

### 输出

| id | name   | ip_address       |
|----|--------|------------------|
| 1  | Router | 192.168.1.1      |

## `cidr` 数据类型

`cidr` 数据类型用于存储 IPv4 或 IPv6 网络地址及其子网掩码。与 `inet` 不同，`cidr` 只能表示网络地址，而不能表示单个主机地址。

### 示例

```sql
CREATE TABLE networks (
    id SERIAL PRIMARY KEY,
    network CIDR
);

INSERT INTO networks (network) VALUES
('192.168.1.0/24'),
('2001:db8::/32');
```

### 查询示例

```sql
SELECT * FROM networks WHERE network >> '192.168.1.1';
```

### 输出

| id | network        |
|----|----------------|
| 1  | 192.168.1.0/24 |

## `macaddr` 数据类型

`macaddr` 数据类型用于存储 MAC 地址。MAC 地址是网络设备的硬件地址，通常用于局域网中。

### 示例

```sql
CREATE TABLE network_devices (
    id SERIAL PRIMARY KEY,
    name TEXT,
    mac_address MACADDR
);

INSERT INTO network_devices (name, mac_address) VALUES
('Switch', '08:00:2b:01:02:03'),
('Router', '00:1a:2b:3c:4d:5e');
```

### 查询示例

```sql
SELECT * FROM network_devices WHERE mac_address = '08:00:2b:01:02:03';
```

### 输出

| id | name   | mac_address       |
|----|--------|-------------------|
| 1  | Switch | 08:00:2b:01:02:03 |

## 实际应用场景

### 场景 1：网络设备管理

假设你正在管理一个大型网络，需要记录每个设备的 IP 地址和 MAC 地址。使用 `inet` 和 `macaddr` 数据类型可以方便地存储和查询这些信息。

```sql
CREATE TABLE network_inventory (
    id SERIAL PRIMARY KEY,
    device_name TEXT,
    ip_address INET,
    mac_address MACADDR
);

INSERT INTO network_inventory (device_name, ip_address, mac_address) VALUES
('Router 1', '192.168.1.1', '08:00:2b:01:02:03'),
('Switch 1', '192.168.1.2', '00:1a:2b:3c:4d:5e');
```

### 场景 2：子网划分

假设你需要管理多个子网，并记录每个子网的网络地址和子网掩码。使用 `cidr` 数据类型可以方便地存储和查询这些信息。

```sql
CREATE TABLE subnets (
    id SERIAL PRIMARY KEY,
    subnet_name TEXT,
    network CIDR
);

INSERT INTO subnets (subnet_name, network) VALUES
('Office LAN', '192.168.1.0/24'),
('Data Center', '10.0.0.0/16');
```

## 总结

PostgreSQL 提供了强大的网络地址数据类型，包括 `inet`、`cidr` 和 `macaddr`，这些数据类型非常适合存储和操作网络相关的信息。通过本文的介绍和示例，你应该能够理解这些数据类型的基本用法，并在实际项目中应用它们。

## 附加资源

- [PostgreSQL 官方文档 - 网络地址类型](https://www.postgresql.org/docs/current/datatype-net-types.html)
- [PostgreSQL 网络地址操作符和函数](https://www.postgresql.org/docs/current/functions-net.html)

## 练习

1. 创建一个表来存储你的家庭网络设备，包括设备的名称、IP 地址和 MAC 地址。
2. 编写一个查询，查找所有在 `192.168.1.0/24` 子网中的设备。
3. 尝试使用 `cidr` 数据类型来存储你所在公司的子网信息，并编写查询来查找包含特定 IP 地址的子网。

通过完成这些练习，你将更深入地理解 PostgreSQL 中的网络地址数据类型及其应用。