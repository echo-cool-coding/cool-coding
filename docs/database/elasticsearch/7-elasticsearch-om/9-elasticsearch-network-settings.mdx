---
title: Elasticsearch 网络设置
description: 了解如何配置和管理 Elasticsearch 的网络设置，确保集群的高效通信和安全性。
---

## 介绍

Elasticsearch 是一个分布式搜索引擎，其核心功能依赖于节点之间的高效通信。网络设置是 Elasticsearch 运维管理中的重要部分，直接影响集群的性能和稳定性。本文将详细介绍 Elasticsearch 的网络设置，包括如何配置网络接口、绑定地址、端口以及安全通信等。

## 1. 网络接口与绑定地址

Elasticsearch 节点需要绑定到特定的网络接口和地址，以便其他节点和客户端能够访问它。默认情况下，Elasticsearch 会绑定到 `localhost`，这意味着它只能在本地访问。为了允许远程访问，你需要修改 `network.host` 配置。

### 配置示例

在 `elasticsearch.yml` 文件中，添加或修改以下配置：

```yaml
network.host: 192.168.1.100
```

这将使 Elasticsearch 绑定到 `192.168.1.100` 这个 IP 地址。你也可以使用 `_local_` 和 `_site_` 等特殊值来绑定到本地接口或站点本地地址。

:::tip
如果你希望 Elasticsearch 绑定到所有可用的网络接口，可以使用 `0.0.0.0`。但请注意，这可能会带来安全风险。
:::

## 2. 端口设置

Elasticsearch 默认使用 `9200` 端口用于 HTTP 通信，`9300` 端口用于节点间的通信。你可以通过 `http.port` 和 `transport.port` 配置项来修改这些端口。

### 配置示例

```yaml
http.port: 9201
transport.port: 9301
```

这将使 Elasticsearch 使用 `9201` 和 `9301` 端口。

:::caution
修改端口后，确保防火墙规则允许这些端口的通信。
:::

## 3. 网络通信安全

在生产环境中，确保 Elasticsearch 集群的通信安全至关重要。你可以通过以下方式增强网络安全性：

### 3.1 使用 TLS/SSL 加密通信

Elasticsearch 支持 TLS/SSL 加密，以防止数据在传输过程中被窃听或篡改。你需要生成证书并在 `elasticsearch.yml` 中配置。

```yaml
xpack.security.transport.ssl.enabled: true
xpack.security.transport.ssl.keystore.path: certs/elastic-certificates.p12
xpack.security.transport.ssl.truststore.path: certs/elastic-certificates.p12
```

### 3.2 启用身份验证

Elasticsearch 提供了内置的身份验证机制，可以通过 `xpack.security.enabled` 启用。

```yaml
xpack.security.enabled: true
```

:::warning
启用身份验证后，确保为所有用户设置强密码，并定期更新。
:::

## 4. 实际案例

假设你有一个由三个节点组成的 Elasticsearch 集群，分别位于不同的数据中心。为了确保节点间的高效通信和数据安全，你需要进行以下配置：

1. **绑定地址**：每个节点绑定到其所在数据中心的私有 IP 地址。
2. **端口设置**：使用默认端口 `9200` 和 `9300`，但确保防火墙规则允许这些端口的通信。
3. **安全通信**：启用 TLS/SSL 加密和身份验证，确保数据在传输过程中不被窃听或篡改。

### 配置示例

```yaml
# 节点 1
network.host: 192.168.1.101
xpack.security.transport.ssl.enabled: true
xpack.security.enabled: true

# 节点 2
network.host: 192.168.1.102
xpack.security.transport.ssl.enabled: true
xpack.security.enabled: true

# 节点 3
network.host: 192.168.1.103
xpack.security.transport.ssl.enabled: true
xpack.security.enabled: true
```

## 5. 总结

Elasticsearch 的网络设置是确保集群高效运行和安全通信的关键。通过合理配置网络接口、端口和安全机制，你可以构建一个稳定且安全的 Elasticsearch 集群。

## 6. 附加资源与练习

- **练习**：尝试在你的本地环境中配置一个双节点 Elasticsearch 集群，并启用 TLS/SSL 加密。
- **资源**：
  - [Elasticsearch 官方文档](https://www.elastic.co/guide/en/elasticsearch/reference/current/index.html)
  - [Elasticsearch 安全指南](https://www.elastic.co/guide/en/elasticsearch/reference/current/security-settings.html)

通过本文的学习，你应该能够理解并配置 Elasticsearch 的网络设置，为构建高效、安全的搜索集群打下坚实基础。