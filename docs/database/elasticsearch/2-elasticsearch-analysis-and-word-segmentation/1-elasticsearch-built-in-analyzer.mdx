---
title: Elasticsearch 内置分析器
description: 了解Elasticsearch内置分析器的基本概念、类型及其在实际应用中的使用方法。
---

# Elasticsearch 内置分析器

Elasticsearch 是一个强大的搜索引擎，它能够快速、高效地处理和分析大量数据。为了实现这一目标，Elasticsearch 提供了多种内置分析器（Analyzer），这些分析器可以帮助我们对文本进行分词、过滤和标准化处理。本文将详细介绍 Elasticsearch 内置分析器的概念、类型以及如何在实际应用中使用它们。

## 什么是分析器？

在 Elasticsearch 中，分析器（Analyzer）是用于处理文本数据的工具。它通常由三个部分组成：

1. **字符过滤器（Character Filters）**：用于在分词之前对原始文本进行预处理，例如去除 HTML 标签或替换特定字符。
2. **分词器（Tokenizer）**：将文本拆分为单个词条（Token），例如按空格或标点符号进行分词。
3. **词条过滤器（Token Filters）**：对分词后的词条进行进一步处理，例如转换为小写、去除停用词或添加同义词。

Elasticsearch 提供了多种内置分析器，每种分析器都有其特定的用途和功能。

## 内置分析器的类型

Elasticsearch 提供了以下几种常见的内置分析器：

### 1. Standard Analyzer

`standard` 分析器是 Elasticsearch 的默认分析器。它使用 Unicode 文本分割算法进行分词，并将词条转换为小写。`standard` 分析器适用于大多数语言的文本分析。

**示例：**

```json
POST _analyze
{
  "analyzer": "standard",
  "text": "The quick brown fox jumps over the lazy dog."
}
```

**输出：**

```json
{
  "tokens": [
    {
      "token": "the",
      "start_offset": 0,
      "end_offset": 3,
      "type": "<ALPHANUM>",
      "position": 0
    },
    {
      "token": "quick",
      "start_offset": 4,
      "end_offset": 9,
      "type": "<ALPHANUM>",
      "position": 1
    },
    // 其他词条...
  ]
}
```

### 2. Simple Analyzer

`simple` 分析器将文本按非字母字符进行分词，并将词条转换为小写。它适用于简单的文本分析场景。

**示例：**

```json
POST _analyze
{
  "analyzer": "simple",
  "text": "The quick brown fox jumps over the lazy dog."
}
```

**输出：**

```json
{
  "tokens": [
    {
      "token": "the",
      "start_offset": 0,
      "end_offset": 3,
      "type": "word",
      "position": 0
    },
    {
      "token": "quick",
      "start_offset": 4,
      "end_offset": 9,
      "type": "word",
      "position": 1
    },
    // 其他词条...
  ]
}
```

### 3. Whitespace Analyzer

`whitespace` 分析器按空格进行分词，但不会将词条转换为小写。它适用于需要保留原始大小写的场景。

**示例：**

```json
POST _analyze
{
  "analyzer": "whitespace",
  "text": "The quick brown fox jumps over the lazy dog."
}
```

**输出：**

```json
{
  "tokens": [
    {
      "token": "The",
      "start_offset": 0,
      "end_offset": 3,
      "type": "word",
      "position": 0
    },
    {
      "token": "quick",
      "start_offset": 4,
      "end_offset": 9,
      "type": "word",
      "position": 1
    },
    // 其他词条...
  ]
}
```

### 4. Keyword Analyzer

`keyword` 分析器将整个文本作为一个单独的词条进行处理。它适用于不需要分词的场景，例如处理 ID 或标签。

**示例：**

```json
POST _analyze
{
  "analyzer": "keyword",
  "text": "The quick brown fox jumps over the lazy dog."
}
```

**输出：**

```json
{
  "tokens": [
    {
      "token": "The quick brown fox jumps over the lazy dog.",
      "start_offset": 0,
      "end_offset": 44,
      "type": "word",
      "position": 0
    }
  ]
}
```

### 5. Pattern Analyzer

`pattern` 分析器使用正则表达式进行分词。它适用于需要自定义分词规则的场景。

**示例：**

```json
POST _analyze
{
  "analyzer": "pattern",
  "text": "The quick brown fox jumps over the lazy dog."
}
```

**输出：**

```json
{
  "tokens": [
    {
      "token": "the",
      "start_offset": 0,
      "end_offset": 3,
      "type": "word",
      "position": 0
    },
    {
      "token": "quick",
      "start_offset": 4,
      "end_offset": 9,
      "type": "word",
      "position": 1
    },
    // 其他词条...
  ]
}
```

## 实际应用场景

### 场景 1：全文搜索

在全文搜索场景中，通常使用 `standard` 分析器来处理用户输入的查询文本。例如，当用户在搜索框中输入 "Elasticsearch tutorial" 时，`standard` 分析器会将文本分词为 "elasticsearch" 和 "tutorial"，然后与索引中的文档进行匹配。

### 场景 2：标签搜索

在标签搜索场景中，通常使用 `keyword` 分析器来处理标签数据。例如，当用户搜索标签 "Elasticsearch" 时，`keyword` 分析器会将整个标签作为一个词条进行匹配，确保搜索结果的准确性。

### 场景 3：日志分析

在日志分析场景中，通常使用 `whitespace` 分析器来处理日志数据。例如，当日志中包含 "ERROR: Failed to connect" 时，`whitespace` 分析器会按空格进行分词，保留原始大小写，便于后续的错误分析。

## 总结

Elasticsearch 提供了多种内置分析器，每种分析器都有其特定的用途和功能。通过合理选择和使用这些分析器，我们可以更高效地处理和分析文本数据。在实际应用中，根据不同的场景需求选择合适的内置分析器，可以显著提升搜索和分析的效果。

## 附加资源

- [Elasticsearch 官方文档 - Analyzers](https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-analyzers.html)
- [Elasticsearch 分析器与分词器详解](https://www.elastic.co/blog/found-text-analysis-part-1)

## 练习

1. 使用 `standard` 分析器分析以下文本："Elasticsearch is a powerful search engine."
2. 使用 `keyword` 分析器分析以下文本："Elasticsearch is a powerful search engine."
3. 比较 `standard` 和 `whitespace` 分析器的输出结果，理解它们之间的区别。

:::tip
在实际开发中，可以根据具体需求自定义分析器，结合字符过滤器、分词器和词条过滤器，实现更复杂的文本处理逻辑。
:::