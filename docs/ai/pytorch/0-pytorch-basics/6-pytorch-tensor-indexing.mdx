---
title: PyTorch 张量索引
description: 学习如何在PyTorch中使用张量索引来访问和操作张量中的数据。本教程适合初学者，包含代码示例和实际应用场景。
---

# PyTorch 张量索引

在PyTorch中，张量（Tensor）是最基本的数据结构，类似于NumPy中的数组。张量索引是指通过索引来访问或修改张量中的特定元素或子集。掌握张量索引是高效操作数据的关键，尤其是在深度学习中。

## 1. 基本索引

PyTorch中的张量索引与Python列表的索引非常相似。你可以使用整数索引来访问张量中的单个元素，或者使用切片来访问子集。

### 1.1 访问单个元素

假设我们有一个2D张量：

```python
import torch

tensor = torch.tensor([[1, 2, 3], [4, 5, 6], [7, 8, 9]])
print(tensor)
```

输出：

```
tensor([[1, 2, 3],
        [4, 5, 6],
        [7, 8, 9]])
```

要访问张量中的单个元素，可以使用整数索引：

```python
element = tensor[1, 2]  # 访问第二行第三列的元素
print(element)
```

输出：

```
tensor(6)
```

### 1.2 使用切片访问子集

你可以使用切片来访问张量的子集。例如，访问第一行的所有元素：

```python
row = tensor[0, :]  # 访问第一行的所有元素
print(row)
```

输出：

```
tensor([1, 2, 3])
```

同样，你也可以访问某一列的所有元素：

```python
column = tensor[:, 1]  # 访问第二列的所有元素
print(column)
```

输出：

```
tensor([2, 5, 8])
```

## 2. 高级索引

除了基本的整数索引和切片，PyTorch还支持更高级的索引方式，如布尔索引和整数数组索引。

### 2.1 布尔索引

布尔索引允许你根据条件来选择张量中的元素。例如，选择所有大于5的元素：

```python
mask = tensor > 5
print(mask)
```

输出：

```
tensor([[False, False, False],
        [False, False,  True],
        [ True,  True,  True]])
```

然后，你可以使用这个布尔掩码来选择满足条件的元素：

```python
selected_elements = tensor[mask]
print(selected_elements)
```

输出：

```
tensor([6, 7, 8, 9])
```

### 2.2 整数数组索引

整数数组索引允许你使用一个整数数组来索引张量。例如，选择特定的行和列：

```python
rows = torch.tensor([0, 2])
columns = torch.tensor([1, 2])
selected_elements = tensor[rows, columns]
print(selected_elements)
```

输出：

```
tensor([2, 9])
```

## 3. 实际应用场景

### 3.1 数据预处理

在深度学习中，数据预处理是一个重要的步骤。通过张量索引，你可以轻松地从数据集中提取特定的样本或特征。例如，假设你有一个包含图像和标签的数据集，你可以使用索引来提取特定类别的图像：

```python
images = torch.randn(100, 3, 32, 32)  # 100张32x32的RGB图像
labels = torch.randint(0, 10, (100,))  # 100个标签，范围是0到9

# 提取标签为5的图像
class_5_images = images[labels == 5]
```

### 3.2 模型输出处理

在模型推理过程中，你可能需要从模型的输出中提取特定的信息。例如，假设模型的输出是一个概率分布，你可以使用索引来提取概率最高的类别：

```python
output = torch.randn(10)  # 假设模型输出10个类别的概率
predicted_class = torch.argmax(output)
print(predicted_class)
```

## 4. 总结

张量索引是PyTorch中非常强大的工具，它允许你高效地访问和操作张量中的数据。通过掌握基本索引和高级索引，你可以轻松地处理各种数据操作任务，从数据预处理到模型输出处理。

:::tip
**练习**：尝试创建一个3D张量，并使用索引来访问其中的特定元素或子集。你还可以尝试使用布尔索引来选择满足特定条件的元素。
:::

## 5. 附加资源

- [PyTorch官方文档 - 张量索引](https://pytorch.org/docs/stable/tensor_indexing.html)
- [PyTorch教程 - 张量操作](https://pytorch.org/tutorials/beginner/basics/tensorqs_tutorial.html)

通过本教程，你应该已经掌握了PyTorch中的张量索引。继续练习并探索更多高级用法，以提升你的PyTorch技能！