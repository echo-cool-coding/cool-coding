---
title: 安全合规
description: 了解 Grafana Loki 的安全合规特性，包括认证、授权、审计日志和合规性标准支持。
---

# 安全合规

## 介绍

安全合规是任何日志管理系统的关键组成部分，尤其是在处理敏感数据时。Grafana Loki 提供了多种机制来确保数据的安全性，并满足行业合规性要求。本章将介绍 Loki 的安全功能，包括认证、授权、审计日志以及与常见合规性标准（如 GDPR、HIPAA）的兼容性。

---

## 认证与授权

### 1. 认证（Authentication）
Loki 支持多种认证方式，确保只有合法用户能够访问系统。常见的认证方式包括：
- **基本认证（Basic Auth）**：用户名和密码。
- **OAuth 2.0**：与第三方身份提供商（如 Google、GitHub）集成。
- **JWT（JSON Web Tokens）**：用于无状态认证。

#### 示例：启用基本认证
在 Loki 的配置文件中启用基本认证：
```yaml
auth_enabled: true
```

### 2. 授权（Authorization）
Loki 通过角色和权限控制用户对数据的访问。例如：
- **读写权限**：允许用户查询或写入日志。
- **租户隔离**：多租户环境下，确保租户数据隔离。

#### 示例：配置租户权限
```yaml
auth_enabled: true
multitenancy_enabled: true
```

---

## 数据加密

Loki 支持传输层加密（TLS）和静态数据加密：
- **TLS**：确保数据在传输过程中不被窃听。
- **静态加密**：通过存储后端（如 S3）的加密功能实现。

#### 示例：启用 TLS
在 Loki 配置中启用 TLS：
```yaml
server:
  http_tls_config:
    cert_file: /path/to/cert.pem
    key_file: /path/to/key.pem
```

---

## 审计日志

审计日志记录用户操作，便于追踪和合规性检查。Loki 可以集成外部审计工具（如 Prometheus）来记录以下操作：
- 用户登录/登出。
- 查询和写入请求。

#### 示例：配置审计日志
```yaml
audit:
  enabled: true
  log_file: /var/log/loki/audit.log
```

---

## 合规性标准

Loki 的设计支持多种合规性标准，包括：
- **GDPR**：确保个人数据的保护和隐私。
- **HIPAA**：满足医疗数据的存储和传输要求。

#### 实际案例：GDPR 合规
假设你的应用需要记录用户活动日志，但需匿名化个人数据。可以通过 Loki 的日志过滤功能实现：
```yaml
pipeline_stages:
  - regex:
      expression: '(?P<email>[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+)'
  - replace:
      source: email
      replacement: '***REDACTED***'
```

---

## 总结

安全合规是 Loki 的核心特性之一，通过认证、授权、加密和审计日志等功能，Loki 能够满足企业级的安全需求。以下是关键点：
1. 使用认证和授权保护数据访问。
2. 通过 TLS 和静态加密确保数据安全。
3. 利用审计日志追踪用户操作。
4. 支持 GDPR、HIPAA 等合规性标准。

---

## 附加资源
1. [Loki 官方文档 - 安全性](https://grafana.com/docs/loki/latest/security/)
2. [GDPR 合规指南](https://gdpr-info.eu/)
3. [HIPAA 合规要求](https://www.hhs.gov/hipaa/index.html)

## 练习
1. 在本地 Loki 实例中启用基本认证并测试访问。
2. 配置一个日志过滤管道，匿名化日志中的电子邮件地址。