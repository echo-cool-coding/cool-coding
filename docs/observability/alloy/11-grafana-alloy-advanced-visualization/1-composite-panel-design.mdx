---
title: 复合面板设计
description: 学习如何在 Grafana Alloy 中使用复合面板设计，创建高级可视化效果。本文适合初学者，包含详细的概念讲解、代码示例和实际案例。
---

# 复合面板设计

在 Grafana Alloy 中，复合面板设计是一种强大的功能，允许你将多个数据源或可视化组件组合到一个面板中，从而创建更复杂、更丰富的数据展示效果。通过复合面板设计，你可以将不同的图表、指标和文本信息整合在一起，提供更全面的数据洞察。

## 什么是复合面板？

复合面板是指在一个面板中组合多个可视化组件或数据源的设计方式。与单一图表不同，复合面板可以同时展示多个相关的数据视图，帮助用户更全面地理解数据。例如，你可以将折线图、柱状图和文本说明放在同一个面板中，展示同一时间段内的不同指标。

## 为什么使用复合面板？

复合面板的主要优势在于它能够将多个相关的数据视图整合在一起，减少用户在不同面板之间切换的频率。这对于需要同时监控多个指标的场景尤其有用，例如：

- 监控系统性能时，同时展示 CPU 使用率、内存使用率和网络流量。
- 在金融分析中，同时展示股票价格、交易量和市场情绪指数。

## 如何设计复合面板

### 1. 选择数据源

首先，你需要为复合面板选择合适的数据源。Grafana Alloy 支持多种数据源，包括 Prometheus、InfluxDB、Elasticsearch 等。你可以为每个可视化组件选择不同的数据源，或者使用同一个数据源的不同查询。

```yaml
data_sources:
  - name: prometheus
    type: prometheus
    url: http://localhost:9090
  - name: influxdb
    type: influxdb
    url: http://localhost:8086
```

### 2. 添加可视化组件

接下来，你可以在面板中添加多个可视化组件。Grafana Alloy 提供了丰富的可视化选项，包括折线图、柱状图、饼图、仪表盘等。你可以根据需要选择合适的组件。

```yaml
panels:
  - type: graph
    title: CPU 使用率
    data_source: prometheus
    query: 'rate(node_cpu_seconds_total{mode="system"}[1m])'
  - type: stat
    title: 内存使用率
    data_source: influxdb
    query: 'SELECT mean("usage") FROM "memory" WHERE time > now() - 1h GROUP BY time(1m)'
```

### 3. 调整布局

在添加了多个可视化组件后，你需要调整它们的布局，以确保面板的整体美观和易读性。Grafana Alloy 提供了灵活的布局选项，允许你自由调整每个组件的大小和位置。

```yaml
layout:
  - type: row
    panels:
      - type: graph
        span: 6
      - type: stat
        span: 6
```

### 4. 添加文本说明

为了帮助用户更好地理解数据，你可以在面板中添加文本说明。文本说明可以用于解释数据来源、指标含义或提供其他相关信息。

```yaml
panels:
  - type: text
    content: |
      **CPU 使用率**：展示了系统 CPU 的使用情况，单位为百分比。
      **内存使用率**：展示了系统内存的使用情况，单位为百分比。
```

## 实际案例

假设你正在监控一个 Web 服务器的性能，你需要同时展示 CPU 使用率、内存使用率和请求响应时间。你可以使用复合面板设计，将这些指标整合到一个面板中。

```yaml
panels:
  - type: graph
    title: CPU 使用率
    data_source: prometheus
    query: 'rate(node_cpu_seconds_total{mode="system"}[1m])'
  - type: graph
    title: 内存使用率
    data_source: prometheus
    query: 'rate(node_memory_MemFree_bytes[1m])'
  - type: graph
    title: 请求响应时间
    data_source: influxdb
    query: 'SELECT mean("response_time") FROM "http_requests" WHERE time > now() - 1h GROUP BY time(1m)'
  - type: text
    content: |
      **CPU 使用率**：展示了系统 CPU 的使用情况，单位为百分比。
      **内存使用率**：展示了系统内存的使用情况，单位为百分比。
      **请求响应时间**：展示了 Web 服务器的请求响应时间，单位为毫秒。
```

## 总结

复合面板设计是 Grafana Alloy 中一种强大的功能，能够帮助你创建更复杂、更丰富的数据可视化效果。通过将多个数据源和可视化组件整合到一个面板中，你可以提供更全面的数据洞察，减少用户在不同面板之间切换的频率。

## 附加资源

- [Grafana Alloy 官方文档](https://grafana.com/docs/alloy/)
- [Prometheus 查询语言指南](https://prometheus.io/docs/prometheus/latest/querying/basics/)
- [InfluxDB 查询语言指南](https://docs.influxdata.com/influxdb/v2.0/query-data/)

## 练习

1. 创建一个复合面板，展示系统的 CPU 使用率、内存使用率和磁盘 I/O。
2. 尝试在复合面板中添加文本说明，解释每个指标的含义。
3. 调整面板布局，使每个可视化组件的大小和位置更加合理。

通过以上练习，你将更好地掌握复合面板设计的基本概念和应用技巧。