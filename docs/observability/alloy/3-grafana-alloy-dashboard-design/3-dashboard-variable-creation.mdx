---
title: 仪表盘变量创建
description: 学习如何在 Grafana Alloy 中创建和使用仪表盘变量，以动态调整仪表盘的内容和显示。
---

# 仪表盘变量创建

在 Grafana Alloy 中，仪表盘变量（Dashboard Variables）是一种强大的工具，它允许你动态地调整仪表盘的内容和显示。通过使用变量，你可以创建更加灵活和交互式的仪表盘，从而更好地满足不同的监控和分析需求。

## 什么是仪表盘变量？

仪表盘变量是 Grafana Alloy 中的一种特殊功能，它允许你在仪表盘中定义和使用变量。这些变量可以在查询、面板标题、面板描述等多个地方使用，从而实现动态内容的展示。例如，你可以创建一个变量来表示不同的服务器名称，然后在查询中使用这个变量来动态地选择不同的服务器数据。

## 创建仪表盘变量的步骤

### 1. 打开仪表盘设置

首先，打开你想要添加变量的仪表盘。点击仪表盘右上角的齿轮图标，进入仪表盘设置页面。

### 2. 添加变量

在仪表盘设置页面中，选择“Variables”选项卡。然后点击“Add variable”按钮，开始创建一个新的变量。

### 3. 配置变量

在变量配置页面中，你需要填写以下信息：

- **Name**: 变量的名称，用于在查询和其他地方引用这个变量。
- **Label**: 变量的标签，用于在仪表盘上显示。
- **Type**: 变量的类型，常见的类型包括 `Query`、`Custom`、`Constant` 等。
- **Data source**: 如果变量类型是 `Query`，你需要选择一个数据源。
- **Query**: 如果变量类型是 `Query`，你需要填写一个查询语句，用于获取变量的值。

### 4. 使用变量

配置完成后，你可以在查询、面板标题、面板描述等地方使用这个变量。例如，在查询中使用变量时，你可以这样写：

```sql
SELECT * FROM metrics WHERE server = '$server'
```

在这个例子中，`$server` 是一个变量，Grafana Alloy 会根据变量的值动态地替换这个部分。

## 实际案例

假设你有一个监控多个服务器的仪表盘，每个服务器的数据存储在不同的表中。你可以创建一个名为 `server` 的变量，然后在查询中使用这个变量来动态地选择不同的服务器数据。

### 变量配置

```yaml
name: server
label: Server
type: Query
data source: Prometheus
query: label_values(up, instance)
```

### 查询示例

```sql
SELECT * FROM metrics WHERE server = '$server'
```

在这个例子中，`$server` 变量会根据用户选择的服务器名称动态地替换为相应的值，从而显示对应服务器的数据。

## 总结

通过使用仪表盘变量，你可以创建更加灵活和交互式的仪表盘，从而更好地满足不同的监控和分析需求。希望这篇教程能帮助你理解如何在 Grafana Alloy 中创建和使用仪表盘变量。

## 附加资源

- [Grafana 官方文档](https://grafana.com/docs/grafana/latest/variables/)
- [Grafana Alloy 教程](https://grafana.com/tutorials/grafana-alloy/)

## 练习

1. 创建一个名为 `environment` 的变量，用于选择不同的环境（如 `production`、`staging`、`development`）。
2. 在查询中使用这个变量，动态地显示不同环境下的监控数据。
3. 尝试在面板标题中使用变量，动态地显示当前选择的环境名称。

通过完成这些练习，你将更好地掌握仪表盘变量的使用技巧。