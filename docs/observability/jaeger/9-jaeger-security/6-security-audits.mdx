---
title: 安全审计
description: 了解安全审计的基本概念、流程及在Jaeger中的实际应用，帮助开发者提升分布式追踪系统的安全性。
---

# 安全审计

## 介绍

安全审计是评估系统或应用程序安全性的系统化过程，目的是识别潜在漏洞、验证安全控制措施的有效性，并确保符合安全策略。在分布式追踪系统（如Jaeger）中，安全审计尤为重要，因为它涉及敏感的操作数据和可能的用户信息。

## 为什么需要安全审计？

1. **风险识别**：发现系统中可能被攻击者利用的弱点。
2. **合规性**：满足行业或法规要求（如GDPR、ISO 27001）。
3. **持续改进**：通过定期审计优化安全策略。

## 安全审计的关键步骤

### 1. 范围定义
明确审计对象（如Jaeger的存储后端、API端点或UI组件）。

### 2. 数据收集
- 检查日志文件（如Jaeger的 `--log-level=debug` 输出）。
- 分析网络流量（使用工具如Wireshark）。

### 3. 漏洞扫描
使用自动化工具（如OWASP ZAP）扫描常见漏洞：
```bash
# 示例：使用ZAP扫描Jaeger UI
zap-cli quick-scan --spider -r http://jaeger-ui.example.com
```

### 4. 手动测试
- **认证测试**：尝试绕过Jaeger的登录机制（如未配置认证时直接访问 `/search`）。
- **注入测试**：验证输入字段是否过滤恶意数据（如查询参数中的SQL注入）。

### 5. 报告与修复
生成审计报告并优先处理高风险问题。

---

## Jaeger 安全审计实战案例

### 场景：未加密的gRPC通信
Jaeger Agent默认使用gRPC与Collector通信，若未启用TLS，数据可能被窃听。

**问题复现**：
```bash
# 监听gRPC流量（需安装grpcurl）
grpcurl -plaintext jaeger-collector:14250 list
```

**修复方案**：
在Jaeger配置中启用TLS：
```yaml
agent:
  tls:
    enabled: true
    cert: /path/to/cert.pem
    key: /path/to/key.pem
```

---

## 安全审计工具推荐

1. **静态分析**：`gosec`（Go语言安全检查）
2. **动态分析**：`Burp Suite`（Web渗透测试）
3. **依赖检查**：`trivy`（扫描容器镜像漏洞）

---

## 总结

安全审计是确保Jaeger部署安全性的关键步骤。通过结合自动化工具和手动测试，开发者可以系统性识别并修复风险。定期审计（如每季度一次）能有效减少安全事件。

:::tip 练习
1. 使用 `trivy` 扫描Jaeger的Docker镜像。
2. 尝试配置Jaeger的TLS并验证通信加密。
:::

**延伸阅读**：
- [OWASP安全审计指南](https://owasp.org)
- [Jaeger官方安全文档](https://jaegertracing.io/docs/security)