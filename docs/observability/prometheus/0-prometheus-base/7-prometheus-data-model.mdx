---
title: Prometheus 数据模型
description: 了解 Prometheus 数据模型的核心概念，包括时间序列、指标、标签和样本。本文适合初学者，通过示例和实际案例帮助你掌握 Prometheus 数据模型的基础知识。
---

## 介绍

Prometheus 是一个开源的监控和告警工具，广泛用于收集和存储时间序列数据。它的核心是**数据模型**，理解这一模型对于有效使用 Prometheus 至关重要。本文将详细介绍 Prometheus 数据模型的核心概念，包括时间序列、指标、标签和样本，并通过示例帮助你更好地理解。

## Prometheus 数据模型的核心概念

### 1. 时间序列（Time Series）

在 Prometheus 中，**时间序列**是由一系列时间戳和值组成的数据流。每个时间序列都有一个唯一的标识符，称为**指标名称**（Metric Name），以及一组**标签**（Labels），用于进一步描述该时间序列。

例如，以下是一个时间序列的示例：

```
http_requests_total{method="GET", status="200"} 100
```

- `http_requests_total` 是指标名称。
- `{method="GET", status="200"}` 是标签。
- `100` 是当前时间戳的值。

### 2. 指标（Metric）

**指标**是 Prometheus 中用于描述系统状态的度量标准。每个指标都有一个名称和一组标签。指标名称通常用于描述被监控的内容，例如 `http_requests_total` 表示 HTTP 请求的总数。

### 3. 标签（Labels）

**标签**是键值对，用于区分相同指标名称下的不同时间序列。标签提供了额外的维度信息，使得我们可以对数据进行更细粒度的查询和聚合。

例如，以下两个时间序列具有相同的指标名称，但标签不同：

```
http_requests_total{method="GET", status="200"} 100
http_requests_total{method="POST", status="500"} 5
```

### 4. 样本（Sample）

**样本**是时间序列中的一个数据点，由时间戳和值组成。Prometheus 定期从目标中抓取样本，并将其存储在时间序列数据库中。

例如，以下是一个样本的示例：

```
http_requests_total{method="GET", status="200"} @1633024800 100
```

- `@1633024800` 是时间戳（Unix 时间）。
- `100` 是该时间戳的值。

## 实际案例

假设我们有一个 Web 服务器，我们想要监控 HTTP 请求的数量和状态码。我们可以使用 Prometheus 来收集以下时间序列数据：

```
http_requests_total{method="GET", status="200"} 100
http_requests_total{method="POST", status="500"} 5
http_requests_total{method="GET", status="404"} 2
```

通过这些数据，我们可以轻松地查询特定状态码的请求数量，或者按方法聚合请求数量。

### 查询示例

以下是一个 PromQL 查询示例，用于获取所有状态码为 200 的 HTTP 请求数量：

```promql
http_requests_total{status="200"}
```

输出结果可能如下：

```
http_requests_total{method="GET", status="200"} 100
http_requests_total{method="POST", status="200"} 50
```

## 总结

Prometheus 数据模型是 Prometheus 监控系统的核心，理解时间序列、指标、标签和样本的概念对于有效使用 Prometheus 至关重要。通过本文的介绍和示例，你应该已经掌握了 Prometheus 数据模型的基础知识。

## 附加资源

- [Prometheus 官方文档](https://prometheus.io/docs/)
- [Prometheus 数据模型详解](https://prometheus.io/docs/concepts/data_model/)
- [PromQL 查询语言指南](https://prometheus.io/docs/prometheus/latest/querying/basics/)

## 练习

1. 创建一个 Prometheus 指标，用于监控 CPU 使用率，并为其添加适当的标签。
2. 使用 PromQL 查询所有状态码为 500 的 HTTP 请求数量。
3. 尝试使用 Prometheus 数据模型描述一个实际应用场景，例如数据库连接数监控。

:::tip
如果你在练习中遇到问题，可以参考 Prometheus 官方文档或社区论坛获取帮助。
:::