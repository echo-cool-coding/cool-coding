---
title: 数据转换功能
description: 了解 Grafana 中的数据转换功能，掌握如何通过转换操作对数据进行处理和优化，以更好地满足可视化需求。
---

# 数据转换功能

在 Grafana 中，数据转换功能是一个强大的工具，它允许你在数据被可视化之前对其进行处理和优化。无论你是需要对数据进行聚合、过滤、重命名，还是进行更复杂的操作，数据转换功能都能帮助你实现这些目标。本文将详细介绍 Grafana 中的数据转换功能，并通过实际案例帮助你理解其应用场景。

## 什么是数据转换？

数据转换是指在数据被可视化之前，对数据进行一系列操作以改变其结构或内容的过程。这些操作可以包括：

- **重命名字段**：将数据中的字段名称更改为更具描述性的名称。
- **过滤数据**：根据特定条件筛选出需要的数据。
- **聚合数据**：将多个数据点合并为一个汇总值，如求和、平均值等。
- **计算新字段**：基于现有字段创建新的计算字段。
- **排序数据**：按照特定字段对数据进行排序。

通过数据转换，你可以更好地控制数据的呈现方式，使其更符合你的分析需求。

## 数据转换的基本操作

### 1. 重命名字段

重命名字段是最常见的数据转换操作之一。它允许你将数据中的字段名称更改为更具描述性的名称，以便在可视化时更容易理解。

**示例：**

假设你有一个包含以下字段的数据集：

```json
[
  { "time": "2023-10-01T00:00:00Z", "value": 100 },
  { "time": "2023-10-01T01:00:00Z", "value": 150 }
]
```

你可以使用 `Rename by regex` 转换器将 `value` 字段重命名为 `Temperature`：

```json
[
  { "time": "2023-10-01T00:00:00Z", "Temperature": 100 },
  { "time": "2023-10-01T01:00:00Z", "Temperature": 150 }
]
```

### 2. 过滤数据

过滤数据允许你根据特定条件筛选出需要的数据。例如，你可能只想显示某个时间范围内的数据，或者只显示某个特定字段的值大于某个阈值的数据。

**示例：**

假设你有一个包含以下字段的数据集：

```json
[
  { "time": "2023-10-01T00:00:00Z", "value": 100 },
  { "time": "2023-10-01T01:00:00Z", "value": 150 },
  { "time": "2023-10-01T02:00:00Z", "value": 80 }
]
```

你可以使用 `Filter data by query` 转换器过滤出 `value` 大于 100 的数据：

```json
[
  { "time": "2023-10-01T01:00:00Z", "value": 150 }
]
```

### 3. 聚合数据

聚合数据是将多个数据点合并为一个汇总值的过程。常见的聚合操作包括求和、平均值、最大值、最小值等。

**示例：**

假设你有一个包含以下字段的数据集：

```json
[
  { "time": "2023-10-01T00:00:00Z", "value": 100 },
  { "time": "2023-10-01T01:00:00Z", "value": 150 },
  { "time": "2023-10-01T02:00:00Z", "value": 80 }
]
```

你可以使用 `Reduce` 转换器计算 `value` 字段的平均值：

```json
[
  { "value": 110 }
]
```

### 4. 计算新字段

计算新字段允许你基于现有字段创建新的计算字段。例如，你可以基于两个字段的差值创建一个新的字段。

**示例：**

假设你有一个包含以下字段的数据集：

```json
[
  { "time": "2023-10-01T00:00:00Z", "value1": 100, "value2": 50 },
  { "time": "2023-10-01T01:00:00Z", "value1": 150, "value2": 75 }
]
```

你可以使用 `Add field from calculation` 转换器创建一个新的字段 `difference`，其值为 `value1 - value2`：

```json
[
  { "time": "2023-10-01T00:00:00Z", "value1": 100, "value2": 50, "difference": 50 },
  { "time": "2023-10-01T01:00:00Z", "value1": 150, "value2": 75, "difference": 75 }
]
```

### 5. 排序数据

排序数据允许你按照特定字段对数据进行排序。例如，你可以按照时间字段对数据进行升序或降序排列。

**示例：**

假设你有一个包含以下字段的数据集：

```json
[
  { "time": "2023-10-01T01:00:00Z", "value": 150 },
  { "time": "2023-10-01T00:00:00Z", "value": 100 },
  { "time": "2023-10-01T02:00:00Z", "value": 80 }
]
```

你可以使用 `Sort by` 转换器按照 `time` 字段对数据进行升序排列：

```json
[
  { "time": "2023-10-01T00:00:00Z", "value": 100 },
  { "time": "2023-10-01T01:00:00Z", "value": 150 },
  { "time": "2023-10-01T02:00:00Z", "value": 80 }
]
```

## 实际应用场景

### 场景 1：监控系统性能

假设你正在监控一个系统的 CPU 使用率，并且你希望只显示 CPU 使用率超过 80% 的数据点。你可以使用 `Filter data by query` 转换器过滤出这些数据点，并使用 `Rename by regex` 转换器将字段名称更改为更具描述性的名称。

### 场景 2：分析销售数据

假设你有一组销售数据，并且你希望计算每个月的总销售额。你可以使用 `Reduce` 转换器对每个月的销售额进行求和，并使用 `Sort by` 转换器按照月份对数据进行排序。

## 总结

Grafana 的数据转换功能为你提供了强大的工具，帮助你在数据可视化之前对其进行处理和优化。通过重命名字段、过滤数据、聚合数据、计算新字段和排序数据等操作，你可以更好地控制数据的呈现方式，使其更符合你的分析需求。

:::tip 提示
在实际使用中，你可以结合多个转换器来实现更复杂的数据处理操作。尝试不同的转换器组合，找到最适合你需求的解决方案。
:::

## 附加资源与练习

- **练习 1**：尝试使用 `Rename by regex` 转换器将一个数据集中的字段名称更改为更具描述性的名称。
- **练习 2**：使用 `Filter data by query` 转换器过滤出一个数据集中满足特定条件的数据点。
- **练习 3**：使用 `Reduce` 转换器计算一个数据集中某个字段的平均值。

通过以上练习，你将更深入地理解 Grafana 中的数据转换功能，并能够在实际项目中灵活运用。