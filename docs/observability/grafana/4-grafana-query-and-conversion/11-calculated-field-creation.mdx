---
title: 计算字段创建
description: 学习如何在 Grafana 中创建和使用计算字段，以增强数据可视化和分析能力。
---

# 计算字段创建

在 Grafana 中，计算字段（Calculated Fields）是一种强大的工具，允许你基于现有数据字段创建新的字段。这些新字段可以用于进一步的数据分析、可视化或与其他字段结合使用。本文将详细介绍如何在 Grafana 中创建和使用计算字段，并通过实际案例帮助你理解其应用场景。

## 什么是计算字段？

计算字段是通过对现有字段进行数学运算或逻辑操作而生成的新字段。它们可以帮助你从现有数据中提取更多信息，或者将多个字段组合成一个更有意义的字段。例如，你可以通过计算字段来计算两个字段的差值、比率，或者将多个字段的值相加。

## 创建计算字段的步骤

### 1. 打开 Grafana 面板

首先，打开你想要添加计算字段的 Grafana 面板。确保你已经配置了数据源，并且数据源中有你需要操作的字段。

### 2. 进入查询编辑器

在面板中，点击“编辑”按钮，进入查询编辑器。在查询编辑器中，你可以看到当前配置的查询和数据字段。

### 3. 添加计算字段

在查询编辑器中，找到“Transform”选项卡。点击“Add field”按钮，然后选择“Calculated field”。

### 4. 输入计算表达式

在“Calculated field”对话框中，输入你想要的计算表达式。例如，如果你有两个字段 `A` 和 `B`，你可以输入 `A + B` 来计算它们的和。

```plaintext
A + B
```

### 5. 命名计算字段

为你的计算字段命名，以便在后续的分析和可视化中使用。例如，你可以将上面的计算字段命名为 `Sum of A and B`。

### 6. 应用并保存

点击“Apply”按钮，然后保存你的面板。现在，你可以在面板中使用这个新的计算字段了。

## 实际案例

### 案例 1：计算两个字段的差值

假设你有一个数据集，其中包含两个字段 `Revenue` 和 `Cost`。你想要计算每个时间点的利润，即 `Revenue - Cost`。

1. 在查询编辑器中，添加一个计算字段。
2. 输入表达式 `Revenue - Cost`。
3. 将计算字段命名为 `Profit`。
4. 应用并保存。

现在，你可以在面板中使用 `Profit` 字段来可视化利润随时间的变化。

### 案例 2：计算字段的比率

假设你有一个数据集，其中包含两个字段 `Visitors` 和 `Conversions`。你想要计算转化率，即 `Conversions / Visitors * 100`。

1. 在查询编辑器中，添加一个计算字段。
2. 输入表达式 `Conversions / Visitors * 100`。
3. 将计算字段命名为 `Conversion Rate`。
4. 应用并保存。

现在，你可以在面板中使用 `Conversion Rate` 字段来可视化转化率随时间的变化。

## 总结

计算字段是 Grafana 中一个非常有用的功能，它允许你基于现有字段创建新的字段，从而增强数据分析和可视化的能力。通过本文的介绍，你应该已经掌握了如何在 Grafana 中创建和使用计算字段，并通过实际案例了解了其应用场景。

## 附加资源与练习

- **练习 1**：尝试在你的 Grafana 面板中创建一个计算字段，计算两个字段的乘积。
- **练习 2**：使用计算字段来计算一个字段的平均值，并将其可视化。

:::tip
如果你在创建计算字段时遇到问题，可以查阅 Grafana 的官方文档，或者参考社区中的相关讨论。
:::

:::caution
请注意，计算字段的表达式必须符合 Grafana 的语法规则，否则可能会导致错误。
:::