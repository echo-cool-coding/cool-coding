---
title: 统计面板使用
description: 学习如何在 Grafana 中使用统计面板来可视化和分析数据。本教程适合初学者，涵盖基本概念、实际案例和代码示例。
---

# 统计面板使用

## 介绍

Grafana 是一个强大的开源数据可视化工具，广泛用于监控和分析时间序列数据。统计面板（Stat Panel）是 Grafana 中的一种面板类型，用于显示单个统计值或一组统计值。它非常适合展示关键指标（KPI）、汇总数据或简单的统计结果。

在本教程中，我们将逐步介绍如何在 Grafana 中使用统计面板，并通过实际案例展示其应用场景。

## 统计面板的基本概念

统计面板的主要功能是显示一个或多个统计值。它可以显示以下内容：

- 单个值（如当前 CPU 使用率）
- 多个值（如不同服务器的 CPU 使用率）
- 值的趋势（如过去一小时内的变化）

统计面板通常用于监控系统的关键指标，例如：

- 服务器的 CPU 使用率
- 数据库的查询响应时间
- 网络流量

## 创建统计面板

### 步骤 1：添加数据源

在 Grafana 中，首先需要添加一个数据源。数据源可以是 Prometheus、InfluxDB、MySQL 等。以下是一个添加 Prometheus 数据源的示例：

1. 打开 Grafana，进入 **Configuration > Data Sources**。
2. 点击 **Add data source**，选择 **Prometheus**。
3. 填写 Prometheus 服务器的 URL，然后点击 **Save & Test**。

### 步骤 2：创建仪表板

1. 在 Grafana 中，点击 **Create > Dashboard**。
2. 点击 **Add new panel**，然后选择 **Stat** 面板类型。

### 步骤 3：配置统计面板

在统计面板的配置界面中，您可以设置以下内容：

- **Query**：选择数据源并编写查询语句。例如，如果您使用的是 Prometheus，可以编写类似 `rate(http_requests_total[1m])` 的查询。
- **Display**：选择如何显示统计值。例如，您可以选择显示为单个值、多个值或趋势图。
- **Field**：选择要显示的字段。例如，如果您查询了多个指标，可以选择其中一个字段进行显示。

以下是一个配置示例：

```plaintext
Query: rate(http_requests_total[1m])
Display: Single stat
Field: Value
```

### 步骤 4：保存并查看面板

完成配置后，点击 **Apply** 保存面板。您将看到统计面板显示查询结果的统计值。

## 实际案例

### 案例 1：监控服务器 CPU 使用率

假设您想监控一台服务器的 CPU 使用率。您可以使用以下步骤：

1. 添加 Prometheus 数据源。
2. 创建一个新的仪表板，并添加一个统计面板。
3. 在查询中输入 `rate(node_cpu_seconds_total{mode="idle"}[1m])`。
4. 配置面板显示为单个值，并选择 `Value` 字段。

保存后，您将看到当前服务器的 CPU 使用率。

### 案例 2：显示数据库查询响应时间

假设您想监控数据库的查询响应时间。您可以使用以下步骤：

1. 添加 InfluxDB 数据源。
2. 创建一个新的仪表板，并添加一个统计面板。
3. 在查询中输入 `SELECT mean("response_time") FROM "database_metrics" WHERE time > now() - 1h GROUP BY time(1m)`。
4. 配置面板显示为趋势图。

保存后，您将看到过去一小时内数据库查询响应时间的变化趋势。

## 总结

统计面板是 Grafana 中一个非常有用的工具，适合用于显示关键指标和汇总数据。通过本教程，您已经学会了如何创建和配置统计面板，并通过实际案例了解了其应用场景。

## 附加资源

- [Grafana 官方文档](https://grafana.com/docs/)
- [Prometheus 查询语言（PromQL）指南](https://prometheus.io/docs/prometheus/latest/querying/basics/)
- [InfluxDB 查询语言（InfluxQL）指南](https://docs.influxdata.com/influxdb/v1.8/query_language/)

## 练习

1. 创建一个统计面板，监控您的 Web 服务器的请求速率。
2. 尝试使用不同的数据源（如 MySQL 或 Elasticsearch）来创建统计面板。
3. 配置一个统计面板，显示多个值并比较它们的变化趋势。

通过练习，您将更深入地理解统计面板的使用方法，并能够在实际项目中灵活应用。