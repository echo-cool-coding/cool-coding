---
title: Grafana 环境变量
description: 了解如何在Grafana中使用环境变量来动态配置仪表盘和数据源，提升灵活性和可维护性。
---

# Grafana 环境变量

Grafana是一个强大的开源监控和可视化工具，广泛用于实时数据的展示和分析。在Grafana中，**环境变量**是一种非常有用的功能，它允许你动态地配置仪表盘和数据源，从而提升灵活性和可维护性。本文将详细介绍Grafana环境变量的概念、使用方法以及实际应用场景。

## 什么是Grafana环境变量？

环境变量是Grafana中用于动态替换值的占位符。它们可以在仪表盘、面板、数据源等配置中使用，使得配置更具灵活性和可重用性。通过使用环境变量，你可以在不修改仪表盘配置的情况下，轻松切换不同的数据源、时间范围或其他参数。

## 环境变量的基本语法

在Grafana中，环境变量的语法通常以`${}`包裹。例如，`${VAR_NAME}`表示一个名为`VAR_NAME`的环境变量。你可以在Grafana的UI中定义这些变量，并在仪表盘中使用它们。

### 定义环境变量

在Grafana中，环境变量通常在仪表盘的“Variables”部分定义。以下是一个简单的例子：

1. 打开Grafana仪表盘。
2. 点击右上角的“Dashboard settings”按钮。
3. 选择“Variables”选项卡。
4. 点击“Add variable”按钮。
5. 输入变量名称（例如`DATASOURCE`），并选择变量类型（例如“Query”）。
6. 配置变量的查询或其他选项，然后保存。

### 使用环境变量

定义好环境变量后，你可以在仪表盘的面板中使用它们。例如，在面板的查询中，你可以这样使用环境变量：

```sql
SELECT * FROM ${DATASOURCE} WHERE time > now() - ${TIME_RANGE}
```

在这个例子中，`${DATASOURCE}`和`${TIME_RANGE}`是环境变量，它们会在运行时被替换为实际的值。

## 实际应用场景

### 1. 动态切换数据源

假设你有多个数据源（例如生产环境和测试环境），你可以在仪表盘中定义一个名为`DATASOURCE`的环境变量，并在查询中使用它。这样，你只需更改环境变量的值，就可以轻松切换数据源，而不需要修改每个面板的查询。

### 2. 动态时间范围

在监控系统中，时间范围是一个常见的需求。你可以定义一个名为`TIME_RANGE`的环境变量，并在查询中使用它。例如：

```sql
SELECT * FROM metrics WHERE time > now() - ${TIME_RANGE}
```

这样，你可以通过更改`TIME_RANGE`的值来动态调整时间范围。

### 3. 多租户仪表盘

如果你需要为不同的租户创建类似的仪表盘，可以使用环境变量来动态替换租户ID。例如：

```sql
SELECT * FROM metrics WHERE tenant_id = ${TENANT_ID}
```

这样，你只需更改`TENANT_ID`的值，就可以为不同的租户生成相应的仪表盘。

## 总结

Grafana环境变量是一个强大的工具，可以帮助你动态配置仪表盘和数据源，提升灵活性和可维护性。通过定义和使用环境变量，你可以轻松切换数据源、调整时间范围，甚至为不同的租户生成仪表盘。

### 附加资源

- [Grafana官方文档](https://grafana.com/docs/grafana/latest/)
- [Grafana环境变量教程](https://grafana.com/tutorials/grafana-fundamentals/)

### 练习

1. 在Grafana中创建一个名为`DATASOURCE`的环境变量，并在一个面板的查询中使用它。
2. 定义一个名为`TIME_RANGE`的环境变量，并在查询中使用它来动态调整时间范围。
3. 尝试为不同的租户创建一个仪表盘，并使用环境变量来动态替换租户ID。

通过这些练习，你将更好地掌握Grafana环境变量的使用方法，并能够在实际项目中灵活应用。