---
title: 仪表盘模板
description: 了解如何在 Grafana 中使用仪表盘模板，通过动态变量和模板化配置创建灵活且可重用的仪表盘。
---

# 仪表盘模板

在 Grafana 中，仪表盘模板是一种强大的功能，允许你通过动态变量和模板化配置创建灵活且可重用的仪表盘。通过使用模板，你可以轻松地为不同的数据源、时间范围或其他条件生成定制化的视图，而无需手动创建多个仪表盘。

## 什么是仪表盘模板？

仪表盘模板是 Grafana 中的一种功能，允许你在仪表盘中定义变量（Variables），这些变量可以在查询、面板标题、描述等地方动态使用。通过这种方式，你可以创建一个仪表盘，并根据用户的选择动态调整其内容。

例如，你可以创建一个变量来选择不同的服务器、应用程序或时间范围，然后根据这些变量的值动态更新仪表盘中的图表和数据。

## 如何创建仪表盘模板

### 1. 定义变量

首先，你需要在仪表盘中定义变量。变量可以是静态列表、查询结果、自定义输入等。以下是一个简单的例子，展示如何定义一个变量来选择不同的服务器：

1. 打开仪表盘的设置页面。
2. 选择 **Variables** 选项卡。
3. 点击 **Add variable** 按钮。
4. 在 **Name** 字段中输入变量名，例如 `server`。
5. 在 **Type** 字段中选择变量类型，例如 `Query`。
6. 在 **Query** 字段中输入查询语句，例如 `SHOW TAG VALUES FROM "cpu" WITH KEY = "host"`。
7. 保存变量。

### 2. 在查询中使用变量

定义变量后，你可以在查询中使用它。例如，如果你定义了一个名为 `server` 的变量，你可以在查询中这样使用它：

```sql
SELECT mean("usage_idle") FROM "cpu" WHERE "host" =~ /$server/
```

在这个例子中，`$server` 是一个变量占位符，Grafana 会根据用户选择的服务器动态替换它。

### 3. 在面板标题和描述中使用变量

你还可以在面板的标题和描述中使用变量。例如，你可以在面板标题中使用 `$server` 变量：

```plaintext
CPU Usage for $server
```

这样，当用户选择不同的服务器时，面板的标题会自动更新。

## 实际案例

假设你正在监控多个服务器的 CPU 使用情况。你可以创建一个仪表盘模板，允许用户选择不同的服务器，并动态显示该服务器的 CPU 使用情况。

1. 定义一个名为 `server` 的变量，允许用户选择服务器。
2. 在查询中使用 `$server` 变量，动态获取所选服务器的 CPU 使用数据。
3. 在面板标题中使用 `$server` 变量，动态更新标题。

这样，用户只需选择一个服务器，仪表盘就会自动显示该服务器的 CPU 使用情况。

## 总结

仪表盘模板是 Grafana 中非常强大的功能，它允许你创建灵活且可重用的仪表盘。通过定义变量并在查询、面板标题和描述中使用它们，你可以轻松地为不同的数据源、时间范围或其他条件生成定制化的视图。

:::tip
尝试在你的仪表盘中添加多个变量，并探索如何在不同的面板中使用它们。这将帮助你更好地理解仪表盘模板的灵活性。
:::

## 附加资源

- [Grafana 官方文档：Variables](https://grafana.com/docs/grafana/latest/variables/)
- [Grafana 官方文档：Templating](https://grafana.com/docs/grafana/latest/dashboards/variables/template-variables/)

## 练习

1. 创建一个新的仪表盘，并定义一个变量来选择不同的时间范围（例如：`1h`, `6h`, `24h`）。
2. 在查询中使用该变量，动态调整图表的时间范围。
3. 在面板标题中使用该变量，动态更新标题以显示所选的时间范围。

通过这些练习，你将更深入地理解仪表盘模板的使用方法，并能够在实际项目中应用它们。