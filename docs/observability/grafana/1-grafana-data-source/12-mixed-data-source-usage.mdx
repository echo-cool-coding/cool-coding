---
title: 混合数据源使用
description: 学习如何在 Grafana 中混合使用多个数据源，以创建更强大的仪表盘和可视化效果。
---

# 混合数据源使用

在 Grafana 中，数据源是仪表盘的核心组成部分。通常情况下，每个面板（Panel）只能使用一个数据源。然而，在某些情况下，您可能需要将来自不同数据源的数据结合起来，以创建更复杂的可视化效果。这就是**混合数据源**的用武之地。

## 什么是混合数据源？

混合数据源允许您在同一个面板中同时使用多个数据源。这意味着您可以将来自不同数据库、API 或其他数据源的数据结合在一起，从而创建更丰富、更有洞察力的仪表盘。

例如，您可能希望将来自 Prometheus 的监控数据与来自 MySQL 的业务数据结合起来，以便更好地理解系统性能与业务指标之间的关系。

## 如何配置混合数据源

在 Grafana 中配置混合数据源非常简单。以下是逐步指南：

1. **创建仪表盘**：首先，创建一个新的仪表盘或打开一个现有的仪表盘。
2. **添加面板**：在仪表盘中添加一个新的面板。
3. **选择数据源**：在面板的查询编辑器中，您会看到一个数据源选择器。默认情况下，它只会显示一个数据源。要启用混合数据源，您需要点击数据源选择器旁边的“+”按钮。
4. **添加多个数据源**：点击“+”按钮后，您可以选择多个数据源。每个数据源将显示为一个单独的查询编辑器。
5. **编写查询**：为每个数据源编写查询。您可以根据需要为每个数据源编写不同的查询。
6. **可视化数据**：完成查询后，Grafana 会自动将来自不同数据源的数据合并到一个面板中。

### 示例：混合 Prometheus 和 MySQL 数据

假设您有一个 Prometheus 数据源和一个 MySQL 数据源。您希望将 Prometheus 中的 CPU 使用率与 MySQL 中的用户注册数结合起来。

```sql
-- MySQL 查询
SELECT COUNT(*) as user_count FROM users WHERE created_at >= NOW() - INTERVAL 1 HOUR;
```

```promql
-- Prometheus 查询
rate(node_cpu_seconds_total{mode="user"}[1h])
```

在 Grafana 中，您可以将这两个查询分别配置为不同的数据源，并在同一个面板中显示它们的结果。

## 实际应用场景

### 场景 1：监控与业务数据结合

假设您正在运行一个电子商务网站，您希望监控系统性能（如 CPU 使用率、内存使用率）与业务指标（如订单数量、用户活跃度）之间的关系。通过混合数据源，您可以将来自 Prometheus 的系统监控数据与来自 MySQL 的业务数据结合起来，从而更好地理解系统性能对业务的影响。

### 场景 2：多环境数据对比

如果您在多个环境中运行相同的应用程序（如开发、测试、生产），您可能希望将来自不同环境的监控数据结合起来进行对比。通过混合数据源，您可以将来自不同环境的 Prometheus 数据结合起来，从而更容易发现环境之间的差异。

## 总结

混合数据源是 Grafana 中一个非常强大的功能，它允许您将来自不同数据源的数据结合起来，从而创建更复杂、更有洞察力的仪表盘。通过本文，您已经学习了如何配置混合数据源，并了解了它在实际应用中的一些常见场景。

## 附加资源与练习

- **练习**：尝试在您的 Grafana 实例中创建一个混合数据源的仪表盘，结合 Prometheus 和 MySQL 数据。
- **进一步学习**：阅读 Grafana 官方文档中关于[混合数据源](https://grafana.com/docs/grafana/latest/features/datasources/mixed/)的更多内容。

通过掌握混合数据源的使用，您将能够创建更强大、更灵活的仪表盘，从而更好地理解和分析您的数据。