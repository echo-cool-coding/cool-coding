---
title: HTTP API 集成
description: 了解如何使用 Grafana 的 HTTP API 集成功能，通过 API 与 Grafana 进行交互，实现自动化管理和数据可视化。
---

# HTTP API 集成

Grafana 是一个强大的开源数据可视化工具，广泛用于监控和数据分析。除了通过用户界面进行操作外，Grafana 还提供了 HTTP API，允许开发者通过编程方式与 Grafana 进行交互。本文将详细介绍如何使用 Grafana 的 HTTP API 集成功能，帮助初学者掌握这一高级功能。

## 什么是 HTTP API 集成？

HTTP API 集成是指通过 HTTP 请求与 Grafana 进行交互，从而实现对 Grafana 的自动化管理。通过 API，您可以创建、更新、删除仪表盘，查询数据源，管理用户权限等。这种方式特别适合需要自动化操作或与其他系统集成的场景。

## 准备工作

在开始之前，您需要确保以下几点：

1. **Grafana 实例**：确保您有一个正在运行的 Grafana 实例，并且可以通过网络访问。
2. **API 密钥**：为了安全地访问 Grafana API，您需要生成一个 API 密钥。可以在 Grafana 的用户界面中生成和管理 API 密钥。
3. **HTTP 客户端**：您可以使用任何支持 HTTP 请求的工具或编程语言，如 `curl`、Postman、Python 的 `requests` 库等。

## 基本操作

### 1. 获取 API 密钥

首先，您需要在 Grafana 中生成一个 API 密钥。登录 Grafana，进入 **Configuration > API Keys**，然后点击 **Add API Key**。填写名称和角色，生成密钥后，请妥善保存，因为它只会显示一次。

### 2. 使用 API 密钥进行身份验证

在发送 HTTP 请求时，您需要在请求头中包含 API 密钥进行身份验证。例如，使用 `curl` 命令时，可以这样设置请求头：

```bash
curl -H "Authorization: Bearer YOUR_API_KEY" http://your-grafana-instance/api/endpoint
```

### 3. 获取仪表盘列表

让我们从一个简单的例子开始：获取 Grafana 中所有的仪表盘列表。使用以下 `curl` 命令：

```bash
curl -H "Authorization: Bearer YOUR_API_KEY" http://your-grafana-instance/api/search
```

**输出示例**：

```json
[
  {
    "id": 1,
    "uid": "dash-1",
    "title": "Example Dashboard",
    "uri": "db/example-dashboard",
    "url": "/d/dash-1/example-dashboard",
    "type": "dash-db"
  }
]
```

### 4. 创建新的仪表盘

接下来，我们尝试通过 API 创建一个新的仪表盘。首先，准备一个 JSON 文件 `dashboard.json`，内容如下：

```json
{
  "dashboard": {
    "title": "New Dashboard",
    "panels": [
      {
        "type": "graph",
        "title": "Sample Graph",
        "gridPos": { "x": 0, "y": 0, "w": 12, "h": 9 }
      }
    ]
  },
  "folderId": 0,
  "overwrite": false
}
```

然后，使用 `curl` 命令发送 POST 请求：

```bash
curl -X POST -H "Authorization: Bearer YOUR_API_KEY" -H "Content-Type: application/json" -d @dashboard.json http://your-grafana-instance/api/dashboards/db
```

**输出示例**：

```json
{
  "id": 2,
  "uid": "dash-2",
  "url": "/d/dash-2/new-dashboard",
  "status": "success"
}
```

## 实际应用场景

### 自动化仪表盘管理

在一个大型监控系统中，可能需要频繁地创建和更新仪表盘。通过 HTTP API，您可以编写脚本或使用 CI/CD 工具自动化这些操作。例如，每次部署新服务时，自动创建一个新的仪表盘来监控该服务的性能。

### 数据源集成

Grafana 支持多种数据源，如 Prometheus、InfluxDB、Elasticsearch 等。通过 API，您可以动态地添加或更新数据源配置，确保 Grafana 始终与最新的数据源保持同步。

## 总结

通过 Grafana 的 HTTP API 集成，您可以实现与 Grafana 的自动化交互，从而简化管理和提高效率。本文介绍了如何获取 API 密钥、进行身份验证、获取仪表盘列表以及创建新的仪表盘。希望这些内容能帮助您更好地理解和使用 Grafana 的 HTTP API 功能。

## 附加资源

- [Grafana 官方 API 文档](https://grafana.com/docs/grafana/latest/http_api/)
- [Grafana API 示例代码库](https://github.com/grafana/grafana-api-examples)

## 练习

1. 使用 API 获取 Grafana 中所有的数据源列表。
2. 编写一个脚本，自动创建一个包含多个面板的仪表盘。
3. 尝试通过 API 更新现有的仪表盘配置。

通过完成这些练习，您将更深入地掌握 Grafana 的 HTTP API 集成功能。