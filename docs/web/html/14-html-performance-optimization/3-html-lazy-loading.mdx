---
title: HTML 延迟加载
description: 了解HTML延迟加载的概念及其在优化网页性能中的应用。本文适合初学者，包含代码示例、实际案例和总结。
---

# HTML 延迟加载

在现代网页开发中，性能优化是一个至关重要的主题。HTML延迟加载（Lazy Loading）是一种优化技术，它允许浏览器在需要时才加载某些资源，而不是在页面初始加载时一次性加载所有内容。这种技术可以显著减少初始页面加载时间，提升用户体验。

## 什么是HTML延迟加载？

HTML延迟加载是一种策略，通过延迟加载非关键资源（如图片、视频、iframe等），直到用户滚动到页面中需要这些资源的部分时才加载它们。这样可以减少初始页面加载时间，节省带宽，并提高页面的响应速度。

### 为什么需要延迟加载？

- **减少初始加载时间**：延迟加载可以减少页面初始加载时需要下载的资源量，从而加快页面加载速度。
- **节省带宽**：对于用户来说，延迟加载可以减少不必要的数据下载，节省带宽。
- **提高用户体验**：用户不会因为页面加载过慢而感到不耐烦，尤其是在移动设备上。

## 如何实现HTML延迟加载？

### 1. 图片延迟加载

图片是网页中最常见的资源之一，也是最容易通过延迟加载来优化的资源。HTML5 提供了一个原生的延迟加载属性 `loading="lazy"`，可以轻松实现图片的延迟加载。

```html
<img src="image.jpg" alt="示例图片" loading="lazy" />
```

在这个例子中，`loading="lazy"` 属性告诉浏览器在图片进入视口时才加载它。

:::note
**注意**：并非所有浏览器都支持 `loading="lazy"` 属性。对于不支持该属性的浏览器，可以使用 JavaScript 来实现延迟加载。
:::

### 2. iframe延迟加载

与图片类似，iframe 也可以通过 `loading="lazy"` 属性来实现延迟加载。

```html
<iframe src="https://example.com" loading="lazy"></iframe>
```

### 3. 使用JavaScript实现延迟加载

对于不支持 `loading="lazy"` 的浏览器，可以使用 JavaScript 来实现延迟加载。以下是一个简单的示例：

```html
<img data-src="image.jpg" alt="示例图片" class="lazyload" />
```

```javascript
document.addEventListener("DOMContentLoaded", function() {
  var lazyloadImages = document.querySelectorAll(".lazyload");
  var lazyloadThrottleTimeout;

  function lazyload() {
    if(lazyloadThrottleTimeout) {
      clearTimeout(lazyloadThrottleTimeout);
    }

    lazyloadThrottleTimeout = setTimeout(function() {
      var scrollTop = window.pageYOffset;
      lazyloadImages.forEach(function(img) {
        if(img.offsetTop < (window.innerHeight + scrollTop)) {
          img.src = img.dataset.src;
          img.classList.remove('lazyload');
        }
      });
      if(lazyloadImages.length == 0) {
        document.removeEventListener("scroll", lazyload);
        window.removeEventListener("resize", lazyload);
        window.removeEventListener("orientationChange", lazyload);
      }
    }, 20);
  }

  document.addEventListener("scroll", lazyload);
  window.addEventListener("resize", lazyload);
  window.addEventListener("orientationChange", lazyload);
});
```

在这个示例中，图片的 `src` 属性被替换为 `data-src`，并在图片进入视口时才将 `data-src` 的值赋给 `src` 属性。

## 实际应用场景

### 1. 图片画廊

在一个包含大量图片的图片画廊中，延迟加载可以显著减少初始加载时间。用户只有在滚动到特定图片时，该图片才会被加载。

### 2. 长页面内容

在长页面中，延迟加载可以确保用户只加载他们实际看到的内容。例如，在一个博客文章中，只有在用户滚动到某个部分时，该部分的图片或视频才会被加载。

### 3. 社交媒体嵌入

社交媒体嵌入（如 Twitter 推文或 Instagram 帖子）通常是通过 iframe 实现的。延迟加载这些 iframe 可以减少初始页面加载时间。

## 总结

HTML延迟加载是一种有效的性能优化技术，特别适用于包含大量图片、视频或 iframe 的网页。通过延迟加载非关键资源，可以显著减少初始页面加载时间，提升用户体验。

:::tip
**提示**：在使用延迟加载时，务必考虑兼容性问题。对于不支持原生延迟加载的浏览器，可以使用 JavaScript 来实现类似的功能。
:::

## 附加资源

- [MDN Web Docs: Lazy Loading](https://developer.mozilla.org/en-US/docs/Web/Performance/Lazy_loading)
- [Google Developers: Lazy Loading Images and Video](https://web.dev/lazy-loading/)

## 练习

1. 在你的网页中添加 `loading="lazy"` 属性，观察页面加载时间的变化。
2. 使用 JavaScript 实现一个简单的图片延迟加载功能，并测试其效果。

通过实践这些技术，你将能够更好地理解HTML延迟加载的工作原理，并将其应用到实际项目中。