---
title: Docker Trusted Registry
description: 了解 Docker Trusted Registry（DTR）的基本概念、功能及其在 Docker 生态系统中的重要性。本文适合初学者，包含代码示例、实际案例和总结。
---

# Docker Trusted Registry

Docker Trusted Registry（DTR）是 Docker 生态系统中的一个关键组件，用于安全地存储和管理 Docker 镜像。它是 Docker 企业版的一部分，专为企业级用户设计，提供了镜像存储、访问控制、漏洞扫描和镜像签名等功能。本文将带你深入了解 DTR 的核心概念、使用方法以及实际应用场景。

## 什么是 Docker Trusted Registry？

Docker Trusted Registry（DTR）是一个企业级的 Docker 镜像仓库，用于存储和管理 Docker 镜像。与 Docker Hub 不同，DTR 是一个私有仓库，可以在企业内部部署，确保镜像的安全性和可控性。DTR 提供了以下主要功能：

1. **镜像存储**：集中存储和管理 Docker 镜像。
2. **访问控制**：通过用户和团队权限管理镜像的访问。
3. **漏洞扫描**：自动扫描镜像中的安全漏洞。
4. **镜像签名**：确保镜像的完整性和来源可信。

## 为什么需要 Docker Trusted Registry？

在企业环境中，镜像的安全性和可控性至关重要。DTR 提供了以下优势：

- **私有化部署**：镜像存储在企业内部，避免将敏感数据暴露在公共网络中。
- **安全性**：通过访问控制和镜像签名，确保只有授权用户可以访问和使用镜像。
- **合规性**：满足企业对镜像管理和安全审计的要求。

## 安装和配置 DTR

要使用 DTR，首先需要在 Docker 企业版环境中安装和配置它。以下是安装 DTR 的基本步骤：

1. **安装 Docker 企业版**：确保你已经安装了 Docker 企业版。
2. **初始化 DTR**：使用以下命令初始化 DTR：

   ```bash
   docker run -it --rm docker/dtr install --ucp-url <UCP_URL> --ucp-username <UCP_USERNAME> --ucp-password <UCP_PASSWORD>
   ```

   其中，`<UCP_URL>` 是 Docker Universal Control Plane（UCP）的 URL，`<UCP_USERNAME>` 和 `<UCP_PASSWORD>` 是 UCP 的管理员凭据。

3. **访问 DTR**：安装完成后，可以通过浏览器访问 DTR 的管理界面。

## 使用 DTR 管理镜像

### 推送镜像到 DTR

要将本地镜像推送到 DTR，首先需要登录到 DTR：

```bash
docker login <DTR_URL>
```

然后，使用 `docker tag` 命令为镜像打上 DTR 的标签，并推送：

```bash
docker tag <IMAGE_NAME> <DTR_URL>/<REPOSITORY>/<IMAGE_NAME>:<TAG>
docker push <DTR_URL>/<REPOSITORY>/<IMAGE_NAME>:<TAG>
```

### 从 DTR 拉取镜像

要从 DTR 拉取镜像，首先需要登录到 DTR，然后使用 `docker pull` 命令：

```bash
docker pull <DTR_URL>/<REPOSITORY>/<IMAGE_NAME>:<TAG>
```

## 实际案例：在企业中使用 DTR

假设你在一家金融科技公司工作，公司需要确保所有 Docker 镜像的安全性和合规性。以下是使用 DTR 的典型流程：

1. **镜像存储**：开发团队将应用程序的 Docker 镜像推送到 DTR 中。
2. **漏洞扫描**：DTR 自动扫描镜像中的安全漏洞，并生成报告。
3. **镜像签名**：通过 DTR 的镜像签名功能，确保镜像的完整性和来源可信。
4. **访问控制**：只有经过授权的运维团队可以拉取和部署这些镜像。

## 总结

Docker Trusted Registry 是企业级 Docker 镜像管理的理想选择。它提供了镜像存储、访问控制、漏洞扫描和镜像签名等功能，确保镜像的安全性和可控性。通过本文的学习，你应该已经掌握了 DTR 的基本概念和使用方法。

## 附加资源

- [Docker 官方文档：Docker Trusted Registry](https://docs.docker.com/ee/dtr/)
- [Docker 企业版入门指南](https://docs.docker.com/ee/)

## 练习

1. 在你的本地环境中安装 Docker 企业版，并初始化 DTR。
2. 尝试将一个本地镜像推送到 DTR，并从 DTR 中拉取该镜像。
3. 使用 DTR 的漏洞扫描功能，检查一个镜像的安全性。

:::tip
如果你在安装或使用 DTR 时遇到问题，可以参考 Docker 官方文档或社区论坛获取帮助。
:::