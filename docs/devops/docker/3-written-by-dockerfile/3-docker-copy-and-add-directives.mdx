---
title: Docker COPY与ADD指令
description: 了解Dockerfile中的COPY与ADD指令，掌握如何将文件从主机复制到容器中，并理解它们的区别与适用场景。
---

# Docker COPY与ADD指令

在Dockerfile中，`COPY`和`ADD`是两个常用的指令，用于将文件或目录从主机复制到容器中。虽然它们的功能相似，但在某些情况下，它们的行为和用途有所不同。本文将详细介绍这两个指令的使用方法、区别以及实际应用场景。

## 1. COPY指令

`COPY`指令用于将文件或目录从主机复制到容器中。它的语法如下：

```dockerfile
COPY <源路径> <目标路径>
```

- `<源路径>`：主机上的文件或目录路径。
- `<目标路径>`：容器中的目标路径。

### 示例

假设我们有一个项目结构如下：

```
my-app/
├── Dockerfile
├── app.py
└── requirements.txt
```

我们希望在构建镜像时将`app.py`和`requirements.txt`复制到容器的`/app`目录中。可以在Dockerfile中这样写：

```dockerfile
FROM python:3.9-slim

WORKDIR /app

COPY app.py .
COPY requirements.txt .

RUN pip install -r requirements.txt

CMD ["python", "app.py"]
```

在这个例子中，`COPY`指令将`app.py`和`requirements.txt`从主机复制到容器的`/app`目录中。

## 2. ADD指令

`ADD`指令的功能与`COPY`类似，但它具有更多的功能。除了复制文件外，`ADD`还可以自动解压缩tar文件，并且可以从URL下载文件。它的语法如下：

```dockerfile
ADD <源路径> <目标路径>
```

### 示例

假设我们有一个压缩文件`app.tar.gz`，我们希望将其解压缩并复制到容器的`/app`目录中。可以在Dockerfile中这样写：

```dockerfile
FROM python:3.9-slim

WORKDIR /app

ADD app.tar.gz .

RUN pip install -r requirements.txt

CMD ["python", "app.py"]
```

在这个例子中，`ADD`指令会自动解压缩`app.tar.gz`文件，并将其内容复制到容器的`/app`目录中。

## 3. COPY与ADD的区别

虽然`COPY`和`ADD`的功能相似，但它们有一些关键的区别：

- **功能**：`COPY`只能复制文件或目录，而`ADD`除了复制文件外，还可以解压缩tar文件和从URL下载文件。
- **可读性**：由于`COPY`的功能更单一，因此在大多数情况下，使用`COPY`可以提高Dockerfile的可读性和可维护性。
- **安全性**：`ADD`从URL下载文件时可能会引入安全风险，因此建议仅在必要时使用`ADD`。

:::tip
在大多数情况下，建议优先使用`COPY`指令，除非你需要`ADD`的额外功能。
:::

## 4. 实际应用场景

### 场景1：复制本地文件

假设你有一个Web应用程序，包含HTML、CSS和JavaScript文件。你可以使用`COPY`指令将这些文件复制到容器的Web服务器目录中：

```dockerfile
FROM nginx:alpine

COPY index.html /usr/share/nginx/html/
COPY styles.css /usr/share/nginx/html/
COPY script.js /usr/share/nginx/html/
```

### 场景2：解压缩文件

假设你有一个包含静态资源的压缩文件`assets.tar.gz`，你可以使用`ADD`指令将其解压缩并复制到容器的Web服务器目录中：

```dockerfile
FROM nginx:alpine

ADD assets.tar.gz /usr/share/nginx/html/
```

### 场景3：从URL下载文件

假设你需要从URL下载一个配置文件并复制到容器中，你可以使用`ADD`指令：

```dockerfile
FROM ubuntu:latest

ADD https://example.com/config.json /app/config.json
```

## 5. 总结

`COPY`和`ADD`是Dockerfile中用于将文件从主机复制到容器中的两个重要指令。`COPY`功能单一，适合大多数文件复制场景；而`ADD`功能更强大，支持解压缩和从URL下载文件。在实际使用中，建议优先使用`COPY`，除非你需要`ADD`的额外功能。

## 6. 附加资源与练习

- **练习1**：创建一个Dockerfile，使用`COPY`指令将本地的一个Python项目复制到容器中，并运行该项目。
- **练习2**：创建一个Dockerfile，使用`ADD`指令从一个URL下载一个配置文件，并将其复制到容器中。

通过以上练习，你将更好地理解`COPY`和`ADD`指令的使用方法和区别。