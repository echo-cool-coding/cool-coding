---
title: Docker FROM 指令
description: 了解 Dockerfile 中的 FROM 指令，它是构建 Docker 镜像的基础。本文将从基础概念到实际应用，逐步讲解如何使用 FROM 指令。
---

# Docker FROM 指令

在 Docker 中，`FROM` 指令是 Dockerfile 中最重要且必不可少的指令之一。它用于指定基础镜像，所有后续的指令都将基于这个基础镜像进行构建。理解 `FROM` 指令的用法和意义，是掌握 Docker 镜像构建的第一步。

## 什么是 `FROM` 指令？

`FROM` 指令用于指定构建 Docker 镜像时所使用的基础镜像。基础镜像可以是官方镜像（如 `ubuntu`、`alpine` 等），也可以是自定义镜像。`FROM` 指令通常是 Dockerfile 的第一条指令（除了注释和 `ARG` 指令外），因为它为后续的指令提供了基础环境。

### 基本语法

```dockerfile
FROM <image>[:<tag>] [AS <name>]
```

- `<image>`：指定基础镜像的名称。
- `<tag>`：可选参数，指定镜像的版本标签。如果不指定，默认使用 `latest` 标签。
- `AS <name>`：可选参数，用于多阶段构建时为阶段命名。

### 示例

以下是一个简单的 Dockerfile 示例，使用 `FROM` 指令指定基础镜像为 `ubuntu:20.04`：

```dockerfile
FROM ubuntu:20.04
```

在这个例子中，`ubuntu:20.04` 是基础镜像，后续的指令将在这个镜像的基础上进行构建。

## 为什么需要 `FROM` 指令？

`FROM` 指令的作用是为 Docker 镜像提供一个起点。它定义了镜像的基础环境，包括操作系统、预安装的软件包等。通过选择合适的基础镜像，可以避免从头开始配置环境，从而节省时间和精力。

:::tip
选择合适的基础镜像非常重要。通常建议使用官方镜像或经过验证的镜像，以确保安全性和稳定性。
:::

## 多阶段构建中的 `FROM` 指令

在复杂的项目中，可能会使用多阶段构建来优化镜像大小和构建过程。多阶段构建允许在一个 Dockerfile 中使用多个 `FROM` 指令，每个阶段可以有不同的基础镜像。

### 示例：多阶段构建

以下是一个多阶段构建的示例，第一阶段用于构建应用程序，第二阶段用于运行应用程序：

```dockerfile
# 第一阶段：构建应用程序
FROM golang:1.19 AS builder
WORKDIR /app
COPY . .
RUN go build -o myapp .

# 第二阶段：运行应用程序
FROM alpine:3.14
WORKDIR /app
COPY --from=builder /app/myapp .
CMD ["./myapp"]
```

在这个例子中，第一阶段使用 `golang:1.19` 作为基础镜像来构建应用程序，第二阶段使用 `alpine:3.14` 作为基础镜像来运行应用程序。通过多阶段构建，最终生成的镜像只包含运行应用程序所需的文件，从而减小了镜像的大小。

## 实际应用场景

### 场景 1：使用官方镜像作为基础

假设你正在开发一个 Python Web 应用程序，可以使用 `python:3.9-slim` 作为基础镜像：

```dockerfile
FROM python:3.9-slim
WORKDIR /app
COPY requirements.txt .
RUN pip install -r requirements.txt
COPY . .
CMD ["python", "app.py"]
```

在这个场景中，`python:3.9-slim` 提供了 Python 3.9 的运行环境，并且由于使用了 `slim` 版本，镜像体积较小。

### 场景 2：自定义基础镜像

如果你有一个自定义的基础镜像，可以在 `FROM` 指令中指定：

```dockerfile
FROM my-custom-base-image:1.0
WORKDIR /app
COPY . .
CMD ["./start.sh"]
```

在这个场景中，`my-custom-base-image:1.0` 是你自己构建的基础镜像，可能已经包含了特定的配置和依赖。

## 总结

`FROM` 指令是 Dockerfile 中的核心指令之一，它定义了构建镜像的基础环境。通过选择合适的基础镜像，可以简化镜像构建过程并优化镜像大小。在多阶段构建中，`FROM` 指令还可以帮助分离构建环境和运行环境，从而生成更高效的镜像。

:::note
在实际使用中，建议定期更新基础镜像，以确保安全性和兼容性。
:::

## 附加资源与练习

- **练习 1**：尝试创建一个 Dockerfile，使用 `node:16` 作为基础镜像，并运行一个简单的 Node.js 应用程序。
- **练习 2**：使用多阶段构建，创建一个包含 Go 应用程序的 Docker 镜像，并确保最终镜像使用 `alpine` 作为基础镜像。

通过实践这些练习，你将更好地理解 `FROM` 指令的用法和重要性。