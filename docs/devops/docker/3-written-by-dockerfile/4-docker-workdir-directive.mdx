---
title: Docker WORKDIR 指令
description: 了解 Docker 中的 WORKDIR 指令，掌握如何设置容器的工作目录，并通过实际案例加深理解。
---

# Docker WORKDIR 指令

在 Docker 中，`WORKDIR` 是一个非常重要的指令，用于设置容器内的工作目录。它类似于在命令行中使用 `cd` 命令切换目录。通过 `WORKDIR`，你可以指定后续指令（如 `RUN`、`COPY`、`CMD` 等）的执行路径。

## 什么是 WORKDIR？

`WORKDIR` 指令用于在 Docker 镜像中设置工作目录。当你使用 `WORKDIR` 设置一个目录后，所有后续的指令都会在这个目录下执行。如果指定的目录不存在，Docker 会自动创建它。

### 语法

```dockerfile
WORKDIR /path/to/directory
```

- `/path/to/directory`：你想要设置为工作目录的路径。

## 为什么使用 WORKDIR？

使用 `WORKDIR` 有以下几个好处：

1. **简化路径**：你不需要在每条指令中都写完整的路径，只需使用相对路径即可。
2. **提高可读性**：通过明确指定工作目录，Dockerfile 更易于理解和维护。
3. **避免错误**：减少因路径错误导致的文件操作问题。

## 代码示例

让我们通过一个简单的例子来理解 `WORKDIR` 的使用。

```dockerfile
FROM ubuntu:latest

# 设置工作目录为 /app
WORKDIR /app

# 在当前工作目录（/app）下创建一个文件
RUN touch example.txt

# 将当前目录的内容复制到容器中的 /app 目录
COPY . .

# 列出 /app 目录下的文件
RUN ls -l
```

### 解释

1. `WORKDIR /app`：将工作目录设置为 `/app`。
2. `RUN touch example.txt`：在 `/app` 目录下创建一个名为 `example.txt` 的文件。
3. `COPY . .`：将当前目录的内容复制到容器中的 `/app` 目录。
4. `RUN ls -l`：列出 `/app` 目录下的文件。

### 输出

假设你在本地有一个包含 `Dockerfile` 和 `index.html` 的目录，构建并运行该容器后，你将看到类似以下的输出：

```bash
total 8
-rw-r--r-- 1 root root    0 Oct  1 12:00 example.txt
-rw-r--r-- 1 root root  123 Oct  1 12:00 index.html
```

## 实际应用场景

### 场景 1：构建 Node.js 应用

假设你正在构建一个 Node.js 应用，通常你会将代码放在 `/app` 目录下，并在该目录下运行 `npm install` 和 `npm start`。

```dockerfile
FROM node:14

# 设置工作目录为 /app
WORKDIR /app

# 复制 package.json 和 package-lock.json
COPY package*.json ./

# 安装依赖
RUN npm install

# 复制所有文件
COPY . .

# 启动应用
CMD ["npm", "start"]
```

### 场景 2：构建 Python 应用

对于 Python 应用，你可能希望将代码放在 `/usr/src/app` 目录下，并在该目录下运行 `pip install` 和 `python` 命令。

```dockerfile
FROM python:3.8-slim

# 设置工作目录为 /usr/src/app
WORKDIR /usr/src/app

# 复制 requirements.txt
COPY requirements.txt ./

# 安装依赖
RUN pip install --no-cache-dir -r requirements.txt

# 复制所有文件
COPY . .

# 启动应用
CMD ["python", "app.py"]
```

## 总结

`WORKDIR` 是 Dockerfile 中一个非常实用的指令，它可以帮助你简化路径操作，提高 Dockerfile 的可读性和可维护性。通过设置工作目录，你可以确保所有后续指令都在正确的路径下执行，从而避免因路径错误导致的问题。

## 附加资源

- [Docker 官方文档 - WORKDIR](https://docs.docker.com/engine/reference/builder/#workdir)
- [Dockerfile 最佳实践](https://docs.docker.com/develop/develop-images/dockerfile_best-practices/)

## 练习

1. 创建一个 Dockerfile，使用 `WORKDIR` 设置工作目录为 `/var/www/html`，并在该目录下创建一个 `index.html` 文件。
2. 修改上面的 Node.js 示例，将工作目录改为 `/usr/src/app`，并确保应用能够正常运行。

通过完成这些练习，你将更深入地理解 `WORKDIR` 的使用方法。