---
title: Jenkins 单点登录
description: 了解如何在Jenkins中配置单点登录（SSO），以简化用户身份验证并提高安全性。
---

# Jenkins 单点登录

在现代软件开发中，Jenkins 是一个广泛使用的持续集成和持续交付（CI/CD）工具。随着团队规模的扩大，管理用户身份验证和权限变得越来越复杂。单点登录（Single Sign-On, SSO）是一种解决方案，它允许用户通过一次登录访问多个系统，从而简化身份验证流程并提高安全性。

本文将详细介绍如何在 Jenkins 中配置单点登录，适合初学者逐步学习和实践。

## 什么是单点登录（SSO）？

单点登录（SSO）是一种身份验证机制，允许用户通过一次登录访问多个应用程序或系统。用户只需在一个地方输入他们的凭据，就可以访问所有授权的资源，而无需在每个系统中单独登录。

在 Jenkins 中，SSO 可以通过集成外部身份提供者（如 LDAP、OAuth、SAML 等）来实现。这样，Jenkins 可以依赖这些外部系统来验证用户身份，而不需要维护自己的用户数据库。

## 为什么在 Jenkins 中使用 SSO？

1. **简化用户管理**：通过 SSO，用户只需记住一组凭据，减少了密码管理的复杂性。
2. **提高安全性**：SSO 通常与多因素认证（MFA）结合使用，增加了额外的安全层。
3. **集中控制**：管理员可以在一个地方管理用户权限，而不需要在多个系统中重复配置。

## 配置 Jenkins 单点登录

### 1. 安装必要的插件

首先，你需要安装支持 SSO 的 Jenkins 插件。常见的插件包括：

- **SAML Plugin**：用于与 SAML 身份提供者集成。
- **OAuth Plugin**：用于与 OAuth 提供者（如 GitHub、Google）集成。
- **LDAP Plugin**：用于与 LDAP 目录服务集成。

你可以通过 Jenkins 的插件管理器安装这些插件。

```bash
# 示例：安装 SAML 插件
Manage Jenkins -> Manage Plugins -> Available -> 搜索 "SAML" -> 安装
```

### 2. 配置身份提供者

接下来，你需要配置 Jenkins 以与你的身份提供者通信。以下是一个使用 SAML 的示例配置：

1. 进入 Jenkins 的全局安全配置页面：`Manage Jenkins -> Configure Global Security`。
2. 在 "Security Realm" 部分，选择 "SAML 2.0"。
3. 填写身份提供者的元数据 URL 或其他必要信息。
4. 保存配置。

```yaml
# 示例：SAML 配置
securityRealm:
  saml:
    idpMetadataConfiguration:
      url: "https://your-idp.com/metadata"
    displayNameAttribute: "displayName"
    groupsAttribute: "groups"
```

### 3. 测试 SSO 配置

配置完成后，你可以通过以下步骤测试 SSO 是否正常工作：

1. 注销 Jenkins。
2. 尝试重新登录，应该会被重定向到身份提供者的登录页面。
3. 输入你的凭据，成功登录后应该会被重定向回 Jenkins。

### 4. 配置用户权限

一旦 SSO 配置成功，你可以通过 Jenkins 的 "Manage Roles" 和 "Assign Roles" 功能来管理用户权限。确保每个用户或用户组都有适当的权限。

```yaml
# 示例：角色配置
roleStrategy:
  roles:
    global:
      - name: "admin"
        permissions:
          - "Overall/Administer"
      - name: "developer"
        permissions:
          - "Job/Build"
          - "Job/Read"
```

## 实际案例

假设你有一个开发团队，使用 GitHub 作为代码仓库，并且希望 Jenkins 与 GitHub 的 OAuth 集成。通过配置 OAuth 插件，团队成员可以使用他们的 GitHub 账户登录 Jenkins，而无需创建单独的 Jenkins 账户。

```yaml
# 示例：GitHub OAuth 配置
securityRealm:
  github:
    clientID: "your-client-id"
    clientSecret: "your-client-secret"
    oauthScopes: "read:org,user:email"
```

## 总结

通过配置 Jenkins 单点登录，你可以简化用户身份验证流程，提高安全性，并集中管理用户权限。本文介绍了如何安装必要的插件、配置身份提供者、测试 SSO 配置以及管理用户权限。

## 附加资源

- [Jenkins 官方文档](https://www.jenkins.io/doc/)
- [SAML 插件文档](https://plugins.jenkins.io/saml/)
- [OAuth 插件文档](https://plugins.jenkins.io/oic-auth/)

## 练习

1. 在你的 Jenkins 实例中安装并配置 SAML 插件。
2. 尝试使用 GitHub OAuth 插件配置 SSO。
3. 创建一个新的 Jenkins 角色，并分配给通过 SSO 登录的用户。

通过完成这些练习，你将更深入地理解 Jenkins 单点登录的配置和管理。