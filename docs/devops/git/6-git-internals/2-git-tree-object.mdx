---
title: Git 树对象
description: "了解Git树对象的概念及其在Git内部原理中的作用。通过实际案例和代码示例，掌握树对象的结构和用途。"
---

## 介绍

在Git中，**树对象（Tree Object）** 是Git用来表示文件和目录结构的一种数据结构。它是Git版本控制系统的核心组成部分之一，用于记录项目中文件和目录的状态。树对象与**提交对象（Commit Object）** 和**Blob对象（Blob Object）** 一起，构成了Git的内部数据模型。

简单来说，树对象就像是一个文件系统的快照，它记录了某个时间点下项目中的所有文件和目录的结构。每个树对象可以包含多个条目，每个条目可以是文件（Blob对象）或子目录（另一个树对象）。

## 树对象的结构

树对象的结构非常简单，它由一系列条目组成，每个条目包含以下信息：

- **模式（Mode）**：文件的权限和类型（例如，100644表示普通文件，040000表示目录）。
- **对象类型（Type）**：通常是`blob`（文件）或`tree`（目录）。
- **对象哈希（Hash）**：指向文件或目录的Git对象哈希值。
- **文件名（Name）**：文件或目录的名称。

### 示例：树对象的内容

假设我们有一个简单的项目结构如下：

```
project/
├── README.md
└── src/
    └── main.py
```

对应的树对象可能如下所示：

```plaintext
100644 blob 3b18e512dba79e4c8300dd08aeb37f8e728b8dad    README.md
040000 tree 1f7a7a472abf3dd9643fd615f6da379c4acb3e3a    src
```

在这个例子中，`README.md`是一个文件（Blob对象），而`src`是一个目录（另一个树对象）。

## 创建树对象

在Git中，树对象通常是通过`git write-tree`命令创建的。这个命令会将当前暂存区（Index）中的内容写入一个树对象，并返回该对象的哈希值。

### 示例：创建树对象

假设我们有一个项目，并且已经将文件添加到暂存区：

```bash
$ git add README.md src/main.py
```

接下来，我们可以使用`git write-tree`命令创建一个树对象：

```bash
$ git write-tree
```

输出可能如下：

```plaintext
4b825dc642cb6eb9a060e54bf8d69288fbee4904
```

这个哈希值就是新创建的树对象的唯一标识符。

## 树对象与提交对象的关系

树对象通常与提交对象一起使用。每次提交时，Git会创建一个新的提交对象，该对象指向一个树对象，表示当前项目的状态。

### 示例：提交对象与树对象的关系

假设我们有一个提交对象，其内容如下：

```plaintext
tree 4b825dc642cb6eb9a060e54bf8d69288fbee4904
parent 1f7a7a472abf3dd9643fd615f6da379c4acb3e3a
author John Doe <john@example.com> 1622547842 -0400
committer John Doe <john@example.com> 1622547842 -0400

Initial commit
```

在这个提交对象中，`tree`字段指向一个树对象，表示当前项目的状态。

## 实际案例：查看树对象

我们可以使用`git cat-file`命令来查看树对象的内容。假设我们有一个树对象的哈希值为`4b825dc642cb6eb9a060e54bf8d69288fbee4904`，我们可以使用以下命令查看其内容：

```bash
$ git cat-file -p 4b825dc642cb6eb9a060e54bf8d69288fbee4904
```

输出可能如下：

```plaintext
100644 blob 3b18e512dba79e4c8300dd08aeb37f8e728b8dad    README.md
040000 tree 1f7a7a472abf3dd9643fd615f6da379c4acb3e3a    src
```

这个输出显示了树对象中的条目，每个条目对应一个文件或目录。

## 总结

树对象是Git内部用来表示文件和目录结构的重要数据结构。它记录了项目中文件和目录的状态，并与提交对象一起构成了Git的版本控制模型。通过理解树对象的结构和作用，我们可以更好地理解Git的内部工作原理。

:::tip 提示
如果你想深入了解Git的内部原理，可以尝试使用`git cat-file`命令查看不同类型的Git对象（如Blob对象、树对象和提交对象）的内容。
:::

## 附加资源

- [Git Internals - Git Objects](https://git-scm.com/book/en/v2/Git-Internals-Git-Objects)
- [Pro Git Book - Git Internals](https://git-scm.com/book/en/v2/Git-Internals-Plumbing-and-Porcelain)

## 练习

1. 使用`git write-tree`命令创建一个树对象，并查看其内容。
2. 使用`git cat-file`命令查看一个提交对象，并找到它指向的树对象。
3. 尝试修改项目中的文件，创建一个新的树对象，并比较新旧树对象的差异。