---
title: Nginx Docker Compose
description: "学习如何使用 Docker Compose 部署 Nginx，掌握容器化部署的基本概念和实践方法。"
---

## 介绍

在现代应用开发中，容器化技术已经成为一种标准实践。Docker 是一个流行的容器化平台，而 Docker Compose 则是一个用于定义和运行多容器 Docker 应用的工具。Nginx 是一个高性能的 HTTP 服务器和反向代理服务器，常用于部署 Web 应用。

本文将介绍如何使用 Docker Compose 来部署 Nginx，帮助初学者理解容器化部署的基本概念，并通过实际案例展示如何将 Nginx 部署到云平台。

## 什么是 Docker Compose？

Docker Compose 是一个用于定义和运行多容器 Docker 应用的工具。通过一个简单的 YAML 文件，你可以定义多个容器的配置、网络和卷，并使用一条命令启动所有服务。

## 为什么使用 Docker Compose 部署 Nginx？

使用 Docker Compose 部署 Nginx 有以下几个优点：

1. **简化部署流程**：通过一个配置文件定义所有服务，避免了手动启动多个容器的复杂性。
2. **环境一致性**：确保开发、测试和生产环境的一致性。
3. **易于扩展**：可以轻松添加或移除服务，扩展应用功能。

## 准备工作

在开始之前，请确保你已经安装了 Docker 和 Docker Compose。如果尚未安装，可以参考 [Docker 官方文档](https://docs.docker.com/get-docker/) 进行安装。

## 创建 Docker Compose 文件

首先，我们需要创建一个 `docker-compose.yml` 文件来定义 Nginx 服务。

```yaml
version: '3.8'

services:
  nginx:
    image: nginx:latest
    container_name: my_nginx
    ports:
      - "80:80"
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
      - ./html:/usr/share/nginx/html
    networks:
      - nginx_network

networks:
  nginx_network:
    driver: bridge
```

### 解释

- **version**: 指定 Docker Compose 文件的版本。
- **services**: 定义服务列表。在这里，我们定义了一个名为 `nginx` 的服务。
- **image**: 指定使用的 Docker 镜像。这里我们使用官方的 `nginx:latest` 镜像。
- **container_name**: 指定容器的名称。
- **ports**: 将主机的 80 端口映射到容器的 80 端口。
- **volumes**: 挂载本地的 `nginx.conf` 文件和 `html` 目录到容器中。
- **networks**: 定义一个名为 `nginx_network` 的网络，并将 Nginx 服务连接到该网络。

## 创建 Nginx 配置文件

接下来，我们需要创建一个 `nginx.conf` 文件来配置 Nginx。

```nginx
events {}

http {
    server {
        listen 80;
        server_name localhost;

        location / {
            root /usr/share/nginx/html;
            index index.html;
        }
    }
}
```

### 解释

- **events**: 定义事件模块。
- **http**: 定义 HTTP 模块。
- **server**: 定义一个虚拟主机。
- **listen**: 监听 80 端口。
- **server_name**: 指定服务器名称为 `localhost`。
- **location**: 定义 URL 路径的处理规则。
- **root**: 指定静态文件的根目录。
- **index**: 指定默认的索引文件。

## 创建 HTML 文件

在 `html` 目录下创建一个 `index.html` 文件，内容如下：

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome to Nginx</title>
</head>
<body>
    <h1>Hello, Nginx!</h1>
</body>
</html>
```

## 启动服务

在终端中，导航到包含 `docker-compose.yml` 文件的目录，并运行以下命令：

```bash
docker-compose up -d
```

### 解释

- **up**: 启动服务。
- **-d**: 在后台运行容器。

## 验证部署

打开浏览器，访问 `http://localhost`，你应该会看到 "Hello, Nginx!" 的页面。

## 实际应用场景

假设你正在开发一个 Web 应用，并且需要部署一个反向代理服务器来处理静态文件和 API 请求。你可以使用 Docker Compose 来部署 Nginx 作为反向代理，同时部署你的应用容器。通过这种方式，你可以轻松管理多个服务，并确保环境的一致性。

## 总结

通过本文，你学习了如何使用 Docker Compose 部署 Nginx。我们创建了一个简单的 `docker-compose.yml` 文件，配置了 Nginx 服务，并通过挂载本地文件和目录来定制 Nginx 的行为。最后，我们验证了部署并讨论了实际应用场景。

## 附加资源

- [Docker 官方文档](https://docs.docker.com/)
- [Docker Compose 官方文档](https://docs.docker.com/compose/)
- [Nginx 官方文档](https://nginx.org/en/docs/)

## 练习

1. 修改 `nginx.conf` 文件，添加一个新的 `location` 块来处理 `/api` 路径的请求。
2. 尝试在 `docker-compose.yml` 文件中添加一个新的服务（例如 MySQL），并将其连接到 Nginx 服务。

通过完成这些练习，你将进一步掌握 Docker Compose 和 Nginx 的使用。