---
title: Nginx Google Cloud 部署
description: 学习如何在 Google Cloud 上部署 Nginx，从基础概念到实际操作，适合初学者。
---

# Nginx Google Cloud 部署

Nginx 是一个高性能的 HTTP 服务器和反向代理服务器，广泛用于托管网站和应用程序。Google Cloud 是一个强大的云平台，提供了灵活的计算资源和全球覆盖的网络基础设施。将 Nginx 部署到 Google Cloud 上，可以帮助你快速搭建一个高性能的 Web 服务。

本文将逐步指导你如何在 Google Cloud 上部署 Nginx，并提供实际案例和代码示例。

## 1. 准备工作

在开始之前，你需要完成以下准备工作：

1. **Google Cloud 账户**：如果你还没有 Google Cloud 账户，可以访问 [Google Cloud](https://cloud.google.com/) 注册一个免费账户。
2. **Google Cloud SDK**：安装并配置 Google Cloud SDK，以便在本地与 Google Cloud 进行交互。
3. **Nginx 安装包**：确保你已经下载了 Nginx 的安装包，或者准备好通过包管理器安装。

## 2. 创建 Google Cloud 虚拟机实例

首先，我们需要在 Google Cloud 上创建一个虚拟机实例来运行 Nginx。

### 2.1 登录 Google Cloud Console

打开 [Google Cloud Console](https://console.cloud.google.com/) 并使用你的 Google 账户登录。

### 2.2 创建虚拟机实例

1. 在左侧导航栏中，选择 **Compute Engine** > **VM instances**。
2. 点击 **Create Instance** 按钮。
3. 配置虚拟机实例：
   - **Name**: 输入实例名称，例如 `nginx-instance`。
   - **Region**: 选择你希望部署的区域。
   - **Machine type**: 选择适合的机器类型，例如 `e2-medium`。
   - **Boot disk**: 选择操作系统，例如 `Ubuntu 20.04 LTS`。
4. 点击 **Create** 按钮，等待实例创建完成。

:::note
确保在创建实例时，选择允许 HTTP 和 HTTPS 流量的防火墙规则，以便外部用户可以访问你的 Nginx 服务器。
:::

## 3. 安装 Nginx

接下来，我们需要在虚拟机实例上安装 Nginx。

### 3.1 连接到虚拟机实例

使用 SSH 连接到你的虚拟机实例：

```bash
gcloud compute ssh nginx-instance
```

### 3.2 更新系统包

在安装 Nginx 之前，先更新系统包：

```bash
sudo apt update
sudo apt upgrade -y
```

### 3.3 安装 Nginx

使用以下命令安装 Nginx：

```bash
sudo apt install nginx -y
```

### 3.4 启动 Nginx 服务

安装完成后，启动 Nginx 服务：

```bash
sudo systemctl start nginx
```

### 3.5 验证 Nginx 安装

你可以通过访问虚拟机的公共 IP 地址来验证 Nginx 是否安装成功。在浏览器中输入 `http://<your-instance-ip>`，如果看到 Nginx 的欢迎页面，说明安装成功。

## 4. 配置 Nginx

默认情况下，Nginx 会使用 `/var/www/html` 作为网站的根目录。你可以根据需要修改 Nginx 的配置文件。

### 4.1 编辑 Nginx 配置文件

使用以下命令编辑 Nginx 的默认配置文件：

```bash
sudo nano /etc/nginx/sites-available/default
```

你可以修改 `root` 指令来指定你的网站根目录，例如：

```nginx
server {
    listen 80 default_server;
    listen [::]:80 default_server;

    root /var/www/mywebsite;
    index index.html;

    server_name _;

    location / {
        try_files $uri $uri/ =404;
    }
}
```

### 4.2 重启 Nginx 服务

保存并退出编辑器后，重启 Nginx 服务以应用更改：

```bash
sudo systemctl restart nginx
```

## 5. 实际案例：部署一个简单的静态网站

假设你有一个简单的静态网站，包含一个 `index.html` 文件。你可以按照以下步骤将其部署到 Nginx 服务器上。

### 5.1 创建网站目录

在 `/var/www` 目录下创建一个新的目录来存放你的网站文件：

```bash
sudo mkdir -p /var/www/mywebsite
```

### 5.2 上传网站文件

将你的 `index.html` 文件上传到 `/var/www/mywebsite` 目录中。你可以使用 `scp` 命令从本地计算机上传文件：

```bash
scp index.html user@<your-instance-ip>:/var/www/mywebsite/
```

### 5.3 配置 Nginx 指向新目录

编辑 Nginx 配置文件，将 `root` 指令指向 `/var/www/mywebsite`：

```nginx
server {
    listen 80 default_server;
    listen [::]:80 default_server;

    root /var/www/mywebsite;
    index index.html;

    server_name _;

    location / {
        try_files $uri $uri/ =404;
    }
}
```

### 5.4 重启 Nginx 服务

保存并退出编辑器后，重启 Nginx 服务：

```bash
sudo systemctl restart nginx
```

### 5.5 访问网站

在浏览器中输入 `http://<your-instance-ip>`，你应该能够看到你的静态网站内容。

## 6. 总结

通过本文，你已经学会了如何在 Google Cloud 上部署 Nginx，并配置它来托管一个简单的静态网站。Nginx 是一个功能强大的 Web 服务器，结合 Google Cloud 的灵活性和可扩展性，你可以轻松地构建和部署高性能的 Web 应用程序。

## 7. 附加资源与练习

- **Google Cloud 文档**：了解更多关于 Google Cloud 的功能和服务，访问 [Google Cloud 文档](https://cloud.google.com/docs)。
- **Nginx 官方文档**：深入学习 Nginx 的配置和高级功能，访问 [Nginx 官方文档](https://nginx.org/en/docs/)。
- **练习**：尝试在 Google Cloud 上部署一个动态网站，使用 Nginx 作为反向代理，将请求转发到后端应用服务器（如 Node.js 或 Django）。

:::tip
如果你在部署过程中遇到问题，可以查看 Google Cloud 的日志和监控工具，帮助你快速定位和解决问题。
:::