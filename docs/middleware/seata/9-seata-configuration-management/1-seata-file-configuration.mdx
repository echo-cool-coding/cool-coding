---
title: Seata 文件配置
description: 了解如何通过文件配置Seata，掌握Seata的核心配置项及其在实际项目中的应用。
---

# Seata 文件配置

Seata 是一款开源的分布式事务解决方案，旨在解决微服务架构下的分布式事务问题。Seata 的配置管理是其核心功能之一，而文件配置是最基础且常用的配置方式。本文将详细介绍如何通过文件配置 Seata，并展示其在实际项目中的应用。

## 什么是Seata文件配置？

Seata 文件配置是指通过配置文件（如 `file.conf` 和 `registry.conf`）来设置 Seata 的各项参数。这些配置文件通常位于项目的资源目录下，Seata 在启动时会读取这些文件以初始化其运行环境。

:::note
文件配置是 Seata 的默认配置方式，适合大多数场景。对于更复杂的配置需求，Seata 还支持通过其他方式（如配置中心）进行配置。
:::

## Seata 配置文件详解

Seata 的配置文件主要包括两个部分：`file.conf` 和 `registry.conf`。

### 1. `file.conf`

`file.conf` 文件用于配置 Seata 的事务存储模式、事务日志存储路径等核心参数。以下是一个典型的 `file.conf` 示例：

```plaintext
transport {
  # 传输层配置
  type = "TCP"
  server = "NIO"
  heartbeat = true
}

service {
  # 服务配置
  vgroupMapping.my_test_tx_group = "default"
  default.grouplist = "127.0.0.1:8091"
  enableDegrade = false
  disableGlobalTransaction = false
}

client {
  # 客户端配置
  rm {
    asyncCommitBufferLimit = 10000
    reportRetryCount = 5
    tableMetaCheckEnable = false
  }
  tm {
    commitRetryCount = 5
    rollbackRetryCount = 5
  }
}

store {
  # 存储配置
  mode = "file"
  file {
    dir = "sessionStore"
  }
}
```

#### 配置项说明

- **transport**: 配置 Seata 的传输层参数，如传输类型、心跳检测等。
- **service**: 配置 Seata 的服务参数，如事务组映射、默认服务列表等。
- **client**: 配置 Seata 的客户端参数，包括资源管理器（RM）和事务管理器（TM）的相关设置。
- **store**: 配置 Seata 的事务存储模式，支持文件存储、数据库存储等。

### 2. `registry.conf`

`registry.conf` 文件用于配置 Seata 的注册中心和配置中心。以下是一个典型的 `registry.conf` 示例：

```plaintext
registry {
  # 注册中心配置
  type = "file"
  file {
    name = "file.conf"
  }
}

config {
  # 配置中心配置
  type = "file"
  file {
    name = "file.conf"
  }
}
```

#### 配置项说明

- **registry**: 配置 Seata 的注册中心，支持文件、Nacos、Zookeeper 等多种注册中心。
- **config**: 配置 Seata 的配置中心，支持文件、Nacos、Apollo 等多种配置中心。

## 实际应用场景

假设我们有一个微服务架构的电商系统，订单服务和库存服务分别部署在不同的节点上。当用户下单时，订单服务需要调用库存服务来扣减库存。为了保证事务的一致性，我们可以使用 Seata 来管理分布式事务。

### 配置步骤

1. **配置 `file.conf`**: 设置事务存储模式为文件存储，并指定存储路径。
2. **配置 `registry.conf`**: 使用文件作为注册中心和配置中心。
3. **启动 Seata Server**: 确保 Seata Server 已启动并监听指定端口。
4. **集成 Seata Client**: 在订单服务和库存服务中集成 Seata Client，并配置事务组。

### 代码示例

以下是一个简单的订单服务代码示例，展示了如何使用 Seata 进行分布式事务管理：

```java
@GlobalTransactional
public void createOrder(Order order) {
    // 创建订单
    orderService.create(order);
    
    // 扣减库存
    inventoryService.deduct(order.getProductId(), order.getQuantity());
}
```

:::tip
在实际项目中，建议将 Seata 的配置文件放置在统一的配置中心（如 Nacos）中，以便于管理和维护。
:::

## 总结

通过本文的学习，你应该已经掌握了 Seata 文件配置的基本概念和配置方法。文件配置是 Seata 最基础的配置方式，适合大多数场景。对于更复杂的配置需求，Seata 还支持通过配置中心进行动态配置。

## 附加资源

- [Seata 官方文档](https://seata.io/zh-cn/docs/overview/what-is-seata.html)
- [Seata GitHub 仓库](https://github.com/seata/seata)

## 练习

1. 尝试在本地环境中配置 Seata，并启动一个简单的分布式事务示例。
2. 修改 `file.conf` 中的存储模式为数据库存储，并观察事务日志的存储方式有何不同。
