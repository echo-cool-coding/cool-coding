---
title: Seata Eureka 注册中心
description: 了解 Seata 如何与 Eureka 注册中心集成，实现分布式事务的注册与发现。
---

# Seata Eureka 注册中心

## 介绍

在分布式系统中，服务之间的通信和协调是一个关键问题。Seata 是一个开源的分布式事务解决方案，而 Eureka 是 Netflix 开源的基于 REST 的服务注册与发现工具。Seata 与 Eureka 的集成可以帮助我们更好地管理和发现分布式事务中的服务。

本文将详细介绍 Seata 如何与 Eureka 注册中心集成，并通过实际案例展示其应用场景。

## Seata 与 Eureka 的集成

### 1. 什么是 Eureka 注册中心？

Eureka 是一个服务注册与发现工具，主要用于微服务架构中。它允许服务实例在启动时向 Eureka 服务器注册自己，并在需要时从 Eureka 服务器获取其他服务实例的信息。

### 2. Seata 如何与 Eureka 集成？

Seata 通过与 Eureka 集成，可以自动发现和注册分布式事务中的服务。具体来说，Seata 的客户端（如 TM、RM）会向 Eureka 注册自己，并通过 Eureka 获取其他服务实例的信息。

### 3. 配置 Seata 使用 Eureka

要在 Seata 中使用 Eureka 作为注册中心，需要进行以下配置：

1. **添加依赖**：在 `pom.xml` 中添加 Seata 和 Eureka 的依赖。

   ```xml
   <dependency>
       <groupId>io.seata</groupId>
       <artifactId>seata-spring-boot-starter</artifactId>
       <version>1.4.2</version>
   </dependency>
   <dependency>
       <groupId>org.springframework.cloud</groupId>
       <artifactId>spring-cloud-starter-netflix-eureka-client</artifactId>
   </dependency>
   ```

2. **配置 Eureka 客户端**：在 `application.yml` 中配置 Eureka 客户端。

   ```yaml
   eureka:
     client:
       serviceUrl:
         defaultZone: http://localhost:8761/eureka/
   ```

3. **配置 Seata 使用 Eureka**：在 `application.yml` 中配置 Seata 使用 Eureka 作为注册中心。

   ```yaml
   seata:
     registry:
       type: eureka
       eureka:
         service-url: http://localhost:8761/eureka/
   ```

### 4. 代码示例

以下是一个简单的 Spring Boot 应用程序，展示了如何配置 Seata 使用 Eureka 作为注册中心。

```java
@SpringBootApplication
@EnableDiscoveryClient
public class SeataEurekaApplication {
    public static void main(String[] args) {
        SpringApplication.run(SeataEurekaApplication.class, args);
    }
}
```

### 5. 运行与验证

启动 Eureka 服务器和 Seata 服务器后，启动上述 Spring Boot 应用程序。你可以在 Eureka 的管理界面中看到 Seata 的服务实例已经成功注册。

## 实际案例

### 场景描述

假设我们有一个电商系统，包含订单服务、库存服务和支付服务。订单服务在创建订单时需要调用库存服务和支付服务，确保库存充足并完成支付。这个过程中需要保证事务的一致性。

### 解决方案

通过 Seata 与 Eureka 的集成，订单服务可以自动发现库存服务和支付服务，并在分布式事务中协调这些服务的操作。

### 代码实现

1. **订单服务**：创建订单并调用库存服务和支付服务。

   ```java
   @GlobalTransactional
   public void createOrder(Order order) {
       // 调用库存服务
       inventoryService.deductStock(order.getProductId(), order.getQuantity());
       // 调用支付服务
       paymentService.pay(order.getUserId(), order.getAmount());
       // 保存订单
       orderRepository.save(order);
   }
   ```

2. **库存服务**：减少库存。

   ```java
   public void deductStock(String productId, int quantity) {
       // 减少库存逻辑
   }
   ```

3. **支付服务**：完成支付。

   ```java
   public void pay(String userId, BigDecimal amount) {
       // 支付逻辑
   }
   ```

### 运行结果

当订单服务调用 `createOrder` 方法时，Seata 会自动协调库存服务和支付服务的事务，确保所有操作要么全部成功，要么全部回滚。

## 总结

通过 Seata 与 Eureka 的集成，我们可以轻松实现分布式事务的注册与发现。本文详细介绍了如何配置 Seata 使用 Eureka 作为注册中心，并通过实际案例展示了其应用场景。

## 附加资源

- [Seata 官方文档](https://seata.io/zh-cn/docs/overview/what-is-seata.html)
- [Eureka 官方文档](https://github.com/Netflix/eureka/wiki)

## 练习

1. 尝试在自己的 Spring Boot 项目中集成 Seata 和 Eureka。
2. 编写一个简单的分布式事务场景，验证 Seata 与 Eureka 的集成效果。
