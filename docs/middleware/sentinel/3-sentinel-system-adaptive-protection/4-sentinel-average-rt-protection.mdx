---
title: Sentinel 平均 RT 保护
description: 了解 Sentinel 中的平均响应时间（RT）保护机制，学习如何通过自适应保护策略防止系统因响应时间过长而崩溃。
---

# Sentinel 平均 RT 保护

在现代分布式系统中，响应时间（Response Time, RT）是衡量系统性能的重要指标之一。如果系统的响应时间过长，可能会导致用户体验下降，甚至引发系统崩溃。Sentinel 提供了**平均 RT 保护**机制，通过动态调整流量来防止系统因响应时间过长而崩溃。

## 什么是平均 RT 保护？

平均 RT 保护是 Sentinel 自适应保护策略的一部分，它通过监控系统的平均响应时间，动态调整流量以保护系统。当系统的平均响应时间超过预设的阈值时，Sentinel 会自动限制流量，防止系统进一步恶化。

### 核心概念

1. **平均响应时间（RT）**：系统处理请求的平均时间。
2. **阈值**：预设的响应时间上限，超过该值则触发保护机制。
3. **流量调整**：通过限制请求量或拒绝部分请求来降低系统负载。

## 如何配置平均 RT 保护？

在 Sentinel 中，可以通过以下步骤配置平均 RT 保护：

1. **定义规则**：设置平均响应时间的阈值和触发条件。
2. **监控系统**：实时监控系统的平均响应时间。
3. **触发保护**：当平均响应时间超过阈值时，自动触发保护机制。

以下是一个简单的配置示例：

```java
// 定义平均 RT 保护规则
DegradeRule rule = new DegradeRule("myResource")
    .setGrade(RuleConstant.DEGRADE_GRADE_RT) // 设置规则类型为 RT
    .setCount(100) // 设置 RT 阈值为 100ms
    .setTimeWindow(10); // 设置时间窗口为 10 秒

// 加载规则
DegradeRuleManager.loadRules(Collections.singletonList(rule));
```

### 代码解释

- `setGrade(RuleConstant.DEGRADE_GRADE_RT)`：设置规则类型为 RT 保护。
- `setCount(100)`：设置平均响应时间的阈值为 100ms。
- `setTimeWindow(10)`：设置时间窗口为 10 秒，表示在 10 秒内如果平均响应时间超过阈值，则触发保护。

## 实际应用场景

假设你正在开发一个电商网站，其中有一个商品详情页的接口。在高并发情况下，该接口的平均响应时间可能会显著增加，导致用户体验下降。通过配置 Sentinel 的平均 RT 保护，可以在响应时间超过 200ms 时自动限制流量，防止系统进一步恶化。

:::tip
在实际应用中，建议根据系统的实际负载情况动态调整 RT 阈值，以达到最佳的保护效果。
:::

## 总结

Sentinel 的平均 RT 保护机制通过动态调整流量，有效防止系统因响应时间过长而崩溃。通过合理配置规则，可以显著提升系统的稳定性和用户体验。

### 附加资源

- [Sentinel 官方文档](https://sentinelguard.io/)
- [Sentinel GitHub 仓库](https://github.com/alibaba/Sentinel)

### 练习

1. 在你的本地环境中配置一个简单的 Sentinel 平均 RT 保护规则，并测试其效果。
2. 尝试调整 RT 阈值和时间窗口，观察系统行为的变化。

通过以上内容，你应该对 Sentinel 的平均 RT 保护有了初步的了解。继续深入学习 Sentinel 的其他保护机制，以全面提升系统的稳定性。