---
title: Sentinel 多应用管理
description: 了解如何使用Sentinel进行多应用管理，包括配置、监控和仪表盘的使用。本文适合初学者，提供详细的步骤和代码示例。
---

# Sentinel 多应用管理

在现代分布式系统中，多个应用通常需要共享相同的资源和服务。为了确保这些应用的稳定性和可靠性，我们需要一种有效的方式来管理和监控它们。Sentinel 是一个强大的流量控制组件，能够帮助我们在多应用环境中实现精细化的流量管理。

## 什么是Sentinel多应用管理？

Sentinel 多应用管理是指在一个系统中，通过 Sentinel 对多个应用进行统一的流量控制、熔断降级和系统保护。通过这种方式，我们可以确保每个应用都能在资源有限的情况下稳定运行，同时避免某个应用的异常影响到其他应用。

## 配置多应用管理

### 1. 引入Sentinel依赖

首先，我们需要在每个应用中引入 Sentinel 的依赖。以 Maven 项目为例，可以在 `pom.xml` 中添加以下依赖：

```xml
<dependency>
    <groupId>com.alibaba.csp</groupId>
    <artifactId>sentinel-core</artifactId>
    <version>1.8.2</version>
</dependency>
<dependency>
    <groupId>com.alibaba.csp</groupId>
    <artifactId>sentinel-spring-cloud-starter</artifactId>
    <version>1.8.2</version>
</dependency>
```

### 2. 配置Sentinel Dashboard

Sentinel Dashboard 是一个可视化的管理工具，可以帮助我们监控和管理多个应用的流量控制规则。我们需要在每个应用中配置 Sentinel Dashboard 的地址：

```yaml
spring:
  cloud:
    sentinel:
      transport:
        dashboard: localhost:8080
```

### 3. 定义资源规则

在每个应用中，我们需要定义 Sentinel 的资源规则。例如，我们可以通过注解 `@SentinelResource` 来定义一个资源：

```java
@RestController
public class MyController {

    @GetMapping("/hello")
    @SentinelResource(value = "hello", blockHandler = "handleBlock")
    public String hello() {
        return "Hello, Sentinel!";
    }

    public String handleBlock(BlockException ex) {
        return "Blocked by Sentinel";
    }
}
```

## 监控多应用

### 1. 查看实时监控

在 Sentinel Dashboard 中，我们可以实时查看每个应用的流量情况。通过仪表盘，我们可以观察到每个资源的 QPS、响应时间、异常比例等指标。

### 2. 配置规则

在 Dashboard 中，我们可以为每个应用配置流量控制规则、熔断降级规则和系统保护规则。例如，我们可以为某个资源设置 QPS 阈值：

```json
{
  "resource": "hello",
  "count": 10,
  "grade": 1,
  "limitApp": "default",
  "strategy": 0,
  "controlBehavior": 0
}
```

### 3. 动态规则推送

Sentinel 支持动态规则推送，这意味着我们可以在不重启应用的情况下，实时更新流量控制规则。通过 Dashboard，我们可以将规则推送到每个应用：

```java
FlowRuleManager.loadRules(rules);
```

## 实际案例

假设我们有一个电商系统，包含用户服务、订单服务和库存服务。我们可以使用 Sentinel 对这些服务进行统一的流量控制：

1. **用户服务**：限制登录接口的 QPS，防止恶意登录。
2. **订单服务**：设置熔断规则，当订单创建失败率达到一定阈值时，自动熔断。
3. **库存服务**：配置系统保护规则，防止库存服务过载。

通过 Sentinel 的多应用管理，我们可以确保这些服务在高并发场景下依然能够稳定运行。

## 总结

Sentinel 多应用管理为我们提供了一种高效的方式来管理和监控多个应用的流量控制。通过合理的配置和规则设置，我们可以确保每个应用都能在资源有限的情况下稳定运行。希望本文能帮助你更好地理解和使用 Sentinel 进行多应用管理。

## 附加资源

- [Sentinel 官方文档](https://github.com/alibaba/Sentinel/wiki)
- [Sentinel Dashboard 使用指南](https://github.com/alibaba/Sentinel/wiki/Dashboard)
- [Sentinel 实战案例](https://github.com/alibaba/Sentinel/wiki/实战案例)

## 练习

1. 在你的项目中引入 Sentinel，并配置一个简单的流量控制规则。
2. 使用 Sentinel Dashboard 监控你的应用，并尝试动态更新规则。
3. 设计一个多应用场景，使用 Sentinel 进行统一的流量控制和管理。
