---
title: Sentinel 简介
description: 了解Sentinel的基本概念、核心功能及其在实际开发中的应用场景。
slug: /middleware/sentinel
---

## 什么是Sentinel？

Sentinel是阿里巴巴开源的一款轻量级流量控制组件，主要用于实现**流量控制**、**熔断降级**、**系统负载保护**等功能。它可以帮助开发者在分布式系统中更好地管理资源，防止系统因流量激增或异常情况而崩溃。

Sentinel的核心思想是通过定义规则来控制资源的访问，确保系统在高并发或异常情况下仍能稳定运行。它广泛应用于微服务架构中，是构建高可用性系统的重要工具之一。

---

## Sentinel 的核心功能

Sentinel提供了以下核心功能：

1. **流量控制**：通过设置QPS（每秒查询数）或线程数等指标，限制资源的访问速率。
2. **熔断降级**：当资源访问失败率超过阈值时，自动熔断并降级服务，避免雪崩效应。
3. **系统负载保护**：根据系统的实时负载情况，动态调整流量控制策略。
4. **实时监控**：提供实时的资源访问统计和监控数据，帮助开发者快速定位问题。

---

## Sentinel 的基本概念

### 1. 资源（Resource）
资源是Sentinel的核心概念，代表需要被保护的逻辑单元。资源可以是一个方法、一个接口或一段代码。例如：

```java
@SentinelResource(value = "myResource", blockHandler = "handleBlock")
public String myMethod() {
    // 业务逻辑
    return "Hello, Sentinel!";
}
```

### 2. 规则（Rule）
规则定义了资源的访问控制策略。常见的规则类型包括：
- **流量控制规则**：限制资源的访问速率。
- **熔断规则**：在资源访问失败时触发熔断。
- **系统保护规则**：根据系统负载动态调整流量。

### 3. 上下文（Context）
上下文是Sentinel的执行环境，包含了资源的调用链信息。每个资源都会在特定的上下文中执行。

---

## 实际应用场景

### 场景1：流量控制
假设你有一个电商系统，其中有一个商品详情接口 `/product/{id}`。在高并发场景下，为了保护后端服务，你可以使用Sentinel对该接口进行流量控制：

```java
FlowRule rule = new FlowRule();
rule.setResource("productDetail");
rule.setGrade(RuleConstant.FLOW_GRADE_QPS);
rule.setCount(100); // 限制QPS为100
FlowRuleManager.loadRules(Collections.singletonList(rule));
```

当接口的QPS超过100时，Sentinel会自动拒绝多余的请求，并返回默认的降级响应。

### 场景2：熔断降级
假设你的系统中有一个依赖外部服务的接口，当外部服务不可用时，你可以通过Sentinel实现熔断降级：

```java
DegradeRule rule = new DegradeRule();
rule.setResource("externalService");
rule.setGrade(RuleConstant.DEGRADE_GRADE_EXCEPTION_COUNT);
rule.setCount(5); // 当异常数达到5时触发熔断
rule.setTimeWindow(10); // 熔断持续10秒
DegradeRuleManager.loadRules(Collections.singletonList(rule));
```

当外部服务异常数达到5次时，Sentinel会自动熔断该服务，并在10秒内拒绝所有请求。

---

## 总结

Sentinel是一个功能强大的流量控制组件，能够帮助开发者在分布式系统中实现流量控制、熔断降级和系统保护等功能。通过定义资源和规则，你可以轻松地保护系统的关键资源，确保系统在高并发或异常情况下仍能稳定运行。

---

## 附加资源与练习

- **官方文档**：访问 [Sentinel官方文档](https://sentinelguard.io/) 了解更多高级功能。
- **练习**：尝试在你的项目中集成Sentinel，并为一个接口设置流量控制规则。
- **扩展阅读**：学习如何在微服务架构中使用Sentinel实现全局流量控制。

:::tip
如果你在集成Sentinel时遇到问题，可以参考官方提供的示例代码，或者加入社区讨论获取帮助。
:::