---
title: Sentinel 核心概念
description: 了解Sentinel的核心概念，包括资源、规则、流量控制、熔断降级等，帮助初学者掌握Sentinel的基本原理和使用方法。
---

# Sentinel 核心概念

Sentinel是阿里巴巴开源的一款轻量级流量控制组件，主要用于实现微服务的流量控制、熔断降级和系统保护等功能。对于初学者来说，理解Sentinel的核心概念是掌握其使用的基础。本文将详细介绍Sentinel的核心概念，并通过代码示例和实际案例帮助你更好地理解。

## 1. 资源（Resource）

在Sentinel中，**资源**是流量控制的基本单位。资源可以是任何需要保护的逻辑单元，比如一个方法、一个接口、一个服务等。Sentinel通过定义资源来实现对它的流量控制。

```java
// 定义一个资源
try (Entry entry = SphU.entry("myResource")) {
    // 被保护的逻辑
    System.out.println("执行资源逻辑");
} catch (BlockException e) {
    // 处理被限流或降级的逻辑
    System.out.println("资源被限流或降级");
}
```

在上面的代码中，`myResource` 就是一个资源。Sentinel会监控这个资源的访问情况，并根据配置的规则进行流量控制。

## 2. 规则（Rule）

**规则**是Sentinel用来控制资源访问的具体策略。Sentinel支持多种规则类型，包括流量控制规则、熔断降级规则、系统保护规则等。

### 2.1 流量控制规则（FlowRule）

流量控制规则用于限制资源的访问速率。你可以通过设置QPS（每秒查询数）或线程数来控制资源的访问。

```java
// 定义一个流量控制规则
FlowRule rule = new FlowRule();
rule.setResource("myResource");
rule.setGrade(RuleConstant.FLOW_GRADE_QPS);
rule.setCount(10); // 设置QPS为10
FlowRuleManager.loadRules(Collections.singletonList(rule));
```

在这个例子中，`myResource` 的QPS被限制为10，即每秒最多允许10次访问。

### 2.2 熔断降级规则（DegradeRule）

熔断降级规则用于在资源出现异常时进行熔断或降级处理。你可以通过设置异常比例、异常数或响应时间来触发熔断。

```java
// 定义一个熔断降级规则
DegradeRule rule = new DegradeRule();
rule.setResource("myResource");
rule.setGrade(RuleConstant.DEGRADE_GRADE_EXCEPTION_COUNT);
rule.setCount(5); // 设置异常数为5
rule.setTimeWindow(10); // 设置熔断时间为10秒
DegradeRuleManager.loadRules(Collections.singletonList(rule));
```

在这个例子中，如果`myResource`在10秒内出现5次异常，Sentinel会触发熔断，并在接下来的10秒内拒绝所有请求。

## 3. 流量控制（Flow Control）

**流量控制**是Sentinel的核心功能之一，用于控制资源的访问速率。Sentinel支持多种流量控制策略，包括直接拒绝、排队等待、预热启动等。

:::tip
流量控制可以帮助你在高并发场景下保护系统，避免因流量过大而导致系统崩溃。
:::

## 4. 熔断降级（Circuit Breaking）

**熔断降级**是Sentinel的另一个核心功能，用于在资源出现异常时进行熔断或降级处理。熔断降级可以帮助你快速失败，避免因资源异常而导致整个系统不可用。

:::caution
熔断降级需要谨慎使用，过度熔断可能会导致系统功能缺失。
:::

## 5. 实际案例

假设你有一个电商系统，其中有一个商品查询接口`/product/{id}`。在高并发场景下，你希望对这个接口进行流量控制，避免因流量过大而导致系统崩溃。

```java
// 定义商品查询资源
try (Entry entry = SphU.entry("productQuery")) {
    // 查询商品逻辑
    Product product = productService.getProductById(id);
    return product;
} catch (BlockException e) {
    // 处理被限流或降级的逻辑
    return new Product("默认商品", 0.0);
}
```

在这个例子中，`productQuery` 是一个资源，你可以通过设置流量控制规则来限制它的访问速率。

## 6. 总结

Sentinel的核心概念包括资源、规则、流量控制和熔断降级。通过定义资源和规则，你可以实现对资源的流量控制和熔断降级，从而保护系统在高并发场景下的稳定性。

:::note
Sentinel还提供了丰富的监控和统计功能，帮助你实时了解系统的运行状态。
:::

## 7. 附加资源与练习

- **官方文档**: [Sentinel官方文档](https://sentinelguard.io/zh-cn/docs/introduction.html)
- **练习**: 尝试在你的项目中集成Sentinel，并为一个接口设置流量控制规则。

通过本文的学习，你应该已经掌握了Sentinel的核心概念。接下来，你可以继续深入学习Sentinel的高级功能，如热点参数限流、系统自适应保护等。