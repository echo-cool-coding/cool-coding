---
title: Redis 集合命令
description: 了解Redis集合数据类型及其常用命令，掌握如何操作集合数据并应用于实际场景。
---

# Redis 集合命令

Redis集合（Set）是一种无序且唯一的数据结构，适合存储不重复的元素。集合中的元素是无序的，这意味着你无法通过索引访问它们，但可以快速检查某个元素是否存在。集合常用于去重、交集、并集等操作。

在本节中，我们将详细介绍Redis集合的常用命令，并通过代码示例和实际案例帮助你理解其应用场景。

---

## 集合的基本操作

### 1. 添加元素到集合
使用 `SADD` 命令可以向集合中添加一个或多个元素。如果元素已经存在，则不会重复添加。

```bash
SADD myset "apple"
SADD myset "banana" "cherry"
```

**输出：**
```bash
(integer) 1  # 表示成功添加了1个新元素
(integer) 2  # 表示成功添加了2个新元素
```

### 2. 获取集合中的所有元素
使用 `SMEMBERS` 命令可以获取集合中的所有元素。

```bash
SMEMBERS myset
```

**输出：**
```bash
1) "apple"
2) "banana"
3) "cherry"
```

### 3. 检查元素是否存在
使用 `SISMEMBER` 命令可以检查某个元素是否存在于集合中。

```bash
SISMEMBER myset "apple"
```

**输出：**
```bash
(integer) 1  # 表示元素存在
```

### 4. 移除元素
使用 `SREM` 命令可以从集合中移除一个或多个元素。

```bash
SREM myset "banana"
```

**输出：**
```bash
(integer) 1  # 表示成功移除了1个元素
```

---

## 集合的高级操作

### 1. 获取集合的大小
使用 `SCARD` 命令可以获取集合中元素的数量。

```bash
SCARD myset
```

**输出：**
```bash
(integer) 2  # 表示集合中有2个元素
```

### 2. 随机获取元素
使用 `SRANDMEMBER` 命令可以从集合中随机获取一个或多个元素。

```bash
SRANDMEMBER myset
SRANDMEMBER myset 2  # 获取2个随机元素
```

**输出：**
```bash
"apple"  # 随机返回一个元素
1) "apple"
2) "cherry"  # 随机返回两个元素
```

### 3. 集合的交集、并集和差集
Redis提供了强大的集合运算命令：

- **交集（SINTER）**：返回多个集合的共同元素。
- **并集（SUNION）**：返回多个集合的所有元素（去重）。
- **差集（SDIFF）**：返回第一个集合中存在但其他集合中不存在的元素。

```bash
SADD set1 "apple" "banana" "cherry"
SADD set2 "banana" "cherry" "date"

SINTER set1 set2  # 交集
SUNION set1 set2  # 并集
SDIFF set1 set2   # 差集
```

**输出：**
```bash
1) "banana"
2) "cherry"  # 交集结果

1) "apple"
2) "banana"
3) "cherry"
4) "date"    # 并集结果

1) "apple"   # 差集结果
```

---

## 实际应用场景

### 1. 去重
集合非常适合用于存储唯一值。例如，存储用户的唯一ID或标签。

```bash
SADD user_ids "1001" "1002" "1003"
SADD user_ids "1001"  # 不会重复添加
```

### 2. 共同好友
假设你有两个用户的好友列表，可以使用交集操作找到他们的共同好友。

```bash
SADD user1_friends "Alice" "Bob" "Charlie"
SADD user2_friends "Bob" "Charlie" "David"

SINTER user1_friends user2_friends
```

**输出：**
```bash
1) "Bob"
2) "Charlie"
```

### 3. 随机抽奖
使用 `SRANDMEMBER` 命令可以轻松实现随机抽奖功能。

```bash
SADD participants "Alice" "Bob" "Charlie" "David"
SRANDMEMBER participants 2  # 随机抽取2名获奖者
```

---

## 总结

Redis集合是一种强大的数据结构，适用于存储唯一值并执行高效的集合运算。通过 `SADD`、`SMEMBERS`、`SINTER` 等命令，你可以轻松实现去重、共同好友、随机抽奖等功能。

:::tip 提示
- 集合中的元素是无序的，如果需要有序集合，可以使用Redis的有序集合（Sorted Set）。
- 集合操作的时间复杂度通常为O(1)或O(N)，具体取决于命令。
:::

---

## 附加资源与练习

### 练习
1. 创建一个集合 `fruits`，并添加 `"apple"`、`"banana"`、`"cherry"`。
2. 检查 `"banana"` 是否存在于集合中。
3. 移除 `"cherry"` 并获取集合的大小。
4. 创建另一个集合 `berries`，包含 `"strawberry"` 和 `"cherry"`，然后计算两个集合的并集。

### 进一步学习
- [Redis官方文档 - 集合](https://redis.io/docs/data-types/sets/)
- 尝试使用有序集合（Sorted Set）实现排行榜功能。