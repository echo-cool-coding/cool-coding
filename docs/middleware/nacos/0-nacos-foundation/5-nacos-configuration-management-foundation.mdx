---
title: Nacos 配置管理基础
description: 了解Nacos配置管理的基础知识，包括配置的创建、读取、更新和删除操作，以及如何在实际项目中使用Nacos进行配置管理。
---

## 介绍

Nacos（Naming and Configuration Service）是一个动态服务发现、配置管理和服务管理平台。它可以帮助开发者轻松管理微服务架构中的配置信息。配置管理是Nacos的核心功能之一，允许开发者将应用程序的配置集中管理，并在运行时动态更新配置，而无需重启应用。

在本教程中，我们将介绍Nacos配置管理的基础知识，包括如何创建、读取、更新和删除配置，以及如何在实际项目中使用Nacos进行配置管理。

## Nacos 配置管理的基本概念

在Nacos中，配置管理是通过“配置集”（Configuration Set）来实现的。每个配置集都有一个唯一的ID，称为“Data ID”。配置集可以包含多个配置项，每个配置项都是一个键值对。

### 配置集的组成

- **Data ID**：配置集的唯一标识符，通常由`group`和`namespace`组成。
- **Group**：配置集的分组，用于逻辑上区分不同的配置集。
- **Namespace**：配置集的命名空间，用于在多租户环境下隔离配置集。

## 创建配置

首先，我们需要在Nacos中创建一个配置集。假设我们要为一个Spring Boot应用程序创建一个数据库连接的配置。

1. 登录Nacos控制台。
2. 在左侧导航栏中选择“配置管理”。
3. 点击“+”按钮，创建一个新的配置集。
4. 填写以下信息：
   - **Data ID**: `spring-boot-demo`
   - **Group**: `DEFAULT_GROUP`
   - **配置格式**: `Properties`
   - **配置内容**:
     ```properties
     spring.datasource.url=jdbc:mysql://localhost:3306/demo
     spring.datasource.username=root
     spring.datasource.password=123456
     ```

5. 点击“发布”按钮，保存配置。

## 读取配置

在Spring Boot应用程序中，我们可以使用`@Value`注解或`@ConfigurationProperties`注解来读取Nacos中的配置。

### 使用`@Value`注解

```java
import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Component;

@Component
public class DatabaseConfig {

    @Value("${spring.datasource.url}")
    private String url;

    @Value("${spring.datasource.username}")
    private String username;

    @Value("${spring.datasource.password}")
    private String password;

    public void printConfig() {
        System.out.println("URL: " + url);
        System.out.println("Username: " + username);
        System.out.println("Password: " + password);
    }
}
```

### 使用`@ConfigurationProperties`注解

```java
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.stereotype.Component;

@Component
@ConfigurationProperties(prefix = "spring.datasource")
public class DatabaseConfig {

    private String url;
    private String username;
    private String password;

    // Getters and Setters

    public void printConfig() {
        System.out.println("URL: " + url);
        System.out.println("Username: " + username);
        System.out.println("Password: " + password);
    }
}
```

## 更新配置

Nacos允许我们在不重启应用程序的情况下动态更新配置。当配置发生变化时，Nacos会通知应用程序，应用程序会自动重新加载配置。

### 在Nacos控制台中更新配置

1. 登录Nacos控制台。
2. 找到之前创建的配置集`spring-boot-demo`。
3. 修改配置内容，例如将数据库密码改为`654321`。
4. 点击“发布”按钮，保存更改。

### 在Spring Boot中监听配置变化

Spring Cloud Nacos Config会自动监听配置的变化，并在配置更新时重新加载配置。我们可以在代码中使用`@RefreshScope`注解来实现配置的动态更新。

```java
import org.springframework.beans.factory.annotation.Value;
import org.springframework.cloud.context.config.annotation.RefreshScope;
import org.springframework.stereotype.Component;

@Component
@RefreshScope
public class DatabaseConfig {

    @Value("${spring.datasource.url}")
    private String url;

    @Value("${spring.datasource.username}")
    private String username;

    @Value("${spring.datasource.password}")
    private String password;

    public void printConfig() {
        System.out.println("URL: " + url);
        System.out.println("Username: " + username);
        System.out.println("Password: " + password);
    }
}
```

## 删除配置

如果不再需要某个配置集，可以在Nacos控制台中将其删除。

1. 登录Nacos控制台。
2. 找到要删除的配置集。
3. 点击“删除”按钮，确认删除操作。

## 实际应用场景

假设我们有一个微服务架构的电商系统，其中包含多个服务，如用户服务、订单服务和商品服务。每个服务都有自己的数据库连接配置。我们可以使用Nacos来集中管理这些配置，并在需要时动态更新。

### 示例：用户服务的数据库配置

1. 在Nacos中创建一个配置集，Data ID为`user-service`，Group为`DEFAULT_GROUP`，配置内容如下：
   ```properties
   spring.datasource.url=jdbc:mysql://localhost:3306/user
   spring.datasource.username=root
   spring.datasource.password=123456
   ```

2. 在用户服务的Spring Boot应用程序中，使用`@ConfigurationProperties`注解读取配置。

3. 当数据库密码需要更新时，只需在Nacos控制台中修改配置并发布，用户服务会自动重新加载新的配置，而无需重启服务。

## 总结

Nacos配置管理是微服务架构中非常重要的一部分，它可以帮助我们集中管理配置，并在运行时动态更新配置。通过本教程，我们学习了如何在Nacos中创建、读取、更新和删除配置，以及如何在Spring Boot应用程序中使用Nacos进行配置管理。

## 附加资源

- [Nacos官方文档](https://nacos.io/zh-cn/docs/what-is-nacos.html)
- [Spring Cloud Nacos Config文档](https://spring.io/projects/spring-cloud-alibaba)

## 练习

1. 在Nacos中创建一个新的配置集，Data ID为`order-service`，Group为`DEFAULT_GROUP`，配置内容为订单服务的数据库连接信息。
2. 在Spring Boot应用程序中读取并打印该配置。
3. 尝试在Nacos控制台中更新配置，并观察Spring Boot应用程序是否能够动态加载新的配置。