---
title: PHP 表单提交
description: 学习如何使用PHP处理表单提交，包括表单创建、数据接收、验证和处理的基本步骤。
---

# PHP 表单提交

在Web开发中，表单是用户与网站交互的重要方式之一。PHP是一种强大的服务器端脚本语言，广泛用于处理表单数据。本文将详细介绍如何使用PHP处理表单提交，包括表单的创建、数据的接收、验证和处理。

## 1. 表单的创建

首先，我们需要在HTML中创建一个表单。表单通常包含输入字段、选择框、按钮等元素。以下是一个简单的表单示例：

```html
<form action="process_form.php" method="post">
  <label for="name">姓名:</label>
  <input type="text" id="name" name="name" required><br /><br />

  <label for="email">邮箱:</label>
  <input type="email" id="email" name="email" required><br /><br />

  <label for="message">留言:</label>
  <textarea id="message" name="message" required></textarea><br /><br />

  <input type="submit" value="提交">
</form>
```

在这个表单中，`action`属性指定了表单提交后数据将被发送到的PHP文件（`process_form.php`），`method`属性指定了数据提交的方式（`post`）。

## 2. 接收表单数据

当用户提交表单后，数据将被发送到指定的PHP文件。在PHP中，我们可以使用`$_POST`超全局数组来接收表单数据。以下是如何在`process_form.php`中接收并处理表单数据的示例：

```php
<?php
if ($_SERVER["REQUEST_METHOD"] == "POST") {
  $name = $_POST['name'];
  $email = $_POST['email'];
  $message = $_POST['message'];

  echo "姓名: " . $name . "<br />";
  echo "邮箱: " . $email . "<br />";
  echo "留言: " . $message . "<br />";
}
?>
```

在这个示例中，我们首先检查请求方法是否为`POST`，然后从`$_POST`数组中获取表单数据，并将其输出到页面上。

## 3. 表单数据的验证

在实际应用中，表单数据的验证是非常重要的。我们可以使用PHP的内置函数或正则表达式来验证用户输入的数据。以下是一个简单的验证示例：

```php
<?php
if ($_SERVER["REQUEST_METHOD"] == "POST") {
  $name = trim($_POST['name']);
  $email = trim($_POST['email']);
  $message = trim($_POST['message']);

  $errors = [];

  if (empty($name)) {
    $errors[] = "姓名不能为空";
  }

  if (!filter_var($email, FILTER_VALIDATE_EMAIL)) {
    $errors[] = "邮箱格式不正确";
  }

  if (empty($message)) {
    $errors[] = "留言不能为空";
  }

  if (empty($errors)) {
    echo "姓名: " . $name . "<br />";
    echo "邮箱: " . $email . "<br />";
    echo "留言: " . $message . "<br />";
  } else {
    foreach ($errors as $error) {
      echo $error . "<br />";
    }
  }
}
?>
```

在这个示例中，我们首先使用`trim()`函数去除用户输入数据的前后空格，然后检查每个字段是否为空，并使用`filter_var()`函数验证邮箱格式。如果发现错误，将错误信息存储在`$errors`数组中，并在页面上显示。

## 4. 表单数据的处理

表单数据验证通过后，通常需要对其进行进一步处理，例如将数据存储到数据库中或发送电子邮件。以下是一个将表单数据存储到数据库的示例：

```php
<?php
if ($_SERVER["REQUEST_METHOD"] == "POST") {
  $name = trim($_POST['name']);
  $email = trim($_POST['email']);
  $message = trim($_POST['message']);

  $errors = [];

  if (empty($name)) {
    $errors[] = "姓名不能为空";
  }

  if (!filter_var($email, FILTER_VALIDATE_EMAIL)) {
    $errors[] = "邮箱格式不正确";
  }

  if (empty($message)) {
    $errors[] = "留言不能为空";
  }

  if (empty($errors)) {
    $servername = "localhost";
    $username = "root";
    $password = "";
    $dbname = "myDB";

    $conn = new mysqli($servername, $username, $password, $dbname);

    if ($conn->connect_error) {
      die("连接失败: " . $conn->connect_error);
    }

    $sql = "INSERT INTO messages (name, email, message) VALUES ('$name', '$email', '$message')";

    if ($conn->query($sql) === TRUE) {
      echo "留言已成功提交";
    } else {
      echo "错误: " . $sql . "<br>" . $conn->error;
    }

    $conn->close();
  } else {
    foreach ($errors as $error) {
      echo $error . "<br />";
    }
  }
}
?>
```

在这个示例中，我们首先验证表单数据，然后连接到MySQL数据库，并将数据插入到`messages`表中。

## 5. 实际应用场景

表单提交在实际应用中有很多场景，例如用户注册、登录、留言板、订单提交等。以下是一个用户注册表单的示例：

```html
<form action="register.php" method="post">
  <label for="username">用户名:</label>
  <input type="text" id="username" name="username" required><br /><br />

  <label for="password">密码:</label>
  <input type="password" id="password" name="password" required><br /><br />

  <label for="confirm_password">确认密码:</label>
  <input type="password" id="confirm_password" name="confirm_password" required><br /><br />

  <input type="submit" value="注册">
</form>
```

在`register.php`中，我们可以验证用户名是否已存在，并确保两次输入的密码一致，然后将用户信息存储到数据库中。

## 6. 总结

通过本文，我们学习了如何使用PHP处理表单提交，包括表单的创建、数据的接收、验证和处理。表单处理是Web开发中的基础技能，掌握这些知识将帮助你构建功能强大的Web应用程序。

## 7. 附加资源与练习

- **练习1**: 创建一个包含多个输入字段的表单，并编写PHP代码来处理和验证这些字段。
- **练习2**: 尝试将表单数据存储到数据库中，并在页面上显示成功或错误消息。
- **附加资源**: 阅读PHP官方文档中关于表单处理的部分，了解更多高级用法和最佳实践。

:::tip
在实际开发中，始终确保对用户输入的数据进行严格的验证和过滤，以防止安全漏洞，如SQL注入和XSS攻击。
:::