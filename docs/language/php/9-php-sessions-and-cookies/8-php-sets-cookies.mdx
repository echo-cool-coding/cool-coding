---
title: PHP 设置Cookie
description: 学习如何在PHP中设置Cookie，了解Cookie的基本概念、使用方法以及实际应用场景。
---

## 介绍

在Web开发中，Cookie是一种用于在客户端（通常是浏览器）存储少量数据的技术。这些数据可以在用户访问同一网站时被服务器读取和修改。Cookie通常用于存储用户的偏好设置、会话信息或其他需要在多个页面之间共享的数据。

在PHP中，设置Cookie非常简单。通过使用 `setcookie()` 函数，你可以轻松地在客户端创建、修改或删除Cookie。

## 基本语法

`setcookie()` 函数的基本语法如下：

```php
setcookie(name, value, expire, path, domain, secure, httponly);
```

- **name**: Cookie的名称。
- **value**: Cookie的值。
- **expire**: Cookie的过期时间（以Unix时间戳表示）。如果不设置，Cookie将在浏览器关闭时过期。
- **path**: Cookie在服务器上的有效路径。默认是当前目录。
- **domain**: Cookie的有效域名。默认是当前域名。
- **secure**: 如果设置为 `true`，Cookie只能通过HTTPS协议传输。
- **httponly**: 如果设置为 `true`，Cookie只能通过HTTP协议访问，JavaScript无法访问。

## 示例：设置一个简单的Cookie

以下是一个简单的示例，展示如何在PHP中设置一个名为 `username` 的Cookie，其值为 `JohnDoe`，并在1小时后过期。

```php
<?php
setcookie("username", "JohnDoe", time() + 3600, "/");
?>
```

在这个例子中，`time() + 3600` 表示当前时间加上3600秒（即1小时），`/` 表示Cookie在整个网站中有效。

## 读取Cookie

设置Cookie后，你可以通过 `$_COOKIE` 超全局数组来读取它。例如：

```php
<?php
if (isset($_COOKIE["username"])) {
    echo "Welcome back, " . $_COOKIE["username"] . "!";
} else {
    echo "Welcome, guest!";
}
?>
```

如果Cookie存在，输出将是 `Welcome back, JohnDoe!`，否则输出 `Welcome, guest!`。

## 修改和删除Cookie

要修改一个Cookie，只需再次调用 `setcookie()` 函数并设置新的值。要删除一个Cookie，可以将过期时间设置为过去的时间。

```php
<?php
// 修改Cookie
setcookie("username", "JaneDoe", time() + 3600, "/");

// 删除Cookie
setcookie("username", "", time() - 3600, "/");
?>
```

## 实际应用场景

### 1. 记住用户偏好

假设你有一个网站，允许用户选择主题（如“亮色”或“暗色”）。你可以使用Cookie来存储用户的选择，以便在用户下次访问时自动应用。

```php
<?php
if (isset($_POST["theme"])) {
    setcookie("theme", $_POST["theme"], time() + (86400 * 30), "/"); // 30天有效
    header("Location: " . $_SERVER["PHP_SELF"]); // 重定向以应用新主题
    exit();
}

$theme = isset($_COOKIE["theme"]) ? $_COOKIE["theme"] : "light";
?>
```

### 2. 购物车

在电子商务网站中，Cookie可以用于存储用户的购物车信息。这样即使用户关闭浏览器，购物车中的商品也不会丢失。

```php
<?php
if (isset($_POST["add_to_cart"])) {
    $cart = isset($_COOKIE["cart"]) ? json_decode($_COOKIE["cart"], true) : [];
    $cart[] = $_POST["product_id"];
    setcookie("cart", json_encode($cart), time() + (86400 * 30), "/");
}
?>
```

## 总结

通过本文，你学习了如何在PHP中设置、读取、修改和删除Cookie。Cookie是Web开发中非常重要的工具，能够帮助你在客户端存储和共享数据。掌握这些基本操作后，你可以将其应用于各种实际场景，如用户偏好设置、购物车管理等。

## 附加资源与练习

- **练习**: 创建一个简单的PHP脚本，允许用户选择并保存他们的语言偏好（如“中文”或“英文”），并在下次访问时自动应用。
- **资源**: 阅读PHP官方文档中关于 `setcookie()` 函数的更多信息：[PHP: setcookie - Manual](https://www.php.net/manual/en/function.setcookie.php)

:::tip
记住，Cookie存储在客户端，因此不应存储敏感信息。对于敏感数据，建议使用服务器端的会话管理。
:::