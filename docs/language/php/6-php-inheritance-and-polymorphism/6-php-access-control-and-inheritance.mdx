---
title: PHP 访问控制与继承
description: "了解PHP中的访问控制修饰符及其在继承中的作用，掌握如何通过继承实现代码复用和多态性。"
---

## 介绍

在PHP中，访问控制修饰符用于限制类成员的可见性。它们决定了哪些类成员（属性和方法）可以在类的内部、子类或外部访问。PHP提供了三种访问控制修饰符：`public`、`protected` 和 `private`。理解这些修饰符的作用对于编写可维护和安全的代码至关重要。

在继承中，访问控制修饰符的作用尤为重要。子类可以继承父类的属性和方法，但它们的可见性取决于父类中定义的访问控制修饰符。本文将详细介绍PHP中的访问控制修饰符及其在继承中的应用。

## 访问控制修饰符

### 1. `public`

`public` 是最宽松的访问控制修饰符。标记为 `public` 的属性和方法可以在类的内部、子类以及类的外部访问。

```php
class Animal {
    public $name;

    public function speak() {
        return "Animal sound!";
    }
}

$dog = new Animal();
$dog->name = "Buddy"; // 可以访问
echo $dog->speak(); // 输出: Animal sound!
```

### 2. `protected`

`protected` 修饰符限制了属性和方法的访问范围。标记为 `protected` 的属性和方法只能在类的内部和子类中访问，不能在类的外部直接访问。

```php
class Animal {
    protected $name;

    protected function speak() {
        return "Animal sound!";
    }
}

class Dog extends Animal {
    public function getName() {
        return $this->name; // 可以在子类中访问
    }

    public function makeSound() {
        return $this->speak(); // 可以在子类中访问
    }
}

$dog = new Dog();
echo $dog->getName(); // 输出: Buddy
echo $dog->makeSound(); // 输出: Animal sound!
```

:::caution
尝试在类的外部直接访问 `protected` 属性或方法会导致错误。
:::

### 3. `private`

`private` 是最严格的访问控制修饰符。标记为 `private` 的属性和方法只能在定义它们的类的内部访问，子类和类的外部都无法访问。

```php
class Animal {
    private $name;

    private function speak() {
        return "Animal sound!";
    }

    public function setName($name) {
        $this->name = $name; // 可以在类的内部访问
    }

    public function getName() {
        return $this->name; // 可以在类的内部访问
    }
}

$dog = new Animal();
$dog->setName("Buddy");
echo $dog->getName(); // 输出: Buddy
```

:::warning
尝试在子类或类的外部直接访问 `private` 属性或方法会导致错误。
:::

## 继承中的访问控制

在继承中，子类可以继承父类的 `public` 和 `protected` 属性和方法，但不能继承 `private` 属性和方法。子类可以覆盖父类的 `public` 和 `protected` 方法，但不能覆盖 `private` 方法。

```php
class Animal {
    public $publicProp = "Public Property";
    protected $protectedProp = "Protected Property";
    private $privateProp = "Private Property";

    public function publicMethod() {
        return "Public Method";
    }

    protected function protectedMethod() {
        return "Protected Method";
    }

    private function privateMethod() {
        return "Private Method";
    }
}

class Dog extends Animal {
    public function accessProtected() {
        return $this->protectedProp; // 可以访问父类的 protected 属性
    }

    public function callProtectedMethod() {
        return $this->protectedMethod(); // 可以调用父类的 protected 方法
    }
}

$dog = new Dog();
echo $dog->publicProp; // 输出: Public Property
echo $dog->accessProtected(); // 输出: Protected Property
echo $dog->callProtectedMethod(); // 输出: Protected Method
```

:::note
子类无法访问父类的 `private` 属性和方法，即使它们被继承。
:::

## 实际应用场景

假设我们正在开发一个简单的电子商务系统，其中包含不同类型的用户（如普通用户和管理员）。我们可以使用继承和访问控制来实现用户权限管理。

```php
class User {
    protected $username;

    public function __construct($username) {
        $this->username = $username;
    }

    public function getUsername() {
        return $this->username;
    }

    protected function canEdit() {
        return false;
    }
}

class Admin extends User {
    public function canEdit() {
        return true;
    }
}

$user = new User("john_doe");
$admin = new Admin("admin");

echo $user->getUsername(); // 输出: john_doe
echo $admin->getUsername(); // 输出: admin

echo $user->canEdit(); // 错误: 无法访问 protected 方法
echo $admin->canEdit(); // 输出: 1 (true)
```

在这个例子中，`User` 类定义了一个 `protected` 方法 `canEdit()`，默认返回 `false`。`Admin` 类继承 `User` 类并覆盖了 `canEdit()` 方法，返回 `true`。这样，我们可以通过继承和访问控制来实现不同用户角色的权限管理。

## 总结

PHP中的访问控制修饰符（`public`、`protected` 和 `private`）决定了类成员的可见性。在继承中，子类可以继承父类的 `public` 和 `protected` 属性和方法，但不能继承 `private` 属性和方法。理解这些修饰符的作用对于编写可维护和安全的代码至关重要。

通过合理使用访问控制修饰符，我们可以实现代码的封装、复用和多态性，从而提高代码的可读性和可维护性。

## 附加资源与练习

- **练习**: 创建一个 `Vehicle` 类，包含 `public`、`protected` 和 `private` 属性和方法。然后创建一个 `Car` 类继承 `Vehicle` 类，并尝试访问和覆盖这些属性和方法。
- **进一步阅读**: [PHP官方文档 - 访问控制](https://www.php.net/manual/en/language.oop5.visibility.php)

:::tip
尝试在实际项目中应用访问控制修饰符，观察它们如何帮助你更好地组织和管理代码。
:::