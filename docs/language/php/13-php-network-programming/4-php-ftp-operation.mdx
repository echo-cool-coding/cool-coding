---
title: PHP FTP 操作
description: 学习如何使用 PHP 进行 FTP 操作，包括连接、上传、下载和管理远程文件。本文适合初学者，包含代码示例和实际应用场景。
---

# PHP FTP 操作

FTP（文件传输协议）是一种用于在网络上传输文件的标准协议。通过 PHP，我们可以轻松地与远程 FTP 服务器进行交互，执行文件上传、下载、删除等操作。本文将逐步介绍如何使用 PHP 进行 FTP 操作，并提供实际案例帮助您理解其应用场景。

## 1. 连接到 FTP 服务器

在 PHP 中，我们使用 `ftp_connect()` 函数来连接到 FTP 服务器。连接成功后，可以使用 `ftp_login()` 函数进行身份验证。

```php
<?php
// 连接到 FTP 服务器
$ftp_server = "ftp.example.com";
$ftp_conn = ftp_connect($ftp_server) or die("无法连接到 $ftp_server");

// 登录到 FTP 服务器
$ftp_username = "username";
$ftp_password = "password";
$login = ftp_login($ftp_conn, $ftp_username, $ftp_password);

if ($login) {
    echo "成功连接到 FTP 服务器";
} else {
    echo "登录失败";
}

// 关闭连接
ftp_close($ftp_conn);
?>
```

:::note
确保 FTP 服务器的地址、用户名和密码正确无误。如果连接失败，请检查网络连接或服务器配置。
:::

## 2. 上传文件到 FTP 服务器

使用 `ftp_put()` 函数可以将本地文件上传到 FTP 服务器。

```php
<?php
// 连接到 FTP 服务器
$ftp_server = "ftp.example.com";
$ftp_conn = ftp_connect($ftp_server) or die("无法连接到 $ftp_server");
$ftp_username = "username";
$ftp_password = "password";
ftp_login($ftp_conn, $ftp_username, $ftp_password);

// 上传文件
$local_file = "local_file.txt";
$remote_file = "remote_file.txt";

if (ftp_put($ftp_conn, $remote_file, $local_file, FTP_ASCII)) {
    echo "文件上传成功";
} else {
    echo "文件上传失败";
}

// 关闭连接
ftp_close($ftp_conn);
?>
```

:::tip
`ftp_put()` 函数的第四个参数指定了传输模式。`FTP_ASCII` 用于文本文件，`FTP_BINARY` 用于二进制文件（如图片、视频等）。
:::

## 3. 从 FTP 服务器下载文件

使用 `ftp_get()` 函数可以从 FTP 服务器下载文件到本地。

```php
<?php
// 连接到 FTP 服务器
$ftp_server = "ftp.example.com";
$ftp_conn = ftp_connect($ftp_server) or die("无法连接到 $ftp_server");
$ftp_username = "username";
$ftp_password = "password";
ftp_login($ftp_conn, $ftp_username, $ftp_password);

// 下载文件
$local_file = "local_file.txt";
$remote_file = "remote_file.txt";

if (ftp_get($ftp_conn, $local_file, $remote_file, FTP_ASCII)) {
    echo "文件下载成功";
} else {
    echo "文件下载失败";
}

// 关闭连接
ftp_close($ftp_conn);
?>
```

## 4. 列出 FTP 服务器上的文件

使用 `ftp_nlist()` 函数可以列出 FTP 服务器上指定目录中的文件。

```php
<?php
// 连接到 FTP 服务器
$ftp_server = "ftp.example.com";
$ftp_conn = ftp_connect($ftp_server) or die("无法连接到 $ftp_server");
$ftp_username = "username";
$ftp_password = "password";
ftp_login($ftp_conn, $ftp_username, $ftp_password);

// 列出文件
$directory = "/";
$files = ftp_nlist($ftp_conn, $directory);

echo "目录 $directory 中的文件：<br />";
foreach ($files as $file) {
    echo $file . "<br />";
}

// 关闭连接
ftp_close($ftp_conn);
?>
```

## 5. 删除 FTP 服务器上的文件

使用 `ftp_delete()` 函数可以删除 FTP 服务器上的文件。

```php
<?php
// 连接到 FTP 服务器
$ftp_server = "ftp.example.com";
$ftp_conn = ftp_connect($ftp_server) or die("无法连接到 $ftp_server");
$ftp_username = "username";
$ftp_password = "password";
ftp_login($ftp_conn, $ftp_username, $ftp_password);

// 删除文件
$remote_file = "remote_file.txt";

if (ftp_delete($ftp_conn, $remote_file)) {
    echo "文件删除成功";
} else {
    echo "文件删除失败";
}

// 关闭连接
ftp_close($ftp_conn);
?>
```

## 6. 实际应用场景

假设您正在开发一个网站，需要定期从 FTP 服务器下载日志文件进行分析。您可以使用 PHP 编写一个脚本，自动连接到 FTP 服务器，下载日志文件，并将其保存到本地目录中。

```php
<?php
// 连接到 FTP 服务器
$ftp_server = "ftp.example.com";
$ftp_conn = ftp_connect($ftp_server) or die("无法连接到 $ftp_server");
$ftp_username = "username";
$ftp_password = "password";
ftp_login($ftp_conn, $ftp_username, $ftp_password);

// 下载日志文件
$local_file = "logs/logfile.txt";
$remote_file = "remote_logs/logfile.txt";

if (ftp_get($ftp_conn, $local_file, $remote_file, FTP_ASCII)) {
    echo "日志文件下载成功";
} else {
    echo "日志文件下载失败";
}

// 关闭连接
ftp_close($ftp_conn);
?>
```

## 7. 总结

通过本文，您已经学习了如何使用 PHP 进行 FTP 操作，包括连接服务器、上传和下载文件、列出文件以及删除文件。这些操作在开发中非常实用，尤其是在需要与远程服务器进行文件交互时。

## 8. 附加资源与练习

- **练习 1**：编写一个 PHP 脚本，将本地目录中的所有文件上传到 FTP 服务器的指定目录中。
- **练习 2**：编写一个 PHP 脚本，定期从 FTP 服务器下载文件，并将其保存到本地备份目录中。

:::caution
在实际应用中，请确保 FTP 服务器的安全性，避免使用明文密码，并考虑使用 SFTP 或 FTPS 等更安全的协议。
:::

希望本文对您的 PHP 网络编程学习有所帮助！继续探索更多 PHP 的强大功能吧！