---
title: PHP HTML字符串处理
description: 学习如何在PHP中处理和操作HTML字符串，包括转义、解析和生成HTML内容。
---

## 介绍

在Web开发中，PHP经常用于生成和处理HTML内容。HTML字符串处理是PHP开发中的一个重要部分，它涉及到如何安全地生成、解析和操作HTML代码。本文将介绍PHP中处理HTML字符串的基本概念和常用函数，并通过实际案例帮助你理解这些概念。

## HTML字符串的基本操作

### 1. 转义HTML字符

在PHP中，`htmlspecialchars()` 函数用于将特殊字符转换为HTML实体。这可以防止XSS（跨站脚本攻击）攻击，确保用户输入的内容在页面上安全显示。

```php
<?php
$input = '<script>alert("XSS Attack!");</script>';
$output = htmlspecialchars($input, ENT_QUOTES, 'UTF-8');
echo $output;
?>
```

**输入：**
```html
<script>alert("XSS Attack!");</script>
```

**输出：**
```html
&lt;script&gt;alert(&quot;XSS Attack!&quot;);&lt;/script&gt;
```

:::tip
使用 `htmlspecialchars()` 时，建议始终指定字符编码（如 `UTF-8`），以确保正确处理所有字符。
:::

### 2. 去除HTML标签

有时我们需要从字符串中去除所有HTML标签，只保留纯文本。可以使用 `strip_tags()` 函数来实现这一点。

```php
<?php
$input = '<p>Hello, <b>world</b>!</p>';
$output = strip_tags($input);
echo $output;
?>
```

**输入：**
```html
<p>Hello, <b>world</b>!</p>
```

**输出：**
```
Hello, world!
```

:::caution
`strip_tags()` 函数不会处理HTML实体（如 `&amp;`），如果需要处理实体，可以结合 `html_entity_decode()` 使用。
:::

### 3. 生成HTML内容

PHP允许我们动态生成HTML内容。例如，我们可以使用字符串拼接或 `heredoc` 语法来生成复杂的HTML结构。

```php
<?php
$title = "My Page";
$content = "Welcome to my website!";

$html = <<<HTML
<!DOCTYPE html>
<html>
<head>
    <title>$title</title>
</head>
<body>
    <h1>$content</h1>
</body>
</html>
HTML;

echo $html;
?>
```

**输出：**
```html
<!DOCTYPE html>
<html>
<head>
    <title>My Page</title>
</head>
<body>
    <h1>Welcome to my website!</h1>
</body>
</html>
```

:::note
`heredoc` 语法非常适合生成多行HTML内容，因为它允许你在字符串中直接嵌入变量。
:::

## 实际案例：表单处理

假设我们有一个简单的HTML表单，用户可以在其中输入评论。我们需要确保用户输入的内容在显示时是安全的。

```php
<?php
if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    $comment = $_POST['comment'];
    $safeComment = htmlspecialchars($comment, ENT_QUOTES, 'UTF-8');
    echo "<p>Your comment: $safeComment</p>";
}
?>

<form method="post">
    <textarea name="comment"></textarea><br />
    <input type="submit" value="Submit" />
</form>
```

**输入：**
```html
<script>alert("XSS Attack!");</script>
```

**输出：**
```html
<p>Your comment: &lt;script&gt;alert(&quot;XSS Attack!&quot;);&lt;/script&gt;</p>
```

:::warning
在处理用户输入时，始终使用 `htmlspecialchars()` 或其他安全函数来防止XSS攻击。
:::

## 总结

在PHP中处理HTML字符串是Web开发中的一项基本技能。通过使用 `htmlspecialchars()`、`strip_tags()` 等函数，我们可以确保生成的HTML内容既安全又符合预期。动态生成HTML内容时，`heredoc` 语法是一个非常有用的工具。

## 附加资源与练习

- **练习1**：创建一个PHP脚本，允许用户输入一段HTML代码，并安全地显示在页面上。
- **练习2**：使用 `strip_tags()` 函数去除用户输入中的所有HTML标签，并保留纯文本。
- **进一步阅读**：PHP官方文档中的 [字符串处理](https://www.php.net/manual/en/book.strings.php) 和 [HTML处理](https://www.php.net/manual/en/book.html.php) 部分。

通过不断练习和探索，你将能够熟练掌握PHP中的HTML字符串处理技巧。