---
title: PHP 联合类型
description: 了解PHP中的联合类型，这是一种允许变量、参数或返回值接受多种类型的特性。本文将通过示例和实际应用场景帮助初学者掌握这一现代PHP特性。
---

## 介绍

在PHP 8.0中，引入了**联合类型**（Union Types）这一强大的特性。联合类型允许你声明一个变量、函数参数或返回值可以接受多种类型。这一特性使得代码更加灵活，同时也能更好地表达开发者的意图。

在之前的PHP版本中，如果你想接受多种类型的参数，通常需要通过类型检查或文档注释来实现。联合类型的引入简化了这一过程，并提供了更严格的类型检查。

## 什么是联合类型？

联合类型允许你指定一个变量、参数或返回值可以是多种类型中的一种。例如，你可以声明一个参数可以是 `int` 或 `string` 类型。

### 语法

联合类型的语法非常简单，使用竖线 `|` 将多个类型分隔开。例如：

```php
function processValue(int|string $value): void {
    // 函数体
}
```

在这个例子中，`$value` 参数可以是 `int` 或 `string` 类型。

## 代码示例

让我们通过一个简单的例子来理解联合类型的使用。

```php
function printValue(int|string $value): void {
    echo $value . PHP_EOL;
}

printValue(42);      // 输出: 42
printValue("Hello"); // 输出: Hello
```

在这个例子中，`printValue` 函数接受一个 `int` 或 `string` 类型的参数，并将其打印出来。

### 输入和输出

- 输入: `42`（整数）
- 输出: `42`

- 输入: `"Hello"`（字符串）
- 输出: `Hello`

## 逐步讲解

### 1. 声明联合类型

在函数或方法的参数列表中，你可以使用 `|` 符号来声明联合类型。例如：

```php
function processValue(int|string $value): void {
    // 函数体
}
```

### 2. 使用联合类型

在函数体内部，你可以根据传入的类型执行不同的操作。例如：

```php
function processValue(int|string $value): void {
    if (is_int($value)) {
        echo "整数: " . $value;
    } else {
        echo "字符串: " . $value;
    }
}
```

### 3. 返回值联合类型

联合类型不仅可以用在参数上，还可以用在返回值上。例如：

```php
function getValue(bool $flag): int|string {
    return $flag ? 42 : "Hello";
}
```

在这个例子中，`getValue` 函数根据 `$flag` 的值返回 `int` 或 `string` 类型。

## 实际案例

### 案例1：处理多种类型的输入

假设你正在开发一个API，需要处理来自不同来源的输入数据。这些数据可能是整数、字符串或数组。你可以使用联合类型来处理这种情况：

```php
function processInput(int|string|array $input): void {
    if (is_int($input)) {
        echo "处理整数: " . $input;
    } elseif (is_string($input)) {
        echo "处理字符串: " . $input;
    } else {
        echo "处理数组: " . implode(", ", $input);
    }
}

processInput(42);               // 输出: 处理整数: 42
processInput("Hello");         // 输出: 处理字符串: Hello
processInput([1, 2, 3]);       // 输出: 处理数组: 1, 2, 3
```

### 案例2：灵活的返回值

在某些情况下，函数可能需要根据不同的条件返回不同类型的值。例如，一个函数可能返回一个整数或一个错误消息：

```php
function divide(int $a, int $b): int|string {
    if ($b === 0) {
        return "除数不能为零";
    }
    return $a / $b;
}

echo divide(10, 2);  // 输出: 5
echo divide(10, 0);  // 输出: 除数不能为零
```

## 总结

联合类型是PHP 8.0引入的一个强大特性，它允许你声明变量、参数或返回值可以接受多种类型。通过使用联合类型，你可以编写更加灵活和表达性更强的代码。

在实际开发中，联合类型可以帮助你处理多种类型的输入数据，或者根据不同的条件返回不同类型的值。这一特性不仅提高了代码的可读性，还增强了类型安全性。

## 附加资源

- [PHP官方文档：联合类型](https://www.php.net/manual/en/language.types.declarations.php#language.types.declarations.union)
- [PHP 8.0新特性](https://www.php.net/releases/8.0/en.php)

## 练习

1. 编写一个函数 `calculateArea`，接受 `int|float` 类型的参数 `$radius`，并返回圆的面积（使用公式 `π * r²`）。
2. 修改 `calculateArea` 函数，使其可以接受 `int|float|string` 类型的参数，并在参数为字符串时尝试将其转换为数字。

通过完成这些练习，你将更好地理解联合类型的使用场景和优势。