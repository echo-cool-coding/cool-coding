---
title: PHP 属性(Attributes)
description: 了解PHP中的属性(Attributes)，这是一种现代PHP特性，用于为类、方法、属性等添加元数据。本文将从基础概念到实际应用逐步讲解。
---

# PHP 属性(Attributes)

PHP属性（Attributes）是PHP 8.0引入的一项新特性，允许开发者为类、方法、属性等添加元数据。这些元数据可以在运行时通过反射API读取，从而实现更灵活和强大的代码结构。

## 什么是属性(Attributes)?

属性是一种声明式语法，用于为代码元素（如类、方法、属性等）附加元数据。它们类似于注释，但具有更强的类型检查和运行时访问能力。属性可以用于各种场景，例如路由定义、依赖注入、验证规则等。

### 基本语法

属性的基本语法如下：

```php
#[AttributeName]
class MyClass {
    #[AttributeName]
    public function myMethod() {}
}
```

在上面的例子中，`AttributeName` 是一个自定义的属性类。属性类本身也是一个普通的PHP类，但需要使用 `#[Attribute]` 标记。

### 定义属性类

要定义一个属性类，只需创建一个普通的PHP类，并使用 `#[Attribute]` 标记它：

```php
#[Attribute]
class MyAttribute {
    public function __construct(public string $name) {}
}
```

### 使用属性

定义好属性类后，可以在其他类、方法或属性上使用它：

```php
#[MyAttribute(name: "ExampleClass")]
class ExampleClass {
    #[MyAttribute(name: "exampleMethod")]
    public function exampleMethod() {}
}
```

### 读取属性

通过反射API，可以在运行时读取属性：

```php
$reflectionClass = new ReflectionClass(ExampleClass::class);
$attributes = $reflectionClass->getAttributes();

foreach ($attributes as $attribute) {
    $instance = $attribute->newInstance();
    echo $instance->name; // 输出: ExampleClass
}
```

## 实际应用场景

### 路由定义

属性可以用于定义路由规则。例如，我们可以创建一个 `Route` 属性类，用于标记控制器方法：

```php
#[Attribute]
class Route {
    public function __construct(public string $path, public string $method) {}
}

class UserController {
    #[Route(path: "/users", method: "GET")]
    public function listUsers() {
        // 处理获取用户列表的逻辑
    }
}
```

### 依赖注入

属性还可以用于依赖注入。例如，我们可以创建一个 `Inject` 属性类，用于标记需要注入的服务：

```php
#[Attribute]
class Inject {
    public function __construct(public string $service) {}
}

class UserService {
    // 业务逻辑
}

class UserController {
    #[Inject(service: UserService::class)]
    private UserService $userService;

    public function __construct() {
        // 通过反射自动注入 UserService
    }
}
```

## 总结

PHP属性(Attributes)为开发者提供了一种强大的方式来为代码元素附加元数据。通过属性，可以实现更灵活和可维护的代码结构。无论是路由定义、依赖注入还是验证规则，属性都能发挥重要作用。

## 附加资源与练习

- **官方文档**: [PHP Attributes](https://www.php.net/manual/en/language.attributes.php)
- **练习**: 尝试创建一个自定义属性类，并在你的项目中使用它来标记某些方法或类，然后通过反射API读取这些属性。

:::tip
属性是PHP 8.0引入的新特性，确保你的PHP版本至少为8.0以使用此功能。
:::