---
title: PHP 目录操作
description: 学习如何在PHP中操作目录，包括创建、读取、删除目录以及遍历目录内容。本文适合初学者，包含代码示例和实际应用场景。
---

## 介绍

在PHP中，目录操作是文件系统操作的重要组成部分。无论是创建新目录、读取目录内容，还是删除目录，这些操作都是开发者在处理文件系统时经常需要执行的任务。本文将详细介绍PHP中的目录操作，并通过代码示例帮助您理解这些概念。

## 创建目录

在PHP中，可以使用 `mkdir()` 函数来创建一个新目录。该函数的基本语法如下：

```php
bool mkdir ( string $pathname [, int $mode = 0777 [, bool $recursive = false [, resource $context ]]] )
```

- `$pathname`：要创建的目录路径。
- `$mode`：目录的权限，默认是 `0777`。
- `$recursive`：如果设置为 `true`，则会递归创建目录。

### 示例

```php
<?php
$dir = "example_dir";

if (!file_exists($dir)) {
    if (mkdir($dir, 0777, true)) {
        echo "目录 '$dir' 创建成功。";
    } else {
        echo "目录 '$dir' 创建失败。";
    }
} else {
    echo "目录 '$dir' 已经存在。";
}
?>
```

**输出：**

```
目录 'example_dir' 创建成功。
```

:::note
如果目录已经存在，`mkdir()` 函数会返回 `false`，并且不会覆盖现有目录。
:::

## 读取目录内容

要读取目录中的内容，可以使用 `scandir()` 函数。该函数返回一个包含指定目录中所有文件和目录的数组。

### 示例

```php
<?php
$dir = "example_dir";

if (is_dir($dir)) {
    $files = scandir($dir);
    foreach ($files as $file) {
        echo $file . "<br />";
    }
} else {
    echo "'$dir' 不是一个有效的目录。";
}
?>
```

**输出：**

```
.
..
file1.txt
file2.txt
```

:::tip
`scandir()` 返回的数组中包含 `.` 和 `..`，分别表示当前目录和上级目录。
:::

## 删除目录

要删除一个目录，可以使用 `rmdir()` 函数。该函数只能删除空目录。如果目录不为空，则需要先删除目录中的所有文件和子目录。

### 示例

```php
<?php
$dir = "example_dir";

if (is_dir($dir)) {
    if (rmdir($dir)) {
        echo "目录 '$dir' 删除成功。";
    } else {
        echo "目录 '$dir' 删除失败。";
    }
} else {
    echo "'$dir' 不是一个有效的目录。";
}
?>
```

**输出：**

```
目录 'example_dir' 删除成功。
```

:::caution
`rmdir()` 只能删除空目录。如果目录中包含文件或其他目录，删除操作将失败。
:::

## 遍历目录

有时我们需要递归遍历目录中的所有文件和子目录。可以使用 `RecursiveDirectoryIterator` 和 `RecursiveIteratorIterator` 类来实现这一功能。

### 示例

```php
<?php
$dir = "example_dir";

if (is_dir($dir)) {
    $iterator = new RecursiveIteratorIterator(
        new RecursiveDirectoryIterator($dir, RecursiveDirectoryIterator::SKIP_DOTS),
        RecursiveIteratorIterator::SELF_FIRST
    );

    foreach ($iterator as $file) {
        echo $file . "<br />";
    }
} else {
    echo "'$dir' 不是一个有效的目录。";
}
?>
```

**输出：**

```
example_dir/file1.txt
example_dir/file2.txt
example_dir/subdir/file3.txt
```

:::warning
递归遍历目录时，确保目录结构不会过深，以免导致性能问题。
:::

## 实际应用场景

### 场景：批量处理目录中的文件

假设您需要批量处理一个目录中的所有图片文件，例如将它们转换为缩略图。您可以使用目录操作来遍历目录中的所有文件，并对符合条件的文件进行处理。

```php
<?php
$dir = "images";

if (is_dir($dir)) {
    $files = scandir($dir);
    foreach ($files as $file) {
        if (in_array(pathinfo($file, PATHINFO_EXTENSION), ['jpg', 'png', 'gif'])) {
            // 处理图片文件
            echo "处理文件: $file<br />";
        }
    }
} else {
    echo "'$dir' 不是一个有效的目录。";
}
?>
```

**输出：**

```
处理文件: image1.jpg
处理文件: image2.png
处理文件: image3.gif
```

## 总结

在本文中，我们学习了如何在PHP中进行目录操作，包括创建、读取、删除目录以及遍历目录内容。这些操作是处理文件系统时的基础，掌握它们将帮助您更好地管理和操作文件系统中的目录。

## 附加资源与练习

- **练习1**：编写一个PHP脚本，创建一个包含多个子目录的目录结构，并在每个子目录中创建一些文件。
- **练习2**：编写一个PHP脚本，递归删除一个目录及其所有内容。

:::tip
建议您在实际项目中尝试使用这些目录操作函数，以加深对它们的理解。
:::