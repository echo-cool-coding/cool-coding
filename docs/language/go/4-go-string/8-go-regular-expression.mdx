---
title: Go 正则表达式
description: 学习如何在Go中使用正则表达式来处理和匹配字符串。本文将从基础概念开始，逐步讲解正则表达式的语法、使用方法以及实际应用场景。
---

正则表达式（Regular Expression，简称Regex）是一种强大的工具，用于匹配、查找和操作字符串。在Go语言中，正则表达式通过`regexp`包来实现。本文将带你从零开始学习如何在Go中使用正则表达式。

## 什么是正则表达式？

正则表达式是一种用于描述字符串模式的语法。通过这种语法，你可以定义一种规则，用来匹配符合特定模式的字符串。例如，你可以使用正则表达式来验证电子邮件地址、提取URL、或者查找特定格式的日期。

## Go 中的正则表达式

在Go中，正则表达式通过`regexp`包来实现。该包提供了编译、匹配和操作正则表达式的功能。以下是`regexp`包中一些常用的函数和方法：

- `regexp.Compile(expr string) (*Regexp, error)`：编译正则表达式，返回一个`Regexp`对象。
- `regexp.MustCompile(expr string) *Regexp`：与`Compile`类似，但如果表达式无效，会引发panic。
- `Regexp.MatchString(s string) bool`：检查字符串`s`是否与正则表达式匹配。
- `Regexp.FindString(s string) string`：返回字符串`s`中第一个与正则表达式匹配的子串。
- `Regexp.FindAllString(s string, n int) []string`：返回字符串`s`中所有与正则表达式匹配的子串，最多返回`n`个。

## 基本用法

### 编译正则表达式

在使用正则表达式之前，首先需要将其编译为一个`Regexp`对象。你可以使用`regexp.Compile`或`regexp.MustCompile`来完成这一步骤。

```go
package main

import (
    "fmt"
    "regexp"
)

func main() {
    re, err := regexp.Compile(`\d+`)
    if err != nil {
        fmt.Println("编译正则表达式失败:", err)
        return
    }
    fmt.Println(re.MatchString("123abc")) // 输出: true
}
```

在上面的例子中，我们编译了一个匹配数字的正则表达式`\d+`，并检查字符串`"123abc"`是否包含数字。

### 匹配字符串

使用`MatchString`方法可以检查字符串是否与正则表达式匹配。

```go
package main

import (
    "fmt"
    "regexp"
)

func main() {
    re := regexp.MustCompile(`\d+`)
    fmt.Println(re.MatchString("abc")) // 输出: false
    fmt.Println(re.MatchString("123")) // 输出: true
}
```

### 查找匹配的子串

使用`FindString`方法可以找到字符串中第一个与正则表达式匹配的子串。

```go
package main

import (
    "fmt"
    "regexp"
)

func main() {
    re := regexp.MustCompile(`\d+`)
    fmt.Println(re.FindString("abc123def456")) // 输出: 123
}
```

### 查找所有匹配的子串

使用`FindAllString`方法可以找到字符串中所有与正则表达式匹配的子串。

```go
package main

import (
    "fmt"
    "regexp"
)

func main() {
    re := regexp.MustCompile(`\d+`)
    fmt.Println(re.FindAllString("abc123def456", -1)) // 输出: [123 456]
}
```

## 实际应用场景

### 验证电子邮件地址

正则表达式常用于验证用户输入的格式是否正确。例如，验证电子邮件地址是否合法。

```go
package main

import (
    "fmt"
    "regexp"
)

func main() {
    emailRegex := regexp.MustCompile(`^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$`)
    fmt.Println(emailRegex.MatchString("example@example.com")) // 输出: true
    fmt.Println(emailRegex.MatchString("invalid-email"))       // 输出: false
}
```

### 提取URL

你可以使用正则表达式从文本中提取URL。

```go
package main

import (
    "fmt"
    "regexp"
)

func main() {
    urlRegex := regexp.MustCompile(`https?://[^\s]+`)
    text := "Visit https://example.com for more information."
    fmt.Println(urlRegex.FindString(text)) // 输出: https://example.com
}
```

## 总结

正则表达式是处理字符串的强大工具，Go语言通过`regexp`包提供了对正则表达式的支持。本文介绍了如何编译正则表达式、匹配字符串、查找子串以及在实际应用中使用正则表达式。

:::tip
正则表达式的语法非常丰富，建议你进一步学习正则表达式的元字符、量词、分组等高级特性，以便更灵活地处理字符串。
:::

## 附加资源

- [Go官方文档 - regexp包](https://pkg.go.dev/regexp)
- [正则表达式教程](https://www.regular-expressions.info/)
- [Go by Example: Regular Expressions](https://gobyexample.com/regular-expressions)

## 练习

1. 编写一个正则表达式，匹配所有以`.go`结尾的文件名。
2. 使用正则表达式从一段文本中提取所有的日期（格式为`YYYY-MM-DD`）。
3. 编写一个正则表达式，验证手机号码是否合法（假设手机号码为11位数字）。

通过练习，你将更好地掌握Go中的正则表达式使用技巧。