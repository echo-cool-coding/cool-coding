---
title: C++ 字符串修改
description: 本文介绍C++中字符串修改的方法，包括插入、删除、替换和追加等操作，适合C++初学者阅读。
---

# C++ 字符串修改

在C++编程中，字符串是最常用的数据类型之一。无论是处理用户输入、文件操作还是网络通信，我们都需要对字符串进行各种修改操作。本文将详细介绍C++中字符串修改的各种方法和技巧。

## 字符串修改概述

C++提供了两种主要的字符串类型：C风格字符串(字符数组)和C++的`std::string`类。虽然两者都可以用来表示字符串，但`std::string`类提供了更丰富的操作方法，使字符串修改变得更加简单和安全。

:::tip
本文主要介绍`std::string`的修改方法，因为它是C++中推荐使用的字符串类型。
:::

## 基本字符串修改操作

### 1. 赋值操作

最基本的字符串修改方法是直接赋值。

```cpp
#include <iostream>
#include <string>

int main() {
    std::string str = "Hello";
    std::cout << "原始字符串: " << str << std::endl;
    
    // 使用赋值运算符修改字符串
    str = "Hello World";
    std::cout << "修改后字符串: " << str << std::endl;
    
    return 0;
}
```

输出：
```
原始字符串: Hello
修改后字符串: Hello World
```

### 2. 连接/追加字符串

`string`类提供了多种方式来连接或追加字符串：

#### 使用 `+` 和 `+=` 运算符

```cpp
#include <iostream>
#include <string>

int main() {
    std::string str1 = "Hello";
    std::string str2 = " World";
    
    // 使用+运算符连接字符串
    std::string str3 = str1 + str2;
    std::cout << "str3: " << str3 << std::endl;
    
    // 使用+=运算符追加字符串
    str1 += str2;
    std::cout << "str1: " << str1 << std::endl;
    
    return 0;
}
```

输出：
```
str3: Hello World
str1: Hello World
```

#### 使用`append()`方法

```cpp
#include <iostream>
#include <string>

int main() {
    std::string str = "Hello";
    std::cout << "原始字符串: " << str << std::endl;
    
    // 使用append()追加字符串
    str.append(" World");
    std::cout << "追加后: " << str << std::endl;
    
    // 追加特定数量的字符
    str.append("!!!", 2);  // 只追加前2个字符
    std::cout << "追加2个感叹号: " << str << std::endl;
    
    return 0;
}
```

输出：
```
原始字符串: Hello
追加后: Hello World
追加2个感叹号: Hello World!!
```

### 3. 插入字符串

使用`insert()`方法可以在字符串的指定位置插入内容：

```cpp
#include <iostream>
#include <string>

int main() {
    std::string str = "Hello World";
    std::cout << "原始字符串: " << str << std::endl;
    
    // 在指定位置插入字符串
    str.insert(5, " beautiful");
    std::cout << "插入后: " << str << std::endl;
    
    // 在指定位置插入多个相同字符
    str.insert(5, 3, '!');  // 在位置5插入3个感叹号
    std::cout << "插入多个字符: " << str << std::endl;
    
    return 0;
}
```

输出：
```
原始字符串: Hello World
插入后: Hello beautiful World
插入多个字符: Hello!!! beautiful World
```

### 4. 删除字符串

使用`erase()`方法可以删除字符串中的部分内容：

```cpp
#include <iostream>
#include <string>

int main() {
    std::string str = "Hello beautiful World";
    std::cout << "原始字符串: " << str << std::endl;
    
    // 删除从指定位置开始的n个字符
    str.erase(5, 10);  // 从位置5开始删除10个字符
    std::cout << "删除后: " << str << std::endl;
    
    // 删除指定位置的一个字符
    str.erase(5);  // 删除位置5的字符
    std::cout << "删除第6个字符: " << str << std::endl;
    
    return 0;
}
```

输出：
```
原始字符串: Hello beautiful World
删除后: HelloWorld
删除第6个字符: HelloWorld
```

### 5. 替换字符串

使用`replace()`方法可以替换字符串中的部分内容：

```cpp
#include <iostream>
#include <string>

int main() {
    std::string str = "Hello World";
    std::cout << "原始字符串: " << str << std::endl;
    
    // 替换从位置6开始的5个字符为新字符串
    str.replace(6, 5, "C++");
    std::cout << "替换后: " << str << std::endl;
    
    // 替换整个字符串
    str.replace(0, str.length(), "Welcome to C++");
    std::cout << "完全替换: " << str << std::endl;
    
    return 0;
}
```

输出：
```
原始字符串: Hello World
替换后: Hello C++
完全替换: Welcome to C++
```

## 修改字符串的高级操作

### 1. 子字符串操作

使用`substr()`方法可以获取字符串的子串：

```cpp
#include <iostream>
#include <string>

int main() {
    std::string str = "Hello World";
    std::cout << "原始字符串: " << str << std::endl;
    
    // 获取子字符串(从位置6开始，长度为5)
    std::string sub = str.substr(6, 5);
    std::cout << "子字符串: " << sub << std::endl;
    
    // 获取从位置6到末尾的子字符串
    std::string sub2 = str.substr(6);
    std::cout << "从位置6到末尾的子字符串: " << sub2 << std::endl;
    
    return 0;
}
```

输出：
```
原始字符串: Hello World
子字符串: World
从位置6到末尾的子字符串: World
```

### 2. 清空字符串

使用`clear()`方法可以清空字符串的内容：

```cpp
#include <iostream>
#include <string>

int main() {
    std::string str = "Hello World";
    std::cout << "清空前: " << str << std::endl;
    
    // 清空字符串
    str.clear();
    std::cout << "清空后: '" << str << "'" << std::endl;
    std::cout << "字符串长度: " << str.length() << std::endl;
    
    return 0;
}
```

输出：
```
清空前: Hello World
清空后: ''
字符串长度: 0
```

### 3. 交换字符串

使用`swap()`方法可以交换两个字符串的内容：

```cpp
#include <iostream>
#include <string>

int main() {
    std::string str1 = "Hello";
    std::string str2 = "World";
    
    std::cout << "交换前:" << std::endl;
    std::cout << "str1: " << str1 << std::endl;
    std::cout << "str2: " << str2 << std::endl;
    
    // 交换字符串
    str1.swap(str2);
    
    std::cout << "交换后:" << std::endl;
    std::cout << "str1: " << str1 << std::endl;
    std::cout << "str2: " << str2 << std::endl;
    
    return 0;
}
```

输出：
```
交换前:
str1: Hello
str2: World
交换后:
str1: World
str2: Hello
```

### 4. 修改单个字符

我们可以使用数组下标或`at()`方法访问并修改字符串中的单个字符：

```cpp
#include <iostream>
#include <string>

int main() {
    std::string str = "Hello World";
    std::cout << "原始字符串: " << str << std::endl;
    
    // 使用下标修改字符
    str[0] = 'J';
    std::cout << "修改后(使用下标): " << str << std::endl;
    
    // 使用at()方法修改字符
    str.at(4) = 'y';
    std::cout << "修改后(使用at()): " << str << std::endl;
    
    return 0;
}
```

输出：
```
原始字符串: Hello World
修改后(使用下标): Jello World
修改后(使用at()): Jelly World
```

:::caution
使用下标访问字符时，如果下标越界，不会进行检查，可能导致未定义行为。而`at()`方法会进行边界检查，如果下标越界将抛出异常。
:::

## 实际应用案例

### 案例1：文本处理器

假设我们正在开发一个简单的文本处理程序，需要对用户输入的文本进行修改：

```cpp
#include <iostream>
#include <string>

int main() {
    std::string text;
    
    std::cout << "请输入一段文本: ";
    std::getline(std::cin, text);
    
    // 1. 在文本开头添加日期
    text.insert(0, "日期: 2023-10-30 - ");
    
    // 2. 将所有的"and"替换为"&"
    std::size_t pos = 0;
    while ((pos = text.find("and", pos)) != std::string::npos) {
        text.replace(pos, 3, "&");
        pos += 1; // 调整查找位置
    }
    
    // 3. 删除所有多余的空格
    pos = 0;
    while ((pos = text.find("  ", pos)) != std::string::npos) {
        text.erase(pos, 1);
    }
    
    // 4. 在文本末尾添加签名
    text.append("\n-- 由文本处理器处理");
    
    std::cout << "\n处理后的文本:\n" << text << std::endl;
    
    return 0;
}
```

输入：
```
Hello and welcome to our meeting today and tomorrow.
```

输出：
```
处理后的文本:
日期: 2023-10-30 - Hello & welcome to our meeting today & tomorrow.
-- 由文本处理器处理
```

### 案例2：URL解析器

假设我们需要解析和修改URL字符串：

```cpp
#include <iostream>
#include <string>

int main() {
    std::string url = "https://www.example.com/path/to/page.html?id=123&name=test";
    std::cout << "原始URL: " << url << std::endl;
    
    // 提取协议
    std::size_t protocolEnd = url.find("://");
    std::string protocol = url.substr(0, protocolEnd);
    std::cout << "协议: " << protocol << std::endl;
    
    // 提取域名
    std::size_t domainStart = protocolEnd + 3;
    std::size_t domainEnd = url.find("/", domainStart);
    std::string domain = url.substr(domainStart, domainEnd - domainStart);
    std::cout << "域名: " << domain << std::endl;
    
    // 提取路径
    std::size_t pathStart = domainEnd;
    std::size_t pathEnd = url.find("?", pathStart);
    std::string path = url.substr(pathStart, pathEnd - pathStart);
    std::cout << "路径: " << path << std::endl;
    
    // 提取查询参数
    std::string query = url.substr(pathEnd + 1);
    std::cout << "查询参数: " << query << std::endl;
    
    // 修改URL - 更换协议为HTTP
    url.replace(0, protocolEnd, "http");
    std::cout << "修改后的URL: " << url << std::endl;
    
    return 0;
}
```

输出：
```
原始URL: https://www.example.com/path/to/page.html?id=123&name=test
协议: https
域名: www.example.com
路径: /path/to/page.html
查询参数: id=123&name=test
修改后的URL: http://www.example.com/path/to/page.html?id=123&name=test
```

## 性能注意事项

在进行大量字符串修改操作时，应该注意一些性能问题：

1. **避免频繁的字符串连接操作**：每次连接都会创建新的字符串对象，可能导致性能下降。如果需要频繁连接字符串，可以考虑使用`std::stringstream`或`std::string`的`reserve()`方法预先分配足够的空间。

2. **使用`reserve()`预分配空间**：如果知道字符串最终的大致长度，可以预先分配空间，避免多次重新分配内存。

```cpp
#include <iostream>
#include <string>

int main() {
    std::string str;
    
    // 预分配100个字符的空间
    str.reserve(100);
    
    for (int i = 0; i < 100; i++) {
        str += "a";
    }
    
    std::cout << "最终字符串长度: " << str.length() << std::endl;
    
    return 0;
}
```

输出：
```
最终字符串长度: 100
```

## 总结

本文详细介绍了C++中字符串修改的各种方法和技巧。我们学习了：

1. 基本的字符串修改操作，包括赋值、连接、追加、插入、删除和替换等。
2. 高级的字符串操作，包括子字符串提取、清空字符串、交换字符串和修改单个字符等。
3. 实际应用案例，如文本处理器和URL解析器。
4. 性能注意事项，如避免频繁连接和预分配空间。

掌握这些字符串修改技巧后，你将能够更加高效地处理各种字符串相关的编程任务。

## 练习题

为了巩固所学知识，请尝试完成以下练习：

1. 编写一个函数，将给定字符串中的所有小写字母转换为大写字母。
2. 编写一个函数，清除字符串中的所有空格。
3. 编写一个函数，反转一个字符串(例如："hello" -> "olleh")。
4. 编写一个函数，检查一个字符串是否是回文(正读反读都一样)，如果不是回文，则将其修改为回文字符串。

:::tip
字符串修改是C++编程中非常基础和重要的操作。通过实际练习和应用，你将能够更好地理解和掌握这些技巧。
:::