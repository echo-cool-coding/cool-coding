---
title: C 语言函数指针
description: 了解C语言中的函数指针，掌握其基本概念、语法和实际应用场景。
---

# C 语言函数指针

## 介绍

在C语言中，函数指针是一种指向函数的指针变量。与普通指针不同，函数指针存储的是函数的地址，而不是数据。通过函数指针，我们可以动态地调用不同的函数，这在编写灵活且可扩展的代码时非常有用。

函数指针的概念可能对初学者来说有些抽象，但一旦掌握，它将为你的编程工具箱增添一个强大的工具。

## 基本语法

函数指针的声明语法如下：

```c
返回类型 (*指针变量名)(参数类型1, 参数类型2, ...);
```

例如，声明一个指向返回类型为 `int`，参数为两个 `int` 类型的函数的指针：

```c
int (*funcPtr)(int, int);
```

### 示例：声明和使用函数指针

```c
#include <stdio.h>

int add(int a, int b) {
    return a + b;
}

int subtract(int a, int b) {
    return a - b;
}

int main() {
    int (*funcPtr)(int, int);

    funcPtr = add;
    printf("Add: %d\n", funcPtr(5, 3)); // 输出: Add: 8

    funcPtr = subtract;
    printf("Subtract: %d\n", funcPtr(5, 3)); // 输出: Subtract: 2

    return 0;
}
```

在这个示例中，`funcPtr` 是一个函数指针，它可以指向 `add` 或 `subtract` 函数。通过改变 `funcPtr` 的指向，我们可以动态地调用不同的函数。

## 函数指针的实际应用

### 1. 回调函数

回调函数是一种通过函数指针实现的机制，允许我们将函数作为参数传递给另一个函数。这在事件驱动编程、异步编程等场景中非常常见。

```c
#include <stdio.h>

void process(int (*callback)(int, int), int a, int b) {
    int result = callback(a, b);
    printf("Result: %d\n", result);
}

int multiply(int a, int b) {
    return a * b;
}

int main() {
    process(multiply, 5, 3); // 输出: Result: 15
    return 0;
}
```

在这个示例中，`process` 函数接受一个函数指针 `callback` 作为参数，并在内部调用它。

### 2. 函数指针数组

函数指针数组是一种存储多个函数指针的数组。通过这种方式，我们可以根据索引动态调用不同的函数。

```c
#include <stdio.h>

int add(int a, int b) {
    return a + b;
}

int subtract(int a, int b) {
    return a - b;
}

int multiply(int a, int b) {
    return a * b;
}

int main() {
    int (*funcArray[3])(int, int) = {add, subtract, multiply};

    printf("Add: %d\n", funcArray[0](5, 3)); // 输出: Add: 8
    printf("Subtract: %d\n", funcArray[1](5, 3)); // 输出: Subtract: 2
    printf("Multiply: %d\n", funcArray[2](5, 3)); // 输出: Multiply: 15

    return 0;
}
```

在这个示例中，`funcArray` 是一个包含三个函数指针的数组，我们可以通过索引来调用不同的函数。

## 总结

函数指针是C语言中一个强大且灵活的特性，它允许我们动态地调用函数，并在许多场景中提供了极大的便利。通过掌握函数指针的基本语法和实际应用，你将能够编写更加灵活和可扩展的代码。

:::tip
**小贴士**：在使用函数指针时，务必确保指针指向的函数签名（返回类型和参数类型）与指针声明一致，否则可能会导致未定义行为。
:::

## 附加资源与练习

1. **练习**：尝试编写一个程序，使用函数指针数组来实现一个简单的计算器，支持加、减、乘、除四种运算。
2. **进一步学习**：了解C语言中的 `typedef` 与函数指针的结合使用，以简化函数指针的声明。
3. **扩展阅读**：研究C标准库中的 `qsort` 函数，理解如何使用函数指针来实现自定义的排序逻辑。

通过不断练习和探索，你将能够更加熟练地使用函数指针，并将其应用到实际的编程项目中。