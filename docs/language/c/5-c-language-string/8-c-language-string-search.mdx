---
title: C 语言字符串搜索
description: 学习如何在C语言中搜索字符串，掌握常用的字符串搜索函数及其应用场景。
---

# C 语言字符串搜索

在C语言中，字符串是以字符数组的形式存储的。字符串搜索是指在一个字符串中查找另一个子字符串或字符的过程。这在处理文本数据时非常常见，例如查找特定单词、验证输入格式或提取信息等。本文将详细介绍C语言中常用的字符串搜索方法，并通过示例代码帮助你理解其用法。

## 1. 字符串搜索的基本概念

字符串搜索可以分为两种主要类型：
1. **查找单个字符**：在字符串中查找某个特定字符的位置。
2. **查找子字符串**：在字符串中查找另一个字符串（子字符串）的位置。

C语言提供了多个标准库函数来实现这些功能，例如 `strchr`、`strstr` 等。接下来，我们将逐一介绍这些函数。

---

## 2. 查找单个字符：`strchr` 函数

`strchr` 函数用于在字符串中查找某个字符的第一次出现位置。其函数原型如下：

```c
char *strchr(const char *str, int c);
```

- `str`：要搜索的字符串。
- `c`：要查找的字符（以 `int` 形式传递，但实际上是字符的ASCII值）。
- 返回值：如果找到字符，返回指向该字符的指针；否则返回 `NULL`。

### 示例代码

```c
#include <stdio.h>
#include <string.h>

int main() {
    char str[] = "Hello, World!";
    char *result = strchr(str, 'W');

    if (result != NULL) {
        printf("找到字符 'W'，位置在：%ld\n", result - str);
    } else {
        printf("未找到字符 'W'\n");
    }

    return 0;
}
```

**输入：**
```
str = "Hello, World!"
```

**输出：**
```
找到字符 'W'，位置在：7
```

:::note
`strchr` 返回的是字符在字符串中的指针，通过 `result - str` 可以计算出字符的位置（索引从0开始）。
:::

---

## 3. 查找子字符串：`strstr` 函数

`strstr` 函数用于在字符串中查找另一个子字符串的第一次出现位置。其函数原型如下：

```c
char *strstr(const char *haystack, const char *needle);
```

- `haystack`：要搜索的主字符串。
- `needle`：要查找的子字符串。
- 返回值：如果找到子字符串，返回指向子字符串在主字符串中首次出现位置的指针；否则返回 `NULL`。

### 示例代码

```c
#include <stdio.h>
#include <string.h>

int main() {
    char str[] = "C programming is fun!";
    char *result = strstr(str, "programming");

    if (result != NULL) {
        printf("找到子字符串 'programming'，位置在：%ld\n", result - str);
    } else {
        printf("未找到子字符串 'programming'\n");
    }

    return 0;
}
```

**输入：**
```
str = "C programming is fun!"
```

**输出：**
```
找到子字符串 'programming'，位置在：2
```

:::tip
`strstr` 是区分大小写的。如果需要不区分大小写的搜索，可以使用其他库函数或自定义实现。
:::

---

## 4. 实际应用场景

### 场景1：验证电子邮件地址格式

假设我们需要验证用户输入的电子邮件地址是否包含 `@` 符号。可以使用 `strchr` 函数来实现：

```c
#include <stdio.h>
#include <string.h>

int is_valid_email(const char *email) {
    return strchr(email, '@') != NULL;
}

int main() {
    char email[] = "user@example.com";

    if (is_valid_email(email)) {
        printf("有效的电子邮件地址\n");
    } else {
        printf("无效的电子邮件地址\n");
    }

    return 0;
}
```

**输出：**
```
有效的电子邮件地址
```

### 场景2：提取文件扩展名

假设我们需要从文件名中提取扩展名（例如 `.txt`），可以使用 `strstr` 函数：

```c
#include <stdio.h>
#include <string.h>

void extract_extension(const char *filename) {
    char *dot = strstr(filename, ".");
    if (dot != NULL) {
        printf("文件扩展名是：%s\n", dot);
    } else {
        printf("未找到文件扩展名\n");
    }
}

int main() {
    char filename[] = "document.txt";
    extract_extension(filename);

    return 0;
}
```

**输出：**
```
文件扩展名是：.txt
```

---

## 5. 总结

在C语言中，字符串搜索是一个常见且重要的操作。通过 `strchr` 和 `strstr` 函数，我们可以轻松地查找字符或子字符串。以下是本文的主要内容总结：
- 使用 `strchr` 查找单个字符。
- 使用 `strstr` 查找子字符串。
- 实际应用场景包括验证电子邮件地址和提取文件扩展名。

---

## 6. 附加资源与练习

### 练习1
编写一个程序，统计字符串中某个字符出现的次数。

### 练习2
编写一个程序，查找字符串中所有出现的子字符串，并输出它们的位置。

### 附加资源
- [C 标准库文档](https://en.cppreference.com/w/c/string/byte)
- 《C程序设计语言》（K&R）—— 经典的C语言教材，深入讲解字符串操作。

通过不断练习和探索，你将熟练掌握C语言中的字符串搜索技巧！