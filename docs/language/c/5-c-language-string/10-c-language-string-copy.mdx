---
title: C 语言字符串复制
description: 学习如何在C语言中复制字符串，掌握strcpy和strncpy函数的使用方法，并通过实际案例理解其应用场景。
---

# C 语言字符串复制

在C语言中，字符串是以字符数组的形式存储的。字符串复制是一个常见的操作，用于将一个字符串的内容复制到另一个字符串中。C语言提供了两个常用的函数来实现字符串复制：`strcpy` 和 `strncpy`。本文将详细介绍这两个函数的使用方法，并通过实际案例帮助你理解它们的应用场景。

## 1. 什么是字符串复制？

字符串复制是指将一个字符串的内容复制到另一个字符串中。在C语言中，字符串是以字符数组的形式存储的，因此字符串复制实际上是将一个字符数组的内容复制到另一个字符数组中。

## 2. 使用 `strcpy` 函数复制字符串

`strcpy` 函数是C语言标准库中的一个函数，用于将一个字符串复制到另一个字符串中。它的原型如下：

```c
char *strcpy(char *dest, const char *src);
```

- `dest`：目标字符串，即复制后的字符串将存储在这里。
- `src`：源字符串，即要复制的字符串。

### 示例代码

```c
#include <stdio.h>
#include <string.h>

int main() {
    char src[] = "Hello, World!";
    char dest[50];

    strcpy(dest, src);

    printf("源字符串: %s\n", src);
    printf("目标字符串: %s\n", dest);

    return 0;
}
```

### 输出

```
源字符串: Hello, World!
目标字符串: Hello, World!
```

### 解释

在上面的代码中，我们首先定义了一个源字符串 `src`，然后定义了一个目标字符串 `dest`，其大小为50个字符。接着，我们使用 `strcpy` 函数将 `src` 的内容复制到 `dest` 中。最后，我们打印出源字符串和目标字符串的内容，可以看到它们的内容是相同的。

:::caution 注意
`strcpy` 函数不会检查目标字符串的大小是否足够容纳源字符串的内容。如果目标字符串的大小不足以容纳源字符串的内容，可能会导致缓冲区溢出，从而引发不可预知的错误。因此，在使用 `strcpy` 函数时，务必确保目标字符串的大小足够大。
:::

## 3. 使用 `strncpy` 函数复制字符串

为了避免 `strcpy` 函数可能导致的缓冲区溢出问题，C语言还提供了 `strncpy` 函数。`strncpy` 函数允许你指定要复制的最大字符数，从而避免目标字符串溢出。它的原型如下：

```c
char *strncpy(char *dest, const char *src, size_t n);
```

- `dest`：目标字符串，即复制后的字符串将存储在这里。
- `src`：源字符串，即要复制的字符串。
- `n`：要复制的最大字符数。

### 示例代码

```c
#include <stdio.h>
#include <string.h>

int main() {
    char src[] = "Hello, World!";
    char dest[10];

    strncpy(dest, src, sizeof(dest) - 1);
    dest[sizeof(dest) - 1] = '\0';  // 确保字符串以 '\0' 结尾

    printf("源字符串: %s\n", src);
    printf("目标字符串: %s\n", dest);

    return 0;
}
```

### 输出

```
源字符串: Hello, World!
目标字符串: Hello, Wo
```

### 解释

在上面的代码中，我们定义了一个大小为10的目标字符串 `dest`。我们使用 `strncpy` 函数将 `src` 的内容复制到 `dest` 中，但最多只复制 `sizeof(dest) - 1` 个字符。这样可以确保目标字符串不会溢出。最后，我们手动在目标字符串的末尾添加了一个 `\0`，以确保字符串以 `\0` 结尾。

:::tip 提示
`strncpy` 函数不会自动在目标字符串的末尾添加 `\0`。如果源字符串的长度大于或等于 `n`，目标字符串将不会以 `\0` 结尾。因此，在使用 `strncpy` 函数时，务必手动在目标字符串的末尾添加 `\0`。
:::

## 4. 实际应用场景

字符串复制在实际编程中有广泛的应用。例如，在处理用户输入时，我们可能需要将用户输入的字符串复制到一个缓冲区中进行进一步处理。以下是一个简单的示例：

```c
#include <stdio.h>
#include <string.h>

int main() {
    char userInput[100];
    char buffer[50];

    printf("请输入一个字符串: ");
    fgets(userInput, sizeof(userInput), stdin);

    // 去掉换行符
    userInput[strcspn(userInput, "\n")] = '\0';

    strncpy(buffer, userInput, sizeof(buffer) - 1);
    buffer[sizeof(buffer) - 1] = '\0';

    printf("你输入的字符串是: %s\n", buffer);

    return 0;
}
```

### 输出

```
请输入一个字符串: Hello, World!
你输入的字符串是: Hello, World!
```

### 解释

在这个示例中，我们首先使用 `fgets` 函数获取用户输入的字符串，并将其存储在 `userInput` 中。然后，我们使用 `strncpy` 函数将 `userInput` 的内容复制到 `buffer` 中，并确保 `buffer` 不会溢出。最后，我们打印出 `buffer` 中的内容。

## 5. 总结

在C语言中，字符串复制是一个常见的操作。`strcpy` 函数可以用于将一个字符串复制到另一个字符串中，但它不会检查目标字符串的大小是否足够。为了避免缓冲区溢出，可以使用 `strncpy` 函数，并手动在目标字符串的末尾添加 `\0`。

在实际编程中，字符串复制常用于处理用户输入、字符串拼接等场景。掌握 `strcpy` 和 `strncpy` 函数的使用方法，可以帮助你更好地处理字符串操作。

## 6. 附加资源与练习

- **练习1**：编写一个程序，要求用户输入两个字符串，并将第一个字符串复制到第二个字符串中。使用 `strcpy` 函数实现。
- **练习2**：修改练习1的程序，使用 `strncpy` 函数实现，并确保目标字符串不会溢出。
- **附加资源**：阅读C语言标准库中关于 `strcpy` 和 `strncpy` 函数的文档，了解更多细节和注意事项。

通过以上内容的学习和练习，你应该能够熟练地在C语言中进行字符串复制操作。继续加油，祝你编程学习顺利！