---
title: C 语言标准流
description: 了解C语言中的标准流，包括标准输入、标准输出和标准错误流，以及它们在文件操作中的重要性。
---

# C 语言标准流

在C语言中，**标准流**是预定义的输入和输出通道，用于与用户进行交互或处理数据。它们是C标准库的一部分，提供了与操作系统进行通信的简单方式。标准流包括**标准输入流**、**标准输出流**和**标准错误流**，分别对应键盘输入、屏幕输出和错误信息输出。

## 标准流简介

C语言中的标准流是通过文件指针（`FILE*`）来操作的。这些流在程序启动时自动打开，并在程序结束时自动关闭。以下是三个主要的标准流：

1. **标准输入流（stdin）**：通常与键盘输入相关联，用于从用户获取输入。
2. **标准输出流（stdout）**：通常与屏幕输出相关联，用于向用户显示信息。
3. **标准错误流（stderr）**：通常也与屏幕输出相关联，但专门用于输出错误信息。

这些流在C标准库中定义为全局变量，可以直接使用。

## 标准流的使用

### 标准输入流（stdin）

`stdin` 用于从用户获取输入。最常见的函数是 `scanf`，它从标准输入读取格式化数据。

```c
#include <stdio.h>

int main() {
    int number;
    printf("请输入一个整数: ");
    scanf("%d", &number);
    printf("你输入的整数是: %d\n", number);
    return 0;
}
```

**输入：**
```
请输入一个整数: 42
```

**输出：**
```
你输入的整数是: 42
```

### 标准输出流（stdout）

`stdout` 用于向用户显示信息。最常见的函数是 `printf`，它将格式化数据输出到标准输出。

```c
#include <stdio.h>

int main() {
    printf("Hello, World!\n");
    return 0;
}
```

**输出：**
```
Hello, World!
```

### 标准错误流（stderr）

`stderr` 用于输出错误信息。与 `stdout` 不同，`stderr` 通常不会被重定向到文件或其他输出设备，因此它总是直接显示在屏幕上。

```c
#include <stdio.h>

int main() {
    fprintf(stderr, "这是一个错误信息！\n");
    return 0;
}
```

**输出：**
```
这是一个错误信息！
```

## 标准流的重定向

标准流可以被重定向到文件或其他设备。例如，你可以将 `stdout` 重定向到一个文件，而不是显示在屏幕上。

```c
#include <stdio.h>

int main() {
    FILE *file = fopen("output.txt", "w");
    if (file == NULL) {
        fprintf(stderr, "无法打开文件！\n");
        return 1;
    }

    // 将 stdout 重定向到文件
    fprintf(file, "这行文字将被写入文件。\n");

    fclose(file);
    return 0;
}
```

运行此程序后，`output.txt` 文件将包含以下内容：

```
这行文字将被写入文件。
```

## 实际应用场景

标准流在实际编程中有广泛的应用。例如，在命令行工具中，`stdin` 用于接收用户输入，`stdout` 用于显示结果，而 `stderr` 用于报告错误。

```c
#include <stdio.h>

int main() {
    int num1, num2;
    printf("请输入两个整数: ");
    if (scanf("%d %d", &num1, &num2) != 2) {
        fprintf(stderr, "输入错误！\n");
        return 1;
    }

    printf("它们的和是: %d\n", num1 + num2);
    return 0;
}
```

**输入：**
```
请输入两个整数: 10 20
```

**输出：**
```
它们的和是: 30
```

如果用户输入的不是整数，程序将输出错误信息：

**输入：**
```
请输入两个整数: 10 abc
```

**输出：**
```
输入错误！
```

## 总结

C语言中的标准流是处理输入和输出的重要工具。通过 `stdin`、`stdout` 和 `stderr`，程序可以与用户进行交互，并处理错误信息。理解这些流的工作原理对于编写健壮的程序至关重要。

## 附加资源与练习

- **练习1**：编写一个程序，从 `stdin` 读取一个字符串，并将其写入到文件中。
- **练习2**：修改上述程序，使其在写入文件时，将错误信息输出到 `stderr`。
- **参考资源**：C标准库文档中关于 `stdio.h` 的部分，了解更多关于标准流的函数和用法。

:::tip
记住，标准流是C语言中处理输入输出的基础，熟练掌握它们将帮助你编写更高效、更可靠的程序。
:::