---
title: Swift 防止重写
description: 学习如何在Swift中使用`final`关键字防止类、方法或属性被重写，确保代码的稳定性和可维护性。
---

# Swift 防止重写

在Swift中，继承是一个强大的特性，它允许我们创建新的类，基于现有的类进行扩展和修改。然而，有时我们希望确保某些类、方法或属性不会被进一步重写，以避免意外的行为或确保代码的稳定性。Swift提供了`final`关键字来实现这一目的。

## 什么是防止重写？

防止重写是指在类、方法或属性上使用`final`关键字，以阻止它们被继承或重写。通过这种方式，我们可以确保某些关键部分的代码不会被修改，从而提高代码的可靠性和可维护性。

## 如何使用`final`关键字

### 防止类被继承

如果你希望某个类不能被继承，可以在类定义前加上`final`关键字。例如：

```swift
final class Vehicle {
    var speed: Double = 0.0
    func accelerate() {
        speed += 10.0
    }
}
```

在这个例子中，`Vehicle`类被标记为`final`，因此任何尝试继承`Vehicle`类的操作都会导致编译错误。

```swift
class Car: Vehicle { // 编译错误：Cannot inherit from final class 'Vehicle'
    // ...
}
```

### 防止方法被重写

如果你希望某个方法在子类中不能被重写，可以在方法定义前加上`final`关键字。例如：

```swift
class Vehicle {
    final func startEngine() {
        print("Engine started")
    }
}

class Car: Vehicle {
    override func startEngine() { // 编译错误：Cannot override final method 'startEngine'
        print("Car engine started")
    }
}
```

在这个例子中，`startEngine`方法被标记为`final`，因此任何尝试重写该方法的操作都会导致编译错误。

### 防止属性被重写

类似地，如果你希望某个属性在子类中不能被重写，可以在属性定义前加上`final`关键字。例如：

```swift
class Vehicle {
    final var speed: Double = 0.0
}

class Car: Vehicle {
    override var speed: Double { // 编译错误：Cannot override final property 'speed'
        get { return super.speed }
        set { super.speed = newValue }
    }
}
```

在这个例子中，`speed`属性被标记为`final`，因此任何尝试重写该属性的操作都会导致编译错误。

## 实际应用场景

### 框架设计

在设计框架或库时，通常希望某些核心类或方法不能被修改，以确保框架的稳定性和一致性。通过使用`final`关键字，可以防止用户重写这些关键部分，从而避免潜在的错误或不一致。

### 性能优化

在某些情况下，防止重写还可以带来性能上的优化。由于编译器知道某些方法或属性不会被重写，因此可以进行更多的优化，例如内联方法调用。

## 总结

`final`关键字是Swift中一个非常有用的工具，它可以帮助我们防止类、方法或属性被重写，从而提高代码的稳定性和可维护性。在设计框架或库时，合理使用`final`关键字可以确保核心逻辑不被修改，避免潜在的错误。

## 附加资源与练习

- **练习1**：创建一个`final`类，并尝试继承它，观察编译器的错误提示。
- **练习2**：在一个类中定义一个`final`方法，并尝试在子类中重写它，观察编译器的错误提示。
- **练习3**：在一个类中定义一个`final`属性，并尝试在子类中重写它，观察编译器的错误提示。

通过以上练习，你将更好地理解`final`关键字的作用和使用场景。