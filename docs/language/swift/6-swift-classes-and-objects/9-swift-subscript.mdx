---
title: Swift 下标
description: 了解 Swift 中的下标（Subscripts），掌握如何使用下标简化对集合、列表或自定义类型的访问。
---

## 介绍

在 Swift 中，**下标**（Subscripts）是一种特殊的语法，允许你通过索引或键值来访问集合、列表或自定义类型中的元素。下标可以让你像访问数组或字典一样访问对象中的数据，从而使代码更加简洁和直观。

下标不仅可以用于数组和字典，还可以为自定义类型定义下标，使其支持类似数组或字典的访问方式。

## 基本语法

下标的基本语法如下：

```swift
subscript(index: IndexType) -> ElementType {
    get {
        // 返回与索引对应的值
    }
    set(newValue) {
        // 设置与索引对应的值
    }
}
```

- `index` 是下标的参数，可以是任意类型。
- `ElementType` 是返回值的类型。
- `get` 用于获取值，`set` 用于设置值（可选）。

### 示例：数组的下标

Swift 中的数组已经内置了下标功能。例如：

```swift
var numbers = [1, 2, 3, 4, 5]
print(numbers[2]) // 输出：3
numbers[2] = 10
print(numbers) // 输出：[1, 2, 10, 4, 5]
```

在这个例子中，`numbers[2]` 使用了数组的下标来访问和修改第三个元素。

## 自定义下标

你可以为自定义类型定义下标。以下是一个简单的例子，展示如何为一个表示矩阵的类型定义下标：

```swift
struct Matrix {
    let rows: Int, columns: Int
    var grid: [Double]
    
    init(rows: Int, columns: Int) {
        self.rows = rows
        self.columns = columns
        grid = Array(repeating: 0.0, count: rows * columns)
    }
    
    func indexIsValid(row: Int, column: Int) -> Bool {
        return row >= 0 && row < rows && column >= 0 && column < columns
    }
    
    subscript(row: Int, column: Int) -> Double {
        get {
            assert(indexIsValid(row: row, column: column), "Index out of range")
            return grid[(row * columns) + column]
        }
        set {
            assert(indexIsValid(row: row, column: column), "Index out of range")
            grid[(row * columns) + column] = newValue
        }
    }
}

var matrix = Matrix(rows: 2, columns: 2)
matrix[0, 1] = 1.5
matrix[1, 0] = 3.2

print(matrix[0, 1]) // 输出：1.5
print(matrix[1, 0]) // 输出：3.2
```

在这个例子中，我们为 `Matrix` 类型定义了一个二维下标，允许通过行和列来访问矩阵中的元素。

:::tip
下标可以有多个参数，甚至可以使用不同类型的参数。例如，你可以定义一个接受字符串作为键的下标。
:::

## 实际应用场景

### 1. 访问多维数据结构

下标非常适合用于访问多维数据结构，如矩阵、表格或棋盘。通过自定义下标，你可以简化对这些数据结构的访问和修改。

### 2. 封装数据访问逻辑

下标可以封装复杂的访问逻辑。例如，你可以通过下标访问数据库中的记录，或者在访问数据时进行验证和转换。

### 3. 简化 API 设计

如果你的类型需要支持类似数组或字典的访问方式，使用下标可以使 API 更加直观和易用。

## 总结

Swift 中的下标是一种强大的工具，可以让你以简洁的方式访问和修改集合、列表或自定义类型中的数据。通过自定义下标，你可以为你的类型添加类似数组或字典的访问功能，从而使代码更加清晰和易读。

## 附加资源与练习

### 练习
1. 定义一个 `ShoppingCart` 类，使用下标来访问购物车中的商品。
2. 为 `ShoppingCart` 添加一个下标，允许通过商品名称来访问商品数量。

### 进一步学习
- 阅读 [Swift 官方文档](https://docs.swift.org/swift-book/LanguageGuide/Subscripts.html) 中关于下标的更多内容。
- 尝试为你的自定义类型添加多维下标，并探索其应用场景。

:::caution
在使用下标时，务必确保索引的有效性，避免越界访问导致的运行时错误。
:::