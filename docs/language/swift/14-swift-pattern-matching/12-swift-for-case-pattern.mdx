---
title: Swift For-case 模式
description: 了解 Swift 中的 For-case 模式，这是一种强大的模式匹配技术，用于在循环中过滤和匹配特定条件的数据。
---

## 介绍

在 Swift 中，模式匹配是一种强大的工具，允许你根据特定条件匹配和提取数据。`for-case` 模式是模式匹配的一种形式，它结合了 `for` 循环和 `case` 语句，用于在遍历集合时过滤和匹配特定模式的数据。

`for-case` 模式特别适用于处理枚举、可选值以及其他复杂的数据结构。通过使用 `for-case`，你可以简化代码并使其更具可读性。

## 基本语法

`for-case` 模式的基本语法如下：

```swift
for case <pattern> in <collection> {
    // 处理匹配的数据
}
```

其中，`<pattern>` 是你想要匹配的模式，`<collection>` 是你想要遍历的集合。

## 示例 1：匹配枚举值

假设我们有一个表示交通信号的枚举：

```swift
enum TrafficLight {
    case red, yellow, green
}
```

现在我们有一个包含多个交通信号的数组，我们只想处理 `.green` 信号：

```swift
let lights: [TrafficLight] = [.red, .green, .yellow, .green, .red]

for case .green in lights {
    print("Go!")
}
```

**输出：**
```
Go!
Go!
```

在这个例子中，`for-case` 模式只匹配了数组中的 `.green` 值，并执行了相应的操作。

## 示例 2：匹配可选值

`for-case` 模式也可以用于匹配可选值。假设我们有一个包含可选整数的数组，我们只想处理非 `nil` 的值：

```swift
let numbers: [Int?] = [1, nil, 2, nil, 3]

for case let number? in numbers {
    print("Number: \(number)")
}
```

**输出：**
```
Number: 1
Number: 2
Number: 3
```

在这个例子中，`for-case` 模式只匹配了数组中的非 `nil` 值，并打印了这些值。

## 示例 3：匹配带有关联值的枚举

`for-case` 模式还可以用于匹配带有关联值的枚举。假设我们有一个表示不同形状的枚举，每个形状都有不同的关联值：

```swift
enum Shape {
    case circle(radius: Double)
    case rectangle(width: Double, height: Double)
}
```

现在我们有一个包含多个形状的数组，我们只想处理半径为 5.0 的圆：

```swift
let shapes: [Shape] = [
    .circle(radius: 5.0),
    .rectangle(width: 4.0, height: 6.0),
    .circle(radius: 3.0),
    .circle(radius: 5.0)
]

for case let .circle(radius: 5.0) in shapes {
    print("Found a circle with radius 5.0")
}
```

**输出：**
```
Found a circle with radius 5.0
Found a circle with radius 5.0
```

在这个例子中，`for-case` 模式只匹配了数组中半径为 5.0 的圆，并打印了相应的消息。

## 实际应用场景

`for-case` 模式在实际开发中有许多应用场景。例如，在处理网络请求的响应时，你可能只想处理成功的响应，而忽略失败的响应。假设我们有一个表示网络请求结果的枚举：

```swift
enum Result {
    case success(data: String)
    case failure(error: String)
}
```

现在我们有一个包含多个请求结果的数组，我们只想处理成功的响应：

```swift
let results: [Result] = [
    .success(data: "Data 1"),
    .failure(error: "Error 1"),
    .success(data: "Data 2"),
    .failure(error: "Error 2")
]

for case let .success(data) in results {
    print("Success: \(data)")
}
```

**输出：**
```
Success: Data 1
Success: Data 2
```

在这个例子中，`for-case` 模式只匹配了数组中成功的响应，并打印了相应的数据。

## 总结

`for-case` 模式是 Swift 中一种强大的模式匹配技术，它允许你在遍历集合时过滤和匹配特定模式的数据。通过使用 `for-case`，你可以简化代码并使其更具可读性。无论是处理枚举、可选值还是带有关联值的枚举，`for-case` 模式都能帮助你更高效地处理数据。

## 附加资源

- [Swift 官方文档 - 模式匹配](https://docs.swift.org/swift-book/ReferenceManual/Patterns.html)
- [Swift 编程语言指南](https://docs.swift.org/swift-book/)

## 练习

1. 创建一个包含多个可选字符串的数组，使用 `for-case` 模式打印所有非 `nil` 的字符串。
2. 定义一个表示不同天气条件的枚举，使用 `for-case` 模式匹配并处理特定的天气条件。
3. 尝试在一个包含多个复杂数据结构的数组中使用 `for-case` 模式，匹配并处理符合特定条件的数据。

通过完成这些练习，你将更好地理解并掌握 `for-case` 模式的使用。