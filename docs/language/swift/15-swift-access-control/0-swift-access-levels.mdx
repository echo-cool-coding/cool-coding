---
title: Swift 访问级别
description: 了解Swift中的访问控制机制，掌握如何通过访问级别保护代码的封装性和安全性。
---

# Swift 访问级别

在Swift中，**访问控制**是一种机制，用于限制代码中实体（如类、结构体、枚举、属性和方法）的可见性和可访问性。通过合理地使用访问级别，开发者可以控制代码的封装性，防止外部代码意外修改或访问内部实现细节，从而提高代码的安全性和可维护性。

## 什么是访问级别？

访问级别定义了代码中实体（如类、方法、属性等）的可见性范围。Swift提供了五种不同的访问级别，从最开放到最严格依次为：

1. **open**：允许实体在模块内外被访问和继承。
2. **public**：允许实体在模块内外被访问，但不能在模块外被继承。
3. **internal**：默认访问级别，允许实体在模块内被访问，但在模块外不可见。
4. **fileprivate**：限制实体仅在定义它的源文件内可见。
5. **private**：限制实体仅在定义它的作用域内可见。

## 访问级别的使用

### 1. open 和 public

`open` 和 `public` 访问级别通常用于框架或库的开发，允许其他模块访问和使用这些实体。

```swift
// 定义一个公开的类
public class PublicClass {
    public var publicProperty: String = "Public Property"
    
    public func publicMethod() {
        print("This is a public method.")
    }
}

// 定义一个开放的类
open class OpenClass: PublicClass {
    open func openMethod() {
        print("This is an open method.")
    }
}
```

:::note
`open` 和 `public` 的区别在于，`open` 允许其他模块继承和重写类或方法，而 `public` 只允许访问，不允许继承。
:::

### 2. internal

`internal` 是默认的访问级别，适用于大多数情况。它允许实体在模块内自由访问，但在模块外不可见。

```swift
// 定义一个内部类
internal class InternalClass {
    internal var internalProperty: String = "Internal Property"
    
    internal func internalMethod() {
        print("This is an internal method.")
    }
}
```

:::tip
如果你没有显式指定访问级别，Swift 会默认使用 `internal`。
:::

### 3. fileprivate

`fileprivate` 限制实体仅在定义它的源文件内可见。这在需要隐藏实现细节时非常有用。

```swift
// 定义一个文件私有的类
fileprivate class FilePrivateClass {
    fileprivate var fileprivateProperty: String = "Fileprivate Property"
    
    fileprivate func fileprivateMethod() {
        print("This is a fileprivate method.")
    }
}
```

:::caution
`fileprivate` 的作用范围是整个源文件，而不是单个类或结构体。
:::

### 4. private

`private` 是最严格的访问级别，限制实体仅在定义它的作用域内可见。通常用于隐藏类的内部实现细节。

```swift
// 定义一个私有的类
private class PrivateClass {
    private var privateProperty: String = "Private Property"
    
    private func privateMethod() {
        print("This is a private method.")
    }
}
```

:::warning
`private` 的作用范围是定义它的作用域，例如类、结构体或枚举的内部。
:::

## 实际应用场景

### 场景1：封装内部实现

假设你正在开发一个银行账户管理系统，你希望隐藏账户余额的实现细节，只允许通过特定的方法进行访问和修改。

```swift
class BankAccount {
    private var balance: Double = 0.0
    
    func deposit(amount: Double) {
        balance += amount
    }
    
    func withdraw(amount: Double) -> Bool {
        if amount <= balance {
            balance -= amount
            return true
        } else {
            return false
        }
    }
    
    func getBalance() -> Double {
        return balance
    }
}
```

在这个例子中，`balance` 属性被标记为 `private`，外部代码无法直接访问或修改它，只能通过 `deposit`、`withdraw` 和 `getBalance` 方法来操作。

### 场景2：框架开发

如果你正在开发一个框架，你可能希望某些类或方法可以被其他开发者继承或重写，而其他部分则只能被访问。

```swift
open class FrameworkClass {
    public func publicMethod() {
        print("This is a public method.")
    }
    
    open func openMethod() {
        print("This is an open method.")
    }
    
    internal func internalMethod() {
        print("This is an internal method.")
    }
}
```

在这个例子中，`openMethod` 可以被其他模块继承和重写，而 `publicMethod` 只能被访问，`internalMethod` 只能在模块内使用。

## 总结

Swift的访问控制机制为开发者提供了强大的工具，用于控制代码的可见性和可访问性。通过合理地使用 `open`、`public`、`internal`、`fileprivate` 和 `private`，你可以有效地封装代码，防止外部代码意外修改或访问内部实现细节。

## 附加资源与练习

- **练习1**：尝试在一个项目中定义不同的访问级别，观察它们在不同模块中的可见性。
- **练习2**：创建一个银行账户类，使用 `private` 访问级别隐藏余额属性，并通过公共方法提供访问和修改的接口。

通过不断实践，你将更好地掌握Swift中的访问控制机制，并能够编写出更加安全和可维护的代码。