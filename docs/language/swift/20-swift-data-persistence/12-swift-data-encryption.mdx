---
title: Swift 数据加密
description: 了解如何在 Swift 中实现数据加密，保护敏感信息的安全。本文将从基础概念入手，逐步讲解加密的实现方法，并提供实际案例和代码示例。
---

# Swift 数据加密

在现代应用程序中，数据安全至关重要。无论是用户的个人信息、支付数据，还是其他敏感信息，都需要通过加密来保护。Swift 提供了多种加密工具和技术，帮助开发者轻松实现数据加密。本文将介绍如何在 Swift 中进行数据加密，并通过实际案例展示其应用。

## 什么是数据加密？

数据加密是将原始数据（明文）转换为不可读的形式（密文）的过程。只有拥有正确密钥的人才能将密文解密回明文。加密技术广泛应用于保护数据的机密性和完整性，防止未经授权的访问。

在 Swift 中，常用的加密技术包括对称加密（如 AES）和非对称加密（如 RSA）。本文将重点介绍对称加密的实现。

## 对称加密：AES

AES（高级加密标准）是一种广泛使用的对称加密算法。对称加密意味着加密和解密使用相同的密钥。AES 支持 128 位、192 位和 256 位的密钥长度，其中 256 位密钥提供了最高的安全性。

### 使用 `CryptoKit` 进行 AES 加密

Swift 的 `CryptoKit` 框架提供了简单易用的 API 来实现 AES 加密。以下是一个使用 `CryptoKit` 进行 AES 加密的示例：

```swift
import CryptoKit

// 生成一个随机的 256 位密钥
let key = SymmetricKey(size: .bits256)

// 要加密的数据
let plainText = "Hello, Swift 数据加密!".data(using: .utf8)!

// 使用 AES-GCM 进行加密
let sealedBox = try! AES.GCM.seal(plainText, using: key)

// 输出加密后的数据
print("加密后的数据: \(sealedBox.ciphertext.base64EncodedString())")
```

**输出示例：**
```
加密后的数据: 3q2+7w==
```

### 解密数据

解密过程与加密类似，只需要使用相同的密钥即可：

```swift
// 解密数据
let decryptedData = try! AES.GCM.open(sealedBox, using: key)

// 将解密后的数据转换为字符串
let decryptedText = String(data: decryptedData, encoding: .utf8)!
print("解密后的数据: \(decryptedText)")
```

**输出示例：**
```
解密后的数据: Hello, Swift 数据加密!
```

:::note
`AES.GCM` 不仅提供了加密功能，还提供了数据完整性验证（通过认证标签）。这确保了数据在传输过程中未被篡改。
:::

## 实际应用场景

### 1. 保护用户敏感信息

假设你正在开发一个存储用户密码的应用程序。为了确保密码的安全性，你可以在存储之前对其进行加密：

```swift
func encryptPassword(_ password: String, using key: SymmetricKey) -> String {
    let passwordData = password.data(using: .utf8)!
    let sealedBox = try! AES.GCM.seal(passwordData, using: key)
    return sealedBox.ciphertext.base64EncodedString()
}

func decryptPassword(_ encryptedPassword: String, using key: SymmetricKey) -> String {
    let encryptedData = Data(base64Encoded: encryptedPassword)!
    let sealedBox = try! AES.GCM.SealedBox(combined: encryptedData)
    let decryptedData = try! AES.GCM.open(sealedBox, using: key)
    return String(data: decryptedData, encoding: .utf8)!
}
```

### 2. 加密本地存储的数据

在 iOS 应用中，你可能需要将一些敏感数据存储在本地（如 `UserDefaults` 或文件中）。为了确保这些数据的安全性，可以在存储之前对其进行加密：

```swift
let sensitiveData = "This is a secret message.".data(using: .utf8)!
let encryptedData = try! AES.GCM.seal(sensitiveData, using: key).combined!

// 存储加密后的数据
UserDefaults.standard.set(encryptedData, forKey: "encryptedData")

// 读取并解密数据
if let storedData = UserDefaults.standard.data(forKey: "encryptedData") {
    let sealedBox = try! AES.GCM.SealedBox(combined: storedData)
    let decryptedData = try! AES.GCM.open(sealedBox, using: key)
    print(String(data: decryptedData, encoding: .utf8)!)
}
```

## 总结

数据加密是保护敏感信息的重要手段。通过 Swift 的 `CryptoKit` 框架，开发者可以轻松实现 AES 加密，确保数据的安全性和完整性。本文介绍了如何使用 `CryptoKit` 进行对称加密，并展示了实际应用场景。

:::tip
为了进一步提高安全性，建议定期更换加密密钥，并确保密钥的安全存储（如使用 iOS 的 Keychain）。
:::

## 附加资源与练习

- **练习 1**: 尝试使用 `CryptoKit` 实现一个简单的加密聊天应用，确保消息在传输过程中是加密的。
- **练习 2**: 研究非对称加密（如 RSA）在 Swift 中的实现，并比较其与对称加密的优缺点。
- **资源**: 阅读 [Apple 的 CryptoKit 文档](https://developer.apple.com/documentation/cryptokit) 以了解更多高级加密功能。