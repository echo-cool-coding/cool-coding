---
title: Swift UserDefaults
description: 学习如何使用 Swift 中的 UserDefaults 进行简单的数据持久化存储，适合初学者。
---

# Swift UserDefaults

在 Swift 开发中，`UserDefaults` 是一种轻量级的数据持久化工具，适用于存储少量的用户偏好设置或应用配置数据。它基于键值对（key-value）存储，适合保存简单的数据类型，如字符串、整数、布尔值等。

## 什么是 UserDefaults？

`UserDefaults` 是 iOS 和 macOS 开发中常用的一个类，它提供了一个简单的接口来存储和读取用户偏好设置。它的数据存储在应用的沙盒中，因此只能在当前应用内访问。`UserDefaults` 适合存储少量的、非敏感的数据。

:::note
`UserDefaults` 不适合存储大量数据或敏感信息（如密码）。对于大量数据，建议使用 Core Data 或 SQLite；对于敏感信息，建议使用 Keychain。
:::

## 如何使用 UserDefaults？

### 1. 存储数据

使用 `UserDefaults` 存储数据非常简单。你可以通过 `standard` 单例访问 `UserDefaults`，并使用 `set(_:forKey:)` 方法存储数据。

```swift
// 存储一个字符串
UserDefaults.standard.set("John Doe", forKey: "username")

// 存储一个整数
UserDefaults.standard.set(25, forKey: "userAge")

// 存储一个布尔值
UserDefaults.standard.set(true, forKey: "isLoggedIn")
```

### 2. 读取数据

要从 `UserDefaults` 中读取数据，可以使用 `object(forKey:)` 方法，或者直接使用特定类型的方法，如 `string(forKey:)`、`integer(forKey:)` 等。

```swift
// 读取字符串
if let username = UserDefaults.standard.string(forKey: "username") {
    print("Username: \(username)")
}

// 读取整数
let userAge = UserDefaults.standard.integer(forKey: "userAge")
print("User Age: \(userAge)")

// 读取布尔值
let isLoggedIn = UserDefaults.standard.bool(forKey: "isLoggedIn")
print("Is logged in: \(isLoggedIn)")
```

### 3. 删除数据

如果你需要删除某个键值对，可以使用 `removeObject(forKey:)` 方法。

```swift
// 删除存储的用户名
UserDefaults.standard.removeObject(forKey: "username")
```

## 实际应用场景

### 场景 1：保存用户登录状态

假设你正在开发一个应用，用户登录后需要保存登录状态。你可以使用 `UserDefaults` 来存储用户的登录状态。

```swift
// 用户登录成功后
UserDefaults.standard.set(true, forKey: "isLoggedIn")

// 检查用户是否已登录
if UserDefaults.standard.bool(forKey: "isLoggedIn") {
    print("User is logged in")
} else {
    print("User is not logged in")
}
```

### 场景 2：保存用户偏好设置

假设你的应用允许用户选择主题（如深色模式或浅色模式），你可以使用 `UserDefaults` 来保存用户的选择。

```swift
// 用户选择深色模式
UserDefaults.standard.set("dark", forKey: "theme")

// 读取用户选择的主题
if let theme = UserDefaults.standard.string(forKey: "theme") {
    print("Selected theme: \(theme)")
}
```

## 总结

`UserDefaults` 是 Swift 中一个简单而强大的工具，适合存储少量的用户偏好设置或应用配置数据。通过键值对的方式，你可以轻松地存储和读取数据。然而，它不适合存储大量数据或敏感信息。

:::tip
在使用 `UserDefaults` 时，建议为键名定义常量，以避免拼写错误。例如：
```swift
let kUsernameKey = "username"
UserDefaults.standard.set("John Doe", forKey: kUsernameKey)
```
:::

## 附加资源与练习

### 练习 1
尝试在你的应用中实现一个功能，使用 `UserDefaults` 保存用户的昵称，并在应用启动时显示该昵称。

### 练习 2
扩展练习 1，允许用户切换应用的主题（深色/浅色模式），并使用 `UserDefaults` 保存用户的选择。

### 附加资源
- [Apple 官方文档：UserDefaults](https://developer.apple.com/documentation/foundation/userdefaults)
- [Swift 编程语言指南](https://docs.swift.org/swift-book/)

通过以上内容，你应该已经掌握了 `UserDefaults` 的基本用法，并能够在实际项目中应用它。继续练习，巩固你的知识吧！