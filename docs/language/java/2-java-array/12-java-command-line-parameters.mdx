---
title: Java 命令行参数
description: 学习如何在Java程序中使用命令行参数，以及如何处理和解析这些参数
---

# Java 命令行参数

## 什么是命令行参数？

命令行参数是在启动Java程序时，通过命令行传递给程序的输入值。这些参数可以为程序提供额外的配置信息或数据，使程序能够根据不同的输入执行不同的操作，从而增强程序的灵活性和通用性。

在Java中，命令行参数通过`main`方法的字符串数组参数`String[] args`接收。当我们通过命令行运行Java程序时，可以在程序名称后添加这些参数。

## 如何访问命令行参数

在Java程序中，命令行参数以字符串数组的形式传递给`main`方法。`args`数组的长度取决于传递的参数数量，数组中的每个元素代表一个参数。

```java
public class CommandLineExample {
    public static void main(String[] args) {
        System.out.println("接收到的参数数量: " + args.length);
        
        for (int i = 0; i < args.length; i++) {
            System.out.println("参数 " + i + ": " + args[i]);
        }
    }
}
```

运行这个程序时，如果输入：

```bash
java CommandLineExample hello world 123
```

输出结果将是：

```
接收到的参数数量: 3
参数 0: hello
参数 1: world
参数 2: 123
```

:::note
参数之间用空格分隔。如果参数本身包含空格，则需要用引号将参数括起来，例如：`"hello world"`将被视为一个参数而不是两个。
:::

## 参数解析与类型转换

命令行参数总是以字符串形式传递，如果需要将它们转换为其他类型（如整数、浮点数等），需要进行显式类型转换。

```java
public class ArgumentTypeExample {
    public static void main(String[] args) {
        if (args.length < 2) {
            System.out.println("请提供两个数字作为参数");
            return;
        }
        
        try {
            // 将字符串参数转换为整数
            int num1 = Integer.parseInt(args[0]);
            int num2 = Integer.parseInt(args[1]);
            
            System.out.println(num1 + " + " + num2 + " = " + (num1 + num2));
        } catch (NumberFormatException e) {
            System.out.println("参数必须是有效的整数");
        }
    }
}
```

运行这个程序：

```bash
java ArgumentTypeExample 5 7
```

输出结果：

```
5 + 7 = 12
```

如果输入的不是有效整数：

```bash
java ArgumentTypeExample 5 hello
```

输出结果：

```
参数必须是有效的整数
```

## 处理命令行选项

有时我们需要处理更复杂的命令行选项，比如带有标志的参数（如`-f filename`或`--verbose`）。可以通过解析`args`数组手动实现这一功能，或者使用专门的库，如Apache Commons CLI。

下面是一个简单的手动解析示例：

```java
public class CommandLineOptions {
    public static void main(String[] args) {
        String filename = null;
        boolean verbose = false;
        
        for (int i = 0; i < args.length; i++) {
            switch (args[i]) {
                case "-f":
                case "--file":
                    if (i + 1 < args.length) {
                        filename = args[++i];
                    } else {
                        System.out.println("错误: 需要指定文件名");
                        return;
                    }
                    break;
                case "-v":
                case "--verbose":
                    verbose = true;
                    break;
                default:
                    System.out.println("未知选项: " + args[i]);
                    return;
            }
        }
        
        System.out.println("文件名: " + (filename != null ? filename : "未指定"));
        System.out.println("详细模式: " + (verbose ? "开启" : "关闭"));
    }
}
```

运行示例：

```bash
java CommandLineOptions -f data.txt --verbose
```

输出结果：

```
文件名: data.txt
详细模式: 开启
```

:::tip
对于复杂的命令行参数解析，建议使用第三方库，如Apache Commons CLI、JCommander或picocli。这些库提供了更丰富的功能，如参数验证、自动生成帮助信息等。
:::

## 实际应用案例

### 案例1：简单计算器

以下是一个使用命令行参数实现的简单计算器：

```java
public class Calculator {
    public static void main(String[] args) {
        if (args.length != 3) {
            System.out.println("用法: java Calculator 数字1 运算符 数字2");
            System.out.println("支持的运算符: +, -, *, /");
            return;
        }
        
        try {
            double num1 = Double.parseDouble(args[0]);
            String operator = args[1];
            double num2 = Double.parseDouble(args[2]);
            double result = 0;
            
            switch (operator) {
                case "+":
                    result = num1 + num2;
                    break;
                case "-":
                    result = num1 - num2;
                    break;
                case "*":
                    result = num1 * num2;
                    break;
                case "/":
                    if (num2 == 0) {
                        System.out.println("错误: 除数不能为零");
                        return;
                    }
                    result = num1 / num2;
                    break;
                default:
                    System.out.println("不支持的运算符: " + operator);
                    return;
            }
            
            System.out.println(num1 + " " + operator + " " + num2 + " = " + result);
        } catch (NumberFormatException e) {
            System.out.println("参数必须是有效的数字");
        }
    }
}
```

使用示例：

```bash
java Calculator 10 + 5
```

输出：

```
10.0 + 5.0 = 15.0
```

### 案例2：文件处理工具

下面是一个使用命令行参数的简单文件处理工具：

```java
import java.io.*;

public class FileProcessor {
    public static void main(String[] args) {
        String inputFile = null;
        String outputFile = null;
        boolean uppercase = false;
        
        for (int i = 0; i < args.length; i++) {
            switch (args[i]) {
                case "-i":
                    if (i + 1 < args.length) {
                        inputFile = args[++i];
                    }
                    break;
                case "-o":
                    if (i + 1 < args.length) {
                        outputFile = args[++i];
                    }
                    break;
                case "-u":
                    uppercase = true;
                    break;
                case "-h":
                case "--help":
                    printHelp();
                    return;
                default:
                    System.out.println("未知选项: " + args[i]);
                    printHelp();
                    return;
            }
        }
        
        if (inputFile == null) {
            System.out.println("错误: 需要指定输入文件");
            printHelp();
            return;
        }
        
        if (outputFile == null) {
            outputFile = inputFile + ".out";
        }
        
        try {
            processFile(inputFile, outputFile, uppercase);
            System.out.println("处理完成。输出文件: " + outputFile);
        } catch (IOException e) {
            System.out.println("文件处理错误: " + e.getMessage());
        }
    }
    
    private static void processFile(String inputFile, String outputFile, boolean uppercase) 
            throws IOException {
        try (BufferedReader reader = new BufferedReader(new FileReader(inputFile));
             BufferedWriter writer = new BufferedWriter(new FileWriter(outputFile))) {
            
            String line;
            while ((line = reader.readLine()) != null) {
                if (uppercase) {
                    line = line.toUpperCase();
                }
                writer.write(line);
                writer.newLine();
            }
        }
    }
    
    private static void printHelp() {
        System.out.println("用法: java FileProcessor [选项]");
        System.out.println("选项:");
        System.out.println("  -i <file>    指定输入文件");
        System.out.println("  -o <file>    指定输出文件");
        System.out.println("  -u           转换为大写");
        System.out.println("  -h, --help   显示帮助信息");
    }
}
```

使用示例：

```bash
java FileProcessor -i input.txt -o output.txt -u
```

## 最佳实践

1. **始终验证参数**：检查参数的数量和类型，并为缺失或无效参数提供适当的错误消息。
2. **提供帮助信息**：为用户提供关于如何使用程序的说明，尤其是当参数无效或用户请求帮助时。
3. **使用有意义的参数名**：选择清晰、描述性的参数名，使命令行更易于理解和使用。
4. **处理错误情况**：优雅地处理错误，提供有用的错误消息，而不是让程序崩溃。
5. **考虑使用第三方库**：对于复杂的命令行解析需求，考虑使用专门的第三方库。

## 总结

Java命令行参数提供了一种灵活的方式，使用户可以在运行时向程序传递信息。通过`main`方法的`String[] args`参数，Java程序可以访问这些命令行参数，并根据需要进行处理。理解和正确使用命令行参数对于构建灵活、交互式的Java应用程序至关重要。

从简单的参数访问到复杂的命令行选项解析，本文介绍了Java命令行参数的各个方面，并提供了实际的应用案例。掌握这些技能将帮助你创建更加强大和用户友好的Java程序。

## 练习

1. 创建一个Java程序，接受两个命令行参数作为文件名，将第一个文件的内容复制到第二个文件中。
2. 编写一个程序，接受一个目录路径作为命令行参数，并列出该目录下的所有文件和子目录。
3. 实现一个简单的命令行文本编辑器，可以通过命令行参数指定要打开的文件，并提供保存、查看和编辑内容的选项。
4. 扩展计算器案例，支持更多的运算符和多个操作数。
5. 尝试使用Apache Commons CLI库重新实现FileProcessor案例，体验专业命令行解析库的优势。