---
title: C# 多个异常捕获
description: 学习如何在C#中捕获多个异常，掌握异常处理的最佳实践，并通过实际案例理解其应用场景。
---

# C# 多个异常捕获

在C#编程中，异常处理是确保程序健壮性和稳定性的重要手段。当程序运行时，可能会遇到各种不可预见的错误，例如文件未找到、网络连接中断或空引用异常等。为了处理这些异常，C#提供了`try-catch`语句。然而，在某些情况下，我们可能需要捕获多种不同类型的异常，并对它们进行不同的处理。这时，**多个异常捕获**就显得尤为重要。

## 什么是多个异常捕获？

多个异常捕获是指在`try-catch`语句中使用多个`catch`块，每个`catch`块专门处理一种特定类型的异常。通过这种方式，我们可以根据不同的异常类型执行不同的处理逻辑，从而更精确地控制程序的错误处理流程。

## 基本语法

以下是C#中多个异常捕获的基本语法：

```csharp
try
{
    // 可能会抛出异常的代码
}
catch (SpecificExceptionType1 ex)
{
    // 处理 SpecificExceptionType1 类型的异常
}
catch (SpecificExceptionType2 ex)
{
    // 处理 SpecificExceptionType2 类型的异常
}
catch (Exception ex)
{
    // 处理所有其他类型的异常
}
```

在这个语法中，`try`块包含可能会抛出异常的代码。每个`catch`块捕获特定类型的异常，并执行相应的处理逻辑。最后一个`catch`块捕获`Exception`类型，这是一个通用的异常类型，可以捕获所有未被前面`catch`块处理的异常。

## 代码示例

让我们通过一个简单的例子来理解多个异常捕获的实际应用。假设我们有一个方法，该方法尝试读取一个文件并解析其中的内容。在这个过程中，可能会遇到文件未找到的异常（`FileNotFoundException`）或文件格式错误的异常（`FormatException`）。

```csharp
using System;
using System.IO;

class Program
{
    static void Main()
    {
        try
        {
            string filePath = "example.txt";
            string content = File.ReadAllText(filePath);
            int number = int.Parse(content);
            Console.WriteLine("Parsed number: " + number);
        }
        catch (FileNotFoundException ex)
        {
            Console.WriteLine("File not found: " + ex.Message);
        }
        catch (FormatException ex)
        {
            Console.WriteLine("Invalid file format: " + ex.Message);
        }
        catch (Exception ex)
        {
            Console.WriteLine("An unexpected error occurred: " + ex.Message);
        }
    }
}
```

### 输入和输出

假设`example.txt`文件不存在，程序将输出：

```
File not found: Could not find file 'example.txt'.
```

如果`example.txt`文件存在，但内容不是有效的整数（例如包含字母），程序将输出：

```
Invalid file format: Input string was not in a correct format.
```

如果发生其他类型的异常（例如权限问题），程序将输出：

```
An unexpected error occurred: [具体的异常信息]
```

## 实际应用场景

在实际开发中，多个异常捕获的应用场景非常广泛。以下是一些常见的例子：

1. **文件操作**：在读取或写入文件时，可能会遇到文件未找到、权限不足或文件格式错误等异常。
2. **网络请求**：在进行网络请求时，可能会遇到连接超时、服务器错误或数据格式错误等异常。
3. **数据库操作**：在访问数据库时，可能会遇到连接失败、SQL语法错误或数据冲突等异常。

通过使用多个异常捕获，我们可以针对不同的异常类型采取不同的处理措施，从而提高程序的健壮性和用户体验。

## 总结

在C#中，多个异常捕获是一种强大的工具，可以帮助我们更精确地处理不同类型的异常。通过使用多个`catch`块，我们可以根据异常的类型执行不同的处理逻辑，从而确保程序在遇到错误时能够优雅地恢复或退出。

:::tip
在实际开发中，建议始终捕获最具体的异常类型，并在最后使用`catch (Exception ex)`来捕获所有未被处理的异常。这样可以避免遗漏任何可能的错误情况。
:::

## 附加资源

- [C# 异常处理官方文档](https://learn.microsoft.com/zh-cn/dotnet/csharp/programming-guide/exceptions/)
- [C# 异常处理最佳实践](https://docs.microsoft.com/zh-cn/dotnet/standard/exceptions/best-practices-for-exceptions)

## 练习

1. 修改上面的代码示例，使其能够处理`IOException`类型的异常。
2. 编写一个程序，尝试从用户输入中读取一个整数，并处理可能出现的`FormatException`和`OverflowException`。

通过完成这些练习，你将更好地掌握C#中的多个异常捕获技术。