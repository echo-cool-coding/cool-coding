---
title: C# 委托实例化
description: 了解如何在C#中实例化委托，掌握委托的基本概念及其在实际编程中的应用。
---

## 介绍

在C#中，**委托（Delegate）**是一种类型安全的函数指针，它允许你将方法作为参数传递或存储。委托的实例化是使用委托的关键步骤之一。通过实例化委托，你可以将具体的方法与委托关联起来，从而在需要时调用这些方法。

本文将详细介绍如何在C#中实例化委托，并通过代码示例和实际案例帮助你理解这一概念。

## 委托的基本概念

委托是一种引用类型，它定义了方法的签名。你可以将委托看作是一个“方法模板”，它规定了方法的参数类型和返回类型。通过委托，你可以将方法作为参数传递给其他方法，或者将方法存储在变量中。

### 委托的声明

在C#中，委托的声明类似于方法的声明，但需要使用 `delegate` 关键字。例如：

```csharp
delegate int MyDelegate(int x, int y);
```

上面的代码声明了一个名为 `MyDelegate` 的委托，它接受两个 `int` 类型的参数，并返回一个 `int` 类型的值。

## 委托的实例化

要使用委托，首先需要实例化它。实例化委托的过程就是将具体的方法与委托关联起来。C#提供了多种方式来实例化委托。

### 1. 使用命名方法实例化委托

最常见的方式是使用命名方法来实例化委托。假设我们有一个方法 `Add`，它接受两个 `int` 类型的参数并返回它们的和：

```csharp
int Add(int x, int y)
{
    return x + y;
}
```

我们可以通过以下方式实例化委托：

```csharp
MyDelegate del = new MyDelegate(Add);
```

现在，`del` 委托实例指向 `Add` 方法。你可以通过调用 `del` 来执行 `Add` 方法：

```csharp
int result = del(3, 5); // 输出：8
```

### 2. 使用匿名方法实例化委托

C# 2.0 引入了匿名方法，允许你在实例化委托时直接定义方法体，而不需要显式地声明一个命名方法。例如：

```csharp
MyDelegate del = delegate(int x, int y)
{
    return x + y;
};
```

这种方式可以让你在不定义额外方法的情况下直接实例化委托。

### 3. 使用Lambda表达式实例化委托

C# 3.0 引入了Lambda表达式，它提供了一种更简洁的方式来实例化委托。Lambda表达式是一种匿名函数，可以用于创建委托实例。例如：

```csharp
MyDelegate del = (x, y) => x + y;
```

上面的代码使用Lambda表达式实例化了一个委托，它与前面的匿名方法实例化方式功能相同，但语法更加简洁。

## 实际应用场景

委托在实际编程中有广泛的应用，特别是在事件处理和回调机制中。以下是一个简单的实际案例，展示了如何使用委托来实现一个简单的计算器。

### 案例：简单计算器

假设我们需要实现一个简单的计算器，它可以执行加、减、乘、除操作。我们可以使用委托来封装这些操作：

```csharp
delegate int CalculatorDelegate(int x, int y);

class Program
{
    static void Main(string[] args)
    {
        CalculatorDelegate add = (x, y) => x + y;
        CalculatorDelegate subtract = (x, y) => x - y;
        CalculatorDelegate multiply = (x, y) => x * y;
        CalculatorDelegate divide = (x, y) => x / y;

        int result1 = add(10, 5);       // 输出：15
        int result2 = subtract(10, 5);   // 输出：5
        int result3 = multiply(10, 5);  // 输出：50
        int result4 = divide(10, 5);     // 输出：2

        Console.WriteLine($"Addition: {result1}");
        Console.WriteLine($"Subtraction: {result2}");
        Console.WriteLine($"Multiplication: {result3}");
        Console.WriteLine($"Division: {result4}");
    }
}
```

在这个案例中，我们使用委托来封装不同的计算操作，并通过委托实例来调用这些操作。这种方式使得代码更加灵活和可扩展。

## 总结

委托是C#中一个强大的特性，它允许你将方法作为参数传递或存储。通过实例化委托，你可以将具体的方法与委托关联起来，从而在需要时调用这些方法。本文介绍了如何使用命名方法、匿名方法和Lambda表达式来实例化委托，并通过一个简单的计算器案例展示了委托的实际应用。

:::tip
如果你想进一步学习委托的高级用法，可以探索多播委托、事件和LINQ等内容。
:::

## 附加资源

- [C# 委托官方文档](https://learn.microsoft.com/zh-cn/dotnet/csharp/programming-guide/delegates/)
- [C# Lambda表达式官方文档](https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/operators/lambda-expressions)

## 练习

1. 声明一个委托 `StringDelegate`，它接受一个 `string` 类型的参数并返回 `void`。使用命名方法、匿名方法和Lambda表达式分别实例化该委托，并调用它们。
2. 创建一个委托数组，存储多个不同的计算操作（如加、减、乘、除），并通过循环调用这些委托来执行计算。