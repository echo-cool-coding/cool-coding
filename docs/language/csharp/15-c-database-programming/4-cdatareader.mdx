---
title: C# 数据读取器
description: 了解如何使用 C# 数据读取器从数据库中高效读取数据。本文适合初学者，包含代码示例、实际案例和详细解释。
---

# C# 数据读取器

在 C# 数据库编程中，数据读取器（`DataReader`）是一个用于从数据库中高效读取数据的工具。与数据集（`DataSet`）不同，数据读取器提供了一种只读、只进的方式访问数据，适用于需要快速读取大量数据的场景。

## 什么是 C# 数据读取器？

`DataReader` 是 ADO.NET 中的一个核心组件，用于从数据库中逐行读取数据。它通过 `Command` 对象执行 SQL 查询，并返回一个只读、只进的数据流。由于 `DataReader` 不缓存数据，因此它在处理大量数据时非常高效。

:::note
`DataReader` 是一个轻量级的对象，适用于需要快速读取数据的场景。如果你需要对数据进行复杂的操作或缓存数据，请考虑使用 `DataSet`。
:::

## 如何使用 C# 数据读取器？

要使用 `DataReader`，首先需要创建一个 `Command` 对象，然后调用 `ExecuteReader` 方法。以下是一个简单的示例：

```csharp
using System;
using System.Data.SqlClient;

class Program
{
    static void Main()
    {
        string connectionString = "YourConnectionStringHere";
        string query = "SELECT * FROM Customers";

        using (SqlConnection connection = new SqlConnection(connectionString))
        {
            connection.Open();
            using (SqlCommand command = new SqlCommand(query, connection))
            {
                using (SqlDataReader reader = command.ExecuteReader())
                {
                    while (reader.Read())
                    {
                        Console.WriteLine($"Customer ID: {reader["CustomerID"]}, Name: {reader["Name"]}");
                    }
                }
            }
        }
    }
}
```

### 代码解释

1. **连接字符串**：`connectionString` 是用于连接到数据库的字符串。
2. **SQL 查询**：`query` 是要执行的 SQL 查询。
3. **SqlConnection**：用于建立与数据库的连接。
4. **SqlCommand**：用于执行 SQL 查询。
5. **SqlDataReader**：用于读取查询结果。

### 输出示例

假设数据库中的 `Customers` 表有以下数据：

| CustomerID | Name       |
|------------|------------|
| 1          | John Doe   |
| 2          | Jane Smith |

运行上述代码后，输出将是：

```
Customer ID: 1, Name: John Doe
Customer ID: 2, Name: Jane Smith
```

## 实际应用场景

### 场景 1：读取大量数据

假设你有一个包含数百万条记录的表，并且需要快速读取这些数据以生成报告。使用 `DataReader` 可以避免将整个数据集加载到内存中，从而提高性能。

### 场景 2：实时数据处理

在某些实时数据处理场景中，数据需要立即处理而不需要缓存。`DataReader` 的只进特性使其非常适合这种需求。

## 总结

`DataReader` 是 C# 数据库编程中一个强大的工具，特别适用于需要高效读取大量数据的场景。通过本文，你应该已经了解了如何使用 `DataReader` 从数据库中读取数据，并掌握了其在实际应用中的使用方法。

## 附加资源

- [ADO.NET 官方文档](https://docs.microsoft.com/en-us/dotnet/framework/data/adonet/)
- [C# 数据库编程教程](https://www.tutorialspoint.com/csharp/csharp_database_access.htm)

## 练习

1. 修改上述代码，使其只读取 `Customers` 表中 `CustomerID` 大于 10 的记录。
2. 尝试使用 `DataReader` 读取另一个表的数据，并将结果输出到控制台。

通过完成这些练习，你将更深入地理解 `DataReader` 的使用方法。