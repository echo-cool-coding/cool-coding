---
title: C# 连接数据库
description: "学习如何使用C#连接数据库，掌握基本的数据库操作，包括连接、查询和更新数据。"
---

# C# 连接数据库

在现代应用程序开发中，数据库是不可或缺的一部分。无论是存储用户信息、管理订单，还是记录日志，数据库都扮演着重要角色。C#作为一种强大的编程语言，提供了多种方式来连接和操作数据库。本文将带你从零开始，学习如何使用C#连接数据库，并进行基本的数据库操作。

## 1. 什么是数据库连接？

数据库连接是指应用程序与数据库之间的通信通道。通过这个通道，应用程序可以发送查询请求、接收数据，并对数据库进行更新操作。在C#中，我们通常使用ADO.NET库来实现与数据库的交互。

## 2. 连接数据库的基本步骤

在C#中连接数据库通常包括以下几个步骤：

1. **创建连接字符串**：连接字符串包含了连接数据库所需的所有信息，如数据库类型、服务器地址、数据库名称、用户名和密码等。
2. **创建连接对象**：使用连接字符串创建一个数据库连接对象。
3. **打开连接**：调用连接对象的`Open()`方法，建立与数据库的连接。
4. **执行SQL命令**：通过连接对象执行SQL查询或命令。
5. **处理结果**：获取查询结果或处理命令执行后的反馈。
6. **关闭连接**：操作完成后，关闭数据库连接以释放资源。

## 3. 使用ADO.NET连接数据库

ADO.NET是C#中用于访问数据库的核心库。它提供了多种类来帮助我们连接和操作数据库。下面是一个简单的示例，展示如何使用ADO.NET连接SQL Server数据库。

### 3.1 创建连接字符串

连接字符串是连接数据库的关键。以下是一个典型的SQL Server连接字符串：

```csharp
string connectionString = "Server=myServerAddress;Database=myDataBase;User Id=myUsername;Password=myPassword;";
```

### 3.2 创建连接对象

使用`SqlConnection`类来创建连接对象：

```csharp
using System.Data.SqlClient;

SqlConnection connection = new SqlConnection(connectionString);
```

### 3.3 打开连接

调用`Open()`方法打开连接：

```csharp
connection.Open();
```

### 3.4 执行SQL命令

使用`SqlCommand`类来执行SQL命令。以下是一个查询示例：

```csharp
string query = "SELECT * FROM Customers";
SqlCommand command = new SqlCommand(query, connection);
```

### 3.5 处理结果

使用`SqlDataReader`来读取查询结果：

```csharp
SqlDataReader reader = command.ExecuteReader();
while (reader.Read())
{
    Console.WriteLine(reader["CustomerName"].ToString());
}
```

### 3.6 关闭连接

操作完成后，关闭连接：

```csharp
connection.Close();
```

## 4. 实际案例：查询用户信息

假设我们有一个名为`Users`的表，其中包含用户的`ID`、`Name`和`Email`字段。以下是一个完整的示例，展示如何查询所有用户信息并打印到控制台：

```csharp
using System;
using System.Data.SqlClient;

class Program
{
    static void Main()
    {
        string connectionString = "Server=myServerAddress;Database=myDataBase;User Id=myUsername;Password=myPassword;";
        using (SqlConnection connection = new SqlConnection(connectionString))
        {
            connection.Open();
            string query = "SELECT * FROM Users";
            SqlCommand command = new SqlCommand(query, connection);
            SqlDataReader reader = command.ExecuteReader();
            while (reader.Read())
            {
                Console.WriteLine($"ID: {reader["ID"]}, Name: {reader["Name"]}, Email: {reader["Email"]}");
            }
            connection.Close();
        }
    }
}
```

:::note
在实际开发中，建议使用`using`语句来确保连接对象在使用后自动关闭，以避免资源泄漏。
:::

## 5. 总结

通过本文，你已经学会了如何使用C#连接数据库，并执行基本的查询操作。数据库连接是C#编程中的重要部分，掌握这些基础知识将为你后续的学习打下坚实的基础。

## 6. 附加资源与练习

- **练习**：尝试修改上面的代码，使其能够插入一条新的用户记录到`Users`表中。
- **进一步学习**：了解如何使用`SqlDataAdapter`和`DataSet`来处理更复杂的数据库操作。
- **参考文档**：[ADO.NET官方文档](https://docs.microsoft.com/en-us/dotnet/framework/data/adonet/)

希望本文对你有所帮助，祝你在C#数据库编程的学习中取得更多进展！