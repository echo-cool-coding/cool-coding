---
title: Python 常量
description: 学习Python中常量的概念、命名规范、实现方式以及在实际项目中的应用。本文适合Python初学者了解如何在代码中正确使用常量。
---

# Python 常量

## 什么是常量？

在编程中，常量(constant)是指一旦定义后，其值不应该在程序执行过程中被改变的变量。常量通常用于存储那些在整个程序中固定不变的值，如数学常数、配置参数或者固定的字符串。

:::note
与其他许多编程语言不同，Python并没有内置的机制来创建真正意义上的常量。也就是说，Python没有`const`这样的关键字来声明一个变量为常量。
:::

尽管如此，Python社区已经形成了一些约定俗成的做法来实现和使用常量。

## Python 中的常量约定

在Python中，常量通常遵循以下约定：

1. **全大写命名**：常量名称通常使用全大写字母，单词之间用下划线连接
2. **模块级别定义**：常量通常在模块级别定义
3. **约定俗成而非强制**：由于Python的动态特性，即使是"常量"也可以被重新赋值，因此遵守常量不变的规则主要依靠开发者的自律

下面是一个简单的例子，展示了如何在Python中定义和使用常量：

```python
# 定义常量
PI = 3.14159
MAX_CONNECTIONS = 100
DEFAULT_USERNAME = "admin"

# 使用常量
def calculate_circle_area(radius):
    return PI * radius * radius

print(f"圆的面积: {calculate_circle_area(5)}")
print(f"最大连接数: {MAX_CONNECTIONS}")
```

输出：
```
圆的面积: 78.53975
最大连接数: 100
```

## 实现"真正的"常量

虽然Python没有提供原生的常量支持，但我们可以通过一些技巧来模拟常量的行为。

### 1. 使用类属性

```python
class Constants:
    PI = 3.14159
    GRAVITY = 9.8
    MAX_USERS = 100

# 使用常量
print(f"圆周率: {Constants.PI}")
print(f"重力加速度: {Constants.GRAVITY} m/s²")
```

输出：
```
圆周率: 3.14159
重力加速度: 9.8 m/s²
```

### 2. 使用命名空间模块

可以创建一个专门的`constants.py`文件来存储所有常量：

```python
# constants.py
PI = 3.14159
GRAVITY = 9.8
DATABASE_URL = "postgresql://localhost/mydb"
```

然后在其他文件中导入：

```python
import constants

def calculate_fall_time(height):
    return (2 * height / constants.GRAVITY) ** 0.5

print(f"从10米高处落下需要 {calculate_fall_time(10):.2f} 秒")
```

输出：
```
从10米高处落下需要 1.43 秒
```

### 3. 使用`dataclasses`和`frozen=True`

从Python 3.7开始，可以使用`dataclasses`模块创建不可变的数据类：

```python
from dataclasses import dataclass

@dataclass(frozen=True)
class MathConstants:
    PI: float = 3.14159
    E: float = 2.71828
    GOLDEN_RATIO: float = 1.61803

# 使用常量
math = MathConstants()
print(f"自然对数的底: {math.E}")
```

输出：
```
自然对数的底: 2.71828
```

:::caution
如果尝试修改frozen dataclass的属性，Python会抛出`FrozenInstanceError`异常。
:::

### 4. 使用`enum`模块

`enum`模块提供了一种定义常量集合的方式：

```python
from enum import Enum, auto

class Color(Enum):
    RED = "#FF0000"
    GREEN = "#00FF00"
    BLUE = "#0000FF"

class Status(Enum):
    PENDING = auto()
    RUNNING = auto()
    COMPLETED = auto()
    FAILED = auto()

# 使用枚举常量
print(f"红色的十六进制代码: {Color.RED.value}")
print(f"当前状态: {Status.RUNNING.name}")
```

输出：
```
红色的十六进制代码: #FF0000
当前状态: RUNNING
```

## Python 内置的常量

Python本身也预定义了一些内置常量，了解这些常量对于编程很有帮助：

### 布尔常量
```python
print(True)    # 布尔真
print(False)   # 布尔假
```

### 特殊常量
```python
print(None)    # 表示"无"或"空"的特殊常量

# __name__是一个特殊变量，如果当前模块是主模块，则其值为'__main__'
print(__name__)
```

### 数值相关常量
使用`math`模块中的常量：

```python
import math

print(f"π (Pi): {math.pi}")
print(f"e (自然对数底): {math.e}")
print(f"无穷大: {math.inf}")
print(f"非数字: {math.nan}")
```

输出：
```
π (Pi): 3.141592653589793
e (自然对数底): 2.718281828459045
无穷大: inf
非数字: nan
```

## 常量的实际应用场景

常量在实际开发中有着广泛的应用，下面是一些典型的使用场景：

### 1. 配置信息

```python
# config.py
DATABASE_HOST = "localhost"
DATABASE_PORT = 5432
DATABASE_NAME = "myapp"
API_KEY = "sk_test_abcdefghijklmnopqrstuvwxyz"
MAX_RETRY_COUNT = 3
REQUEST_TIMEOUT = 30  # 秒
```

### 2. 数学或物理计算

```python
import math

# 物理常量
SPEED_OF_LIGHT = 299792458  # 米/秒
PLANCK_CONSTANT = 6.62607015e-34  # J·s

# 使用常量进行计算
def energy_from_mass(mass_kg):
    """根据E=mc²计算质能"""
    return mass_kg * SPEED_OF_LIGHT**2

# 计算1克物质蕴含的能量(焦耳)
energy = energy_from_mass(0.001)
print(f"1克物质蕴含的能量: {energy:.2e} 焦耳")
```

输出：
```
1克物质蕴含的能量: 8.99e+13 焦耳
```

### 3. 状态和错误码

```python
# 用户状态
USER_STATUS_ACTIVE = 1
USER_STATUS_INACTIVE = 0
USER_STATUS_SUSPENDED = -1

# HTTP状态码
HTTP_OK = 200
HTTP_CREATED = 201
HTTP_BAD_REQUEST = 400
HTTP_UNAUTHORIZED = 401
HTTP_FORBIDDEN = 403
HTTP_NOT_FOUND = 404
HTTP_SERVER_ERROR = 500

def handle_response(status_code):
    if status_code == HTTP_OK:
        return "请求成功"
    elif status_code == HTTP_NOT_FOUND:
        return "未找到请求的资源"
    elif status_code == HTTP_SERVER_ERROR:
        return "服务器内部错误"
    else:
        return f"未处理的状态码: {status_code}"
```

### 4. 屏幕尺寸和UI布局

```python
# 窗口尺寸
WINDOW_WIDTH = 800
WINDOW_HEIGHT = 600

# 颜色定义
COLOR_WHITE = (255, 255, 255)
COLOR_BLACK = (0, 0, 0)
COLOR_RED = (255, 0, 0)
COLOR_PRIMARY = "#0066cc"
COLOR_SECONDARY = "#6c757d"

# 边距和间距
MARGIN_SMALL = 8
MARGIN_MEDIUM = 16
MARGIN_LARGE = 24
```

### 5. 文件路径和目录

```python
import os

# 项目目录结构
BASE_DIR = os.path.dirname(os.path.abspath(__file__))
DATA_DIR = os.path.join(BASE_DIR, "data")
LOGS_DIR = os.path.join(BASE_DIR, "logs")
CONFIG_PATH = os.path.join(BASE_DIR, "config.ini")

# 确保目录存在
os.makedirs(DATA_DIR, exist_ok=True)
os.makedirs(LOGS_DIR, exist_ok=True)
```

## 常量的最佳实践

在使用Python常量时，以下是一些最佳实践：

1. **命名明确**：常量名应该清晰表达其用途
2. **集中管理**：将相关的常量集中在一个模块或类中
3. **避免硬编码**：使用常量代替代码中的硬编码值
4. **适当注释**：为常量添加适当的注释，特别是对于不那么直观的数值
5. **注意作用域**：根据常量的使用范围，合理放置在模块、包或配置文件中

## 总结

尽管Python没有提供原生的常量支持，但通过遵循命名约定和使用适当的设计模式，我们可以在Python程序中有效地使用常量。常量使代码更加清晰、易于维护，并减少了因硬编码值而引起的错误。

在实际开发中，常量常用于配置、状态定义、数学计算、UI设计等场景，是编写优质Python代码的重要组成部分。

## 练习

1. 创建一个名为`math_constants.py`的文件，定义常用的数学常量，如圆周率、自然对数底、黄金比例等。
2. 编写一个简单的游戏程序，使用常量定义游戏窗口大小、角色移动速度、颜色等。
3. 设计一个配置系统，使用Python的常量模式存储应用程序的配置信息。
4. 创建一个使用`enum`模块定义状态常量的示例，例如订单状态、任务状态等。
5. 思考：如何确保团队成员不会意外地修改常量值？你会采取什么措施来防止这种情况？

:::tip 进阶学习
如果你想进一步了解Python中的常量使用，可以探索一些第三方库，如`python-dotenv`(用于环境变量管理)和`pydantic`(用于数据验证和设置管理)。
:::