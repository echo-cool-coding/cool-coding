---
title: TypeScript 模块解析
description: 了解 TypeScript 模块解析的工作原理，掌握如何配置模块解析策略，以及在实际项目中应用模块解析的最佳实践。
---

# TypeScript 模块解析

TypeScript 是一种强类型的 JavaScript 超集，它引入了模块系统来帮助开发者更好地组织代码。模块解析是 TypeScript 中一个重要的概念，它决定了 TypeScript 编译器如何查找和解析模块。本文将详细介绍 TypeScript 模块解析的工作原理、配置方法以及实际应用场景。

## 什么是模块解析？

在 TypeScript 中，模块解析是指编译器在编译过程中如何查找和解析模块的过程。当你使用 `import` 或 `require` 语句引入一个模块时，TypeScript 编译器需要确定该模块的实际路径。这个过程就是模块解析。

TypeScript 支持两种模块解析策略：

1. **Classic 模式**：这是 TypeScript 早期的模块解析策略，主要用于向后兼容。
2. **Node 模式**：这是 TypeScript 默认的模块解析策略，它模仿了 Node.js 的模块解析机制。

## 模块解析策略

### Classic 模式

在 Classic 模式下，TypeScript 编译器会按照以下顺序查找模块：

1. 查找与导入语句中指定的路径完全匹配的文件。
2. 如果找不到，则查找与导入路径匹配的 `.ts` 文件。
3. 如果仍然找不到，则查找与导入路径匹配的 `.d.ts` 文件。

例如，假设你有以下导入语句：

```typescript
import { MyModule } from "./myModule";
```

在 Classic 模式下，TypeScript 会依次查找以下文件：

1. `./myModule.ts`
2. `./myModule.d.ts`

### Node 模式

Node 模式是 TypeScript 默认的模块解析策略，它模仿了 Node.js 的模块解析机制。在 Node 模式下，TypeScript 编译器会按照以下顺序查找模块：

1. 查找与导入路径匹配的 `.ts` 文件。
2. 如果找不到，则查找与导入路径匹配的 `.tsx` 文件。
3. 如果仍然找不到，则查找与导入路径匹配的 `.d.ts` 文件。
4. 如果仍然找不到，则查找与导入路径匹配的目录下的 `index.ts` 文件。
5. 如果仍然找不到，则查找与导入路径匹配的目录下的 `index.tsx` 文件。
6. 如果仍然找不到，则查找与导入路径匹配的目录下的 `index.d.ts` 文件。

例如，假设你有以下导入语句：

```typescript
import { MyModule } from "./myModule";
```

在 Node 模式下，TypeScript 会依次查找以下文件：

1. `./myModule.ts`
2. `./myModule.tsx`
3. `./myModule.d.ts`
4. `./myModule/index.ts`
5. `./myModule/index.tsx`
6. `./myModule/index.d.ts`

## 配置模块解析策略

你可以在 `tsconfig.json` 文件中配置模块解析策略。默认情况下，TypeScript 使用 Node 模式。如果你想使用 Classic 模式，可以在 `tsconfig.json` 中添加以下配置：

```json
{
  "compilerOptions": {
    "moduleResolution": "classic"
  }
}
```

## 实际应用场景

### 场景 1：使用相对路径导入模块

假设你有一个项目结构如下：

```
project/
├── src/
│   ├── utils/
│   │   └── math.ts
│   └── index.ts
└── tsconfig.json
```

在 `math.ts` 文件中，你定义了一个简单的加法函数：

```typescript
// src/utils/math.ts
export function add(a: number, b: number): number {
  return a + b;
}
```

在 `index.ts` 文件中，你可以使用相对路径导入 `math.ts` 模块：

```typescript
// src/index.ts
import { add } from "./utils/math";

console.log(add(1, 2)); // 输出: 3
```

### 场景 2：使用绝对路径导入模块

在某些情况下，你可能希望使用绝对路径来导入模块。你可以通过配置 `baseUrl` 和 `paths` 来实现这一点。

在 `tsconfig.json` 中添加以下配置：

```json
{
  "compilerOptions": {
    "baseUrl": "./src",
    "paths": {
      "@utils/*": ["utils/*"]
    }
  }
}
```

然后，你可以在 `index.ts` 中使用绝对路径导入 `math.ts` 模块：

```typescript
// src/index.ts
import { add } from "@utils/math";

console.log(add(1, 2)); // 输出: 3
```

## 总结

TypeScript 模块解析是 TypeScript 编译器在编译过程中查找和解析模块的过程。TypeScript 支持两种模块解析策略：Classic 模式和 Node 模式。默认情况下，TypeScript 使用 Node 模式，它模仿了 Node.js 的模块解析机制。你可以通过配置 `tsconfig.json` 文件来调整模块解析策略。

在实际项目中，合理配置模块解析策略可以帮助你更好地组织代码，提高代码的可维护性和可读性。

## 附加资源

- [TypeScript 官方文档 - 模块解析](https://www.typescriptlang.org/docs/handbook/module-resolution.html)
- [Node.js 模块解析机制](https://nodejs.org/api/modules.html#modules_all_together)

## 练习

1. 创建一个 TypeScript 项目，尝试使用相对路径和绝对路径导入模块。
2. 修改 `tsconfig.json` 文件，切换模块解析策略为 Classic 模式，观察编译结果的变化。
3. 在项目中创建一个 `index.ts` 文件，使用 `import` 语句导入多个模块，并确保模块解析正常工作。
