---
title: synchronized关键字
description: 了解Java中的synchronized关键字，掌握如何使用它来实现线程同步，确保多线程环境下的数据安全。
---

# synchronized关键字

在Java中，`synchronized`关键字用于控制多个线程对共享资源的访问，确保在同一时间只有一个线程可以执行特定的代码块或方法。这对于防止多线程环境下的数据竞争和不一致性至关重要。

## 什么是synchronized？

`synchronized`是Java中的一个关键字，用于实现线程同步。它可以应用于方法或代码块，确保在同一时间只有一个线程可以执行被`synchronized`修饰的代码。这样可以避免多个线程同时修改共享资源，从而防止数据不一致的问题。

## 如何使用synchronized？

`synchronized`关键字可以用于以下两种场景：

1. **同步方法**：将`synchronized`关键字放在方法声明中。
2. **同步代码块**：将`synchronized`关键字放在代码块中，并指定一个锁对象。

### 同步方法

当一个方法被`synchronized`修饰时，该方法在同一时间只能被一个线程执行。其他线程必须等待当前线程执行完毕后才能进入该方法。

```java
public class Counter {
    private int count = 0;

    public synchronized void increment() {
        count++;
    }

    public synchronized int getCount() {
        return count;
    }
}
```

在上面的例子中，`increment`和`getCount`方法都被`synchronized`修饰，因此它们在同一时间只能被一个线程访问。

### 同步代码块

`synchronized`关键字也可以用于代码块，此时需要指定一个锁对象。锁对象可以是任何Java对象，通常使用`this`关键字来引用当前对象。

```java
public class Counter {
    private int count = 0;
    private final Object lock = new Object();

    public void increment() {
        synchronized (lock) {
            count++;
        }
    }

    public int getCount() {
        synchronized (lock) {
            return count;
        }
    }
}
```

在这个例子中，`increment`和`getCount`方法中的代码块被`synchronized`修饰，并且使用了`lock`对象作为锁。这样可以确保在同一时间只有一个线程可以执行这些代码块。

## 实际应用场景

`synchronized`关键字在多线程编程中非常常见，特别是在需要保护共享资源的情况下。以下是一个实际应用场景：

### 银行账户转账

假设我们有一个银行账户类，多个线程可能会同时进行转账操作。为了防止多个线程同时修改账户余额，我们可以使用`synchronized`关键字来确保线程安全。

```java
public class BankAccount {
    private double balance;

    public BankAccount(double initialBalance) {
        this.balance = initialBalance;
    }

    public synchronized void deposit(double amount) {
        balance += amount;
    }

    public synchronized void withdraw(double amount) {
        if (balance >= amount) {
            balance -= amount;
        } else {
            System.out.println("Insufficient balance");
        }
    }

    public synchronized double getBalance() {
        return balance;
    }
}
```

在这个例子中，`deposit`、`withdraw`和`getBalance`方法都被`synchronized`修饰，确保在同一时间只有一个线程可以修改账户余额。

## 总结

`synchronized`关键字是Java中实现线程同步的重要工具。它可以用于方法或代码块，确保在同一时间只有一个线程可以访问共享资源，从而防止数据竞争和不一致性。通过合理使用`synchronized`，我们可以编写出线程安全的代码，确保多线程环境下的数据安全。

## 附加资源与练习

- **练习**：尝试编写一个多线程程序，使用`synchronized`关键字保护共享资源，并观察其行为。
- **进一步阅读**：了解Java中的其他同步机制，如`ReentrantLock`和`volatile`关键字。

:::tip
在使用`synchronized`时，尽量避免在方法级别使用，而是使用同步代码块来减少锁的粒度，从而提高性能。
:::

:::caution
过度使用`synchronized`可能会导致性能问题，因为它会阻止其他线程访问被锁定的资源。因此，在使用`synchronized`时要谨慎，确保只在必要时使用。
:::