---
title: SQL联结表
description: 学习如何使用SQL联结表，掌握内联结、左联结、右联结和全联结的基本概念和应用场景。
---

# SQL联结表

在关系型数据库中，数据通常分散在多个表中。为了从这些表中提取有意义的信息，我们需要使用SQL的联结（JOIN）功能。联结允许我们将多个表中的数据组合在一起，基于某些条件进行匹配。本文将详细介绍SQL中的联结类型及其使用方法。

## 什么是SQL联结？

SQL联结是一种将两个或多个表中的行基于相关列进行组合的操作。通过联结，我们可以从多个表中提取数据，并将它们合并成一个结果集。联结的核心是**条件匹配**，即基于某些列的值是否相等来决定是否将行组合在一起。

### 联结的类型

SQL支持多种类型的联结，主要包括：

1. **内联结（INNER JOIN）**
2. **左联结（LEFT JOIN）**
3. **右联结（RIGHT JOIN）**
4. **全联结（FULL JOIN）**

接下来，我们将逐一介绍这些联结类型。

## 内联结（INNER JOIN）

内联结是最常用的联结类型。它返回两个表中**匹配的行**。如果某一行在其中一个表中没有匹配的行，则该行不会出现在结果集中。

### 语法

```sql
SELECT 列名
FROM 表1
INNER JOIN 表2
ON 表1.列名 = 表2.列名;
```

### 示例

假设我们有两个表：`Customers` 和 `Orders`。

```sql
-- Customers 表
+----+----------+
| id | name     |
+----+----------+
| 1  | Alice    |
| 2  | Bob      |
| 3  | Charlie  |
+----+----------+

-- Orders 表
+----+------------+-------+
| id | order_date | amount|
+----+------------+-------+
| 1  | 2023-01-01 | 100   |
| 2  | 2023-01-02 | 200   |
| 3  | 2023-01-03 | 300   |
+----+------------+-------+
```

我们想要获取每个客户的订单信息：

```sql
SELECT Customers.name, Orders.order_date, Orders.amount
FROM Customers
INNER JOIN Orders
ON Customers.id = Orders.id;
```

### 输出

```sql
+-------+------------+--------+
| name  | order_date | amount |
+-------+------------+--------+
| Alice | 2023-01-01 | 100    |
| Bob   | 2023-01-02 | 200    |
| Charlie| 2023-01-03 | 300    |
+-------+------------+--------+
```

:::note
内联结只返回两个表中都有匹配的行。如果某个客户没有订单，或者某个订单没有对应的客户，这些行将不会出现在结果集中。
:::

## 左联结（LEFT JOIN）

左联结返回左表中的所有行，即使右表中没有匹配的行。如果右表中没有匹配的行，则结果集中右表的列将包含 `NULL`。

### 语法

```sql
SELECT 列名
FROM 表1
LEFT JOIN 表2
ON 表1.列名 = 表2.列名;
```

### 示例

继续使用 `Customers` 和 `Orders` 表，假设我们想要获取所有客户的订单信息，即使他们没有订单：

```sql
SELECT Customers.name, Orders.order_date, Orders.amount
FROM Customers
LEFT JOIN Orders
ON Customers.id = Orders.id;
```

### 输出

```sql
+-------+------------+--------+
| name  | order_date | amount |
+-------+------------+--------+
| Alice | 2023-01-01 | 100    |
| Bob   | 2023-01-02 | 200    |
| Charlie| 2023-01-03 | 300    |
| Dave  | NULL       | NULL   |
+-------+------------+--------+
```

:::tip
左联结非常适合用于查找“所有客户及其订单，即使他们没有订单”这样的场景。
:::

## 右联结（RIGHT JOIN）

右联结与左联结相反，它返回右表中的所有行，即使左表中没有匹配的行。如果左表中没有匹配的行，则结果集中左表的列将包含 `NULL`。

### 语法

```sql
SELECT 列名
FROM 表1
RIGHT JOIN 表2
ON 表1.列名 = 表2.列名;
```

### 示例

假设我们想要获取所有订单及其对应的客户信息，即使某些订单没有对应的客户：

```sql
SELECT Customers.name, Orders.order_date, Orders.amount
FROM Customers
RIGHT JOIN Orders
ON Customers.id = Orders.id;
```

### 输出

```sql
+-------+------------+--------+
| name  | order_date | amount |
+-------+------------+--------+
| Alice | 2023-01-01 | 100    |
| Bob   | 2023-01-02 | 200    |
| Charlie| 2023-01-03 | 300    |
| NULL  | 2023-01-04 | 400    |
+-------+------------+--------+
```

:::caution
右联结在实际应用中较少使用，通常可以通过左联结和表的顺序调整来实现相同的效果。
:::

## 全联结（FULL JOIN）

全联结返回左表和右表中的所有行。如果某一行在其中一个表中没有匹配的行，则结果集中缺失的列将包含 `NULL`。

### 语法

```sql
SELECT 列名
FROM 表1
FULL JOIN 表2
ON 表1.列名 = 表2.列名;
```

### 示例

假设我们想要获取所有客户和所有订单的信息，即使某些客户没有订单，或者某些订单没有对应的客户：

```sql
SELECT Customers.name, Orders.order_date, Orders.amount
FROM Customers
FULL JOIN Orders
ON Customers.id = Orders.id;
```

### 输出

```sql
+-------+------------+--------+
| name  | order_date | amount |
+-------+------------+--------+
| Alice | 2023-01-01 | 100    |
| Bob   | 2023-01-02 | 200    |
| Charlie| 2023-01-03 | 300    |
| Dave  | NULL       | NULL   |
| NULL  | 2023-01-04 | 400    |
+-------+------------+--------+
```

:::warning
全联结在某些数据库系统中可能不被支持，例如MySQL。在这种情况下，可以通过左联结和右联结的组合来实现全联结的效果。
:::

## 实际应用场景

### 场景1：电商系统中的订单与客户信息

在电商系统中，通常会有 `Customers` 表和 `Orders` 表。通过联结这两个表，我们可以轻松获取每个客户的订单信息，或者查找没有订单的客户。

### 场景2：员工与部门信息

在企业系统中，`Employees` 表和 `Departments` 表通常需要联结。通过联结，我们可以获取每个员工所属的部门信息，或者查找没有员工的部门。

## 总结

SQL联结是处理关系型数据库中多个表数据的重要工具。通过内联结、左联结、右联结和全联结，我们可以灵活地从多个表中提取所需的数据。掌握这些联结类型，将帮助你更好地处理复杂的数据库查询任务。

## 附加资源与练习

- **练习1**：创建一个包含 `Students` 和 `Courses` 表的数据库，并编写SQL查询，获取每个学生选修的课程。
- **练习2**：使用左联结查找所有没有选修任何课程的学生。
- **练习3**：使用全联结获取所有学生和所有课程的信息，即使某些学生没有选修课程，或者某些课程没有被任何学生选修。

:::tip
建议在实际数据库中尝试这些查询，以加深对SQL联结的理解。
:::