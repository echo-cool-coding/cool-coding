---
title: PRISM 验证自动化
description: 学习如何使用PRISM模型检测工具实现验证流程自动化，包括脚本编写、批量处理和结果分析的最佳实践。
---

# PRISM 验证自动化

## 介绍

PRISM（Probabilistic Symbolic Model Checker）是一个用于建模和分析概率系统的工具。验证自动化是指通过脚本和工具链将PRISM的建模、属性验证和结果分析过程标准化，减少人工干预，提高效率。本指南将介绍如何利用PRISM的命令行接口、脚本功能和第三方工具实现自动化验证。

---

## 基础自动化流程

### 1. 命令行基础
PRISM可通过命令行直接执行模型检查任务。基本语法如下：
```bash
prism model.pm properties.pctl -exportresults result.txt
```
- `model.pm`：PRISM模型文件
- `properties.pctl`：PCTL属性文件
- `-exportresults`：将结果导出到文本文件

:::tip
使用 `-javamaxmem` 参数可调整内存分配（例如 `-javamaxmem 4g` 分配4GB内存）
:::

### 2. 批量处理多个属性
创建包含多个属性的 `.pctl` 文件：
```pctl
// properties.pctl
P>=0.9 [ F "success" ] // 属性1
Pmax=? [ F<=10 "error" ] // 属性2
```

然后使用循环处理：
```bash
for prop in $(seq 1 2); do
  prism model.pm properties.pctl -prop $prop -exportresults result_$prop.txt
done
```

---

## 高级自动化技术

### 1. 参数化模型分析
通过PRISM的常量定义实现参数扫描：
```pm
// model_param.pm
const double p = 0.5; // 可被覆盖的参数
module System
  // ... 使用p的模型定义
endmodule
```

扫描参数范围：
```bash
for p_val in 0.1 0.2 0.3 0.4 0.5; do
  prism model_param.pm properties.pctl -const p=$p_val -exportresults result_p_$p_val.txt
done
```

### 2. 结果可视化
使用Python处理结果数据（需安装`matplotlib`）：
```python
import matplotlib.pyplot as plt
import numpy as np

p_values = [0.1, 0.2, 0.3, 0.4, 0.5]
results = [...] # 从result_p_*.txt提取的数据

plt.plot(p_values, results)
plt.xlabel('Failure probability (p)')
plt.ylabel('System reliability')
plt.show()
```

---

## 实际案例：网络协议验证

### 场景描述
验证一个重传协议在丢包环境下的可靠性：
1. 模型参数：`max_retrans=3`, `packet_loss=0.1`
2. 验证属性："在10步内成功传输的概率"

### 自动化脚本
```bash
#!/bin/bash
# verify_protocol.sh

MODEL="retransmit.pm"
PROPERTIES="protocol.pctl"
LOSS_RATES="0.05 0.1 0.15 0.2"

for loss in $LOSS_RATES; do
  prism $MODEL $PROPERTIES \
    -const packet_loss=$loss \
    -exportresults "loss_${loss}_result.csv" \
    -csv
done
```

### 结果分析
```mermaid
lineChart
    title 协议可靠性 vs 丢包率
    x-axis 丢包率 0.05, 0.1, 0.15, 0.2
    y-axis 成功概率
    series "10步内成功"
        0.95, 0.89, 0.82, 0.76
```

---

## 总结与扩展

### 关键收获
- 命令行接口是自动化的核心
- 参数扫描可实现系统行为的全面分析
- 结果导出格式（CSV/JSON）决定后续处理难度

### 推荐练习
1. 为您的模型创建包含5个属性的.pctl文件
2. 编写Shell脚本执行参数扫描（如改变初始状态）
3. 使用Python处理结果并生成折线图

### 扩展资源
- PRISM官方文档《Automating Experiments》章节
- GNU Parallel工具（用于并行化验证任务）
- Jupyter Notebook与PRISM的集成方案