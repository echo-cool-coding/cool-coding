---
title: PRISM 生物系统建模
description: 学习如何使用PRISM概率模型检测器对生物系统进行建模和分析，涵盖基础概念、案例实现与领域应用。
---

## 引言

PRISM（Probabilistic Symbolic Model Checker）是一个用于建模和分析概率系统的工具，在生物系统研究中具有广泛应用。通过形式化建模，PRISM可以帮助研究者量化生物过程中的随机性（如基因表达、信号传导），并验证其可靠性或性能指标。本章将介绍如何用PRISM构建生物系统模型，并通过案例演示分析流程。

---

## 生物系统建模基础

生物系统通常涉及以下特性，适合用PRISM建模：
1. **概率行为**：如分子相互作用的随机性。
2. **并发性**：多个生物过程并行发生（如代谢通路）。
3. **时间依赖性**：反应速率或延迟时间的影响。

PRISM支持以下模型类型：
- **离散时间马尔可夫链（DTMC）**：用于离散步骤的概率过程。
- **连续时间马尔可夫链（CTMC）**：适合带时间延迟的反应（如化学反应动力学）。

---

## 案例1：基因调控网络

### 问题描述
假设一个基因通过蛋白质产物自我调控，其表达概率受当前蛋白质浓度影响。我们将用DTMC建模该过程。

### PRISM 模型代码
```prism
// 定义蛋白质浓度范围（离散等级）
const int MAX_PROTEIN = 3;
formula is_activated = (protein >= 2); // 当蛋白质≥2时基因激活

module Gene
    protein : [0..MAX_PROTEIN] init 0; // 初始浓度为0

    // 基因表达（概率依赖当前状态）
    [express] is_activated -> 0.7 : (protein'=min(protein+1, MAX_PROTEIN)) + 0.3 : true;
    [express] !is_activated -> 0.5 : (protein'=min(protein+1, MAX_PROTEIN)) + 0.5 : true;

    // 蛋白质降解（固定概率）
    [degrade] true -> 0.1 : (protein'=max(protein-1, 0)) + 0.9 : true;
endmodule
```

### 属性验证示例
```prism
// 检查“蛋白质浓度最终达到最大值”的概率
P>=1 [ F protein=MAX_PROTEIN ]

// 计算稳态下蛋白质浓度为2的概率
S=? [ protein=2 ]
```

---

## 案例2：流行病传播模型（CTMC）

### 场景描述
用CTMC模拟病毒在群体中的传播，个体状态包括：易感（S）、感染（I）、康复（R）。

### PRISM 代码
```prism
const double infection_rate = 0.05; // 感染速率
const double recovery_rate = 0.1;  // 康复速率

module Individual
    state : [0..2] init 0; // 0=S, 1=I, 2=R

    [contact] state=0 -> infection_rate : state'=1; // 易感→感染
    [recover] state=1 -> recovery_rate : state'=2;  // 感染→康复
endmodule
```

### 分析输出
```mermaid
graph LR
    S[易感] --感染速率--> I[感染]
    I --康复速率--> R[康复]
```

验证属性示例：
```prism
// 计算10小时内感染概率
P=? [ F<=10 state=1 ]
```

---

## 实际应用场景

1. **药物作用预测**  
   建模药物分子与靶点的结合概率，优化给药方案。
2. **合成生物学**  
   验证人工基因电路设计的可靠性（如振荡器稳定性）。
3. **细胞信号通路**  
   分析MAPK等通路中信号传递的成功率。

:::tip 生物学参数获取
PRISM模型参数（如反应速率）常来自：
- 实验室测量数据
- 文献中的动力学常数
- 最大似然估计法拟合
:::

---

## 总结

通过PRISM对生物系统建模，可以：
- 量化随机性对生物过程的影响
- 预测系统长期行为（如稳态概率）
- 验证假设场景（如“抑制某反应是否降低病变概率”）

---

## 扩展练习

1. 修改基因调控模型，增加“抑制因子”变量，观察稳态变化。
2. 在流行病模型中引入疫苗接种状态，计算群体免疫阈值。

## 资源推荐
- PRISM官方案例库：`BioModels`目录
- 教材：《Computational Modeling of Biological Systems》