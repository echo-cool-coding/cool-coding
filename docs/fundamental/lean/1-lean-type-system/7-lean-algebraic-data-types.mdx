---
title: Lean 代数数据类型
description: "了解Lean中的代数数据类型（ADT），掌握如何定义和使用它们来构建复杂的数据结构。"
---

## 介绍

在Lean编程语言中，**代数数据类型**（Algebraic Data Types，简称ADT）是一种强大的工具，用于定义复杂的数据结构。通过ADT，你可以将数据组织成不同的形式，并为每种形式指定特定的行为。ADT的核心思想是将数据表示为“和类型”（Sum Types）和“积类型”（Product Types）的组合。

对于初学者来说，理解ADT是掌握Lean类型系统的关键一步。本文将逐步介绍ADT的概念，并通过代码示例和实际案例帮助你更好地理解。

## 什么是代数数据类型？

代数数据类型是一种复合类型，它允许你将多个类型组合在一起。在Lean中，ADT通常通过`inductive`关键字定义。ADT可以分为两类：

1. **和类型（Sum Types）**：表示“或”关系，即一个值可以是多种类型中的一种。
2. **积类型（Product Types）**：表示“与”关系，即一个值由多个类型的值组合而成。

### 和类型示例

假设我们要定义一个表示“形状”的类型，它可以是“圆形”或“矩形”。我们可以使用和类型来表示：

```lean
inductive Shape
| circle (radius : Float)
| rectangle (width : Float) (height : Float)
```

在这个例子中，`Shape`类型有两个构造函数：`circle`和`rectangle`。`circle`接受一个`Float`类型的参数`radius`，而`rectangle`接受两个`Float`类型的参数`width`和`height`。

### 积类型示例

积类型通常用于表示多个值的组合。例如，我们可以定义一个表示“点”的类型，它由两个`Float`类型的值组成：

```lean
structure Point where
  x : Float
  y : Float
```

在这个例子中，`Point`类型是一个积类型，因为它由两个字段`x`和`y`组成。

## 使用代数数据类型

定义ADT后，你可以使用模式匹配来处理不同的情况。例如，我们可以编写一个函数来计算不同形状的面积：

```lean
def area : Shape → Float
| Shape.circle r => 3.14 * r * r
| Shape.rectangle w h => w * h
```

在这个函数中，我们使用模式匹配来处理`Shape`类型的两种可能情况：`circle`和`rectangle`。对于`circle`，我们计算圆的面积；对于`rectangle`，我们计算矩形的面积。

### 示例输出

```lean
#eval area (Shape.circle 5.0)  -- 输出: 78.5
#eval area (Shape.rectangle 4.0 6.0)  -- 输出: 24.0
```

## 实际案例：表达式求值

让我们通过一个更复杂的例子来展示ADT的实际应用。假设我们要定义一个表示数学表达式的类型，并编写一个函数来求值这些表达式。

```lean
inductive Expr
| num (n : Float)
| add (e1 : Expr) (e2 : Expr)
| mul (e1 : Expr) (e2 : Expr)

def eval : Expr → Float
| Expr.num n => n
| Expr.add e1 e2 => eval e1 + eval e2
| Expr.mul e1 e2 => eval e1 * eval e2
```

在这个例子中，`Expr`类型表示数学表达式，它可以是数字、加法或乘法。`eval`函数递归地计算表达式的值。

### 示例输出

```lean
#eval eval (Expr.add (Expr.num 2.0) (Expr.mul (Expr.num 3.0) (Expr.num 4.0)))  -- 输出: 14.0
```

## 总结

代数数据类型是Lean中用于定义复杂数据结构的强大工具。通过和类型和积类型的组合，你可以构建出灵活且强大的数据类型。本文通过多个示例展示了如何定义和使用ADT，并提供了一个实际案例来帮助你理解其应用场景。

:::tip 提示
如果你想进一步练习，可以尝试定义一个表示二叉树的ADT，并编写一个函数来计算树的高度。
:::

## 附加资源

- [Lean官方文档](https://leanprover.github.io/)
- 《定理证明与编程》——一本关于Lean的入门书籍

通过本文的学习，你应该对Lean中的代数数据类型有了初步的了解。继续练习和探索，你将能够更熟练地使用ADT来解决实际问题。