---
title: Lean 匿名函数
description: "了解 Lean 中的匿名函数，掌握如何使用它们简化代码并提高表达力。本文适合初学者，包含清晰的解释、代码示例和实际应用场景。"
---

## 介绍

在 Lean 编程语言中，**匿名函数**（Anonymous Functions）是一种无需显式命名的函数。它们通常用于简化代码，尤其是在需要传递简单函数作为参数时。匿名函数的核心思想是“即用即弃”，它们不需要在全局作用域中定义，而是直接在需要的地方创建和使用。

匿名函数在函数式编程中非常常见，因为它们允许我们以更简洁的方式表达逻辑。在 Lean 中，匿名函数通过 `fun` 关键字定义。

## 基本语法

Lean 中的匿名函数使用以下语法：

```lean
fun (参数) => 表达式
```

- `fun` 是定义匿名函数的关键字。
- `(参数)` 是函数的输入参数。
- `=>` 是箭头符号，表示将参数映射到表达式。
- `表达式` 是函数的返回值。

### 示例 1：简单的匿名函数

以下是一个简单的匿名函数示例，它将输入的数字加 1：

```lean
#eval (fun (x : Nat) => x + 1) 5
```

**输入：**  
`5`

**输出：**  
`6`

在这个例子中，`fun (x : Nat) => x + 1` 定义了一个匿名函数，它接受一个自然数 `x` 并返回 `x + 1`。然后，我们通过 `#eval` 将这个函数应用于 `5`，得到结果 `6`。

## 逐步讲解

### 1. 匿名函数的作用

匿名函数的主要作用是简化代码。例如，如果你只需要一个简单的函数来执行一次操作，那么定义一个完整的命名函数可能显得冗余。匿名函数允许你在需要的地方直接定义并使用它。

### 2. 多参数匿名函数

匿名函数也可以接受多个参数。以下是一个接受两个参数的匿名函数示例：

```lean
#eval (fun (x : Nat) (y : Nat) => x + y) 3 4
```

**输入：**  
`3` 和 `4`

**输出：**  
`7`

在这个例子中，匿名函数 `fun (x : Nat) (y : Nat) => x + y` 接受两个自然数 `x` 和 `y`，并返回它们的和。

### 3. 匿名函数作为参数

匿名函数常用于高阶函数中，即接受函数作为参数的函数。以下是一个使用匿名函数作为参数的示例：

```lean
def applyTwice (f : Nat → Nat) (x : Nat) : Nat :=
  f (f x)

#eval applyTwice (fun (x : Nat) => x * 2) 3
```

**输入：**  
`3`

**输出：**  
`12`

在这个例子中，`applyTwice` 是一个高阶函数，它接受一个函数 `f` 和一个自然数 `x`，并将 `f` 应用于 `x` 两次。我们传递了一个匿名函数 `fun (x : Nat) => x * 2` 作为 `f`，它将输入的数字乘以 2。

## 实际案例

### 案例 1：列表映射

在 Lean 中，匿名函数常用于列表操作。例如，我们可以使用匿名函数来映射一个列表中的每个元素：

```lean
def doubleList (xs : List Nat) : List Nat :=
  xs.map (fun (x : Nat) => x * 2)

#eval doubleList [1, 2, 3, 4]
```

**输入：**  
`[1, 2, 3, 4]`

**输出：**  
`[2, 4, 6, 8]`

在这个例子中，`doubleList` 函数使用 `List.map` 方法将列表中的每个元素乘以 2。匿名函数 `fun (x : Nat) => x * 2` 被传递给 `map`，用于定义映射逻辑。

### 案例 2：过滤器

另一个常见的用例是使用匿名函数过滤列表中的元素：

```lean
def filterEven (xs : List Nat) : List Nat :=
  xs.filter (fun (x : Nat) => x % 2 == 0)

#eval filterEven [1, 2, 3, 4, 5, 6]
```

**输入：**  
`[1, 2, 3, 4, 5, 6]`

**输出：**  
`[2, 4, 6]`

在这个例子中，`filterEven` 函数使用 `List.filter` 方法过滤出列表中的偶数。匿名函数 `fun (x : Nat) => x % 2 == 0` 被传递给 `filter`，用于定义过滤条件。

## 总结

匿名函数是 Lean 中一个强大的工具，它们允许我们以简洁的方式定义和使用函数，尤其是在需要传递简单逻辑时。通过匿名函数，我们可以避免定义不必要的命名函数，从而使代码更加清晰和易读。

在实际编程中，匿名函数常用于高阶函数、列表操作（如映射和过滤）等场景。掌握匿名函数的使用将帮助你编写更高效的 Lean 代码。

## 附加资源与练习

### 练习 1
编写一个匿名函数，将输入的字符串转换为大写，并将其应用于字符串 `"hello"`。

### 练习 2
使用匿名函数和 `List.map`，将列表 `[1, 2, 3, 4, 5]` 中的每个元素平方。

### 附加资源
- [Lean 官方文档](https://leanprover.github.io/)
- 《函数式编程入门》——一本适合初学者的函数式编程书籍

:::tip
尝试在 Lean 中多使用匿名函数，你会发现它们能让你的代码更加简洁和灵活！
:::