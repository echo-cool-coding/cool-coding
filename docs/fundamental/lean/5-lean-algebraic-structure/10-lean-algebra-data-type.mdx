---
title: Lean 代数数据类型
description: "了解Lean中的代数数据类型（ADT），掌握其基本概念、语法和应用场景。本文适合初学者，通过代码示例和实际案例帮助你快速上手。"
---

# Lean 代数数据类型

代数数据类型（Algebraic Data Types，简称ADT）是函数式编程中的一个核心概念。在Lean中，ADT用于定义复杂的数据结构，允许我们通过组合简单的类型来构建更复杂的类型。本文将详细介绍Lean中的代数数据类型，并通过示例帮助你理解其用法。

## 什么是代数数据类型？

代数数据类型是一种复合类型，它通过组合其他类型来定义新的类型。在Lean中，ADT通常通过`inductive`关键字定义。ADT的核心思想是将类型视为“代数表达式”，通过“和类型”（sum types）和“积类型”（product types）来组合。

- **和类型**：表示“或”关系，例如一个值可以是类型A或类型B。
- **积类型**：表示“与”关系，例如一个值同时包含类型A和类型B。

## 定义代数数据类型

在Lean中，我们可以使用`inductive`关键字定义一个代数数据类型。以下是一个简单的例子：

```lean
inductive Shape
  | circle (radius : Float)
  | rectangle (width : Float) (height : Float)
```

在这个例子中，`Shape`是一个代数数据类型，它有两个构造函数：
- `circle`：表示一个圆形，接受一个`Float`类型的参数`radius`。
- `rectangle`：表示一个矩形，接受两个`Float`类型的参数`width`和`height`。

### 使用代数数据类型

定义好代数数据类型后，我们可以使用它来创建具体的值。例如：

```lean
def myCircle : Shape := Shape.circle 5.0
def myRectangle : Shape := Shape.rectangle 4.0 6.0
```

这里，`myCircle`是一个半径为5.0的圆形，`myRectangle`是一个宽度为4.0、高度为6.0的矩形。

### 模式匹配

代数数据类型的一个强大特性是模式匹配。我们可以根据不同的构造函数来处理不同的情况。例如：

```lean
def area : Shape → Float
  | Shape.circle r => 3.14 * r * r
  | Shape.rectangle w h => w * h
```

在这个例子中，`area`函数根据传入的`Shape`类型计算面积。如果传入的是圆形，则计算圆的面积；如果传入的是矩形，则计算矩形的面积。

## 实际应用场景

代数数据类型在编程中有广泛的应用。以下是一些常见的场景：

1. **表示状态**：在状态机中，可以使用ADT来表示不同的状态。例如，一个简单的开关状态可以定义为：

    ```lean
    inductive SwitchState
      | on
      | off
    ```

2. **解析表达式**：在解析数学表达式时，可以使用ADT来表示不同的表达式类型。例如：

    ```lean
    inductive Expr
      | num (n : Int)
      | add (e1 : Expr) (e2 : Expr)
      | mul (e1 : Expr) (e2 : Expr)
    ```

3. **处理错误**：在处理可能失败的操作时，可以使用ADT来表示成功或失败的结果。例如：

    ```lean
    inductive Result (α : Type)
      | success (value : α)
      | failure (error : String)
    ```

## 总结

代数数据类型是Lean中一个强大的工具，它允许我们通过组合简单的类型来构建复杂的数据结构。通过`inductive`关键字，我们可以定义自己的ADT，并通过模式匹配来处理不同的情况。ADT在表示状态、解析表达式和处理错误等场景中有着广泛的应用。

:::tip
如果你想进一步练习，可以尝试定义一个表示二叉树的代数数据类型，并编写一个函数来计算树的高度。
:::

## 附加资源

- [Lean官方文档](https://leanprover.github.io/lean4/doc/)
- 《函数式编程入门》—— 一本适合初学者的函数式编程书籍
- [Lean社区论坛](https://leanprover.zulipchat.com/) —— 与其他Lean学习者交流