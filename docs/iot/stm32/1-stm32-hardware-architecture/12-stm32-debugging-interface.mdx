---
title: STM32 调试接口
description: 本文详细介绍了STM32微控制器的调试接口，包括其工作原理、常见调试工具的使用方法以及实际应用场景。适合初学者快速掌握STM32调试接口的基础知识。
---

## 介绍

STM32微控制器广泛应用于嵌入式系统中，调试接口是开发过程中不可或缺的一部分。调试接口允许开发者通过硬件工具与STM32进行通信，从而实现对程序的调试、烧录和性能分析。本文将详细介绍STM32的调试接口，帮助初学者理解其工作原理和使用方法。

## STM32 调试接口概述

STM32微控制器通常支持多种调试接口，最常见的是**SWD（Serial Wire Debug）**和**JTAG（Joint Test Action Group）**。这两种接口都允许开发者通过外部调试工具与STM32进行通信。

### SWD接口

SWD是一种两线制的调试接口，使用**SWDIO**（数据线）和**SWCLK**（时钟线）进行通信。相比JTAG，SWD接口占用更少的引脚，适合引脚资源有限的应用场景。

### JTAG接口

JTAG是一种四线制的调试接口，使用**TDI**（数据输入）、**TDO**（数据输出）、**TCK**（时钟）和**TMS**（模式选择）进行通信。JTAG接口功能更强大，支持更多的调试功能，但占用更多的引脚。

## 调试工具

常见的STM32调试工具包括：

- **ST-Link**：ST官方提供的调试工具，支持SWD和JTAG接口。
- **J-Link**：SEGGER公司提供的调试工具，支持多种微控制器，功能强大。
- **OpenOCD**：开源的调试工具，支持多种调试接口和微控制器。

## 调试接口的使用

### 连接调试工具

以ST-Link为例，连接STM32的调试接口步骤如下：

1. 将ST-Link的**SWDIO**引脚连接到STM32的**SWDIO**引脚。
2. 将ST-Link的**SWCLK**引脚连接到STM32的**SWCLK**引脚。
3. 将ST-Link的**GND**引脚连接到STM32的**GND**引脚。
4. 将ST-Link的**VCC**引脚连接到STM32的**VCC**引脚（如果需要供电）。

### 配置调试环境

在开发环境中配置调试工具，以Keil MDK为例：

1. 打开Keil MDK，进入项目设置。
2. 在**Debug**选项卡中，选择**ST-Link Debugger**。
3. 在**Settings**中，选择**SWD**接口。
4. 点击**OK**保存设置。

### 调试代码

在Keil MDK中，可以通过以下步骤调试代码：

1. 点击**Debug**按钮进入调试模式。
2. 使用**Step Over**、**Step Into**等按钮单步执行代码。
3. 在**Watch**窗口中查看变量的值。
4. 在**Memory**窗口中查看内存数据。

## 实际应用场景

### 调试LED闪烁程序

假设我们有一个简单的LED闪烁程序，代码如下：

```c
#include "stm32f1xx.h"

void delay(volatile uint32_t count) {
    while(count--);
}

int main(void) {
    RCC->APB2ENR |= RCC_APB2ENR_IOPCEN;  // 使能GPIOC时钟
    GPIOC->CRH &= ~(0xF << 20);          // 清除PC13的配置
    GPIOC->CRH |= (0x3 << 20);           // 配置PC13为推挽输出

    while(1) {
        GPIOC->ODR ^= GPIO_ODR_ODR13;    // 切换PC13状态
        delay(1000000);                  // 简单延时
    }
}
```

通过调试工具，我们可以单步执行代码，观察LED的状态变化，验证程序的正确性。

## 总结

STM32的调试接口是嵌入式开发中不可或缺的工具，通过SWD或JTAG接口，开发者可以方便地进行程序调试、烧录和性能分析。本文介绍了STM32调试接口的基本概念、常见调试工具的使用方法以及实际应用场景，希望对初学者有所帮助。

## 附加资源

- [STM32官方文档](https://www.st.com)
- [Keil MDK用户手册](https://www.keil.com)
- [OpenOCD官方文档](http://openocd.org)

## 练习

1. 使用ST-Link调试一个简单的GPIO控制程序，观察LED的状态变化。
2. 尝试使用JTAG接口连接STM32，比较与SWD接口的区别。
3. 在Keil MDK中设置断点，观察程序执行到断点时的变量值。