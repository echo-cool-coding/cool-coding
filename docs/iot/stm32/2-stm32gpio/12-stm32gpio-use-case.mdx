---
title: STM32 GPIO应用案例
description: 本文介绍了STM32微控制器的GPIO（通用输入输出）功能，并通过实际案例展示其应用场景。适合初学者学习如何使用STM32的GPIO进行硬件控制。
---

# STM32 GPIO应用案例

## 介绍

GPIO（General Purpose Input/Output，通用输入输出）是STM32微控制器中最基本的功能之一。它允许开发者通过配置引脚为输入或输出模式，与外部设备进行交互。GPIO可以用于控制LED、读取按钮状态、驱动继电器等多种场景。

在STM32中，每个GPIO引脚都可以独立配置为输入或输出模式，并且可以设置上拉、下拉电阻，以及输出速度等参数。本文将逐步讲解GPIO的基本概念，并通过实际案例展示其应用。

## GPIO基本概念

### 引脚模式

STM32的GPIO引脚可以配置为以下几种模式：

- **输入模式**：用于读取外部信号，如按钮状态。
- **输出模式**：用于控制外部设备，如点亮LED。
- **复用功能模式**：用于将引脚配置为特定的外设功能，如UART、SPI等。
- **模拟模式**：用于将引脚配置为ADC或DAC的输入输出。

### 引脚配置

在STM32中，GPIO的配置通常包括以下步骤：

1. **使能GPIO时钟**：在使用GPIO之前，需要先使能对应的GPIO端口时钟。
2. **配置引脚模式**：设置引脚为输入、输出、复用或模拟模式。
3. **配置输出类型**：如果引脚为输出模式，可以配置为推挽输出或开漏输出。
4. **配置上拉/下拉电阻**：根据需要配置引脚的上拉或下拉电阻。
5. **配置输出速度**：设置引脚的输出速度，适用于高速或低速场景。

## 代码示例：控制LED

以下是一个简单的代码示例，展示如何使用STM32的GPIO控制LED的亮灭。

```c
#include "stm32f4xx.h"  // 包含STM32F4系列的头文件

void GPIO_Config(void) {
    // 使能GPIOA时钟
    RCC_AHB1PeriphClockCmd(RCC_AHB1Periph_GPIOA, ENABLE);

    // 配置PA5引脚为输出模式
    GPIO_InitTypeDef GPIO_InitStruct;
    GPIO_InitStruct.GPIO_Pin = GPIO_Pin_5;
    GPIO_InitStruct.GPIO_Mode = GPIO_Mode_OUT;
    GPIO_InitStruct.GPIO_OType = GPIO_OType_PP;
    GPIO_InitStruct.GPIO_PuPd = GPIO_PuPd_NOPULL;
    GPIO_InitStruct.GPIO_Speed = GPIO_Speed_50MHz;
    GPIO_Init(GPIOA, &GPIO_InitStruct);
}

int main(void) {
    GPIO_Config();  // 配置GPIO

    while (1) {
        GPIO_SetBits(GPIOA, GPIO_Pin_5);  // 点亮LED
        for (int i = 0; i < 1000000; i++);  // 延时
        GPIO_ResetBits(GPIOA, GPIO_Pin_5);  // 熄灭LED
        for (int i = 0; i < 1000000; i++);  // 延时
    }
}
```

### 代码解释

1. **使能GPIOA时钟**：通过 `RCC_AHB1PeriphClockCmd` 函数使能GPIOA的时钟。
2. **配置PA5引脚**：将PA5引脚配置为推挽输出模式，无上拉或下拉电阻，输出速度为50MHz。
3. **控制LED**：在 `while` 循环中，通过 `GPIO_SetBits` 和 `GPIO_ResetBits` 函数控制PA5引脚的电平，从而控制LED的亮灭。

## 实际应用案例：按钮控制LED

在实际应用中，GPIO常用于读取按钮状态并控制其他设备。以下是一个按钮控制LED的案例。

```c
#include "stm32f4xx.h"

void GPIO_Config(void) {
    // 使能GPIOA和GPIOC时钟
    RCC_AHB1PeriphClockCmd(RCC_AHB1Periph_GPIOA | RCC_AHB1Periph_GPIOC, ENABLE);

    // 配置PA5引脚为输出模式（控制LED）
    GPIO_InitTypeDef GPIO_InitStruct;
    GPIO_InitStruct.GPIO_Pin = GPIO_Pin_5;
    GPIO_InitStruct.GPIO_Mode = GPIO_Mode_OUT;
    GPIO_InitStruct.GPIO_OType = GPIO_OType_PP;
    GPIO_InitStruct.GPIO_PuPd = GPIO_PuPd_NOPULL;
    GPIO_InitStruct.GPIO_Speed = GPIO_Speed_50MHz;
    GPIO_Init(GPIOA, &GPIO_InitStruct);

    // 配置PC13引脚为输入模式（读取按钮状态）
    GPIO_InitStruct.GPIO_Pin = GPIO_Pin_13;
    GPIO_InitStruct.GPIO_Mode = GPIO_Mode_IN;
    GPIO_InitStruct.GPIO_PuPd = GPIO_PuPd_NOPULL;
    GPIO_Init(GPIOC, &GPIO_InitStruct);
}

int main(void) {
    GPIO_Config();  // 配置GPIO

    while (1) {
        if (GPIO_ReadInputDataBit(GPIOC, GPIO_Pin_13) == 0) {  // 检测按钮是否按下
            GPIO_SetBits(GPIOA, GPIO_Pin_5);  // 点亮LED
        } else {
            GPIO_ResetBits(GPIOA, GPIO_Pin_5);  // 熄灭LED
        }
    }
}
```

### 代码解释

1. **配置PC13引脚**：将PC13引脚配置为输入模式，用于读取按钮状态。
2. **读取按钮状态**：通过 `GPIO_ReadInputDataBit` 函数读取PC13引脚的电平，判断按钮是否按下。
3. **控制LED**：根据按钮状态，控制PA5引脚的电平，从而控制LED的亮灭。

## 总结

通过本文的学习，你应该已经掌握了STM32 GPIO的基本概念和配置方法，并能够通过代码控制LED和读取按钮状态。GPIO是STM32中最基础的功能，掌握它对于后续学习其他外设功能至关重要。

## 附加资源与练习

- **练习1**：尝试修改代码，使LED在按钮按下时闪烁，而不是常亮。
- **练习2**：使用多个GPIO引脚控制多个LED，实现流水灯效果。
- **资源**：参考STM32官方文档，了解更多关于GPIO的配置选项和高级功能。

:::tip
在编写代码时，务必注意引脚的电气特性，避免过高的电流或电压损坏芯片。
:::