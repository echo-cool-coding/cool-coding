---
title: STM32 GPIO输入模式
description: 本文详细介绍了STM32微控制器的GPIO输入模式，包括其工作原理、配置方法、代码示例以及实际应用场景，适合初学者学习。
---

## 介绍

GPIO（通用输入输出）是STM32微控制器中最基本且常用的功能之一。GPIO引脚可以配置为输入或输出模式。在输入模式下，GPIO引脚用于读取外部信号的状态，例如按钮的按下或释放、传感器的输出等。理解GPIO输入模式的工作原理和配置方法对于开发嵌入式系统至关重要。

本文将逐步讲解STM32的GPIO输入模式，包括其配置方法、代码示例以及实际应用场景。

## GPIO输入模式的工作原理

在输入模式下，GPIO引脚可以读取外部信号的电平状态。STM32的GPIO输入模式主要有以下几种：

1. **浮空输入（Input Floating）**：引脚处于高阻抗状态，外部信号的电平直接决定引脚的状态。适用于需要外部上拉或下拉电阻的场合。
2. **上拉输入（Input Pull-up）**：内部上拉电阻连接到引脚，默认状态下引脚为高电平。
3. **下拉输入（Input Pull-down）**：内部下拉电阻连接到引脚，默认状态下引脚为低电平。
4. **模拟输入（Analog Input）**：引脚配置为模拟输入模式，用于读取模拟信号（如ADC输入）。

:::note
浮空输入模式下，引脚的状态由外部电路决定，因此通常需要外部上拉或下拉电阻来确保稳定的电平状态。
:::

## 配置GPIO输入模式

在STM32中，GPIO的配置通常通过寄存器或HAL库函数来完成。以下是一个使用HAL库配置GPIO输入模式的示例：

```c
#include "stm32f1xx_hal.h"

void GPIO_Input_Config(void) {
    GPIO_InitTypeDef GPIO_InitStruct = {0};

    // 使能GPIO端口时钟
    __HAL_RCC_GPIOA_CLK_ENABLE();

    // 配置GPIO引脚为输入模式
    GPIO_InitStruct.Pin = GPIO_PIN_0;  // 选择引脚0
    GPIO_InitStruct.Mode = GPIO_MODE_INPUT;  // 配置为输入模式
    GPIO_InitStruct.Pull = GPIO_NOPULL;  // 浮空输入
    HAL_GPIO_Init(GPIOA, &GPIO_InitStruct);
}
```

在上述代码中，我们配置了GPIOA的第0引脚为浮空输入模式。通过`GPIO_InitStruct.Pull`可以配置为上拉或下拉输入模式。

## 读取GPIO输入状态

配置好GPIO输入模式后，可以通过HAL库函数`HAL_GPIO_ReadPin`来读取引脚的状态。以下是一个读取引脚状态的示例：

```c
uint8_t pinState = HAL_GPIO_ReadPin(GPIOA, GPIO_PIN_0);
if (pinState == GPIO_PIN_SET) {
    // 引脚为高电平
} else {
    // 引脚为低电平
}
```

## 实际应用场景

### 1. 按钮输入检测

在嵌入式系统中，按钮是最常见的输入设备之一。通过配置GPIO为输入模式，可以检测按钮的按下和释放状态。以下是一个简单的按钮检测示例：

```c
void Button_Check(void) {
    if (HAL_GPIO_ReadPin(GPIOA, GPIO_PIN_0) == GPIO_PIN_RESET) {
        // 按钮按下
    } else {
        // 按钮释放
    }
}
```

### 2. 传感器信号读取

许多传感器输出数字信号，可以通过GPIO输入模式读取。例如，红外传感器的输出信号可以通过GPIO输入模式读取，以检测障碍物的存在。

```c
void Sensor_Read(void) {
    if (HAL_GPIO_ReadPin(GPIOA, GPIO_PIN_1) == GPIO_PIN_SET) {
        // 检测到障碍物
    } else {
        // 无障碍物
    }
}
```

## 总结

GPIO输入模式是STM32微控制器中非常基础且重要的功能。通过配置GPIO为输入模式，可以读取外部信号的状态，从而实现与外部设备的交互。本文介绍了GPIO输入模式的工作原理、配置方法、代码示例以及实际应用场景，希望能够帮助初学者更好地理解和应用这一功能。

## 附加资源与练习

- **练习1**：尝试配置GPIO引脚为上拉输入模式，并读取按钮的状态。
- **练习2**：使用GPIO输入模式读取多个传感器的输出信号，并根据信号状态控制LED的亮灭。
- **参考文档**：STM32官方参考手册和HAL库文档。

:::tip
在实际开发中，建议使用HAL库或LL库来简化GPIO的配置和操作，同时确保代码的可移植性和可维护性。
:::