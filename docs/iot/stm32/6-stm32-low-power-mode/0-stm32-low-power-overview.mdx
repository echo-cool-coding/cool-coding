---
title: STM32 低功耗概述
description: 了解STM32微控制器的低功耗模式，掌握如何在实际项目中优化功耗并延长电池寿命。
---

# STM32 低功耗概述

在现代嵌入式系统中，功耗优化是一个关键的设计目标，尤其是在电池供电的设备中。STM32微控制器提供了多种低功耗模式，帮助开发者在满足性能需求的同时，最大限度地降低功耗。本文将详细介绍STM32的低功耗模式，并通过实际案例展示如何应用这些模式。

## 什么是低功耗模式？

低功耗模式是微控制器的一种特殊运行状态，通过关闭或降低某些功能模块的功耗来减少整体能耗。STM32提供了多种低功耗模式，每种模式都有不同的功耗和唤醒时间特性，适用于不同的应用场景。

## STM32 的低功耗模式

STM32微控制器通常支持以下几种低功耗模式：

1. **睡眠模式（Sleep Mode）**
2. **停止模式（Stop Mode）**
3. **待机模式（Standby Mode）**
4. **关机模式（Shutdown Mode）**

### 1. 睡眠模式（Sleep Mode）

在睡眠模式下，CPU停止运行，但外设和内存仍然保持供电。这种模式的功耗较低，且唤醒时间非常短，适合需要快速响应的应用。

#### 进入睡眠模式

```c
__WFI();  // 等待中断
```

#### 唤醒睡眠模式

睡眠模式可以通过任何中断唤醒。

### 2. 停止模式（Stop Mode）

在停止模式下，CPU和大部分外设都停止运行，只有少数低功耗外设（如RTC）保持工作。这种模式的功耗比睡眠模式更低，但唤醒时间稍长。

#### 进入停止模式

```c
HAL_PWR_EnterSTOPMode(PWR_LOWPOWERREGULATOR_ON, PWR_STOPENTRY_WFI);
```

#### 唤醒停止模式

停止模式可以通过外部中断或RTC闹钟唤醒。

### 3. 待机模式（Standby Mode）

在待机模式下，CPU、外设和大部分内存都关闭，只有备份域（如RTC和备份寄存器）保持供电。这种模式的功耗非常低，但唤醒时间较长。

#### 进入待机模式

```c
HAL_PWR_EnterSTANDBYMode();
```

#### 唤醒待机模式

待机模式可以通过外部复位、RTC闹钟或WKUP引脚唤醒。

### 4. 关机模式（Shutdown Mode）

在关机模式下，除了备份域外，所有电源都被关闭。这种模式的功耗最低，但唤醒时间最长。

#### 进入关机模式

```c
HAL_PWREx_EnterSHUTDOWNMode();
```

#### 唤醒关机模式

关机模式可以通过外部复位或RTC闹钟唤醒。

## 实际应用案例

### 案例1：智能手表

在智能手表中，设备大部分时间处于低功耗模式，只有在用户交互或定时任务时才唤醒。通过使用停止模式或待机模式，可以显著延长电池寿命。

### 案例2：环境监测传感器

环境监测传感器通常需要长时间运行，但数据采集频率较低。通过使用睡眠模式或停止模式，可以在数据采集间隔期间降低功耗。

## 总结

STM32的低功耗模式为开发者提供了灵活的选择，可以根据应用需求优化功耗。通过合理使用这些模式，可以显著延长电池寿命，提高设备的续航能力。

## 附加资源

- [STM32低功耗模式官方文档](https://www.st.com)
- [STM32 HAL库低功耗函数参考](https://www.st.com)

## 练习

1. 编写一个程序，使STM32在按下按钮时进入停止模式，并在5秒后自动唤醒。
2. 比较不同低功耗模式的功耗和唤醒时间，选择最适合你的应用场景的模式。

:::tip
在实际项目中，建议使用STM32CubeMX工具配置低功耗模式，以确保所有外设和时钟设置正确。
:::