---
title: Arduino 参数传递
description: 了解如何在Arduino函数中传递参数，掌握值传递和引用传递的区别，并通过实际案例加深理解。
---

# Arduino 参数传递

在Arduino编程中，函数是代码复用的重要工具。为了让函数更加灵活和通用，我们常常需要向函数传递参数。本文将详细介绍Arduino中的参数传递机制，包括值传递和引用传递，并通过实际案例帮助你理解这些概念。

## 什么是参数传递？

参数传递是指在调用函数时，将数据传递给函数的过程。这些数据可以是变量、常量或表达式。通过参数传递，函数可以根据传入的数据执行不同的操作。

在Arduino中，参数传递主要有两种方式：
1. **值传递**：传递的是数据的副本，函数内部对参数的修改不会影响原始数据。
2. **引用传递**：传递的是数据的引用（即内存地址），函数内部对参数的修改会影响原始数据。

## 值传递

值传递是最常见的参数传递方式。当你将一个变量作为参数传递给函数时，函数会创建一个该变量的副本，并在函数内部使用这个副本。因此，函数内部对参数的修改不会影响原始变量。

### 示例代码

```cpp
void increment(int value) {
  value = value + 1;
  Serial.println(value); // 输出：6
}

void setup() {
  Serial.begin(9600);
  int num = 5;
  increment(num);
  Serial.println(num); // 输出：5
}

void loop() {
  // 空循环
}
```

### 解释
- 在 `setup()` 函数中，我们定义了一个变量 `num` 并赋值为 `5`。
- 调用 `increment(num)` 时，`num` 的值被传递给 `increment` 函数。
- 在 `increment` 函数中，`value` 是 `num` 的副本，因此 `value` 的值增加 `1` 后变为 `6`，但 `num` 的值仍然是 `5`。

## 引用传递

引用传递允许函数直接操作原始数据。通过引用传递，函数可以修改原始变量的值。在Arduino中，引用传递通过指针或引用符号 `&` 实现。

### 示例代码

```cpp
void increment(int &value) {
  value = value + 1;
  Serial.println(value); // 输出：6
}

void setup() {
  Serial.begin(9600);
  int num = 5;
  increment(num);
  Serial.println(num); // 输出：6
}

void loop() {
  // 空循环
}
```

### 解释
- 在 `setup()` 函数中，我们定义了一个变量 `num` 并赋值为 `5`。
- 调用 `increment(num)` 时，`num` 的引用被传递给 `increment` 函数。
- 在 `increment` 函数中，`value` 是 `num` 的引用，因此 `value` 的值增加 `1` 后，`num` 的值也变为 `6`。

## 实际应用案例

### 案例1：控制LED亮度

假设我们有一个函数用于控制LED的亮度，亮度值通过参数传递。我们可以使用值传递来确保亮度值不会被意外修改。

```cpp
void setBrightness(int brightness) {
  analogWrite(LED_PIN, brightness);
}

void setup() {
  pinMode(LED_PIN, OUTPUT);
  int brightness = 128; // 中等亮度
  setBrightness(brightness);
}

void loop() {
  // 空循环
}
```

### 案例2：交换两个变量的值

如果我们希望交换两个变量的值，可以使用引用传递来直接修改原始变量。

```cpp
void swap(int &a, int &b) {
  int temp = a;
  a = b;
  b = temp;
}

void setup() {
  Serial.begin(9600);
  int x = 10;
  int y = 20;
  swap(x, y);
  Serial.print("x: ");
  Serial.println(x); // 输出：20
  Serial.print("y: ");
  Serial.println(y); // 输出：10
}

void loop() {
  // 空循环
}
```

## 总结

在Arduino编程中，参数传递是函数调用的重要部分。值传递适用于不需要修改原始数据的场景，而引用传递则适用于需要直接操作原始数据的场景。通过合理选择参数传递方式，可以使代码更加灵活和高效。

## 附加资源与练习

- **练习1**：编写一个函数，使用值传递计算两个数的和，并返回结果。
- **练习2**：编写一个函数，使用引用传递修改数组中的元素值。
- **进一步阅读**：Arduino官方文档中的函数和指针部分。

希望本文能帮助你更好地理解Arduino中的参数传递机制。继续练习和探索，你将能够编写出更加复杂和高效的Arduino程序！