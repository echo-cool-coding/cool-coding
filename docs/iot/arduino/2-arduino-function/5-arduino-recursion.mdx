---
title: Arduino 递归
description: 了解如何在Arduino中使用递归函数，掌握递归的基本概念、实现方法以及实际应用场景。
---

# Arduino 递归

## 介绍

递归是一种编程技术，指的是函数直接或间接调用自身的过程。在Arduino编程中，递归可以帮助我们解决一些复杂的问题，尤其是那些可以分解为相似子问题的情况。然而，递归的使用需要谨慎，因为不当的递归调用可能导致堆栈溢出或程序崩溃。

在本教程中，我们将学习如何在Arduino中使用递归函数，并通过实际示例来理解其工作原理。

## 什么是递归？

递归函数是一种调用自身的函数。它通常用于解决可以分解为更小、相似子问题的问题。递归函数通常包含两个部分：
1. **基准条件（Base Case）**：这是递归停止的条件。如果没有基准条件，递归将无限进行下去，导致堆栈溢出。
2. **递归条件（Recursive Case）**：这是函数调用自身的部分，通常会将问题规模缩小。

## 递归的基本结构

以下是一个简单的递归函数的基本结构：

```cpp
void recursiveFunction(parameters) {
  if (baseCase) {
    // 基准条件
    return;
  } else {
    // 递归条件
    recursiveFunction(modifiedParameters);
  }
}
```

## 递归示例：计算阶乘

阶乘是一个经典的递归示例。阶乘的定义是：`n! = n * (n-1) * (n-2) * ... * 1`。我们可以用递归来实现阶乘计算。

```cpp
int factorial(int n) {
  if (n <= 1) {
    return 1; // 基准条件
  } else {
    return n * factorial(n - 1); // 递归条件
  }
}

void setup() {
  Serial.begin(9600);
  int result = factorial(5);
  Serial.print("5的阶乘是: ");
  Serial.println(result);
}

void loop() {
  // 空循环
}
```

**输出：**
```
5的阶乘是: 120
```

在这个示例中，`factorial` 函数通过递归调用自身来计算阶乘。当 `n` 小于或等于 1 时，递归停止并返回 1。

## 递归的实际应用：遍历二叉树

递归在数据结构中的应用非常广泛，例如遍历二叉树。以下是一个简单的二叉树遍历示例：

```cpp
struct Node {
  int data;
  Node* left;
  Node* right;
};

void inorderTraversal(Node* node) {
  if (node == NULL) {
    return; // 基准条件
  }
  inorderTraversal(node->left); // 递归遍历左子树
  Serial.print(node->data); // 访问节点
  inorderTraversal(node->right); // 递归遍历右子树
}

void setup() {
  Serial.begin(9600);
  
  // 创建一个简单的二叉树
  Node* root = new Node{1, NULL, NULL};
  root->left = new Node{2, NULL, NULL};
  root->right = new Node{3, NULL, NULL};
  
  Serial.println("中序遍历结果:");
  inorderTraversal(root);
}

void loop() {
  // 空循环
}
```

**输出：**
```
中序遍历结果:
213
```

在这个示例中，`inorderTraversal` 函数通过递归调用自身来遍历二叉树的左子树、访问当前节点、然后遍历右子树。

## 递归的注意事项

:::caution
使用递归时需要注意以下几点：
1. **基准条件**：确保递归函数有明确的基准条件，否则会导致无限递归。
2. **堆栈溢出**：递归调用会占用堆栈空间，深度递归可能导致堆栈溢出。
3. **性能**：递归可能不如迭代高效，尤其是在处理大规模数据时。
:::

## 总结

递归是一种强大的编程技术，能够简化某些复杂问题的解决方案。通过理解递归的基本结构和注意事项，你可以在Arduino编程中有效地使用递归。

## 附加资源与练习

1. **练习**：尝试编写一个递归函数来计算斐波那契数列的第 `n` 项。
2. **进一步学习**：了解尾递归优化及其在Arduino中的应用。
3. **挑战**：使用递归实现一个简单的迷宫求解算法。

希望本教程能帮助你更好地理解Arduino中的递归函数。继续练习和探索，你会发现递归在解决复杂问题时的强大之处！