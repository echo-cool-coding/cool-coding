---
title: Arduino 字符串
description: 了解Arduino中的字符串数据类型，学习如何创建、操作和使用字符串，以及它们在Arduino项目中的实际应用。
---

# Arduino 字符串

在Arduino编程中，字符串（String）是一种用于存储和操作文本数据的数据类型。字符串可以包含字母、数字、符号等字符，是处理文本信息的重要工具。本文将详细介绍Arduino中的字符串数据类型，包括如何创建、操作和使用字符串，并通过实际案例展示其应用场景。

## 什么是字符串？

字符串是由一系列字符组成的序列。在Arduino中，字符串可以用于存储文本信息，例如传感器读数、用户输入或输出消息。Arduino提供了两种主要的字符串处理方式：

1. **C风格字符串（字符数组）**：这是基于C语言的传统字符串表示方法，使用字符数组（`char[]`）来存储字符串。
2. **Arduino String类**：Arduino提供了一个更高级的`String`类，它封装了字符串操作的功能，使得字符串处理更加方便。

本文将重点介绍Arduino的`String`类，因为它更适合初学者使用。

## 创建字符串

在Arduino中，可以使用`String`类来创建字符串。以下是几种常见的创建字符串的方式：

```cpp
String str1 = "Hello, Arduino!"; // 直接赋值
String str2 = String(123);       // 将整数转换为字符串
String str3 = String(3.14, 2);   // 将浮点数转换为字符串，保留两位小数
```

### 示例代码

```cpp
void setup() {
  Serial.begin(9600);

  String greeting = "Hello, World!";
  Serial.println(greeting);

  String numberStr = String(42);
  Serial.println(numberStr);

  String floatStr = String(3.14159, 3);
  Serial.println(floatStr);
}

void loop() {
  // 空循环
}
```

**输出：**
```
Hello, World!
42
3.142
```

## 字符串操作

Arduino的`String`类提供了许多方法来操作字符串。以下是一些常用的操作：

### 1. 连接字符串

可以使用`+`运算符或`concat()`方法来连接字符串。

```cpp
String str1 = "Hello";
String str2 = "Arduino";
String result = str1 + " " + str2; // 使用 + 运算符
result.concat("!");                // 使用 concat() 方法
```

### 2. 获取字符串长度

使用`length()`方法可以获取字符串的长度。

```cpp
String str = "Arduino";
int len = str.length(); // len = 7
```

### 3. 查找子字符串

使用`indexOf()`方法可以查找子字符串的位置。

```cpp
String str = "Hello, Arduino!";
int pos = str.indexOf("Arduino"); // pos = 7
```

### 4. 截取子字符串

使用`substring()`方法可以截取字符串的一部分。

```cpp
String str = "Hello, Arduino!";
String subStr = str.substring(7, 14); // subStr = "Arduino"
```

### 5. 比较字符串

使用`equals()`方法可以比较两个字符串是否相等。

```cpp
String str1 = "Arduino";
String str2 = "arduino";
bool isEqual = str1.equals(str2); // isEqual = false
```

### 示例代码

```cpp
void setup() {
  Serial.begin(9600);

  String str1 = "Hello";
  String str2 = "Arduino";
  String result = str1 + " " + str2;
  result.concat("!");

  Serial.println(result); // 输出: Hello Arduino!
  Serial.println(result.length()); // 输出: 14

  int pos = result.indexOf("Arduino");
  Serial.println(pos); // 输出: 7

  String subStr = result.substring(7, 14);
  Serial.println(subStr); // 输出: Arduino

  bool isEqual = str1.equals(str2);
  Serial.println(isEqual); // 输出: 0 (false)
}

void loop() {
  // 空循环
}
```

## 实际应用案例

### 案例1：读取传感器数据并显示

假设你有一个温度传感器，读取到的温度值需要显示在串口监视器中。你可以使用字符串来格式化输出。

```cpp
void setup() {
  Serial.begin(9600);
}

void loop() {
  float temperature = readTemperature(); // 假设这是一个读取温度的函数
  String message = "Current Temperature: " + String(temperature) + " C";
  Serial.println(message);
  delay(1000);
}

float readTemperature() {
  // 模拟读取温度值
  return 25.5;
}
```

**输出：**
```
Current Temperature: 25.50 C
```

### 案例2：用户输入处理

假设你有一个项目，用户可以通过串口输入命令来控制LED灯的开关。你可以使用字符串来处理用户输入。

```cpp
void setup() {
  Serial.begin(9600);
  pinMode(LED_BUILTIN, OUTPUT);
}

void loop() {
  if (Serial.available() > 0) {
    String input = Serial.readString();
    input.trim(); // 去除首尾空白字符

    if (input == "ON") {
      digitalWrite(LED_BUILTIN, HIGH);
      Serial.println("LED is ON");
    } else if (input == "OFF") {
      digitalWrite(LED_BUILTIN, LOW);
      Serial.println("LED is OFF");
    } else {
      Serial.println("Invalid command");
    }
  }
}
```

**输入：**
```
ON
```

**输出：**
```
LED is ON
```

## 总结

Arduino中的字符串是一个强大的工具，能够帮助你处理和操作文本数据。通过`String`类，你可以轻松地创建、连接、查找、截取和比较字符串。在实际项目中，字符串常用于格式化输出、处理用户输入以及与传感器数据交互。

:::tip
在使用字符串时，注意内存管理。频繁的字符串操作可能会导致内存碎片，尤其是在处理大量数据时。如果遇到内存问题，可以考虑使用C风格字符串（字符数组）来优化内存使用。
:::

## 附加资源与练习

### 练习1
编写一个Arduino程序，要求用户通过串口输入他们的名字，然后输出“Hello, [名字]!”。

### 练习2
修改温度传感器案例，使其能够显示华氏温度（Fahrenheit）和摄氏温度（Celsius）。

### 附加资源
- [Arduino String类官方文档](https://www.arduino.cc/reference/en/language/variables/data-types/stringobject/)
- [C风格字符串教程](https://www.arduino.cc/reference/en/language/variables/data-types/string/)

通过本文的学习，你应该已经掌握了Arduino中字符串的基本操作和应用。继续练习和探索，你将能够更熟练地使用字符串来处理各种文本数据。