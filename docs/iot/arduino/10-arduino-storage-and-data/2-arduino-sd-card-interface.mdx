---
title: Arduino SD卡接口
description: 学习如何在Arduino中使用SD卡模块进行数据存储和读取。本文适合初学者，包含代码示例、实际应用场景和总结。
---

# Arduino SD卡接口

在Arduino项目中，存储数据是一个常见的需求。无论是记录传感器数据、存储配置信息，还是保存日志文件，SD卡模块都是一个非常实用的工具。本文将详细介绍如何在Arduino中使用SD卡模块进行数据存储和读取。

## 什么是SD卡接口？

SD卡接口是一种允许Arduino与SD卡通信的硬件模块。通过这个接口，Arduino可以读取和写入SD卡中的数据。SD卡模块通常通过SPI（串行外设接口）与Arduino连接，这使得它能够高效地传输数据。

## 所需材料

- Arduino开发板（如Arduino Uno）
- SD卡模块
- 一张SD卡（建议使用容量较小的卡，如2GB或4GB）
- 连接线

## 连接SD卡模块

首先，我们需要将SD卡模块连接到Arduino。以下是连接方式：

- **SD卡模块的VCC引脚** -> **Arduino的5V引脚**
- **SD卡模块的GND引脚** -> **Arduino的GND引脚**
- **SD卡模块的MISO引脚** -> **Arduino的12引脚**
- **SD卡模块的MOSI引脚** -> **Arduino的11引脚**
- **SD卡模块的SCK引脚** -> **Arduino的13引脚**
- **SD卡模块的CS引脚** -> **Arduino的10引脚**

:::note
不同型号的SD卡模块引脚可能有所不同，请参考模块的说明书。
:::

## 安装SD库

Arduino IDE自带了一个名为`SD`的库，用于与SD卡模块进行通信。你可以在代码中直接包含这个库：

```cpp
#include <SD.h>
```

## 初始化SD卡

在使用SD卡之前，我们需要初始化它。以下是一个简单的初始化代码示例：

```cpp
#include <SD.h>

const int chipSelect = 10;

void setup() {
  Serial.begin(9600);

  if (!SD.begin(chipSelect)) {
    Serial.println("SD卡初始化失败！");
    return;
  }
  Serial.println("SD卡初始化成功！");
}

void loop() {
  // 主循环代码
}
```

:::tip
如果SD卡初始化失败，请检查连接是否正确，并确保SD卡已正确插入模块。
:::

## 写入数据到SD卡

初始化成功后，我们可以开始向SD卡写入数据。以下是一个将字符串写入文件的示例：

```cpp
#include <SD.h>

const int chipSelect = 10;

void setup() {
  Serial.begin(9600);

  if (!SD.begin(chipSelect)) {
    Serial.println("SD卡初始化失败！");
    return;
  }
  Serial.println("SD卡初始化成功！");

  File dataFile = SD.open("datalog.txt", FILE_WRITE);

  if (dataFile) {
    dataFile.println("Hello, SD Card!");
    dataFile.close();
    Serial.println("数据写入成功！");
  } else {
    Serial.println("打开文件失败！");
  }
}

void loop() {
  // 主循环代码
}
```

## 从SD卡读取数据

读取SD卡中的数据同样简单。以下是一个读取文件内容并打印到串口监视器的示例：

```cpp
#include <SD.h>

const int chipSelect = 10;

void setup() {
  Serial.begin(9600);

  if (!SD.begin(chipSelect)) {
    Serial.println("SD卡初始化失败！");
    return;
  }
  Serial.println("SD卡初始化成功！");

  File dataFile = SD.open("datalog.txt");

  if (dataFile) {
    while (dataFile.available()) {
      Serial.write(dataFile.read());
    }
    dataFile.close();
  } else {
    Serial.println("打开文件失败！");
  }
}

void loop() {
  // 主循环代码
}
```

## 实际应用场景

### 数据记录器

假设你正在开发一个环境监测系统，需要记录温度和湿度数据。你可以使用SD卡模块将传感器数据保存到文件中，以便后续分析。

```cpp
#include <SD.h>
#include <DHT.h>

#define DHTPIN 2
#define DHTTYPE DHT11

DHT dht(DHTPIN, DHTTYPE);
const int chipSelect = 10;

void setup() {
  Serial.begin(9600);
  dht.begin();

  if (!SD.begin(chipSelect)) {
    Serial.println("SD卡初始化失败！");
    return;
  }
  Serial.println("SD卡初始化成功！");
}

void loop() {
  float h = dht.readHumidity();
  float t = dht.readTemperature();

  if (isnan(h) || isnan(t)) {
    Serial.println("读取传感器数据失败！");
    return;
  }

  File dataFile = SD.open("datalog.txt", FILE_WRITE);

  if (dataFile) {
    dataFile.print("温度: ");
    dataFile.print(t);
    dataFile.print(" 湿度: ");
    dataFile.println(h);
    dataFile.close();
    Serial.println("数据写入成功！");
  } else {
    Serial.println("打开文件失败！");
  }

  delay(5000); // 每5秒记录一次数据
}
```

## 总结

通过本文，你已经学会了如何在Arduino中使用SD卡模块进行数据存储和读取。我们介绍了SD卡模块的连接方式、初始化过程、数据写入和读取方法，并通过一个实际应用场景展示了如何使用SD卡模块记录传感器数据。

## 附加资源与练习

- **练习1**：尝试修改代码，将传感器数据保存为CSV格式，以便在Excel中进行分析。
- **练习2**：扩展数据记录器功能，使其能够记录多个传感器的数据。
- **资源**：Arduino官方文档中的[SD库参考](https://www.arduino.cc/en/Reference/SD)提供了更多关于SD卡操作的详细信息。

希望本文对你有所帮助，祝你在Arduino的学习之旅中取得更多进展！