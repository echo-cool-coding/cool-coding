---
title: Arduino 模拟写入
description: "学习如何使用Arduino进行模拟写入，控制模拟输出设备，如LED亮度或电机速度。"
---

## 介绍

在Arduino中，模拟写入（Analog Write）是一种用于控制模拟输出设备的技术。与数字写入（Digital Write）只能输出高电平（HIGH）或低电平（LOW）不同，模拟写入允许你输出一个介于0到255之间的值，从而控制设备的输出强度。例如，你可以使用模拟写入来控制LED的亮度或电机的速度。

Arduino的模拟写入功能是通过PWM（脉宽调制）实现的。PWM通过快速切换高低电平来模拟一个介于0V和5V之间的电压。占空比（Duty Cycle）决定了输出信号的平均电压，占空比越高，输出信号的平均电压越高。

## 模拟写入的基本语法

在Arduino中，模拟写入使用 `analogWrite()` 函数。该函数的语法如下：

```cpp
analogWrite(pin, value);
```

- `pin`：指定要写入的引脚。在Arduino Uno中，支持PWM的引脚通常标记为 `~`，例如 `3`, `5`, `6`, `9`, `10`, 和 `11`。
- `value`：指定要写入的值，范围是0到255。0表示完全关闭（0V），255表示完全打开（5V）。

## 示例：控制LED亮度

让我们通过一个简单的例子来理解如何使用 `analogWrite()` 控制LED的亮度。

### 电路连接

将LED的正极（长脚）连接到Arduino的PWM引脚（例如 `9`），负极（短脚）连接到GND。为了限制电流，可以在LED和GND之间串联一个220Ω的电阻。

### 代码示例

```cpp
int ledPin = 9;  // 将LED连接到引脚9

void setup() {
  pinMode(ledPin, OUTPUT);  // 将引脚设置为输出模式
}

void loop() {
  // 逐渐增加亮度
  for (int brightness = 0; brightness <= 255; brightness++) {
    analogWrite(ledPin, brightness);
    delay(10);  // 等待10毫秒
  }

  // 逐渐减少亮度
  for (int brightness = 255; brightness >= 0; brightness--) {
    analogWrite(ledPin, brightness);
    delay(10);  // 等待10毫秒
  }
}
```

### 代码解释

1. **`pinMode(ledPin, OUTPUT)`**：将 `ledPin` 设置为输出模式。
2. **`analogWrite(ledPin, brightness)`**：根据 `brightness` 的值控制LED的亮度。`brightness` 从0逐渐增加到255，然后再逐渐减少到0。
3. **`delay(10)`**：每次改变亮度后等待10毫秒，以便观察LED的亮度变化。

## 实际应用场景

### 1. 控制电机速度

模拟写入不仅可以用于控制LED的亮度，还可以用于控制电机的速度。通过改变PWM信号的占空比，你可以调整电机的转速。

### 2. 调节蜂鸣器音量

在某些情况下，你可以使用模拟写入来控制蜂鸣器的音量。通过改变PWM信号的占空比，你可以调整蜂鸣器的音量大小。

### 3. 调光器

模拟写入还可以用于制作调光器。通过调整PWM信号的占空比，你可以控制灯光的亮度，从而实现调光功能。

## 总结

模拟写入是Arduino中一个非常有用的功能，它允许你通过PWM信号控制模拟输出设备的强度。通过 `analogWrite()` 函数，你可以轻松地控制LED的亮度、电机的速度或蜂鸣器的音量。

:::tip
**提示**：在使用模拟写入时，请确保你选择的引脚支持PWM功能。在Arduino Uno中，支持PWM的引脚通常标记为 `~`。
:::

## 附加资源与练习

1. **练习**：尝试使用模拟写入控制多个LED的亮度，使它们以不同的速度渐变。
2. **扩展阅读**：了解更多关于PWM（脉宽调制）的工作原理，以及它在其他微控制器中的应用。
3. **项目**：制作一个简单的调光器，使用电位器调整LED的亮度。你可以使用 `analogRead()` 读取电位器的值，然后使用 `analogWrite()` 控制LED的亮度。

通过不断实践和探索，你将更好地掌握Arduino的模拟写入功能，并能够将其应用到各种有趣的项目中。