---
title: Arduino 信号滤波
description: "学习如何在Arduino中使用信号滤波技术，消除噪声并提高传感器数据的准确性。本文适合初学者，包含代码示例和实际应用案例。"
---

# Arduino 信号滤波

在Arduino项目中，传感器数据通常会受到噪声的干扰，导致读数不准确。信号滤波是一种常用的技术，用于消除这些噪声，从而提高数据的可靠性和准确性。本文将介绍几种常见的信号滤波方法，并通过代码示例和实际案例帮助你理解如何在Arduino中实现信号滤波。

## 什么是信号滤波？

信号滤波是指通过某种算法或电路，从原始信号中去除不需要的噪声成分，保留有用的信号。在Arduino中，信号滤波通常用于处理模拟输入信号，例如来自温度传感器、光敏电阻或加速度传感器的数据。

:::note
噪声可能来自多种来源，例如电源波动、电磁干扰或传感器本身的误差。
:::

## 常见的信号滤波方法

在Arduino中，常用的信号滤波方法包括：

1. **均值滤波**：通过计算多个采样值的平均值来平滑数据。
2. **中值滤波**：通过取多个采样值的中位数来消除异常值。
3. **低通滤波**：通过保留低频信号并滤除高频噪声来平滑数据。

### 均值滤波

均值滤波是最简单的滤波方法之一。它通过计算多个采样值的平均值来平滑数据。这种方法适用于噪声较小且变化较慢的信号。

以下是一个均值滤波的代码示例：

```cpp
const int numReadings = 10; // 采样次数
int readings[numReadings];  // 存储采样值的数组
int index = 0;              // 当前采样索引
int total = 0;              // 采样值总和
int average = 0;            // 平均值

void setup() {
  Serial.begin(9600);
  for (int i = 0; i < numReadings; i++) {
    readings[i] = 0; // 初始化数组
  }
}

void loop() {
  total -= readings[index]; // 减去最早的采样值
  readings[index] = analogRead(A0); // 读取新的采样值
  total += readings[index]; // 加上新的采样值
  index = (index + 1) % numReadings; // 更新索引

  average = total / numReadings; // 计算平均值
  Serial.println(average); // 输出滤波后的值
  delay(10); // 延迟以稳定采样
}
```

:::tip
均值滤波的效果取决于采样次数 `numReadings`。采样次数越多，滤波效果越好，但响应速度会变慢。
:::

### 中值滤波

中值滤波通过取多个采样值的中位数来消除异常值。这种方法适用于噪声较大且存在突变的信号。

以下是一个中值滤波的代码示例：

```cpp
const int numReadings = 5; // 采样次数
int readings[numReadings]; // 存储采样值的数组

void setup() {
  Serial.begin(9600);
}

void loop() {
  for (int i = 0; i < numReadings; i++) {
    readings[i] = analogRead(A0); // 读取采样值
    delay(10); // 延迟以稳定采样
  }

  // 对采样值进行排序
  for (int i = 0; i < numReadings - 1; i++) {
    for (int j = i + 1; j < numReadings; j++) {
      if (readings[i] > readings[j]) {
        int temp = readings[i];
        readings[i] = readings[j];
        readings[j] = temp;
      }
    }
  }

  int median = readings[numReadings / 2]; // 取中位数
  Serial.println(median); // 输出滤波后的值
}
```

:::caution
中值滤波的计算量较大，采样次数过多可能会影响Arduino的性能。
:::

### 低通滤波

低通滤波通过保留低频信号并滤除高频噪声来平滑数据。这种方法适用于噪声频率较高的信号。

以下是一个低通滤波的代码示例：

```cpp
float alpha = 0.2; // 滤波系数
int filteredValue = 0; // 滤波后的值

void setup() {
  Serial.begin(9600);
}

void loop() {
  int rawValue = analogRead(A0); // 读取原始值
  filteredValue = alpha * rawValue + (1 - alpha) * filteredValue; // 计算滤波后的值
  Serial.println(filteredValue); // 输出滤波后的值
  delay(10); // 延迟以稳定采样
}
```

:::tip
滤波系数 `alpha` 决定了滤波的强度。`alpha` 越小，滤波效果越强，但响应速度越慢。
:::

## 实际应用案例

### 案例1：温度传感器滤波

假设你使用一个温度传感器来监测环境温度，但传感器的读数受到电源噪声的干扰。你可以使用均值滤波来平滑数据，从而获得更稳定的温度读数。

```cpp
const int numReadings = 10;
int readings[numReadings];
int index = 0;
int total = 0;
int average = 0;

void setup() {
  Serial.begin(9600);
  for (int i = 0; i < numReadings; i++) {
    readings[i] = 0;
  }
}

void loop() {
  total -= readings[index];
  readings[index] = analogRead(A0);
  total += readings[index];
  index = (index + 1) % numReadings;

  average = total / numReadings;
  float temperature = (average * 5.0 / 1023.0) * 100; // 转换为温度值
  Serial.println(temperature);
  delay(100);
}
```

### 案例2：加速度传感器滤波

假设你使用一个加速度传感器来检测物体的运动状态，但传感器的读数存在突变。你可以使用中值滤波来消除这些异常值，从而获得更准确的运动数据。

```cpp
const int numReadings = 5;
int readings[numReadings];

void setup() {
  Serial.begin(9600);
}

void loop() {
  for (int i = 0; i < numReadings; i++) {
    readings[i] = analogRead(A0);
    delay(10);
  }

  for (int i = 0; i < numReadings - 1; i++) {
    for (int j = i + 1; j < numReadings; j++) {
      if (readings[i] > readings[j]) {
        int temp = readings[i];
        readings[i] = readings[j];
        readings[j] = temp;
      }
    }
  }

  int median = readings[numReadings / 2];
  Serial.println(median);
}
```

## 总结

信号滤波是Arduino项目中处理噪声数据的有效方法。通过均值滤波、中值滤波和低通滤波，你可以显著提高传感器数据的准确性和可靠性。选择适合的滤波方法取决于你的具体应用场景和噪声特性。

## 附加资源与练习

- **练习1**：尝试将均值滤波和中值滤波结合使用，观察滤波效果。
- **练习2**：调整低通滤波的滤波系数 `alpha`，观察其对滤波效果和响应速度的影响。
- **资源**：阅读Arduino官方文档，了解更多关于模拟输入输出的知识。

通过本文的学习，你应该能够在Arduino项目中应用信号滤波技术，从而提高数据的准确性和可靠性。祝你编程愉快！