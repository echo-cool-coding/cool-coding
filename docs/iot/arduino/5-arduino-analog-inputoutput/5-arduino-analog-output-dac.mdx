---
title: Arduino 模拟输出(DAC)
description: "了解如何使用Arduino的模拟输出功能，通过DAC（数模转换器）生成模拟信号。适合初学者的全面教程。"
---

# Arduino 模拟输出(DAC)

## 介绍

在Arduino中，模拟输出是通过**数模转换器（DAC, Digital-to-Analog Converter）**实现的。DAC可以将数字信号转换为模拟信号，从而控制外部设备的电压或电流。与PWM（脉宽调制）不同，DAC提供的是真正的模拟信号，而不是通过快速切换高低电平来模拟的。

Arduino的某些型号（如Arduino Due）内置了DAC功能，而其他型号（如Arduino Uno）则需要使用外部DAC模块来实现模拟输出。

## 什么是DAC？

DAC是一种将数字信号转换为模拟信号的设备。它接收一个数字值（通常是8位、10位或12位），并将其转换为相应的电压值。例如，一个10位DAC可以将0到1023的数字值转换为0V到5V的电压。

### 为什么需要DAC？

- **精确控制**：DAC可以提供精确的电压输出，适用于需要精细控制的场景，如音频生成、电机控制等。
- **真实模拟信号**：与PWM不同，DAC生成的是连续的模拟信号，适用于需要平滑变化的场景。

## Arduino 中的DAC

### 支持的Arduino型号

并非所有Arduino型号都内置DAC功能。以下是一些支持DAC的Arduino型号：

- **Arduino Due**：内置12位DAC，引脚为DAC0和DAC1。
- **Arduino Zero**：内置10位DAC，引脚为DAC0。

如果你使用的是不支持DAC的Arduino型号（如Arduino Uno），你可以通过外部DAC模块（如MCP4725）来实现模拟输出。

### 使用内置DAC

以下是一个使用Arduino Due内置DAC的简单示例：

```cpp
void setup() {
  // 初始化DAC引脚
  analogWriteResolution(12); // 设置DAC分辨率为12位
}

void loop() {
  // 生成一个从0到4095的模拟信号
  for (int i = 0; i < 4096; i++) {
    analogWrite(DAC0, i); // 将数字值写入DAC0引脚
    delay(1); // 延迟1毫秒
  }
}
```

在这个示例中，`analogWriteResolution(12)`将DAC的分辨率设置为12位，这意味着你可以输出0到4095之间的数字值。`analogWrite(DAC0, i)`将数字值`i`转换为相应的电压输出到DAC0引脚。

### 使用外部DAC模块

如果你使用的是不支持DAC的Arduino型号，可以使用外部DAC模块（如MCP4725）。以下是一个使用MCP4725的示例：

```cpp
#include <Wire.h>
#include <Adafruit_MCP4725.h>

Adafruit_MCP4725 dac;

void setup() {
  dac.begin(0x60); // 初始化MCP4725，I2C地址为0x60
}

void loop() {
  // 生成一个从0到4095的模拟信号
  for (int i = 0; i < 4096; i++) {
    dac.setVoltage(i, false); // 将数字值写入DAC
    delay(1); // 延迟1毫秒
  }
}
```

在这个示例中，`Adafruit_MCP4725`库用于控制MCP4725模块。`dac.setVoltage(i, false)`将数字值`i`转换为相应的电压输出。

## 实际应用场景

### 音频生成

DAC可以用于生成音频信号。通过将音频数据转换为模拟信号，你可以使用Arduino生成简单的音调或播放音频文件。

```cpp
void setup() {
  analogWriteResolution(12); // 设置DAC分辨率为12位
}

void loop() {
  // 生成一个简单的正弦波
  for (int i = 0; i < 4096; i++) {
    int value = 2048 + 2047 * sin(i * 2 * PI / 4096); // 计算正弦波值
    analogWrite(DAC0, value); // 将值写入DAC
    delayMicroseconds(10); // 延迟10微秒
  }
}
```

### 电机控制

DAC可以用于控制电机的速度或位置。通过输出不同的电压值，你可以精确控制电机的转速或位置。

```cpp
void setup() {
  analogWriteResolution(12); // 设置DAC分辨率为12位
}

void loop() {
  // 控制电机速度
  for (int i = 0; i < 4096; i++) {
    analogWrite(DAC0, i); // 将数字值写入DAC
    delay(10); // 延迟10毫秒
  }
}
```

## 总结

DAC是Arduino中实现模拟输出的重要工具，适用于需要精确控制电压或电流的场景。通过内置DAC或外部DAC模块，你可以生成真正的模拟信号，用于音频生成、电机控制等应用。

:::tip
如果你使用的是不支持DAC的Arduino型号，可以考虑使用外部DAC模块（如MCP4725）来实现模拟输出。
:::

## 附加资源与练习

- **练习1**：尝试使用DAC生成一个三角波信号。
- **练习2**：使用DAC控制LED的亮度，观察与PWM控制的不同。
- **资源**：了解更多关于DAC的工作原理和应用场景，可以参考Arduino官方文档和相关教程。

希望这篇教程能帮助你更好地理解和使用Arduino的模拟输出功能！如果你有任何问题或建议，欢迎在评论区留言。