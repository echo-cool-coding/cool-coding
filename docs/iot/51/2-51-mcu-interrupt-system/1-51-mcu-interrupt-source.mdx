---
title: 51单片机中断源
description: 了解51单片机的中断源，掌握中断的基本概念及其在嵌入式系统中的应用。
---

# 51单片机中断源

## 介绍

在嵌入式系统中，中断是一种非常重要的机制，它允许处理器在执行主程序的同时，能够响应外部或内部的事件。51单片机（如8051系列）具有多个中断源，这些中断源可以用于处理各种实时事件，例如按键输入、定时器溢出、串口通信等。

中断源是指能够触发中断的事件或信号。51单片机的中断源可以分为外部中断和内部中断两类。外部中断通常由外部设备触发，而内部中断则由单片机内部的定时器、串口等模块触发。

## 51单片机的中断源

51单片机通常有5个中断源，具体如下：

1. **外部中断0（INT0）**：由P3.2引脚触发，通常用于处理外部设备的信号。
2. **外部中断1（INT1）**：由P3.3引脚触发，功能与INT0类似。
3. **定时器0中断（TF0）**：当定时器0溢出时触发。
4. **定时器1中断（TF1）**：当定时器1溢出时触发。
5. **串口中断（RI/TI）**：当串口接收到数据或发送完数据时触发。

### 中断优先级

51单片机的中断源具有优先级，优先级高的中断会打断优先级低的中断。默认情况下，中断的优先级顺序为：INT0 > TF0 > INT1 > TF1 > RI/TI。用户可以通过设置中断优先级寄存器（IP）来调整中断的优先级。

## 中断处理流程

当中断发生时，单片机会执行以下步骤：

1. **保存当前程序计数器（PC）的值**：将当前执行的指令地址压入堆栈。
2. **跳转到中断服务程序（ISR）**：根据中断类型，跳转到相应的中断向量地址。
3. **执行中断服务程序**：在ISR中处理中断事件。
4. **恢复程序计数器（PC）的值**：从堆栈中弹出PC的值，继续执行主程序。

### 代码示例

以下是一个简单的51单片机中断处理代码示例，展示了如何使用外部中断0（INT0）来处理按键按下事件。

```c
#include <reg51.h>

sbit LED = P1^0;  // 定义LED连接到P1.0引脚

void external0_isr(void) interrupt 0 {
    LED = ~LED;  // 切换LED状态
}

void main() {
    IT0 = 1;     // 设置INT0为下降沿触发
    EX0 = 1;     // 使能外部中断0
    EA = 1;      // 使能全局中断

    while (1) {
        // 主程序循环
    }
}
```

在这个示例中，当按键按下时，INT0引脚会产生一个下降沿信号，触发外部中断0。中断服务程序 `external0_isr` 会被调用，切换LED的状态。

## 实际应用场景

### 案例1：按键去抖动

在实际应用中，按键按下时可能会产生抖动，导致多次触发中断。可以通过在中断服务程序中加入延时来消除抖动。

```c
void external0_isr(void) interrupt 0 {
    delay_ms(20);  // 延时20ms消除抖动
    if (INT0 == 0) {  // 再次检测按键状态
        LED = ~LED;  // 切换LED状态
    }
}
```

### 案例2：定时器中断

定时器中断可以用于精确计时。例如，使用定时器0每隔1秒切换一次LED状态。

```c
#include <reg51.h>

sbit LED = P1^0;  // 定义LED连接到P1.0引脚

void timer0_isr(void) interrupt 1 {
    TH0 = 0xFC;  // 重装定时器初值
    TL0 = 0x18;
    LED = ~LED;  // 切换LED状态
}

void main() {
    TMOD = 0x01;  // 设置定时器0为模式1
    TH0 = 0xFC;   // 设置定时器初值
    TL0 = 0x18;
    ET0 = 1;      // 使能定时器0中断
    EA = 1;       // 使能全局中断
    TR0 = 1;      // 启动定时器0

    while (1) {
        // 主程序循环
    }
}
```

## 总结

51单片机的中断系统是嵌入式开发中的重要组成部分。通过合理使用中断源，可以实现实时响应外部事件、精确计时等功能。掌握中断的基本概念和处理流程，对于开发高效的嵌入式系统至关重要。

## 附加资源与练习

- **练习1**：尝试修改代码，使用外部中断1（INT1）来控制另一个LED。
- **练习2**：结合定时器中断和外部中断，设计一个简单的秒表程序。
- **资源**：参考8051单片机数据手册，了解更多关于中断寄存器的详细信息。

:::tip
在实际开发中，合理设置中断优先级和优化中断服务程序的执行时间，可以提高系统的响应速度和稳定性。
:::