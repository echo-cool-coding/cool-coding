---
title: 51单片机波特率计算
description: 本文详细介绍了51单片机串行通信中的波特率计算方法，适合初学者学习。通过清晰的解释、代码示例和实际案例，帮助读者掌握波特率计算的原理和应用。
---

# 51单片机波特率计算

## 介绍

在51单片机的串行通信中，波特率（Baud Rate）是一个非常重要的参数。它决定了数据在通信线路上的传输速度。波特率越高，数据传输速度越快，但同时也对硬件的要求更高。因此，正确计算和设置波特率是确保通信稳定性的关键。

本文将详细介绍51单片机波特率的计算方法，并通过代码示例和实际案例帮助初学者理解这一概念。

## 波特率的基本概念

波特率是指每秒钟传输的符号数（Symbols per second），通常以bps（bits per second）为单位。在串行通信中，波特率决定了数据位的传输速度。

51单片机的串行通信通常使用定时器1（Timer 1）来生成波特率。波特率的计算公式如下：

```
波特率 = (2^SMOD / 32) * (晶振频率 / (12 * (256 - TH1)))
```

其中：
- `SMOD` 是波特率倍增位，位于 `PCON` 寄存器的第7位。当 `SMOD = 1` 时，波特率加倍。
- `晶振频率` 是单片机的外部晶振频率，通常为11.0592MHz或12MHz。
- `TH1` 是定时器1的初值。

## 波特率计算步骤

### 1. 确定晶振频率

首先，需要知道单片机的外部晶振频率。常见的晶振频率有11.0592MHz和12MHz。本文以11.0592MHz为例。

### 2. 选择波特率

根据通信需求选择合适的波特率。常见的波特率有9600bps、19200bps、38400bps等。

### 3. 计算定时器初值

根据波特率公式，计算定时器1的初值 `TH1`。以9600bps为例：

```
波特率 = 9600
晶振频率 = 11.0592MHz
SMOD = 0
```

将已知值代入公式：

```
9600 = (2^0 / 32) * (11059200 / (12 * (256 - TH1)))
```

简化公式：

```
9600 = (1 / 32) * (11059200 / (12 * (256 - TH1)))
```

进一步简化：

```
9600 = 11059200 / (384 * (256 - TH1))
```

解得：

```
256 - TH1 = 11059200 / (384 * 9600)
256 - TH1 = 3
TH1 = 253
```

因此，定时器1的初值 `TH1` 为253。

### 4. 配置寄存器

根据计算结果，配置相关寄存器：

```c
TMOD = 0x20;  // 设置定时器1为模式2（8位自动重装）
TH1 = 253;    // 设置定时器1初值
TL1 = 253;    // 设置定时器1初值
PCON &= 0x7F; // 设置SMOD=0
TR1 = 1;      // 启动定时器1
```

## 实际案例

假设我们需要在11.0592MHz的晶振频率下，使用9600bps的波特率进行串行通信。按照上述步骤计算，定时器1的初值 `TH1` 为253。

### 代码示例

```c
#include <reg51.h>

void UART_Init() {
    TMOD = 0x20;  // 设置定时器1为模式2
    TH1 = 253;    // 设置定时器1初值
    TL1 = 253;    // 设置定时器1初值
    PCON &= 0x7F; // 设置SMOD=0
    TR1 = 1;      // 启动定时器1
    SCON = 0x50;  // 设置串口模式1，8位数据，1位停止位
}

void UART_SendChar(char c) {
    SBUF = c;     // 发送字符
    while (!TI);  // 等待发送完成
    TI = 0;       // 清除发送标志
}

void main() {
    UART_Init();
    UART_SendChar('H');
    UART_SendChar('i');
    while (1);
}
```

### 输出

当程序运行时，串口会发送字符 `'H'` 和 `'i'`，波特率为9600bps。

## 总结

本文详细介绍了51单片机波特率的计算方法，并通过实际案例展示了如何配置寄存器以实现特定的波特率。掌握波特率的计算和配置是进行串行通信的基础，希望本文能帮助初学者更好地理解这一概念。

## 附加资源与练习

- **练习1**：尝试使用12MHz的晶振频率，计算9600bps波特率下的定时器1初值。
- **练习2**：修改代码，使用19200bps的波特率进行通信，并验证计算结果。
- **参考资源**：查阅51单片机的数据手册，了解更多关于定时器和串行通信的详细信息。

通过不断练习和探索，你将能够熟练地掌握51单片机的串行通信技术。