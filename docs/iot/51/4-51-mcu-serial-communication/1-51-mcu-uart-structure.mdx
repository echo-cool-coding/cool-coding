---
title: 51单片机UART结构
description: 本文详细介绍了51单片机的UART（通用异步收发传输器）结构，包括其工作原理、寄存器配置、代码示例以及实际应用场景，适合初学者学习。
---

# 51单片机UART结构

## 介绍

UART（Universal Asynchronous Receiver/Transmitter，通用异步收发传输器）是51单片机中用于串行通信的重要模块。它允许单片机通过串行接口与其他设备进行数据交换，广泛应用于嵌入式系统中。UART通信是异步的，意味着数据传输不需要时钟信号同步，而是通过起始位、数据位、校验位和停止位来协调通信。

本文将详细介绍51单片机的UART结构，包括其工作原理、寄存器配置、代码示例以及实际应用场景。

## UART的基本结构

51单片机的UART模块主要由以下几个部分组成：

1. **发送缓冲器（SBUF）**：用于存储待发送的数据。
2. **接收缓冲器（SBUF）**：用于存储接收到的数据。
3. **波特率发生器**：用于生成通信所需的波特率。
4. **控制寄存器（SCON）**：用于配置UART的工作模式。
5. **状态寄存器（SCON）**：用于指示UART的状态，如发送完成、接收完成等。

### 波特率

波特率是指每秒传输的位数（bps）。常见的波特率有9600、19200、38400等。波特率的选择需要与通信双方一致，否则会导致通信失败。

### 数据帧格式

UART通信的数据帧通常包括以下部分：

- **起始位**：1位，低电平，表示数据传输的开始。
- **数据位**：5-8位，实际传输的数据。
- **校验位**：1位，用于错误检测（可选）。
- **停止位**：1-2位，高电平，表示数据传输的结束。

## UART寄存器配置

51单片机的UART功能主要通过配置以下几个寄存器来实现：

- **SCON（串行控制寄存器）**：用于设置UART的工作模式和状态。
- **PCON（电源控制寄存器）**：用于设置波特率加倍位（SMOD）。
- **SBUF（串行数据缓冲器）**：用于存储发送和接收的数据。

### SCON寄存器

SCON寄存器的各位定义如下：

| 位 | 名称 | 功能 |
|----|------|------|
| 7  | SM0  | 工作模式选择位 |
| 6  | SM1  | 工作模式选择位 |
| 5  | SM2  | 多机通信控制位 |
| 4  | REN  | 接收使能位 |
| 3  | TB8  | 发送数据的第9位 |
| 2  | RB8  | 接收数据的第9位 |
| 1  | TI   | 发送中断标志位 |
| 0  | RI   | 接收中断标志位 |

### 波特率设置

波特率的设置通常通过定时器1来实现。以下是一个常见的波特率计算公式：

```
波特率 = (2^SMOD / 32) * (定时器1溢出率)
```

其中，`SMOD`是PCON寄存器中的波特率加倍位。

## 代码示例

以下是一个简单的UART通信示例代码，展示了如何配置UART并发送和接收数据。

```c
#include <reg51.h>

void UART_Init() {
    SCON = 0x50;        // 设置UART为模式1，8位数据，1位停止位
    TMOD = 0x20;        // 设置定时器1为模式2
    TH1 = 0xFD;         // 设置波特率为9600
    TL1 = 0xFD;
    TR1 = 1;            // 启动定时器1
    ES = 1;             // 使能串口中断
    EA = 1;             // 使能全局中断
}

void UART_Send(char data) {
    SBUF = data;        // 将数据放入发送缓冲器
    while (!TI);        // 等待发送完成
    TI = 0;             // 清除发送中断标志
}

char UART_Receive() {
    while (!RI);        // 等待接收完成
    RI = 0;             // 清除接收中断标志
    return SBUF;        // 返回接收到的数据
}

void main() {
    UART_Init();
    UART_Send('A');     // 发送字符'A'
    char received = UART_Receive(); // 接收数据
    while (1);
}
```

### 代码解释

1. **UART_Init()**：初始化UART，设置波特率为9600，并启用串口中断。
2. **UART_Send()**：发送一个字符，并等待发送完成。
3. **UART_Receive()**：接收一个字符，并返回接收到的数据。

## 实际应用场景

UART在嵌入式系统中有广泛的应用，以下是一些常见的应用场景：

1. **与PC通信**：通过串口调试助手与PC进行数据交换，调试程序。
2. **与传感器通信**：与温度传感器、湿度传感器等设备进行数据采集。
3. **多机通信**：在多个单片机之间进行数据交换，实现分布式控制系统。

## 总结

本文详细介绍了51单片机的UART结构，包括其工作原理、寄存器配置、代码示例以及实际应用场景。通过本文的学习，你应该能够理解UART的基本概念，并能够在实际项目中应用UART进行串行通信。

## 附加资源与练习

- **练习1**：修改代码，实现单片机与PC的双向通信。
- **练习2**：尝试使用不同的波特率进行通信，观察通信效果。
- **附加资源**：查阅51单片机的数据手册，了解更多关于UART的详细信息。

:::tip
在实际项目中，UART通信的稳定性和可靠性非常重要。建议在调试时使用示波器或逻辑分析仪来观察通信波形，确保数据传输的正确性。
:::