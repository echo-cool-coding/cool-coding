---
title: CentOS 存储扩展
description: 学习如何在CentOS中扩展存储空间，包括添加新磁盘、扩展逻辑卷以及调整文件系统大小。
---

# CentOS 存储扩展

在CentOS系统中，随着数据量的增长，存储空间可能会变得不足。为了应对这种情况，我们需要了解如何扩展存储空间。本文将详细介绍如何在CentOS中添加新磁盘、扩展逻辑卷以及调整文件系统大小。

## 1. 添加新磁盘

当现有磁盘空间不足时，我们可以通过添加新磁盘来扩展存储空间。以下是添加新磁盘的步骤：

### 1.1 物理连接新磁盘

首先，将新磁盘物理连接到服务器。确保磁盘已正确连接并被系统识别。

### 1.2 查看新磁盘

使用以下命令查看新磁盘是否被系统识别：

```bash
lsblk
```

输出示例：

```plaintext
NAME   MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT
sda      8:0    0   100G  0 disk 
├─sda1   8:1    0    99G  0 part /
└─sda2   8:2    0     1G  0 part [SWAP]
sdb      8:16   0   200G  0 disk 
```

在这个例子中，`sdb` 是新添加的磁盘。

### 1.3 分区和格式化新磁盘

使用 `fdisk` 或 `parted` 工具对新磁盘进行分区和格式化。以下是使用 `fdisk` 的示例：

```bash
fdisk /dev/sdb
```

在 `fdisk` 中，按 `n` 创建新分区，按 `w` 保存并退出。

然后，格式化新分区：

```bash
mkfs.ext4 /dev/sdb1
```

### 1.4 挂载新磁盘

创建一个挂载点并挂载新分区：

```bash
mkdir /mnt/newdisk
mount /dev/sdb1 /mnt/newdisk
```

为了在系统重启后自动挂载，编辑 `/etc/fstab` 文件：

```bash
echo '/dev/sdb1 /mnt/newdisk ext4 defaults 0 0' >> /etc/fstab
```

## 2. 扩展逻辑卷

如果系统使用了逻辑卷管理（LVM），我们可以通过扩展逻辑卷来增加存储空间。

### 2.1 查看当前逻辑卷

使用以下命令查看当前逻辑卷：

```bash
lvdisplay
```

输出示例：

```plaintext
  --- Logical volume ---
  LV Path                /dev/vg_data/lv_data
  LV Name                lv_data
  VG Name                vg_data
  LV Size                50.00 GiB
  ...
```

### 2.2 扩展逻辑卷

假设我们有一个新的物理卷 `/dev/sdb1`，首先将其添加到卷组中：

```bash
vgextend vg_data /dev/sdb1
```

然后，扩展逻辑卷：

```bash
lvextend -l +100%FREE /dev/vg_data/lv_data
```

### 2.3 调整文件系统大小

扩展逻辑卷后，需要调整文件系统大小以使用新增的空间。对于 `ext4` 文件系统，使用以下命令：

```bash
resize2fs /dev/vg_data/lv_data
```

## 3. 实际案例

假设我们有一个运行CentOS的Web服务器，存储空间不足导致无法上传新的文件。我们可以通过以下步骤扩展存储空间：

1. 添加一个新磁盘 `/dev/sdb`。
2. 将新磁盘添加到现有的逻辑卷组 `vg_data` 中。
3. 扩展逻辑卷 `lv_data` 并使用新增的空间。
4. 调整文件系统大小，确保Web服务器可以继续上传文件。

## 4. 总结

通过本文，我们学习了如何在CentOS中扩展存储空间，包括添加新磁盘、扩展逻辑卷以及调整文件系统大小。这些技能对于管理不断增长的存储需求至关重要。

## 5. 附加资源与练习

- **练习**：尝试在虚拟机中添加一个新磁盘，并按照本文的步骤扩展存储空间。
- **资源**：阅读 `man` 页面以了解更多关于 `fdisk`、`lvextend` 和 `resize2fs` 的详细信息。

:::tip
在操作存储设备时，务必小心谨慎，确保备份重要数据。
:::