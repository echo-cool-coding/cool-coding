---
title: CentOS iSCSI 存储
description: 了解如何在 CentOS 中配置和管理 iSCSI 存储，掌握 iSCSI 的基本概念、配置步骤以及实际应用场景。
---

# CentOS iSCSI 存储

iSCSI（Internet Small Computer System Interface）是一种基于 IP 网络的存储协议，允许将远程存储设备映射为本地磁盘。它广泛应用于数据中心和虚拟化环境中，提供了一种经济高效的存储解决方案。本文将介绍如何在 CentOS 中配置和管理 iSCSI 存储，适合初学者学习。

## 什么是 iSCSI？

iSCSI 是一种通过网络传输 SCSI 命令的协议，它将存储设备（如硬盘、磁带库）连接到服务器。通过 iSCSI，远程存储设备可以像本地磁盘一样被操作系统识别和使用。iSCSI 的主要优势在于其基于 IP 网络，无需专用硬件即可实现存储共享。

### iSCSI 的基本组件

- **iSCSI Initiator**：客户端，负责发起连接并访问远程存储设备。
- **iSCSI Target**：服务器端，提供存储资源供客户端使用。
- **LUN（Logical Unit Number）**：逻辑单元号，用于标识存储设备中的逻辑单元。

## 在 CentOS 中配置 iSCSI

### 1. 安装 iSCSI Initiator

首先，在 CentOS 中安装 `iscsi-initiator-utils` 包，这是 iSCSI 客户端的工具集。

```bash
sudo yum install iscsi-initiator-utils -y
```

安装完成后，启动并启用 `iscsid` 服务：

```bash
sudo systemctl start iscsid
sudo systemctl enable iscsid
```

### 2. 发现 iSCSI Target

使用以下命令发现可用的 iSCSI Target：

```bash
sudo iscsiadm -m discovery -t sendtargets -p <target_ip>
```

其中 `<target_ip>` 是 iSCSI Target 服务器的 IP 地址。执行后，系统会列出可用的 Target。

### 3. 登录到 iSCSI Target

发现 Target 后，使用以下命令登录：

```bash
sudo iscsiadm -m node -T <target_name> -p <target_ip> -l
```

其中 `<target_name>` 是 Target 的名称，`<target_ip>` 是 Target 的 IP 地址。

### 4. 验证连接

登录成功后，使用 `lsblk` 或 `fdisk -l` 命令查看新连接的磁盘设备：

```bash
lsblk
```

你应该能够看到一个新的磁盘设备，例如 `/dev/sdb`。

### 5. 挂载 iSCSI 磁盘

将 iSCSI 磁盘格式化为文件系统并挂载：

```bash
sudo mkfs.ext4 /dev/sdb
sudo mkdir /mnt/iscsi
sudo mount /dev/sdb /mnt/iscsi
```

现在，iSCSI 磁盘已经可以像本地磁盘一样使用了。

## 实际应用场景

### 场景 1：虚拟化环境中的共享存储

在虚拟化环境中，iSCSI 常用于为虚拟机提供共享存储。例如，VMware ESXi 或 KVM 可以使用 iSCSI 存储作为虚拟机的数据存储，从而实现高可用性和动态扩展。

### 场景 2：数据库服务器的存储扩展

对于需要高性能存储的数据库服务器，iSCSI 可以将远程存储设备映射为本地磁盘，提供更高的 I/O 性能和存储容量。

## 总结

iSCSI 是一种强大的存储协议，能够通过网络将远程存储设备映射为本地磁盘。通过本文的学习，你应该已经掌握了在 CentOS 中配置和管理 iSCSI 存储的基本步骤。iSCSI 在虚拟化、数据库和高可用性环境中有着广泛的应用，是存储管理的重要工具。

## 附加资源与练习

- **练习**：尝试在本地虚拟机中搭建一个 iSCSI Target，并使用另一台虚拟机作为 Initiator 进行连接。
- **资源**：
  - [iSCSI 官方文档](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/storage_administration_guide/ch-iscsi)
  - [CentOS 存储管理指南](https://wiki.centos.org/HowTos/StorageManagement)

:::tip
如果你在配置过程中遇到问题，可以查看 `/var/log/messages` 或使用 `dmesg` 命令排查错误。
:::