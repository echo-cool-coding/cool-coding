---
title: CentOS 循环结构
description: 了解如何在CentOS Shell脚本中使用循环结构，包括for循环、while循环和until循环，并通过实际案例掌握其应用。
---

# CentOS 循环结构

在Shell脚本编程中，循环结构是一种强大的工具，它允许我们重复执行一段代码，直到满足特定条件为止。CentOS Shell脚本支持多种循环结构，包括`for`循环、`while`循环和`until`循环。本文将详细介绍这些循环结构的使用方法，并通过实际案例帮助你掌握它们的应用。

## 1. 什么是循环结构？

循环结构是编程中的一种控制结构，用于重复执行一段代码。通过循环，我们可以避免重复编写相同的代码，从而提高代码的可读性和可维护性。在Shell脚本中，常见的循环结构包括：

- **for循环**：用于遍历一个列表或范围，并对每个元素执行相同的操作。
- **while循环**：在条件为真时重复执行一段代码。
- **until循环**：在条件为假时重复执行一段代码，直到条件为真为止。

## 2. for循环

`for`循环是最常用的循环结构之一，它允许我们遍历一个列表或范围，并对每个元素执行相同的操作。

### 语法

```bash
for 变量 in 列表
do
    命令
done
```

### 示例

假设我们有一个包含多个文件名的列表，我们想要打印每个文件的名称：

```bash
#!/bin/bash

for file in file1.txt file2.txt file3.txt
do
    echo "Processing $file"
done
```

**输出：**

```
Processing file1.txt
Processing file2.txt
Processing file3.txt
```

### 实际应用

在实际应用中，`for`循环常用于遍历目录中的文件或处理命令行参数。例如，以下脚本会遍历当前目录中的所有`.txt`文件，并打印它们的名称：

```bash
#!/bin/bash

for file in *.txt
do
    echo "Found text file: $file"
done
```

## 3. while循环

`while`循环在条件为真时重复执行一段代码。它通常用于需要根据条件动态控制循环次数的场景。

### 语法

```bash
while [ 条件 ]
do
    命令
done
```

### 示例

以下脚本会从1数到5：

```bash
#!/bin/bash

count=1

while [ $count -le 5 ]
do
    echo "Count: $count"
    count=$((count + 1))
done
```

**输出：**

```
Count: 1
Count: 2
Count: 3
Count: 4
Count: 5
```

### 实际应用

`while`循环常用于处理需要持续监控的任务，例如监控系统资源或等待某个条件满足。以下脚本会持续检查某个文件是否存在，直到文件被创建：

```bash
#!/bin/bash

while [ ! -f /tmp/myfile.txt ]
do
    echo "Waiting for /tmp/myfile.txt to be created..."
    sleep 1
done

echo "File found!"
```

## 4. until循环

`until`循环与`while`循环类似，但它是在条件为假时重复执行一段代码，直到条件为真为止。

### 语法

```bash
until [ 条件 ]
do
    命令
done
```

### 示例

以下脚本会从5倒数到1：

```bash
#!/bin/bash

count=5

until [ $count -eq 0 ]
do
    echo "Countdown: $count"
    count=$((count - 1))
done
```

**输出：**

```
Countdown: 5
Countdown: 4
Countdown: 3
Countdown: 2
Countdown: 1
```

### 实际应用

`until`循环常用于等待某个条件满足的场景。例如，以下脚本会等待用户输入“yes”：

```bash
#!/bin/bash

response=""

until [ "$response" = "yes" ]
do
    echo -n "Please type 'yes': "
    read response
done

echo "Thank you!"
```

## 5. 循环控制语句

在循环中，我们有时需要提前退出循环或跳过某些迭代。Shell脚本提供了`break`和`continue`语句来实现这些功能。

### break语句

`break`语句用于立即退出循环。

#### 示例

以下脚本会在找到目标文件后立即退出循环：

```bash
#!/bin/bash

for file in *.txt
do
    if [ "$file" = "target.txt" ]
    then
        echo "Found target file: $file"
        break
    fi
    echo "Checking $file"
done
```

### continue语句

`continue`语句用于跳过当前迭代，直接进入下一次迭代。

#### 示例

以下脚本会跳过所有以“test”开头的文件：

```bash
#!/bin/bash

for file in *.txt
do
    if [[ "$file" == test* ]]
    then
        continue
    fi
    echo "Processing $file"
done
```

## 6. 实际案例

### 案例1：批量重命名文件

假设我们有一组文件，文件名格式为`file1.txt`、`file2.txt`等，我们想要将它们重命名为`backup1.txt`、`backup2.txt`等。可以使用以下脚本：

```bash
#!/bin/bash

for file in file*.txt
do
    newname=$(echo $file | sed 's/file/backup/')
    mv "$file" "$newname"
    echo "Renamed $file to $newname"
done
```

### 案例2：监控系统负载

以下脚本会持续监控系统负载，并在负载过高时发出警告：

```bash
#!/bin/bash

while true
do
    load=$(uptime | awk '{print $10}' | sed 's/,//')
    if (( $(echo "$load > 1.0" | bc -l) ))
    then
        echo "High system load detected: $load"
    fi
    sleep 5
done
```

## 7. 总结

循环结构是Shell脚本编程中不可或缺的一部分。通过`for`、`while`和`until`循环，我们可以轻松地重复执行代码，处理复杂的任务。掌握这些循环结构的使用方法，将大大提高你的脚本编写能力。

## 8. 附加资源与练习

- **练习1**：编写一个脚本，使用`for`循环遍历当前目录中的所有`.log`文件，并将它们移动到`/var/logs`目录。
- **练习2**：编写一个脚本，使用`while`循环等待用户输入“exit”，并在用户输入后退出循环。
- **附加资源**：阅读Bash脚本编程的官方文档，了解更多高级循环技巧和最佳实践。

:::tip
在编写循环时，务必注意循环条件的设置，避免无限循环的发生。
:::

:::caution
在使用`break`和`continue`语句时，确保逻辑清晰，以免影响程序的正常流程。
:::