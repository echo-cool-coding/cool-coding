---
title: CentOS 脚本调度
description: 学习如何在CentOS中使用Shell脚本进行任务调度，掌握cron和at命令的基本用法及其实际应用场景。
---

# CentOS 脚本调度

在CentOS系统中，脚本调度是一项非常重要的技能，它允许你自动化执行重复性任务，从而提高工作效率。本文将介绍如何使用`cron`和`at`命令来调度Shell脚本的执行。

## 什么是脚本调度？

脚本调度是指在特定的时间或条件下自动执行脚本的过程。通过脚本调度，你可以让系统在无需人工干预的情况下完成诸如备份、日志清理、系统监控等任务。

## 使用`cron`进行任务调度

`cron`是Linux系统中用于周期性任务调度的工具。它通过`crontab`文件来管理任务计划。

### 1. 编辑`crontab`文件

要编辑当前用户的`crontab`文件，可以使用以下命令：

```bash
crontab -e
```

### 2. `crontab`文件格式

`crontab`文件的每一行代表一个任务，格式如下：

```bash
* * * * * command_to_execute
```

其中，五个星号分别代表：

- 分钟 (0 - 59)
- 小时 (0 - 23)
- 日 (1 - 31)
- 月 (1 - 12)
- 星期 (0 - 7)（0和7都代表星期日）

例如，以下任务将在每天的凌晨2点执行`/path/to/script.sh`：

```bash
0 2 * * * /path/to/script.sh
```

### 3. 示例：每天备份数据库

假设你有一个备份数据库的脚本`/home/user/backup_db.sh`，你可以将其添加到`crontab`中：

```bash
0 3 * * * /home/user/backup_db.sh
```

这将在每天凌晨3点执行备份任务。

## 使用`at`进行一次性任务调度

`at`命令用于在指定的时间执行一次性任务。

### 1. 基本用法

要使用`at`命令，首先需要安装`at`包：

```bash
sudo yum install at
```

然后，可以使用以下命令来调度任务：

```bash
at 14:00
```

在提示符下输入要执行的命令，然后按`Ctrl+D`结束输入。

### 2. 示例：在指定时间发送邮件

假设你想在下午4点发送一封邮件，可以使用以下命令：

```bash
at 16:00
at> echo "Hello, this is a reminder!" | mail -s "Reminder" user@example.com
at> <EOT>
```

## 实际应用场景

### 1. 系统监控

你可以编写一个脚本，定期检查系统的CPU、内存和磁盘使用情况，并将结果保存到日志文件中。然后使用`cron`每天定时执行该脚本。

### 2. 日志清理

定期清理旧的日志文件可以防止磁盘空间被占满。你可以编写一个脚本，删除超过30天的日志文件，并使用`cron`每周执行一次。

## 总结

通过`cron`和`at`命令，你可以轻松地在CentOS系统中调度Shell脚本的执行。无论是周期性任务还是一次性任务，脚本调度都能帮助你自动化处理重复性工作，提高效率。

## 附加资源与练习

- **练习1**：编写一个脚本，每天凌晨1点清理`/var/log`目录下超过7天的日志文件，并使用`cron`调度该脚本。
- **练习2**：使用`at`命令，在明天上午10点执行一个脚本，该脚本将当前系统时间写入到一个文件中。

通过以上练习，你将更深入地理解脚本调度的实际应用。