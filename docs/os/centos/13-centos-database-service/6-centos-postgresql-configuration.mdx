---
title: CentOS PostgreSQL 配置
description: 学习如何在 CentOS 系统上安装和配置 PostgreSQL 数据库服务，适合初学者。
---

# CentOS PostgreSQL 配置

PostgreSQL 是一个功能强大的开源关系型数据库管理系统（RDBMS），广泛应用于各种规模的项目中。在 CentOS 系统上配置 PostgreSQL 是许多开发者和系统管理员的基本技能之一。本文将逐步指导你如何在 CentOS 上安装、配置和管理 PostgreSQL 数据库。

## 1. 安装 PostgreSQL

首先，我们需要在 CentOS 系统上安装 PostgreSQL。CentOS 默认的软件仓库中可能不包含最新版本的 PostgreSQL，因此我们可以使用 PostgreSQL 官方提供的仓库来安装最新版本。

### 1.1 添加 PostgreSQL 仓库

打开终端并执行以下命令来添加 PostgreSQL 官方仓库：

```bash
sudo yum install -y https://download.postgresql.org/pub/repos/yum/reporpms/EL-7-x86_64/pgdg-redhat-repo-latest.noarch.rpm
```

### 1.2 安装 PostgreSQL

添加仓库后，使用以下命令安装 PostgreSQL：

```bash
sudo yum install -y postgresql12-server
```

:::note
`postgresql12-server` 中的 `12` 表示 PostgreSQL 的版本号。你可以根据需要安装其他版本。
:::

### 1.3 初始化数据库

安装完成后，初始化 PostgreSQL 数据库：

```bash
sudo /usr/pgsql-12/bin/postgresql-12-setup initdb
```

### 1.4 启动并启用 PostgreSQL 服务

启动 PostgreSQL 服务并将其设置为开机自启：

```bash
sudo systemctl start postgresql-12
sudo systemctl enable postgresql-12
```

## 2. 配置 PostgreSQL

安装完成后，我们需要对 PostgreSQL 进行一些基本配置，以确保其安全性和可用性。

### 2.1 配置远程访问

默认情况下，PostgreSQL 只允许本地访问。如果你需要从远程主机访问数据库，需要修改配置文件。

编辑 PostgreSQL 的主配置文件 `pg_hba.conf`：

```bash
sudo vi /var/lib/pgsql/12/data/pg_hba.conf
```

在文件末尾添加以下行，允许所有 IP 地址通过密码认证访问数据库：

```plaintext
host    all             all             0.0.0.0/0               md5
```

接下来，编辑 `postgresql.conf` 文件，允许监听所有网络接口：

```bash
sudo vi /var/lib/pgsql/12/data/postgresql.conf
```

找到 `listen_addresses` 行，并将其修改为：

```plaintext
listen_addresses = '*'
```

保存并退出编辑器，然后重启 PostgreSQL 服务以应用更改：

```bash
sudo systemctl restart postgresql-12
```

### 2.2 创建数据库和用户

PostgreSQL 安装完成后，默认会创建一个名为 `postgres` 的系统用户。你可以使用该用户登录并创建新的数据库和用户。

切换到 `postgres` 用户：

```bash
sudo -i -u postgres
```

进入 PostgreSQL 命令行工具：

```bash
psql
```

创建一个新用户和数据库：

```sql
CREATE USER myuser WITH PASSWORD 'mypassword';
CREATE DATABASE mydb OWNER myuser;
```

退出 PostgreSQL 命令行工具：

```sql
\q
```

## 3. 实际案例

假设你正在开发一个简单的 Web 应用程序，需要使用 PostgreSQL 作为后端数据库。以下是一个实际案例，展示如何在应用程序中连接到 PostgreSQL 数据库。

### 3.1 使用 Python 连接 PostgreSQL

首先，安装 `psycopg2` 库，它是 Python 连接 PostgreSQL 的常用库：

```bash
pip install psycopg2
```

然后，编写一个简单的 Python 脚本来连接数据库并执行查询：

```python
import psycopg2

# 连接到数据库
conn = psycopg2.connect(
    dbname="mydb",
    user="myuser",
    password="mypassword",
    host="your_server_ip",
    port="5432"
)

# 创建游标对象
cur = conn.cursor()

# 执行查询
cur.execute("SELECT version();")
db_version = cur.fetchone()
print("Database version:", db_version)

# 关闭连接
cur.close()
conn.close()
```

运行该脚本，你将看到 PostgreSQL 的版本信息。

## 4. 总结

通过本文，你已经学会了如何在 CentOS 系统上安装和配置 PostgreSQL 数据库服务。我们还介绍了如何配置远程访问、创建数据库和用户，并通过一个实际案例展示了如何在 Python 应用程序中连接 PostgreSQL。

## 5. 附加资源与练习

- **官方文档**: [PostgreSQL Documentation](https://www.postgresql.org/docs/)
- **练习**: 尝试在 CentOS 上安装不同版本的 PostgreSQL，并配置多个数据库和用户。
- **进阶**: 学习如何配置 PostgreSQL 的备份和恢复策略，以确保数据安全。

希望本文对你有所帮助，祝你在 PostgreSQL 的学习和实践中取得成功！