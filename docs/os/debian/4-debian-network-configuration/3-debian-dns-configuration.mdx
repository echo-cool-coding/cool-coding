---
title: Debian DNS 配置
description: 学习如何在 Debian 系统中配置 DNS，确保网络连接正常并解析域名。
---

# Debian DNS 配置

在 Debian 系统中，DNS（域名系统）配置是网络设置的重要组成部分。DNS 负责将人类可读的域名（如 `example.com`）转换为机器可读的 IP 地址（如 `93.184.216.34`）。正确配置 DNS 是确保系统能够访问互联网和其他网络资源的关键。

本文将逐步指导你如何在 Debian 系统中配置 DNS，并提供实际案例帮助你理解其应用场景。

---

## 什么是 DNS？

DNS（Domain Name System）是一种将域名转换为 IP 地址的系统。它类似于电话簿，将易于记忆的域名映射到复杂的 IP 地址。例如，当你访问 `google.com` 时，DNS 会将其解析为 `142.250.190.14`，以便你的计算机能够连接到 Google 的服务器。

---

## Debian 中的 DNS 配置文件

在 Debian 中，DNS 配置通常存储在以下文件中：

1. **`/etc/resolv.conf`**：这是主要的 DNS 配置文件，用于指定 DNS 服务器的 IP 地址。
2. **`/etc/network/interfaces`** 或 **`/etc/netplan/*.yaml`**：这些文件用于配置网络接口，包括 DNS 设置（取决于网络管理工具）。

---

## 配置 DNS 的步骤

### 1. 编辑 `/etc/resolv.conf`

`/etc/resolv.conf` 文件用于指定 DNS 服务器的 IP 地址。你可以手动编辑此文件来添加 DNS 服务器。

```bash
sudo nano /etc/resolv.conf
```

在文件中添加以下内容：

```plaintext
nameserver 8.8.8.8
nameserver 8.8.4.4
```

- `8.8.8.8` 和 `8.8.4.4` 是 Google 的公共 DNS 服务器。
- 你可以根据需要添加其他 DNS 服务器，例如 Cloudflare 的 `1.1.1.1`。

:::note
在较新的 Debian 版本中，`/etc/resolv.conf` 可能由网络管理工具（如 `systemd-resolved` 或 `NetworkManager`）自动生成。如果你使用这些工具，请参考相关文档进行配置。
:::

---

### 2. 使用 `systemd-resolved` 配置 DNS

如果你使用的是 `systemd-resolved`，可以通过以下步骤配置 DNS：

1. 编辑 `/etc/systemd/resolved.conf` 文件：

   ```bash
   sudo nano /etc/systemd/resolved.conf
   ```

2. 添加或修改以下行：

   ```plaintext
   [Resolve]
   DNS=8.8.8.8 8.8.4.4
   FallbackDNS=1.1.1.1
   ```

3. 重启 `systemd-resolved` 服务：

   ```bash
   sudo systemctl restart systemd-resolved
   ```

---

### 3. 使用 `NetworkManager` 配置 DNS

如果你使用 `NetworkManager`，可以通过以下步骤配置 DNS：

1. 打开网络连接设置：

   ```bash
   nmtui
   ```

2. 选择要配置的网络连接，然后编辑其 DNS 设置。
3. 添加 DNS 服务器地址，例如 `8.8.8.8` 和 `8.8.4.4`。
4. 保存并退出。

---

## 实际案例：配置本地 DNS 服务器

假设你正在运行一个本地 DNS 服务器（如 `dnsmasq`），并希望将其配置为 Debian 系统的默认 DNS 服务器。

1. 安装 `dnsmasq`：

   ```bash
   sudo apt install dnsmasq
   ```

2. 编辑 `/etc/dnsmasq.conf` 文件：

   ```bash
   sudo nano /etc/dnsmasq.conf
   ```

3. 添加以下配置：

   ```plaintext
   server=8.8.8.8
   server=8.8.4.4
   ```

4. 重启 `dnsmasq` 服务：

   ```bash
   sudo systemctl restart dnsmasq
   ```

5. 将 `/etc/resolv.conf` 中的 DNS 服务器指向本地：

   ```plaintext
   nameserver 127.0.0.1
   ```

---

## 验证 DNS 配置

你可以使用以下命令验证 DNS 配置是否生效：

1. 使用 `nslookup` 测试域名解析：

   ```bash
   nslookup example.com
   ```

   输出示例：

   ```plaintext
   Server:         8.8.8.8
   Address:        8.8.8.8#53

   Non-authoritative answer:
   Name:   example.com
   Address: 93.184.216.34
   ```

2. 使用 `dig` 命令进行更详细的 DNS 查询：

   ```bash
   dig example.com
   ```

---

## 总结

在 Debian 系统中配置 DNS 是确保网络连接正常的关键步骤。通过编辑 `/etc/resolv.conf` 或使用网络管理工具（如 `systemd-resolved` 或 `NetworkManager`），你可以轻松配置 DNS 服务器。本文还提供了一个实际案例，展示了如何配置本地 DNS 服务器。

---

## 附加资源

- [Debian 官方文档](https://www.debian.org/doc/)
- [DNS 基础知识](https://www.cloudflare.com/learning/dns/what-is-dns/)
- [systemd-resolved 文档](https://www.freedesktop.org/software/systemd/man/systemd-resolved.service.html)

---

## 练习

1. 尝试将你的 DNS 服务器更改为 `1.1.1.1`（Cloudflare 的公共 DNS），并验证其是否生效。
2. 安装并配置 `dnsmasq`，将其作为本地 DNS 服务器使用。
3. 使用 `dig` 命令查询 `google.com` 的 DNS 记录，并分析输出结果。