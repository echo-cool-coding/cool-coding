---
title: useReducer 钩子
description: 了解 React 中的 useReducer 钩子，掌握如何使用它来管理复杂的状态逻辑。
---

# useReducer 钩子

`useReducer` 是 React 提供的一个钩子，用于管理组件中的复杂状态逻辑。它类似于 `useState`，但更适合处理包含多个子值或依赖于之前状态的状态更新。`useReducer` 的核心思想是使用一个 reducer 函数来处理状态更新，这使得状态管理更加可预测和易于调试。

## 什么是 useReducer？

`useReducer` 是一个 React 钩子，它接受一个 reducer 函数和一个初始状态作为参数，并返回当前状态以及一个 dispatch 函数。通过调用 dispatch 函数并传递一个 action，可以触发状态更新。

### 基本语法

```javascript
const [state, dispatch] = useReducer(reducer, initialState);
```

- `reducer`：一个函数，接受当前状态和一个 action，返回新的状态。
- `initialState`：状态的初始值。
- `state`：当前的状态。
- `dispatch`：一个函数，用于触发状态更新。

## 如何使用 useReducer？

### 1. 定义 Reducer 函数

Reducer 函数接受两个参数：当前状态和一个 action。根据 action 的类型，reducer 函数会返回新的状态。

```javascript
function reducer(state, action) {
  switch (action.type) {
    case 'increment':
      return { count: state.count + 1 };
    case 'decrement':
      return { count: state.count - 1 };
    default:
      throw new Error();
  }
}
```

### 2. 初始化 useReducer

在组件中使用 `useReducer` 钩子，传入 reducer 函数和初始状态。

```javascript
const initialState = { count: 0 };

function Counter() {
  const [state, dispatch] = useReducer(reducer, initialState);

  return (
    <>
      Count: {state.count}
      <button onClick={() => dispatch({ type: 'increment' })}>+</button>
      <button onClick={() => dispatch({ type: 'decrement' })}>-</button>
    </>
  );
}
```

### 3. 触发状态更新

通过调用 `dispatch` 函数并传递一个 action，可以触发状态更新。在上面的例子中，点击按钮会分别增加或减少计数器的值。

## 实际应用场景

`useReducer` 特别适合处理以下场景：

1. **复杂的状态逻辑**：当状态更新逻辑较为复杂时，使用 `useReducer` 可以将逻辑集中在一个地方，使代码更易于维护。
2. **依赖之前状态的状态更新**：如果新状态依赖于之前的状态，使用 `useReducer` 可以避免直接修改状态带来的问题。
3. **全局状态管理**：虽然 `useReducer` 通常用于组件内部的状态管理，但它也可以与 Context API 结合使用，实现简单的全局状态管理。

### 示例：购物车状态管理

假设我们有一个购物车组件，需要管理商品的数量和总价。使用 `useReducer` 可以轻松实现这一功能。

```javascript
const initialState = { items: [], total: 0 };

function cartReducer(state, action) {
  switch (action.type) {
    case 'add_item':
      return {
        items: [...state.items, action.payload],
        total: state.total + action.payload.price,
      };
    case 'remove_item':
      return {
        items: state.items.filter(item => item.id !== action.payload.id),
        total: state.total - action.payload.price,
      };
    default:
      throw new Error();
  }
}

function Cart() {
  const [state, dispatch] = useReducer(cartReducer, initialState);

  const addItem = item => dispatch({ type: 'add_item', payload: item });
  const removeItem = item => dispatch({ type: 'remove_item', payload: item });

  return (
    <div>
      <h2>购物车</h2>
      <ul>
        {state.items.map(item => (
          <li key={item.id}>
            {item.name} - ${item.price}
            <button onClick={() => removeItem(item)}>移除</button>
          </li>
        ))}
      </ul>
      <p>总价: ${state.total}</p>
      <button onClick={() => addItem({ id: 1, name: '商品1', price: 10 })}>
        添加商品1
      </button>
    </div>
  );
}
```

## 总结

`useReducer` 是 React 中一个强大的工具，特别适合处理复杂的状态逻辑。通过将状态更新逻辑集中在一个 reducer 函数中，可以使代码更加清晰和易于维护。对于初学者来说，掌握 `useReducer` 是迈向高级 React 开发的重要一步。

## 附加资源与练习

- **官方文档**：[React useReducer 文档](https://reactjs.org/docs/hooks-reference.html#usereducer)
- **练习**：尝试使用 `useReducer` 实现一个待办事项列表，支持添加、删除和标记完成功能。

:::tip
如果你对 `useReducer` 的使用还有疑问，建议从简单的计数器开始，逐步扩展到更复杂的场景。通过实践，你将更好地理解其工作原理。
:::