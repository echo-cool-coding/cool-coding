---
title: 表单状态管理
description: 学习如何在 React 中管理表单状态，掌握受控组件和非受控组件的使用，并通过实际案例理解表单状态管理的核心概念。
---

# 表单状态管理

在 React 中，表单是用户与应用程序交互的重要方式之一。表单状态管理是指如何在 React 中有效地管理表单数据的变化和提交。本文将详细介绍如何使用受控组件和非受控组件来管理表单状态，并通过实际案例帮助你更好地理解这一概念。

## 什么是表单状态管理？

表单状态管理是指在 React 应用中，如何捕获、存储和更新用户在表单中输入的数据。React 提供了两种主要的方式来管理表单状态：

1. **受控组件（Controlled Components）**：表单数据由 React 组件的状态（state）管理。
2. **非受控组件（Uncontrolled Components）**：表单数据由 DOM 自身管理，React 通过 ref 来访问表单数据。

### 受控组件

在受控组件中，表单的输入值由 React 的状态（state）控制。每当用户输入内容时，状态会更新，从而重新渲染组件。

#### 示例：受控输入框

```jsx
import React, { useState } from 'react';

function ControlledInput() {
  const [value, setValue] = useState('');

  const handleChange = (event) => {
    setValue(event.target.value);
  };

  return (
    <div>
      <label>
        输入内容:
        <input type="text" value={value} onChange={handleChange} />
      </label>
      <p>你输入的内容是: {value}</p>
    </div>
  );
}

export default ControlledInput;
```

在这个例子中，`value` 状态变量存储了输入框的值，`handleChange` 函数在每次输入时更新状态。这样，输入框的值始终与 React 的状态保持同步。

### 非受控组件

在非受控组件中，表单数据由 DOM 自身管理。React 通过 ref 来访问表单数据，而不是通过状态。

#### 示例：非受控输入框

```jsx
import React, { useRef } from 'react';

function UncontrolledInput() {
  const inputRef = useRef(null);

  const handleSubmit = (event) => {
    event.preventDefault();
    alert('输入的内容是: ' + inputRef.current.value);
  };

  return (
    <form onSubmit={handleSubmit}>
      <label>
        输入内容:
        <input type="text" ref={inputRef} />
      </label>
      <button type="submit">提交</button>
    </form>
  );
}

export default UncontrolledInput;
```

在这个例子中，`inputRef` 是一个 ref，它指向输入框的 DOM 元素。当表单提交时，我们可以通过 `inputRef.current.value` 来获取输入框的值。

:::tip
受控组件通常更符合 React 的设计理念，因为它们将表单数据与组件的状态绑定在一起。然而，非受控组件在某些情况下（如表单数据量较大或性能要求较高时）可能更为合适。
:::

## 实际案例：登录表单

让我们通过一个实际的登录表单案例来理解表单状态管理的应用。

### 登录表单示例

```jsx
import React, { useState } from 'react';

function LoginForm() {
  const [username, setUsername] = useState('');
  const [password, setPassword] = useState('');

  const handleSubmit = (event) => {
    event.preventDefault();
    alert(`用户名: ${username}, 密码: ${password}`);
  };

  return (
    <form onSubmit={handleSubmit}>
      <div>
        <label>
          用户名:
          <input
            type="text"
            value={username}
            onChange={(e) => setUsername(e.target.value)}
          />
        </label>
      </div>
      <div>
        <label>
          密码:
          <input
            type="password"
            value={password}
            onChange={(e) => setPassword(e.target.value)}
          />
        </label>
      </div>
      <button type="submit">登录</button>
    </form>
  );
}

export default LoginForm;
```

在这个例子中，我们使用了两个受控输入框来分别管理用户名和密码的状态。当用户点击“登录”按钮时，表单会提交并弹出一个包含用户名和密码的提示框。

:::caution
在实际应用中，密码等敏感信息不应直接通过 `alert` 显示，这里仅用于演示目的。
:::

## 总结

表单状态管理是 React 应用开发中的一个重要概念。通过受控组件，我们可以将表单数据与 React 的状态绑定在一起，从而实现更灵活和可控的表单处理。非受控组件则提供了一种更直接的方式来访问表单数据，适用于某些特定的场景。

在实际开发中，选择受控组件还是非受控组件取决于具体的需求和性能考虑。希望本文能帮助你更好地理解表单状态管理，并在实际项目中灵活运用。

## 附加资源与练习

- **练习**：尝试创建一个注册表单，包含用户名、密码和确认密码字段，并在提交时验证密码是否一致。
- **资源**：
  - [React 官方文档 - 表单](https://reactjs.org/docs/forms.html)
  - [React 官方文档 - 受控组件与非受控组件](https://reactjs.org/docs/uncontrolled-components.html)
