---
title: 环境变量管理
description: 学习如何在 React 工程化项目中管理环境变量，确保开发、测试和生产环境的安全性和灵活性。
---

# 环境变量管理

在 React 工程化开发中，环境变量管理是一个至关重要的环节。它允许我们在不同的环境中（如开发、测试和生产）使用不同的配置，而无需修改代码。通过合理管理环境变量，我们可以确保敏感信息（如 API 密钥）的安全性，同时提高代码的灵活性和可维护性。

## 什么是环境变量？

环境变量是存储在操作系统或应用程序中的键值对，用于配置应用程序的行为。在 React 项目中，环境变量通常用于存储 API 端点、调试标志、第三方服务密钥等信息。

### 为什么需要环境变量？

1. **安全性**：避免将敏感信息（如 API 密钥）硬编码在代码中。
2. **灵活性**：在不同环境中使用不同的配置，而无需修改代码。
3. **可维护性**：集中管理配置，便于维护和更新。

## 在 React 中使用环境变量

React 项目通常使用 `.env` 文件来管理环境变量。Create React App (CRA) 提供了内置的支持，允许我们轻松地在项目中定义和使用环境变量。

### 1. 创建 `.env` 文件

在项目的根目录下创建一个 `.env` 文件。例如：

```plaintext
REACT_APP_API_URL=https://api.example.com
REACT_APP_DEBUG=true
```

:::note
**注意**：在 React 中，环境变量必须以 `REACT_APP_` 开头，否则它们将不会被识别。
:::

### 2. 在代码中使用环境变量

在 React 组件中，可以通过 `process.env` 对象访问这些环境变量。例如：

```jsx
const apiUrl = process.env.REACT_APP_API_URL;
const isDebug = process.env.REACT_APP_DEBUG === 'true';

console.log(`API URL: ${apiUrl}`);
console.log(`Debug Mode: ${isDebug}`);
```

### 3. 不同环境的不同配置

我们可以为不同的环境创建不同的 `.env` 文件。例如：

- `.env.development`：开发环境
- `.env.test`：测试环境
- `.env.production`：生产环境

React 会根据当前的构建环境自动加载相应的 `.env` 文件。

## 实际案例

假设我们正在开发一个天气应用，需要根据不同的环境使用不同的 API 端点。

### 开发环境 (`.env.development`)

```plaintext
REACT_APP_API_URL=https://dev.api.weather.com
```

### 生产环境 (`.env.production`)

```plaintext
REACT_APP_API_URL=https://api.weather.com
```

在代码中，我们可以这样使用：

```jsx
function fetchWeatherData() {
  const apiUrl = process.env.REACT_APP_API_URL;
  return fetch(`${apiUrl}/weather`);
}
```

这样，无论是在开发环境还是生产环境，我们都可以使用正确的 API 端点，而无需修改代码。

## 总结

环境变量管理是 React 工程化开发中的一个重要环节。通过合理使用环境变量，我们可以提高代码的安全性、灵活性和可维护性。在实际开发中，建议为不同的环境创建不同的 `.env` 文件，并确保敏感信息不会泄露。

## 附加资源

- [Create React App 文档 - 环境变量](https://create-react-app.dev/docs/adding-custom-environment-variables/)
- [Dotenv - 环境变量管理工具](https://github.com/motdotla/dotenv)

## 练习

1. 在你的 React 项目中创建一个 `.env` 文件，并定义一个环境变量 `REACT_APP_API_KEY`。
2. 在代码中使用 `process.env.REACT_APP_API_KEY` 访问该变量，并打印到控制台。
3. 尝试为开发和生产环境创建不同的 `.env` 文件，并验证它们是否按预期工作。

通过以上练习，你将更好地理解如何在 React 项目中管理环境变量。