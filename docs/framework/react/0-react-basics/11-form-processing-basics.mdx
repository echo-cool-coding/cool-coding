---
title: 表单处理基础
description: 学习如何在 React 中处理表单输入，包括受控组件、非受控组件以及表单验证的基础知识。
---

# 表单处理基础

表单是 Web 应用程序中用户输入数据的主要方式之一。在 React 中，表单处理是一个重要的概念，因为它涉及到如何管理用户输入、验证数据以及提交表单。本文将带你逐步了解 React 中的表单处理基础知识，并通过实际案例帮助你掌握这些概念。

## 介绍

在 React 中，表单处理通常分为两种方式：**受控组件**和**非受控组件**。受控组件是指表单数据由 React 组件的状态（state）管理，而非受控组件则是指表单数据由 DOM 本身管理。我们将重点介绍受控组件，因为它是 React 推荐的方式。

## 受控组件

受控组件是指表单元素的值由 React 的状态（state）管理。当用户输入数据时，React 会更新状态，从而控制表单元素的值。这种方式使得 React 能够完全控制表单的行为。

### 基本示例

以下是一个简单的受控组件示例，展示了如何处理一个文本输入框：

```jsx
import React, { useState } from 'react';

function SimpleForm() {
  const [inputValue, setInputValue] = useState('');

  const handleChange = (event) => {
    setInputValue(event.target.value);
  };

  const handleSubmit = (event) => {
    event.preventDefault();
    alert(`你输入的内容是: ${inputValue}`);
  };

  return (
    <form onSubmit={handleSubmit}>
      <label>
        输入内容:
        <input type="text" value={inputValue} onChange={handleChange} />
      </label>
      <button type="submit">提交</button>
    </form>
  );
}

export default SimpleForm;
```

在这个示例中，`inputValue` 状态用于存储输入框的值。当用户输入内容时，`handleChange` 函数会更新状态，从而控制输入框的值。当用户提交表单时，`handleSubmit` 函数会阻止默认的表单提交行为，并弹出一个提示框显示用户输入的内容。

:::note
**注意**：在受控组件中，表单元素的值始终由 React 的状态控制。这意味着你需要为每个表单元素编写一个事件处理函数来更新状态。
:::

### 处理多个输入

在实际应用中，表单通常包含多个输入字段。为了处理多个输入，你可以为每个输入字段创建一个单独的状态，或者使用一个对象来存储所有输入字段的值。

以下是一个处理多个输入字段的示例：

```jsx
import React, { useState } from 'react';

function MultiInputForm() {
  const [formData, setFormData] = useState({
    firstName: '',
    lastName: '',
    email: '',
  });

  const handleChange = (event) => {
    const { name, value } = event.target;
    setFormData({
      ...formData,
      [name]: value,
    });
  };

  const handleSubmit = (event) => {
    event.preventDefault();
    alert(`你输入的内容是: ${JSON.stringify(formData, null, 2)}`);
  };

  return (
    <form onSubmit={handleSubmit}>
      <label>
        名字:
        <input
          type="text"
          name="firstName"
          value={formData.firstName}
          onChange={handleChange}
        />
      </label>
      <br />
      <label>
        姓氏:
        <input
          type="text"
          name="lastName"
          value={formData.lastName}
          onChange={handleChange}
        />
      </label>
      <br />
      <label>
        邮箱:
        <input
          type="email"
          name="email"
          value={formData.email}
          onChange={handleChange}
        />
      </label>
      <br />
      <button type="submit">提交</button>
    </form>
  );
}

export default MultiInputForm;
```

在这个示例中，`formData` 状态是一个对象，用于存储所有输入字段的值。`handleChange` 函数通过 `event.target.name` 来识别是哪个输入字段发生了变化，并更新相应的状态。

:::tip
**提示**：使用对象来存储多个输入字段的值可以使代码更加简洁和易于维护。
:::

## 表单验证

表单验证是确保用户输入的数据符合预期的重要步骤。在 React 中，你可以在表单提交时进行验证，或者在用户输入时实时验证。

### 提交时验证

以下是一个在表单提交时进行验证的示例：

```jsx
import React, { useState } from 'react';

function ValidationForm() {
  const [email, setEmail] = useState('');
  const [error, setError] = useState('');

  const handleSubmit = (event) => {
    event.preventDefault();
    if (!email.includes('@')) {
      setError('请输入有效的邮箱地址');
    } else {
      setError('');
      alert(`你输入的邮箱是: ${email}`);
    }
  };

  return (
    <form onSubmit={handleSubmit}>
      <label>
        邮箱:
        <input
          type="email"
          value={email}
          onChange={(e) => setEmail(e.target.value)}
        />
      </label>
      {error && <p style={{ color: 'red' }}>{error}</p>}
      <br />
      <button type="submit">提交</button>
    </form>
  );
}

export default ValidationForm;
```

在这个示例中，当用户提交表单时，`handleSubmit` 函数会检查邮箱地址是否包含 `@` 符号。如果不包含，则显示错误信息。

### 实时验证

你也可以在用户输入时进行实时验证。以下是一个实时验证的示例：

```jsx
import React, { useState } from 'react';

function RealTimeValidationForm() {
  const [email, setEmail] = useState('');
  const [error, setError] = useState('');

  const handleChange = (event) => {
    const value = event.target.value;
    setEmail(value);
    if (!value.includes('@')) {
      setError('请输入有效的邮箱地址');
    } else {
      setError('');
    }
  };

  const handleSubmit = (event) => {
    event.preventDefault();
    alert(`你输入的邮箱是: ${email}`);
  };

  return (
    <form onSubmit={handleSubmit}>
      <label>
        邮箱:
        <input
          type="email"
          value={email}
          onChange={handleChange}
        />
      </label>
      {error && <p style={{ color: 'red' }}>{error}</p>}
      <br />
      <button type="submit">提交</button>
    </form>
  );
}

export default RealTimeValidationForm;
```

在这个示例中，`handleChange` 函数会在用户输入时实时检查邮箱地址的有效性，并在输入无效时显示错误信息。

:::caution
**注意**：实时验证可以提高用户体验，但也可能导致性能问题，特别是在处理复杂的验证逻辑时。因此，建议在必要时使用实时验证。
:::

## 实际案例：用户注册表单

以下是一个用户注册表单的实际案例，展示了如何结合受控组件和表单验证来处理用户输入：

```jsx
import React, { useState } from 'react';

function RegistrationForm() {
  const [formData, setFormData] = useState({
    username: '',
    email: '',
    password: '',
  });
  const [errors, setErrors] = useState({});

  const handleChange = (event) => {
    const { name, value } = event.target;
    setFormData({
      ...formData,
      [name]: value,
    });
  };

  const validateForm = () => {
    const newErrors = {};
    if (!formData.username) {
      newErrors.username = '用户名不能为空';
    }
    if (!formData.email.includes('@')) {
      newErrors.email = '请输入有效的邮箱地址';
    }
    if (formData.password.length < 6) {
      newErrors.password = '密码长度不能少于6个字符';
    }
    setErrors(newErrors);
    return Object.keys(newErrors).length === 0;
  };

  const handleSubmit = (event) => {
    event.preventDefault();
    if (validateForm()) {
      alert(`注册成功! 用户名: ${formData.username}, 邮箱: ${formData.email}`);
    }
  };

  return (
    <form onSubmit={handleSubmit}>
      <label>
        用户名:
        <input
          type="text"
          name="username"
          value={formData.username}
          onChange={handleChange}
        />
        {errors.username && <p style={{ color: 'red' }}>{errors.username}</p>}
      </label>
      <br />
      <label>
        邮箱:
        <input
          type="email"
          name="email"
          value={formData.email}
          onChange={handleChange}
        />
        {errors.email && <p style={{ color: 'red' }}>{errors.email}</p>}
      </label>
      <br />
      <label>
        密码:
        <input
          type="password"
          name="password"
          value={formData.password}
          onChange={handleChange}
        />
        {errors.password && <p style={{ color: 'red' }}>{errors.password}</p>}
      </label>
      <br />
      <button type="submit">注册</button>
    </form>
  );
}

export default RegistrationForm;
```

在这个案例中，`validateForm` 函数用于验证表单数据，并在发现错误时更新 `errors` 状态。如果表单数据有效，则提交表单并显示成功消息。

## 总结

在本文中，我们学习了如何在 React 中处理表单输入，包括受控组件、非受控组件以及表单验证的基础知识。通过实际案例，我们展示了如何将这些概念应用到真实的表单中。

### 附加资源

- [React 官方文档 - 表单](https://reactjs.org/docs/forms.html)
- [React 表单验证库 - Formik](https://formik.org/)
- [React 表单验证库 - Yup](https://github.com/jquense/yup)

### 练习

1. 创建一个包含多个输入字段的表单，并在提交时验证所有字段。
2. 尝试实现一个实时验证的表单，确保用户在输入时能够立即看到错误提示。
3. 使用 Formik 或 Yup 库来简化表单处理和验证的代码。

通过不断练习，你将能够熟练掌握 React 中的表单处理技巧，并能够构建出功能强大的表单组件。