---
title: 客户端状态 vs 服务端状态
description: 了解客户端状态和服务端状态的区别，以及它们在 React 应用中的应用场景和最佳实践。
---

在构建现代 Web 应用时，状态管理是一个核心概念。状态可以存储在客户端（浏览器）或服务端（服务器），每种方式都有其独特的优势和适用场景。本文将深入探讨客户端状态和服务端状态的区别，并通过实际案例帮助你理解如何在 React 应用中有效地管理这两种状态。

## 什么是客户端状态和服务端状态？

### 客户端状态
客户端状态是指在浏览器中存储和管理的数据。这些数据通常与用户界面（UI）直接相关，例如表单输入、UI 组件的展开/折叠状态、用户偏好设置等。客户端状态的特点是：
- **临时性**：通常只在当前会话中有效，页面刷新后可能会丢失。
- **快速访问**：由于数据存储在浏览器中，访问速度非常快。
- **无需网络请求**：数据可以直接在本地操作，无需与服务器通信。

### 服务端状态
服务端状态是指在服务器上存储和管理的数据。这些数据通常是应用的核心数据，例如用户信息、订单记录、产品库存等。服务端状态的特点是：
- **持久性**：数据存储在服务器上，即使页面刷新或用户关闭浏览器，数据也不会丢失。
- **一致性**：多个客户端可以访问和修改同一份数据，确保数据的一致性。
- **需要网络请求**：每次访问或修改数据都需要与服务器通信。

## 客户端状态 vs 服务端状态

### 1. 数据存储位置
- **客户端状态**：存储在浏览器的内存或本地存储（如 `localStorage`、`sessionStorage`）中。
- **服务端状态**：存储在服务器的数据库或内存中。

### 2. 数据生命周期
- **客户端状态**：通常与当前会话相关，页面刷新或关闭后可能会丢失。
- **服务端状态**：持久化存储，数据生命周期与服务器一致。

### 3. 数据访问速度
- **客户端状态**：访问速度快，无需网络请求。
- **服务端状态**：访问速度较慢，需要通过网络请求获取数据。

### 4. 数据一致性
- **客户端状态**：通常只影响当前客户端，多个客户端之间的状态可能不一致。
- **服务端状态**：多个客户端可以访问和修改同一份数据，确保数据一致性。

## 实际应用场景

### 客户端状态的应用
客户端状态通常用于管理用户界面的临时数据。例如，在一个表单应用中，用户输入的数据可以存储在客户端状态中，直到用户提交表单。

```jsx
import React, { useState } from 'react';

function Form() {
  const [inputValue, setInputValue] = useState('');

  const handleSubmit = () => {
    console.log('Submitted value:', inputValue);
  };

  return (
    <div>
      <input
        type="text"
        value={inputValue}
        onChange={(e) => setInputValue(e.target.value)}
      />
      <button onClick={handleSubmit}>Submit</button>
    </div>
  );
}

export default Form;
```

在这个例子中，`inputValue` 是一个客户端状态，它只在当前会话中有效。

### 服务端状态的应用
服务端状态通常用于管理应用的核心数据。例如，在一个电商网站中，商品库存信息通常存储在服务端，以确保所有用户看到的数据是一致的。

```jsx
import React, { useEffect, useState } from 'react';

function ProductStock({ productId }) {
  const [stock, setStock] = useState(null);

  useEffect(() => {
    fetch(`/api/products/${productId}/stock`)
      .then(response => response.json())
      .then(data => setStock(data.stock));
  }, [productId]);

  return (
    <div>
      {stock !== null ? `Stock: ${stock}` : 'Loading...'}
    </div>
  );
}

export default ProductStock;
```

在这个例子中，`stock` 是一个服务端状态，它通过 API 请求从服务器获取。

## 总结

客户端状态和服务端状态在 Web 应用中扮演着不同的角色。客户端状态适合管理临时、与 UI 相关的数据，而服务端状态适合管理持久化、核心的数据。理解这两种状态的区别和应用场景，有助于你在 React 应用中做出更合理的设计决策。

## 附加资源与练习

- **练习 1**：尝试在一个 React 应用中同时使用客户端状态和服务端状态，例如创建一个待办事项应用，其中待办事项列表存储在服务端，而当前选中的待办事项存储在客户端。
- **练习 2**：研究如何使用 `localStorage` 或 `sessionStorage` 来持久化客户端状态，以便在页面刷新后恢复数据。

:::tip
如果你对状态管理有更深入的需求，可以探索像 Redux 或 React Query 这样的状态管理库，它们提供了更强大的工具来管理客户端和服务端状态。
:::