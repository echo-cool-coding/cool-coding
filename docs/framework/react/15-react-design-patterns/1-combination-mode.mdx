---
title: 组合模式
description: 了解 React 中的组合模式，这是一种强大的设计模式，用于构建可重用和灵活的组件结构。
---

# 组合模式

组合模式（Composition Pattern）是 React 中一种常见的设计模式，它通过将多个小组件组合成一个更大的组件来实现复杂的 UI 结构。这种模式的核心思想是“组合优于继承”，即通过组合简单组件来构建复杂功能，而不是通过继承来扩展功能。

## 什么是组合模式？

在 React 中，组合模式允许你将多个小组件组合在一起，形成一个更大的组件。这种方式不仅使代码更加模块化，还提高了组件的可重用性和灵活性。组合模式特别适用于构建复杂的 UI 结构，例如表单、导航栏、卡片等。

### 组合模式的优势

1. **可重用性**：小组件可以在多个地方重复使用。
2. **灵活性**：通过组合不同的组件，可以轻松构建复杂的 UI。
3. **易于维护**：每个小组件只负责一小部分功能，代码更易于理解和维护。

## 组合模式的基本用法

在 React 中，组合模式通常通过 `props.children` 来实现。`props.children` 是一个特殊的属性，它允许你将子组件传递给父组件。

### 示例：简单的组合模式

```jsx
function Card({ children }) {
  return (
    <div style={{ border: '1px solid #ccc', padding: '16px', borderRadius: '8px' }}>
      {children}
    </div>
  );
}

function CardHeader({ title }) {
  return <h2>{title}</h2>;
}

function CardBody({ content }) {
  return <p>{content}</p>;
}

function App() {
  return (
    <Card>
      <CardHeader title="React 组合模式" />
      <CardBody content="这是一个简单的组合模式示例。" />
    </Card>
  );
}
```

在这个示例中，`Card` 组件通过 `props.children` 接收 `CardHeader` 和 `CardBody` 组件，并将它们组合在一起。这种方式使得 `Card` 组件可以灵活地包含不同的子组件。

## 组合模式的实际应用

组合模式在实际开发中有广泛的应用场景。以下是一个常见的例子：构建一个可重用的表单组件。

### 示例：可重用的表单组件

```jsx
function Form({ children, onSubmit }) {
  return (
    <form onSubmit={onSubmit}>
      {children}
    </form>
  );
}

function FormInput({ label, type, name }) {
  return (
    <div>
      <label>{label}</label>
      <input type={type} name={name} />
    </div>
  );
}

function App() {
  const handleSubmit = (e) => {
    e.preventDefault();
    alert('表单已提交！');
  };

  return (
    <Form onSubmit={handleSubmit}>
      <FormInput label="用户名" type="text" name="username" />
      <FormInput label="密码" type="password" name="password" />
      <button type="submit">提交</button>
    </Form>
  );
}
```

在这个示例中，`Form` 组件通过 `props.children` 接收多个 `FormInput` 组件，并将它们组合成一个完整的表单。这种方式使得表单组件可以灵活地包含不同的输入字段。

## 组合模式的高级用法

除了基本的组合模式，React 还提供了一些高级的组合模式，例如 **Render Props** 和 **高阶组件（HOC）**。这些模式可以进一步增强组件的灵活性和可重用性。

### 示例：Render Props 模式

```jsx
function Toggle({ children }) {
  const [isOn, setIsOn] = React.useState(false);

  const toggle = () => setIsOn(!isOn);

  return children({ isOn, toggle });
}

function App() {
  return (
    <Toggle>
      {({ isOn, toggle }) => (
        <div>
          <button onClick={toggle}>{isOn ? '开' : '关'}</button>
          <p>当前状态: {isOn ? '开' : '关'}</p>
        </div>
      )}
    </Toggle>
  );
}
```

在这个示例中，`Toggle` 组件通过 `children` 属性接收一个函数，并将状态和切换函数作为参数传递给该函数。这种方式使得 `Toggle` 组件可以灵活地控制子组件的渲染逻辑。

## 总结

组合模式是 React 中一种强大的设计模式，它通过将多个小组件组合在一起，构建出复杂且灵活的 UI 结构。通过使用 `props.children`、Render Props 和高阶组件等技术，你可以轻松实现组件的复用和扩展。

:::tip 提示
组合模式的核心思想是“组合优于继承”。在 React 中，尽量通过组合简单组件来构建复杂功能，而不是通过继承来扩展功能。
:::

## 附加资源

- [React 官方文档 - 组合与继承](https://reactjs.org/docs/composition-vs-inheritance.html)
- [React 设计模式 - Render Props](https://reactjs.org/docs/render-props.html)
- [React 设计模式 - 高阶组件](https://reactjs.org/docs/higher-order-components.html)

## 练习

1. 尝试使用组合模式构建一个可重用的导航栏组件。
2. 使用 Render Props 模式实现一个可复用的数据加载组件。
3. 探索高阶组件的使用场景，并尝试实现一个简单的高阶组件。

通过实践这些练习，你将更深入地理解组合模式的应用场景和优势。