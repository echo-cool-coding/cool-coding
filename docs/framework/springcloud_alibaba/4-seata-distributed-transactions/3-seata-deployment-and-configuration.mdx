---
title: Seata部署与配置
description: 本教程将详细介绍如何部署和配置Seata分布式事务框架，帮助初学者快速上手并理解其核心概念。
---

# Seata部署与配置

## 介绍

Seata 是一款开源的分布式事务解决方案，旨在解决微服务架构下的分布式事务问题。它提供了 AT（自动补偿事务）、TCC（Try-Confirm-Cancel）、Saga 等多种事务模式，能够帮助开发者轻松实现跨服务的分布式事务管理。

在本教程中，我们将逐步讲解如何部署和配置 Seata，并通过实际案例展示其应用场景。

---

## 1. Seata 的部署

### 1.1 下载 Seata

首先，我们需要从 Seata 的官方 GitHub 仓库下载最新版本的 Seata Server。你可以通过以下命令下载：

```bash
wget https://github.com/seata/seata/releases/download/v1.5.0/seata-server-1.5.0.zip
unzip seata-server-1.5.0.zip
```

解压后，你会得到一个名为 `seata` 的文件夹，其中包含了 Seata Server 的所有文件。

### 1.2 启动 Seata Server

进入解压后的目录，运行以下命令启动 Seata Server：

```bash
cd seata/bin
sh seata-server.sh
```

默认情况下，Seata Server 会监听 `8091` 端口。你可以通过访问 `http://localhost:8091` 来确认 Seata Server 是否成功启动。

:::tip
如果你希望修改 Seata Server 的端口或其他配置，可以编辑 `conf/registry.conf` 文件。
:::

---

## 2. Seata 的配置

### 2.1 配置注册中心

Seata 支持多种注册中心，例如 Nacos、Eureka、Zookeeper 等。以下是一个使用 Nacos 作为注册中心的配置示例：

```properties
registry {
  type = "nacos"
  nacos {
    serverAddr = "127.0.0.1:8848"
    namespace = ""
    cluster = "default"
  }
}
```

将上述配置保存到 `conf/registry.conf` 文件中。

### 2.2 配置存储模式

Seata 支持多种存储模式，包括文件存储、数据库存储等。以下是一个使用数据库存储的配置示例：

```properties
store {
  mode = "db"
  db {
    datasource = "druid"
    dbType = "mysql"
    url = "jdbc:mysql://127.0.0.1:3306/seata"
    user = "root"
    password = "password"
    minConn = 5
    maxConn = 30
    globalTable = "global_table"
    branchTable = "branch_table"
    lockTable = "lock_table"
  }
}
```

将上述配置保存到 `conf/file.conf` 文件中。

:::caution
请确保数据库中的表结构已经创建。你可以从 Seata 的官方文档中找到相应的 SQL 脚本。
:::

---

## 3. 实际案例

### 3.1 场景描述

假设我们有一个电商系统，包含订单服务、库存服务和支付服务。当用户下单时，需要同时调用这三个服务来完成订单的创建、库存的扣减和支付的扣款操作。如果其中任何一个服务失败，整个操作需要回滚。

### 3.2 代码示例

以下是一个使用 Seata 的 AT 模式的代码示例：

```java
@GlobalTransactional
public void createOrder(Order order) {
    // 1. 创建订单
    orderService.create(order);

    // 2. 扣减库存
    stockService.deduct(order.getProductId(), order.getCount());

    // 3. 扣款
    paymentService.pay(order.getUserId(), order.getAmount());
}
```

在上述代码中，`@GlobalTransactional` 注解用于标记一个全局事务。如果任何一个方法抛出异常，Seata 会自动回滚所有操作。

---

## 4. 总结

通过本教程，你已经学会了如何部署和配置 Seata 分布式事务框架，并通过实际案例了解了其应用场景。Seata 提供了强大的分布式事务管理能力，能够帮助你在微服务架构下轻松处理复杂的业务逻辑。

---

## 5. 附加资源

- [Seata 官方文档](https://seata.io/zh-cn/docs/overview/what-is-seata.html)
- [Seata GitHub 仓库](https://github.com/seata/seata)

## 6. 练习

1. 尝试将 Seata 的存储模式从文件存储切换为数据库存储，并观察其行为变化。
2. 在你的项目中实现一个简单的分布式事务场景，并使用 Seata 进行管理。
