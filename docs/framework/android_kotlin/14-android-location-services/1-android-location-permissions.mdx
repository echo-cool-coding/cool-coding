---
title: Android 位置权限
description: 了解 Android 应用中的位置权限，包括权限类型、申请方式以及实际应用场景。
---

在 Android 应用开发中，位置服务是一个非常重要的功能，它允许应用访问设备的地理位置信息。然而，为了保护用户隐私，Android 系统要求应用在访问位置信息之前必须获得用户的明确授权。本文将详细介绍 Android 中的位置权限，包括权限类型、申请方式以及实际应用场景。

## 1. 什么是 Android 位置权限？

Android 位置权限是指应用在访问设备的地理位置信息时需要获得的用户授权。Android 系统提供了两种主要的位置权限：

- **ACCESS_COARSE_LOCATION**：允许应用访问大致的地理位置信息（例如，基于 Wi-Fi 或移动网络的定位）。
- **ACCESS_FINE_LOCATION**：允许应用访问精确的地理位置信息（例如，基于 GPS 的定位）。

:::note
从 Android 10（API 级别 29）开始，应用在后台访问位置信息时还需要申请 **ACCESS_BACKGROUND_LOCATION** 权限。
:::

## 2. 如何申请位置权限？

在 Android 应用中申请位置权限的步骤如下：

### 2.1 在 `AndroidManifest.xml` 中声明权限

首先，你需要在应用的 `AndroidManifest.xml` 文件中声明所需的位置权限。例如：

```xml
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.myapp">

    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />

    <application
        android:allowBackup="true"
        android:icon="@mipmap/ic_launcher"
        android:label="@string/app_name"
        android:roundIcon="@mipmap/ic_launcher_round"
        android:supportsRtl="true"
        android:theme="@style/AppTheme">
        <activity android:name=".MainActivity">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>
</manifest>
```

### 2.2 在运行时请求权限

从 Android 6.0（API 级别 23）开始，应用需要在运行时请求敏感权限。以下是一个在运行时请求位置权限的示例：

```java
import android.Manifest;
import android.content.pm.PackageManager;
import android.os.Bundle;
import androidx.annotation.NonNull;
import androidx.appcompat.app.AppCompatActivity;
import androidx.core.app.ActivityCompat;
import androidx.core.content.ContextCompat;

public class MainActivity extends AppCompatActivity {

    private static final int LOCATION_PERMISSION_REQUEST_CODE = 1;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        // 检查是否已经授予位置权限
        if (ContextCompat.checkSelfPermission(this, Manifest.permission.ACCESS_FINE_LOCATION)
                != PackageManager.PERMISSION_GRANTED) {
            // 如果没有权限，请求权限
            ActivityCompat.requestPermissions(this,
                    new String[]{Manifest.permission.ACCESS_FINE_LOCATION},
                    LOCATION_PERMISSION_REQUEST_CODE);
        } else {
            // 已经有权限，可以开始使用位置服务
            startLocationService();
        }
    }

    @Override
    public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) {
        super.onRequestPermissionsResult(requestCode, permissions, grantResults);
        if (requestCode == LOCATION_PERMISSION_REQUEST_CODE) {
            if (grantResults.length > 0 && grantResults[0] == PackageManager.PERMISSION_GRANTED) {
                // 权限被授予，可以开始使用位置服务
                startLocationService();
            } else {
                // 权限被拒绝，提示用户
                showPermissionDeniedMessage();
            }
        }
    }

    private void startLocationService() {
        // 开始使用位置服务
    }

    private void showPermissionDeniedMessage() {
        // 提示用户权限被拒绝
    }
}
```

:::tip
在请求权限时，建议向用户解释为什么需要该权限，以提高用户授权的可能性。
:::

## 3. 实际应用场景

### 3.1 地图应用

地图应用是最常见的使用位置权限的场景之一。通过获取用户的地理位置，地图应用可以提供导航、路线规划等功能。

### 3.2 健身应用

健身应用通常需要访问精确的位置信息来跟踪用户的运动轨迹，例如跑步、骑行等。

### 3.3 本地服务推荐

一些本地服务推荐应用会根据用户的地理位置提供附近的餐厅、商店等信息。

## 4. 总结

Android 位置权限是开发位置相关应用时必须掌握的重要概念。通过合理申请和使用位置权限，你可以在保护用户隐私的同时，为用户提供丰富的位置服务功能。

## 5. 附加资源与练习

- **官方文档**：阅读 [Android 位置权限官方文档](https://developer.android.com/training/location) 以获取更多详细信息。
- **练习**：尝试在你的应用中集成位置服务，并测试在不同权限状态下的行为。

:::caution
在开发过程中，请始终注意用户隐私，避免滥用位置权限。
:::