---
title: Android SQLite数据库
description: "了解如何在Android应用中使用SQLite数据库进行数据存储和管理。本指南适合初学者，涵盖基本概念、代码示例和实际应用场景。"
---

# Android SQLite数据库

在Android开发中，数据存储是一个非常重要的部分。SQLite是Android平台上内置的轻量级关系型数据库，非常适合用于存储结构化数据。本文将带你了解SQLite的基本概念、使用方法以及如何在Android应用中实现数据存储。

## 什么是SQLite？

SQLite是一个开源的嵌入式关系型数据库，它不需要单独的服务器进程，而是直接读写磁盘文件。SQLite数据库存储在设备的文件系统中，通常以 `.db` 文件的形式存在。由于其轻量级和高效性，SQLite非常适合移动应用开发。

## SQLite的基本概念

在开始使用SQLite之前，我们需要了解一些基本概念：

- **表（Table）**：表是数据库中存储数据的基本单位，类似于Excel中的表格。每个表由多个列（Column）和行（Row）组成。
- **列（Column）**：列定义了表中的字段，每个字段都有一个数据类型，如 `INTEGER`、`TEXT`、`REAL` 等。
- **行（Row）**：行是表中的一条记录，包含了具体的数据。
- **主键（Primary Key）**：主键是表中唯一标识一条记录的字段，通常是一个自增的整数。

## 在Android中使用SQLite

Android提供了 `SQLiteOpenHelper` 类来帮助我们管理数据库的创建和版本控制。下面我们将通过一个简单的例子来演示如何在Android应用中使用SQLite。

### 1. 创建数据库

首先，我们需要创建一个继承自 `SQLiteOpenHelper` 的类来管理数据库。

```java
import android.content.Context;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;

public class MyDatabaseHelper extends SQLiteOpenHelper {

    private static final String DATABASE_NAME = "MyDatabase.db";
    private static final int DATABASE_VERSION = 1;

    public MyDatabaseHelper(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        // 创建表
        String CREATE_TABLE = "CREATE TABLE Users (" +
                "id INTEGER PRIMARY KEY AUTOINCREMENT, " +
                "name TEXT, " +
                "age INTEGER)";
        db.execSQL(CREATE_TABLE);
    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        // 升级数据库
        db.execSQL("DROP TABLE IF EXISTS Users");
        onCreate(db);
    }
}
```

在这个例子中，我们创建了一个名为 `MyDatabaseHelper` 的类，它继承自 `SQLiteOpenHelper`。在 `onCreate` 方法中，我们定义了一个 `Users` 表，包含 `id`、`name` 和 `age` 三个字段。

### 2. 插入数据

接下来，我们来看看如何向数据库中插入数据。

```java
import android.content.ContentValues;
import android.database.sqlite.SQLiteDatabase;

public class DatabaseManager {

    private MyDatabaseHelper dbHelper;

    public DatabaseManager(Context context) {
        dbHelper = new MyDatabaseHelper(context);
    }

    public long insertUser(String name, int age) {
        SQLiteDatabase db = dbHelper.getWritableDatabase();
        ContentValues values = new ContentValues();
        values.put("name", name);
        values.put("age", age);
        return db.insert("Users", null, values);
    }
}
```

在这个例子中，我们创建了一个 `DatabaseManager` 类来管理数据库操作。`insertUser` 方法用于向 `Users` 表中插入一条记录。

### 3. 查询数据

查询数据是数据库操作中最常见的任务之一。下面是一个简单的查询示例：

```java
import android.database.Cursor;
import android.database.sqlite.SQLiteDatabase;

public class DatabaseManager {

    // ... 其他代码

    public Cursor getAllUsers() {
        SQLiteDatabase db = dbHelper.getReadableDatabase();
        return db.query("Users", null, null, null, null, null, null);
    }
}
```

在这个例子中，`getAllUsers` 方法返回一个 `Cursor` 对象，它包含了 `Users` 表中的所有记录。

### 4. 更新和删除数据

除了插入和查询，我们还可以更新和删除数据。

```java
public class DatabaseManager {

    // ... 其他代码

    public int updateUser(int id, String name, int age) {
        SQLiteDatabase db = dbHelper.getWritableDatabase();
        ContentValues values = new ContentValues();
        values.put("name", name);
        values.put("age", age);
        return db.update("Users", values, "id = ?", new String[]{String.valueOf(id)});
    }

    public int deleteUser(int id) {
        SQLiteDatabase db = dbHelper.getWritableDatabase();
        return db.delete("Users", "id = ?", new String[]{String.valueOf(id)});
    }
}
```

`updateUser` 方法用于更新指定 `id` 的用户信息，而 `deleteUser` 方法用于删除指定 `id` 的用户。

## 实际应用场景

假设我们正在开发一个简单的联系人管理应用，用户可以在应用中添加、查看、更新和删除联系人信息。我们可以使用SQLite数据库来存储这些联系人信息。

1. **添加联系人**：用户输入姓名和年龄，点击“添加”按钮，应用将数据插入到 `Users` 表中。
2. **查看联系人**：应用从 `Users` 表中查询所有联系人信息，并显示在列表中。
3. **更新联系人**：用户选择某个联系人，修改其信息后点击“更新”按钮，应用将更新 `Users` 表中的相应记录。
4. **删除联系人**：用户选择某个联系人，点击“删除”按钮，应用将从 `Users` 表中删除该记录。

## 总结

SQLite是Android开发中非常重要的数据存储工具。通过 `SQLiteOpenHelper` 类，我们可以轻松地创建和管理数据库。本文介绍了SQLite的基本概念、如何在Android应用中使用SQLite进行数据存储，并通过一个简单的联系人管理应用展示了SQLite的实际应用场景。

## 附加资源

- [Android官方文档：SQLite数据库](https://developer.android.com/training/data-storage/sqlite)
- [SQLite官方文档](https://www.sqlite.org/docs.html)

## 练习

1. 创建一个新的Android项目，并实现一个简单的待办事项应用，使用SQLite数据库存储待办事项。
2. 尝试在应用中实现数据的批量插入和批量删除功能。
3. 研究如何在SQLite中使用事务（Transaction）来确保数据的一致性。

:::tip
在开发过程中，记得使用 `Log` 类来输出调试信息，这有助于你更好地理解代码的执行流程。
:::