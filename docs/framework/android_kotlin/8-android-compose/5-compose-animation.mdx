---
title: Compose动画
description: 了解如何在Jetpack Compose中创建流畅的动画效果，掌握动画的基本概念和实际应用。
---

# Compose动画

Jetpack Compose 是 Android 开发中用于构建现代 UI 的声明式框架。动画是用户界面设计中不可或缺的一部分，它能够增强用户体验，使应用更具吸引力。在 Compose 中，动画的实现变得非常简单和直观。本文将带你从基础概念入手，逐步掌握如何在 Compose 中创建动画。

## 什么是 Compose 动画？

Compose 动画是通过改变 UI 组件的状态来实现的。你可以通过定义动画的起始状态和结束状态，Compose 会自动处理中间的过渡效果。Compose 提供了多种动画 API，包括 `animate*AsState`、`Transition`、`AnimatedVisibility` 等，帮助你轻松实现各种动画效果。

## 基础动画：`animate*AsState`

`animate*AsState` 是 Compose 中最简单的动画 API 之一。它允许你通过改变状态来触发动画。以下是一个简单的例子，展示如何使用 `animateDpAsState` 来实现一个按钮的缩放动画。

```kotlin
@Composable
fun AnimatedButton() {
    var isExpanded by remember { mutableStateOf(false) }
    val size by animateDpAsState(targetValue = if (isExpanded) 200.dp else 100.dp)

    Box(
        modifier = Modifier
            .size(size)
            .background(Color.Blue)
            .clickable { isExpanded = !isExpanded }
    )
}
```

在这个例子中，`animateDpAsState` 会根据 `isExpanded` 的值自动调整按钮的大小。当 `isExpanded` 为 `true` 时，按钮会从 100.dp 平滑过渡到 200.dp。

:::note
`animate*AsState` 可以用于多种类型的动画，例如 `animateColorAsState`、`animateFloatAsState` 等，具体取决于你需要动画化的属性。
:::

## 复杂动画：`Transition`

`Transition` 是 Compose 中用于处理多个动画的 API。它允许你同时控制多个属性的动画效果。以下是一个使用 `Transition` 的例子，展示如何同时改变按钮的大小和颜色。

```kotlin
@Composable
fun AnimatedButtonWithTransition() {
    var isExpanded by remember { mutableStateOf(false) }
    val transition = updateTransition(targetState = isExpanded, label = "buttonTransition")

    val size by transition.animateDp(label = "size") { state ->
        if (state) 200.dp else 100.dp
    }
    val color by transition.animateColor(label = "color") { state ->
        if (state) Color.Red else Color.Blue
    }

    Box(
        modifier = Modifier
            .size(size)
            .background(color)
            .clickable { isExpanded = !isExpanded }
    )
}
```

在这个例子中，`Transition` 同时控制了按钮的大小和颜色。当 `isExpanded` 改变时，按钮的大小和颜色会同时发生变化。

## 实际应用：`AnimatedVisibility`

`AnimatedVisibility` 是 Compose 中用于控制组件显示和隐藏的动画 API。它允许你在组件显示或隐藏时添加动画效果。以下是一个使用 `AnimatedVisibility` 的例子，展示如何实现一个带有淡入淡出效果的文本。

```kotlin
@Composable
fun AnimatedText() {
    var isVisible by remember { mutableStateOf(false) }

    Column {
        Button(onClick = { isVisible = !isVisible }) {
            Text("Toggle Visibility")
        }

        AnimatedVisibility(visible = isVisible) {
            Text("Hello, Compose!", modifier = Modifier.padding(16.dp))
        }
    }
}
```

在这个例子中，`AnimatedVisibility` 会根据 `isVisible` 的值自动添加淡入淡出效果。当 `isVisible` 为 `true` 时，文本会淡入；当 `isVisible` 为 `false` 时，文本会淡出。

## 总结

Compose 提供了丰富的动画 API，帮助你轻松实现各种动画效果。通过 `animate*AsState`、`Transition` 和 `AnimatedVisibility` 等 API，你可以创建出流畅且富有表现力的用户界面。希望本文能帮助你掌握 Compose 动画的基础知识，并在实际项目中应用这些概念。

## 附加资源

- [Jetpack Compose 官方文档](https://developer.android.com/jetpack/compose)
- [Compose 动画指南](https://developer.android.com/jetpack/compose/animation)
- [Compose 动画示例](https://github.com/android/compose-samples)

## 练习

1. 尝试使用 `animateColorAsState` 实现一个按钮的背景色渐变效果。
2. 使用 `Transition` 实现一个同时改变大小、颜色和透明度的动画效果。
3. 使用 `AnimatedVisibility` 实现一个带有滑动效果的列表项显示和隐藏动画。
