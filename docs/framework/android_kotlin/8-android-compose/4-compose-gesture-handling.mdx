---
title: Compose手势处理
description: 了解如何在Jetpack Compose中处理手势，包括点击、拖动、缩放等常见手势操作。本文适合初学者，包含代码示例和实际应用场景。
---

## 介绍

在Android应用开发中，手势处理是用户交互的重要组成部分。Jetpack Compose作为现代UI工具包，提供了强大的手势处理功能，使开发者能够轻松实现点击、拖动、缩放等手势操作。本文将逐步讲解如何在Compose中处理手势，并通过实际案例展示其应用。

## 基本手势处理

### 点击手势

在Compose中，处理点击手势非常简单。你可以使用`Modifier.clickable`来监听点击事件。

```kotlin
@Composable
fun ClickableBox() {
    Box(
        modifier = Modifier
            .size(100.dp)
            .background(Color.Blue)
            .clickable {
                println("Box clicked!")
            }
    )
}
```

在这个例子中，当用户点击蓝色方块时，控制台会输出`"Box clicked!"`。

### 长按手势

长按手势可以通过`Modifier.combinedClickable`来实现。以下是一个示例：

```kotlin
@Composable
fun LongClickableBox() {
    Box(
        modifier = Modifier
            .size(100.dp)
            .background(Color.Green)
            .combinedClickable(
                onClick = { println("Box clicked!") },
                onLongClick = { println("Box long clicked!") }
            )
    )
}
```

在这个例子中，当用户长按绿色方块时，控制台会输出`"Box long clicked!"`。

## 高级手势处理

### 拖动手势

拖动手势可以通过`Modifier.draggable`来实现。以下是一个简单的拖动手势示例：

```kotlin
@Composable
fun DraggableBox() {
    var offsetX by remember { mutableStateOf(0f) }
    var offsetY by remember { mutableStateOf(0f) }

    Box(
        modifier = Modifier
            .size(100.dp)
            .background(Color.Red)
            .offset { IntOffset(offsetX.roundToInt(), offsetY.roundToInt()) }
            .pointerInput(Unit) {
                detectDragGestures { change, dragAmount ->
                    change.consume()
                    offsetX += dragAmount.x
                    offsetY += dragAmount.y
                }
            }
    )
}
```

在这个例子中，红色方块可以通过拖动来改变其位置。

### 缩放手势

缩放手势可以通过`Modifier.transformable`来实现。以下是一个缩放手势示例：

```kotlin
@Composable
fun ScalableBox() {
    var scale by remember { mutableStateOf(1f) }
    var offset by remember { mutableStateOf(Offset.Zero) }

    Box(
        modifier = Modifier
            .size(100.dp)
            .background(Color.Yellow)
            .graphicsLayer(
                scaleX = scale,
                scaleY = scale,
                translationX = offset.x,
                translationY = offset.y
            )
            .pointerInput(Unit) {
                detectTransformGestures { _, pan, zoom, _ ->
                    scale *= zoom
                    offset = Offset(offset.x + pan.x, offset.y + pan.y)
                }
            }
    )
}
```

在这个例子中，黄色方块可以通过捏合手势进行缩放。

## 实际应用场景

### 图片查看器

假设你正在开发一个图片查看器应用，用户可以通过手势来缩放和拖动图片。以下是一个简单的实现：

```kotlin
@Composable
fun ImageViewer(image: Painter) {
    var scale by remember { mutableStateOf(1f) }
    var offset by remember { mutableStateOf(Offset.Zero) }

    Box(
        modifier = Modifier
            .fillMaxSize()
            .pointerInput(Unit) {
                detectTransformGestures { _, pan, zoom, _ ->
                    scale *= zoom
                    offset = Offset(offset.x + pan.x, offset.y + pan.y)
                }
            }
    ) {
        Image(
            painter = image,
            contentDescription = null,
            modifier = Modifier
                .graphicsLayer(
                    scaleX = scale,
                    scaleY = scale,
                    translationX = offset.x,
                    translationY = offset.y
                )
        )
    }
}
```

在这个例子中，用户可以通过手势缩放和拖动图片。

## 总结

通过本文，你已经了解了如何在Jetpack Compose中处理常见的手势操作，包括点击、长按、拖动和缩放。这些手势处理技术可以应用于各种实际场景，如图片查看器、地图应用等。

## 附加资源

- [Jetpack Compose官方文档](https://developer.android.com/jetpack/compose)
- [Compose手势处理示例](https://github.com/android/compose-samples)

## 练习

1. 创建一个可拖动的圆形组件。
2. 实现一个双指缩放的图片查看器。
3. 结合点击和长按手势，创建一个多功能按钮。

通过完成这些练习，你将更深入地理解Compose中的手势处理。