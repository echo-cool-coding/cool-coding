---
title: Compose 列表
description: 了解如何在 Jetpack Compose 中创建和管理列表，包括基本用法、性能优化和实际应用场景。
---

# Compose 列表

在 Android 开发中，列表是展示数据集合的常见方式。Jetpack Compose 提供了一种声明式的方式来创建和管理列表，使得开发者可以更轻松地构建动态和高效的 UI。本文将带你从基础到进阶，全面掌握 Compose 中的列表使用。

## 什么是 Compose 列表？

Compose 列表是通过 `LazyColumn` 或 `LazyRow` 组件实现的。与传统的 `RecyclerView` 不同，`LazyColumn` 和 `LazyRow` 是声明式的，意味着你只需描述列表的内容，Compose 会自动处理布局和滚动。

### 基本用法

以下是一个简单的 `LazyColumn` 示例，展示如何在 Compose 中创建一个垂直滚动的列表：

```kotlin
import androidx.compose.foundation.lazy.LazyColumn
import androidx.compose.foundation.lazy.items
import androidx.compose.material.Text
import androidx.compose.runtime.Composable

@Composable
fun SimpleList(items: List<String>) {
    LazyColumn {
        items(items) { item ->
            Text(text = item)
        }
    }
}
```

在这个例子中，`LazyColumn` 接收一个 `items` 列表，并为每个 `item` 创建一个 `Text` 组件。`items` 函数会自动处理列表项的布局和复用。

### 输入和输出

假设我们有一个字符串列表 `["Item 1", "Item 2", "Item 3"]`，调用 `SimpleList` 函数将生成一个包含三个文本项的垂直列表。

## 逐步讲解

### 1. 基本列表

我们已经看到了如何使用 `LazyColumn` 创建一个简单的列表。接下来，我们将探讨如何自定义列表项。

### 2. 自定义列表项

你可以通过传递一个 `@Composable` lambda 函数来自定义列表项的外观。例如，为每个列表项添加一个图标：

```kotlin
import androidx.compose.foundation.Image
import androidx.compose.foundation.layout.Row
import androidx.compose.foundation.layout.padding
import androidx.compose.material.Icon
import androidx.compose.material.icons.Icons
import androidx.compose.material.icons.filled.Star
import androidx.compose.ui.Modifier
import androidx.compose.ui.unit.dp

@Composable
fun CustomList(items: List<String>) {
    LazyColumn {
        items(items) { item ->
            Row(modifier = Modifier.padding(8.dp)) {
                Icon(Icons.Filled.Star, contentDescription = null)
                Text(text = item, modifier = Modifier.padding(start = 8.dp))
            }
        }
    }
}
```

在这个例子中，每个列表项都包含一个星形图标和文本。

### 3. 性能优化

Compose 的 `LazyColumn` 和 `LazyRow` 已经内置了性能优化机制，如项复用和懒加载。然而，你仍然可以通过以下方式进一步优化性能：

- **避免在列表项中使用昂贵的操作**：例如，避免在列表项中进行复杂的计算或网络请求。
- **使用 `key` 参数**：为每个列表项指定一个唯一的 `key`，以帮助 Compose 更高效地识别和复用项。

```kotlin
LazyColumn {
    items(items, key = { it.id }) { item ->
        Text(text = item.name)
    }
}
```

### 4. 实际案例

假设你正在开发一个任务管理应用，需要展示用户的任务列表。你可以使用 `LazyColumn` 来展示任务，并为每个任务添加完成状态和优先级图标。

```kotlin
data class Task(val id: Int, val name: String, val isCompleted: Boolean, val priority: Priority)

@Composable
fun TaskList(tasks: List<Task>) {
    LazyColumn {
        items(tasks, key = { it.id }) { task ->
            Row(modifier = Modifier.padding(8.dp)) {
                Icon(
                    if (task.isCompleted) Icons.Filled.CheckCircle else Icons.Filled.RadioButtonUnchecked,
                    contentDescription = null
                )
                Text(text = task.name, modifier = Modifier.padding(start = 8.dp))
                Icon(
                    when (task.priority) {
                        Priority.HIGH -> Icons.Filled.Warning
                        Priority.MEDIUM -> Icons.Filled.Info
                        Priority.LOW -> Icons.Filled.ArrowDownward
                    },
                    contentDescription = null
                )
            }
        }
    }
}
```

在这个例子中，每个任务项都包含一个完成状态图标、任务名称和优先级图标。

## 总结

Compose 列表通过 `LazyColumn` 和 `LazyRow` 提供了一种声明式的方式来创建和管理列表。你可以轻松地自定义列表项的外观，并通过性能优化技巧确保列表的高效运行。在实际应用中，列表可以用于展示各种数据集合，如任务列表、消息列表等。

## 附加资源

- [Jetpack Compose 官方文档](https://developer.android.com/jetpack/compose)
- [Compose 列表示例](https://github.com/android/compose-samples)

## 练习

1. 创建一个包含 100 个随机生成数字的列表，并为每个数字添加一个颜色背景。
2. 尝试使用 `LazyRow` 创建一个水平滚动的图片列表。

:::tip
在开发过程中，始终注意性能优化，尤其是在处理大量数据时。
:::