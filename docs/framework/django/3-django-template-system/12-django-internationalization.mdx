---
title: Django 国际化
description: 了解如何在Django项目中使用国际化（i18n）功能，使您的网站支持多语言。
---

# Django 国际化

Django国际化（Internationalization，简称i18n）是Django框架提供的一项强大功能，允许开发者轻松地将网站内容翻译成多种语言。通过使用Django的国际化工具，您可以为全球用户提供本地化的用户体验。

## 什么是Django国际化？

Django国际化是指将网站的内容（如文本、日期、时间等）转换为多种语言的过程。Django通过提供一系列工具和API，使开发者能够轻松地管理和切换不同语言的版本。

### 为什么需要国际化？

随着互联网的普及，越来越多的网站需要面向全球用户。为了提供更好的用户体验，网站需要支持多种语言。Django的国际化功能可以帮助您实现这一目标，而无需重写整个应用程序。

## 配置Django国际化

在开始使用Django的国际化功能之前，您需要在项目的设置中进行一些配置。

### 1. 启用国际化

首先，确保在 `settings.py` 文件中启用了国际化功能：

```python
# settings.py

LANGUAGE_CODE = 'en-us'  # 默认语言
USE_I18N = True  # 启用国际化
USE_L10N = True  # 启用本地化
```

### 2. 添加中间件

Django提供了一个中间件来根据用户的语言偏好自动切换语言。确保在 `MIDDLEWARE` 列表中添加 `django.middleware.locale.LocaleMiddleware`：

```python
# settings.py

MIDDLEWARE = [
    # 其他中间件
    'django.middleware.locale.LocaleMiddleware',
]
```

### 3. 配置支持的语言

在 `settings.py` 中定义您的网站支持的语言：

```python
# settings.py

LANGUAGES = [
    ('en', 'English'),
    ('es', 'Spanish'),
    ('fr', 'French'),
    # 添加更多语言
]
```

## 翻译文本

Django使用 `gettext` 工具来标记需要翻译的文本。您可以使用 `gettext` 函数或其别名 `_` 来标记需要翻译的字符串。

### 1. 标记需要翻译的文本

在您的视图或模板中，使用 `_` 函数标记需要翻译的文本：

```python
# views.py

from django.utils.translation import gettext as _

def my_view(request):
    output = _("Welcome to my site.")
    return HttpResponse(output)
```

### 2. 生成翻译文件

使用 `makemessages` 命令生成翻译文件：

```bash
django-admin makemessages -l es  # 生成西班牙语翻译文件
```

这将在 `locale` 目录下生成一个 `.po` 文件，您可以在其中添加翻译。

### 3. 编译翻译文件

完成翻译后，使用 `compilemessages` 命令编译翻译文件：

```bash
django-admin compilemessages
```

这将生成 `.mo` 文件，Django将使用这些文件来提供翻译内容。

## 在模板中使用国际化

Django模板系统也支持国际化。您可以在模板中使用 `trans` 标签来标记需要翻译的文本。

### 1. 标记模板中的文本

在模板中，使用 `trans` 标签标记需要翻译的文本：

```html
<!-- template.html -->

{% load i18n %}

<h1>{% trans "Welcome to my site." %}</h1>
```

### 2. 翻译模板中的文本

与视图中的文本一样，您可以使用 `makemessages` 命令生成翻译文件，并在 `.po` 文件中添加翻译。

## 实际案例

假设您正在开发一个多语言博客网站。您希望用户可以选择他们喜欢的语言来浏览博客文章。

### 1. 配置语言选择器

在模板中添加一个语言选择器，允许用户切换语言：

```html
<!-- language_selector.html -->

<form action="{% url 'set_language' %}" method="post">
    {% csrf_token %}
    <input name="next" type="hidden" value="{{ redirect_to }}" />
    <select name="language">
        {% get_current_language as LANGUAGE_CODE %}
        {% get_available_languages as LANGUAGES %}
        {% for code, name in LANGUAGES %}
            <option value="{{ code }}" {% if code == LANGUAGE_CODE %}selected{% endif %}>
                {{ name }}
            </option>
        {% endfor %}
    </select>
    <input type="submit" value="Go" />
</form>
```

### 2. 切换语言

当用户选择一种语言并提交表单时，Django会自动切换到所选语言，并重定向到当前页面。

## 总结

Django的国际化功能使您能够轻松地为全球用户提供多语言支持。通过配置Django的国际化设置、标记需要翻译的文本、生成和编译翻译文件，您可以为您的网站添加多语言支持。

### 附加资源

- [Django官方文档 - 国际化](https://docs.djangoproject.com/en/stable/topics/i18n/)
- [gettext 文档](https://www.gnu.org/software/gettext/)

### 练习

1. 在您的Django项目中启用国际化功能，并添加至少两种语言支持。
2. 使用 `trans` 标签在模板中标记需要翻译的文本，并生成翻译文件。
3. 创建一个语言选择器，允许用户切换网站的语言。

通过这些练习，您将更好地理解Django的国际化功能，并能够将其应用到实际项目中。