---
title: Django 模型简介
description: 了解Django模型的基础知识，掌握如何定义模型并将其映射到数据库表。
---

## 什么是Django模型？

Django模型是Django框架中用于与数据库交互的核心组件。模型是一个Python类，它定义了数据的结构和行为。每个模型类对应数据库中的一张表，而模型的属性则对应表中的字段。通过Django模型，开发者可以以面向对象的方式操作数据库，而无需直接编写SQL语句。

Django的ORM（对象关系映射）系统会自动将模型类映射到数据库表，并生成相应的SQL语句。这使得开发者可以专注于业务逻辑，而不必担心底层的数据库操作。

## 定义一个简单的Django模型

让我们从一个简单的例子开始。假设我们正在开发一个博客应用，我们需要定义一个 `Post` 模型来表示博客文章。

```python
from django.db import models

class Post(models.Model):
    title = models.CharField(max_length=200)
    content = models.TextField()
    published_date = models.DateTimeField(auto_now_add=True)

    def __str__(self):
        return self.title
```

### 代码解析

- `models.Model`：所有Django模型都必须继承自 `models.Model` 类。
- `title`：这是一个字符字段，最大长度为200个字符。
- `content`：这是一个文本字段，用于存储文章的正文内容。
- `published_date`：这是一个日期时间字段，`auto_now_add=True` 表示在创建记录时自动设置为当前时间。
- `__str__` 方法：定义了模型的字符串表示形式，通常在管理界面中显示。

### 数据库表的生成

当你运行 `python manage.py makemigrations` 和 `python manage.py migrate` 命令时，Django会根据这个模型在数据库中创建一张表。生成的SQL语句类似于：

```sql
CREATE TABLE blog_post (
    id SERIAL PRIMARY KEY,
    title VARCHAR(200) NOT NULL,
    content TEXT NOT NULL,
    published_date TIMESTAMP NOT NULL
);
```

## 模型字段类型

Django提供了多种字段类型来满足不同的数据存储需求。以下是一些常用的字段类型：

- `CharField`：用于存储短文本，如标题。
- `TextField`：用于存储长文本，如文章内容。
- `IntegerField`：用于存储整数。
- `BooleanField`：用于存储布尔值（True/False）。
- `DateField` 和 `DateTimeField`：用于存储日期和时间。
- `ForeignKey`：用于定义一对多关系。
- `ManyToManyField`：用于定义多对多关系。

:::tip
选择合适的字段类型可以提高数据库的性能和数据的完整性。例如，使用 `CharField` 而不是 `TextField` 来存储短文本可以节省存储空间。
:::

## 模型的关系

在实际应用中，数据之间通常存在各种关系。Django模型支持以下几种关系：

### 1. 一对一关系（One-to-One）

一对一关系表示一个模型实例与另一个模型实例之间存在唯一的关联。例如，一个用户（`User`）可能有一个个人资料（`Profile`）。

```python
class Profile(models.Model):
    user = models.OneToOneField(User, on_delete=models.CASCADE)
    bio = models.TextField()
```

### 2. 一对多关系（One-to-Many）

一对多关系表示一个模型实例可以关联多个另一个模型的实例。例如，一篇博客文章（`Post`）可以有多个评论（`Comment`）。

```python
class Comment(models.Model):
    post = models.ForeignKey(Post, on_delete=models.CASCADE)
    text = models.TextField()
    created_date = models.DateTimeField(auto_now_add=True)
```

### 3. 多对多关系（Many-to-Many）

多对多关系表示一个模型实例可以关联多个另一个模型的实例，反之亦然。例如，一篇文章（`Post`）可以有多个标签（`Tag`），而一个标签也可以被多篇文章使用。

```python
class Tag(models.Model):
    name = models.CharField(max_length=50)

class Post(models.Model):
    title = models.CharField(max_length=200)
    content = models.TextField()
    tags = models.ManyToManyField(Tag)
```

## 实际应用场景

假设我们正在开发一个简单的博客系统，我们需要存储文章、评论和标签。我们可以定义以下模型：

```python
from django.db import models

class Tag(models.Model):
    name = models.CharField(max_length=50)

    def __str__(self):
        return self.name

class Post(models.Model):
    title = models.CharField(max_length=200)
    content = models.TextField()
    published_date = models.DateTimeField(auto_now_add=True)
    tags = models.ManyToManyField(Tag)

    def __str__(self):
        return self.title

class Comment(models.Model):
    post = models.ForeignKey(Post, on_delete=models.CASCADE)
    text = models.TextField()
    created_date = models.DateTimeField(auto_now_add=True)

    def __str__(self):
        return f"Comment by {self.post.title}"
```

在这个例子中，我们定义了三个模型：`Tag`、`Post` 和 `Comment`。`Post` 和 `Tag` 之间是多对多关系，而 `Post` 和 `Comment` 之间是一对多关系。

## 总结

Django模型是Django框架中用于与数据库交互的核心组件。通过定义模型，开发者可以以面向对象的方式操作数据库，而无需直接编写SQL语句。Django的ORM系统会自动将模型类映射到数据库表，并生成相应的SQL语句。

在本教程中，我们介绍了如何定义Django模型、常用的字段类型以及模型之间的关系。我们还通过一个实际的博客系统示例展示了如何将这些概念应用到实际项目中。

## 附加资源与练习

- **练习**：尝试创建一个简单的任务管理应用，定义 `Task` 模型，并为其添加 `title`、`description` 和 `due_date` 字段。
- **进一步学习**：阅读Django官方文档中关于[模型](https://docs.djangoproject.com/en/stable/topics/db/models/)的更多内容，了解更多高级用法，如自定义管理器、查询集等。

:::caution
在定义模型时，务必仔细选择字段类型和关系类型，以确保数据的完整性和一致性。
:::