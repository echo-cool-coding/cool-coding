---
title: Django 国际化最佳实践
description: 学习如何在Django项目中实现国际化（i18n）和本地化（l10n），并掌握最佳实践，确保您的应用支持多语言。
---

# Django 国际化最佳实践

国际化（Internationalization，简称i18n）和本地化（Localization，简称l10n）是现代Web应用开发中的重要概念。Django提供了强大的工具来支持多语言应用，使您的应用能够轻松适应不同语言和地区的用户。本文将介绍如何在Django项目中实现国际化，并分享一些最佳实践。

## 什么是国际化？

国际化是指设计和开发应用程序，使其能够支持多种语言和地区的过程。本地化则是将应用程序适配到特定语言或地区的过程。Django通过内置的翻译系统、时区支持和格式化工具，简化了这些任务。

## 配置Django项目以支持国际化

### 1. 启用国际化支持

首先，确保您的Django项目已启用国际化支持。在 `settings.py` 文件中，找到以下设置并确保它们已正确配置：

```python
# settings.py

# 启用国际化
USE_I18N = True

# 启用本地化
USE_L10N = True

# 设置默认语言
LANGUAGE_CODE = 'en-us'

# 支持的语言列表
LANGUAGES = [
    ('en', 'English'),
    ('zh-hans', 'Simplified Chinese'),
    ('es', 'Spanish'),
]
```

### 2. 配置中间件

Django的 `LocaleMiddleware` 用于根据用户的语言偏好自动切换语言。确保在 `MIDDLEWARE` 列表中添加 `django.middleware.locale.LocaleMiddleware`：

```python
# settings.py

MIDDLEWARE = [
    ...
    'django.middleware.locale.LocaleMiddleware',
    ...
]
```

### 3. 创建翻译文件

Django使用 `.po` 文件来存储翻译字符串。您可以使用 `django-admin` 命令生成翻译文件：

```bash
django-admin makemessages -l zh_Hans
```

这将在 `locale/zh_Hans/LC_MESSAGES/` 目录下生成一个 `.po` 文件。您可以使用文本编辑器或翻译工具编辑该文件，添加翻译内容。

### 4. 编译翻译文件

编辑完 `.po` 文件后，使用以下命令将其编译为 `.mo` 文件：

```bash
django-admin compilemessages
```

## 在模板和视图中使用翻译

### 1. 模板中的翻译

在Django模板中，您可以使用 `{% trans %}` 标签来标记需要翻译的字符串：

```html
<!-- template.html -->

<h1>{% trans "Welcome to our website!" %}</h1>
<p>{% trans "Please select your language:" %}</p>
```

### 2. 视图中的翻译

在Python代码中，您可以使用 `gettext` 函数来标记需要翻译的字符串：

```python
# views.py

from django.utils.translation import gettext as _

def my_view(request):
    output = _("Hello, world!")
    return HttpResponse(output)
```

## 实际案例：多语言网站

假设您正在开发一个多语言电子商务网站。您需要为产品名称、描述和用户界面提供多种语言的翻译。通过Django的国际化工具，您可以轻松实现这一目标。

### 1. 翻译产品名称

在模型中，您可以使用 `gettext_lazy` 来标记需要翻译的字段：

```python
# models.py

from django.db import models
from django.utils.translation import gettext_lazy as _

class Product(models.Model):
    name = models.CharField(_("Product Name"), max_length=100)
    description = models.TextField(_("Product Description"))
```

### 2. 动态切换语言

您可以在网站顶部添加一个语言选择器，允许用户动态切换语言：

```html
<!-- language_selector.html -->

<form action="{% url 'set_language' %}" method="post">
    {% csrf_token %}
    <input name="next" type="hidden" value="{{ request.path }}" />
    <select name="language">
        {% get_current_language as LANGUAGE_CODE %}
        {% get_available_languages as LANGUAGES %}
        {% for code, name in LANGUAGES %}
            <option value="{{ code }}" {% if code == LANGUAGE_CODE %}selected{% endif %}>
                {{ name }}
            </option>
        {% endfor %}
    </select>
    <input type="submit" value="Go" />
</form>
```

## 总结

Django的国际化工具使您能够轻松构建支持多语言的Web应用。通过遵循本文中的最佳实践，您可以确保您的应用能够适应全球用户的需求。

## 附加资源

- [Django官方文档：国际化](https://docs.djangoproject.com/en/stable/topics/i18n/)
- [Django国际化教程](https://realpython.com/django-internationalization/)
- [gettext手册](https://www.gnu.org/software/gettext/manual/gettext.html)

## 练习

1. 在您的Django项目中启用国际化支持，并添加至少两种语言的翻译。
2. 创建一个语言选择器，允许用户动态切换语言。
3. 尝试在模型和视图中使用 `gettext_lazy` 和 `gettext` 函数，标记需要翻译的字符串。
