---
title: Django Gunicorn 配置
description: 学习如何配置 Gunicorn 以部署 Django 应用程序。本文将从基础概念开始，逐步讲解 Gunicorn 的安装、配置以及与 Django 的集成，帮助初学者掌握部署的关键步骤。
---

## 介绍

在 Django 开发中，Gunicorn 是一个常用的 WSGI HTTP 服务器，用于在生产环境中运行 Django 应用程序。它能够处理多个并发请求，并与 Nginx 或 Apache 等反向代理服务器配合使用，提供高性能的 Web 服务。本文将详细介绍如何配置 Gunicorn 以部署 Django 应用程序。

## 什么是 Gunicorn？

Gunicorn（Green Unicorn）是一个 Python WSGI HTTP 服务器，专为生产环境设计。它支持多进程和多线程模型，能够高效地处理并发请求。Gunicorn 通常与 Django 一起使用，作为 Django 应用程序的 WSGI 服务器。

:::note
WSGI（Web Server Gateway Interface）是 Python Web 应用程序与 Web 服务器之间的标准接口。Gunicorn 实现了 WSGI 协议，因此可以与 Django 无缝集成。
:::

## 安装 Gunicorn

在开始配置之前，首先需要安装 Gunicorn。你可以使用 `pip` 来安装：

```bash
pip install gunicorn
```

安装完成后，可以通过以下命令检查 Gunicorn 是否安装成功：

```bash
gunicorn --version
```

如果安装成功，你将看到 Gunicorn 的版本号。

## 配置 Gunicorn 运行 Django 应用程序

### 1. 基本运行

假设你的 Django 项目名为 `myproject`，你可以使用以下命令启动 Gunicorn：

```bash
gunicorn myproject.wsgi:application
```

这个命令会启动 Gunicorn，并加载 Django 的 WSGI 应用程序。默认情况下，Gunicorn 会监听 `127.0.0.1:8000`。

### 2. 绑定到特定地址和端口

你可以通过 `--bind` 参数指定 Gunicorn 监听的地址和端口。例如，绑定到 `0.0.0.0:8000`：

```bash
gunicorn myproject.wsgi:application --bind 0.0.0.0:8000
```

这样，Gunicorn 将监听所有网络接口的 8000 端口。

### 3. 使用配置文件

为了更方便地管理 Gunicorn 的配置，你可以创建一个配置文件。例如，创建一个名为 `gunicorn_config.py` 的文件：

```python
bind = "0.0.0.0:8000"
workers = 3
timeout = 120
```

然后，使用以下命令启动 Gunicorn：

```bash
gunicorn myproject.wsgi:application -c gunicorn_config.py
```

在这个配置文件中，`bind` 指定了监听的地址和端口，`workers` 指定了工作进程的数量，`timeout` 指定了请求超时时间。

:::tip
`workers` 的数量通常设置为 CPU 核心数的 2 倍加 1。例如，如果你的服务器有 4 个 CPU 核心，可以设置为 `9`。
:::

## 实际案例：部署 Django 应用程序

假设你有一个 Django 项目 `myproject`，并且你已经配置好了 Nginx 作为反向代理服务器。以下是部署 Django 应用程序的步骤：

1. **安装 Gunicorn**：确保 Gunicorn 已经安装。

2. **创建 Gunicorn 配置文件**：在项目根目录下创建 `gunicorn_config.py` 文件，内容如下：

    ```python
    bind = "127.0.0.1:8001"
    workers = 3
    timeout = 120
    ```

3. **启动 Gunicorn**：使用以下命令启动 Gunicorn：

    ```bash
    gunicorn myproject.wsgi:application -c gunicorn_config.py
    ```

4. **配置 Nginx**：在 Nginx 配置文件中添加以下内容：

    ```nginx
    server {
        listen 80;
        server_name example.com;

        location / {
            proxy_pass http://127.0.0.1:8001;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }
    }
    ```

5. **重启 Nginx**：保存 Nginx 配置文件后，重启 Nginx 服务：

    ```bash
    sudo systemctl restart nginx
    ```

现在，你的 Django 应用程序已经通过 Gunicorn 和 Nginx 部署成功，可以通过 `http://example.com` 访问。

## 总结

通过本文，你已经学习了如何配置 Gunicorn 以部署 Django 应用程序。我们从 Gunicorn 的基本概念开始，逐步讲解了安装、配置以及与 Nginx 的集成。希望这些内容能够帮助你顺利部署 Django 应用程序。

## 附加资源

- [Gunicorn 官方文档](https://docs.gunicorn.org/en/stable/)
- [Django 部署指南](https://docs.djangoproject.com/en/stable/howto/deployment/)
- [Nginx 官方文档](https://nginx.org/en/docs/)

## 练习

1. 尝试在你的本地环境中安装 Gunicorn 并运行一个简单的 Django 应用程序。
2. 创建一个 Gunicorn 配置文件，并尝试调整 `workers` 和 `timeout` 参数，观察对性能的影响。
3. 配置 Nginx 作为反向代理服务器，并将 Django 应用程序部署到生产环境中。

祝你学习愉快！