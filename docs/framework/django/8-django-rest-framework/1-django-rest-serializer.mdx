---
title: Django REST 序列化器
description: 了解 Django REST 框架中的序列化器，掌握如何将复杂数据类型转换为 JSON 或其他格式，以及如何反序列化数据。
---

# Django REST 序列化器

在 Django REST 框架（DRF）中，序列化器（Serializer）是一个核心组件，用于将复杂的数据类型（如 Django 模型实例）转换为 Python 原生数据类型，进而可以轻松地渲染为 JSON、XML 或其他内容类型。同时，序列化器也负责将传入的数据反序列化为 Django 模型实例或其他复杂数据类型。

## 什么是序列化器？

序列化器在 Web API 开发中扮演着重要角色。它们的主要功能包括：

1. **序列化**：将 Django 模型实例或其他复杂数据类型转换为 Python 字典，进而可以渲染为 JSON 或其他格式。
2. **反序列化**：将传入的 JSON 数据解析为 Python 字典，并验证数据是否符合预期格式，最终将其转换为 Django 模型实例。

序列化器类似于 Django 的表单（Form）类，但它们更专注于处理复杂的数据结构，而不仅仅是 HTML 表单数据。

## 创建一个简单的序列化器

让我们从一个简单的例子开始。假设我们有一个 Django 模型 `Book`，定义如下：

```python
from django.db import models

class Book(models.Model):
    title = models.CharField(max_length=100)
    author = models.CharField(max_length=100)
    published_date = models.DateField()
```

接下来，我们为这个模型创建一个序列化器：

```python
from rest_framework import serializers
from .models import Book

class BookSerializer(serializers.ModelSerializer):
    class Meta:
        model = Book
        fields = ['id', 'title', 'author', 'published_date']
```

在这个例子中，`BookSerializer` 继承自 `serializers.ModelSerializer`，并指定了要序列化的模型和字段。

### 序列化数据

假设我们有一个 `Book` 实例：

```python
book = Book(title="Django for Beginners", author="William S. Vincent", published_date="2020-01-01")
```

我们可以使用 `BookSerializer` 将其序列化为 JSON：

```python
serializer = BookSerializer(book)
print(serializer.data)
```

输出将是：

```json
{
    "id": 1,
    "title": "Django for Beginners",
    "author": "William S. Vincent",
    "published_date": "2020-01-01"
}
```

### 反序列化数据

反序列化是将 JSON 数据转换回 Django 模型实例的过程。假设我们有以下 JSON 数据：

```json
{
    "title": "Django REST Framework",
    "author": "Tom Christie",
    "published_date": "2021-01-01"
}
```

我们可以使用 `BookSerializer` 将其反序列化为 `Book` 实例：

```python
data = {
    "title": "Django REST Framework",
    "author": "Tom Christie",
    "published_date": "2021-01-01"
}
serializer = BookSerializer(data=data)
if serializer.is_valid():
    book = serializer.save()
    print(book)
```

如果数据有效，`serializer.save()` 将创建一个新的 `Book` 实例并保存到数据库中。

## 序列化器的字段

Django REST 框架提供了多种字段类型，用于处理不同类型的数据。以下是一些常用的字段类型：

- `CharField`：用于字符串数据。
- `IntegerField`：用于整数数据。
- `DateField`：用于日期数据。
- `BooleanField`：用于布尔值数据。
- `EmailField`：用于电子邮件地址数据。

你可以在序列化器中自定义字段，例如：

```python
class BookSerializer(serializers.ModelSerializer):
    title = serializers.CharField(max_length=100)
    author = serializers.CharField(max_length=100)
    published_date = serializers.DateField()

    class Meta:
        model = Book
        fields = ['id', 'title', 'author', 'published_date']
```

## 嵌套序列化器

有时，你可能需要序列化嵌套的对象。例如，假设我们有一个 `Author` 模型：

```python
class Author(models.Model):
    name = models.CharField(max_length=100)
    email = models.EmailField()
```

我们可以创建一个嵌套的序列化器来处理 `Book` 和 `Author` 之间的关系：

```python
class AuthorSerializer(serializers.ModelSerializer):
    class Meta:
        model = Author
        fields = ['name', 'email']

class BookSerializer(serializers.ModelSerializer):
    author = AuthorSerializer()

    class Meta:
        model = Book
        fields = ['id', 'title', 'author', 'published_date']
```

在这种情况下，`BookSerializer` 将包含 `Author` 的详细信息。

## 实际应用场景

假设你正在开发一个图书管理 API，你需要实现以下功能：

1. 列出所有图书。
2. 创建新图书。
3. 更新现有图书。
4. 删除图书。

使用 Django REST 框架和序列化器，你可以轻松实现这些功能。以下是一个简单的视图示例：

```python
from rest_framework import generics
from .models import Book
from .serializers import BookSerializer

class BookListCreateView(generics.ListCreateAPIView):
    queryset = Book.objects.all()
    serializer_class = BookSerializer

class BookRetrieveUpdateDestroyView(generics.RetrieveUpdateDestroyAPIView):
    queryset = Book.objects.all()
    serializer_class = BookSerializer
```

在这个例子中，`BookListCreateView` 处理列出所有图书和创建新图书的请求，而 `BookRetrieveUpdateDestroyView` 处理获取、更新和删除单个图书的请求。

## 总结

Django REST 框架中的序列化器是处理数据序列化和反序列化的强大工具。通过使用序列化器，你可以轻松地将复杂的数据类型转换为 JSON 或其他格式，并确保数据的完整性和有效性。

### 附加资源

- [Django REST 框架官方文档](https://www.django-rest-framework.org/)
- [Django 模型文档](https://docs.djangoproject.com/en/stable/topics/db/models/)

### 练习

1. 创建一个新的 Django 模型 `Movie`，并为其编写一个序列化器。
2. 实现一个 API 视图，允许用户列出、创建、更新和删除电影。
3. 尝试使用嵌套序列化器来处理 `Movie` 和 `Director` 之间的关系。

通过完成这些练习，你将更深入地理解 Django REST 序列化器的工作原理及其在实际项目中的应用。