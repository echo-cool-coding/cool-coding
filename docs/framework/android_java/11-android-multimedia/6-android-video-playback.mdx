---
title: Android视频播放
description: 学习如何在Android应用中实现视频播放功能。本文将从基础概念讲起，逐步引导你完成一个简单的视频播放器，并提供实际案例和代码示例。
---

## 介绍

在Android应用中，视频播放是一个常见的功能需求。无论是播放本地视频文件还是流媒体视频，Android都提供了强大的API来支持这些功能。本文将介绍如何使用Android的`MediaPlayer`和`VideoView`来实现视频播放功能，并通过实际案例帮助你理解这些概念。

## 基础概念

在Android中，视频播放可以通过`MediaPlayer`或`VideoView`来实现。`MediaPlayer`是一个更底层的API，提供了更多的控制选项，而`VideoView`则是一个封装了`MediaPlayer`的视图组件，使用起来更加简单。

### MediaPlayer

`MediaPlayer`是Android中用于播放音频和视频的核心类。它支持多种数据源，包括本地文件、网络流媒体等。使用`MediaPlayer`时，你需要手动管理播放器的生命周期，包括准备、开始、暂停、停止和释放等操作。

### VideoView

`VideoView`是一个封装了`MediaPlayer`的视图组件，它简化了视频播放的实现过程。`VideoView`可以直接在布局文件中使用，并且提供了简单的API来控制视频的播放。

## 实现视频播放

### 使用VideoView播放视频

首先，我们来看一个使用`VideoView`播放视频的简单示例。

#### 布局文件

在`res/layout/activity_main.xml`中定义一个`VideoView`：

```xml
<VideoView
    android:id="@+id/videoView"
    android:layout_width="match_parent"
    android:layout_height="match_parent" />
```

#### 代码实现

在`MainActivity.java`中，我们可以通过以下代码来播放视频：

```java
import android.net.Uri;
import android.os.Bundle;
import android.widget.VideoView;
import androidx.appcompat.app.AppCompatActivity;

public class MainActivity extends AppCompatActivity {

    private VideoView videoView;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        videoView = findViewById(R.id.videoView);

        // 设置视频路径
        Uri videoUri = Uri.parse("android.resource://" + getPackageName() + "/" + R.raw.sample_video);
        videoView.setVideoURI(videoUri);

        // 开始播放
        videoView.start();
    }
}
```

在这个示例中，我们首先在布局文件中定义了一个`VideoView`，然后在`MainActivity`中通过`setVideoURI`方法设置视频路径，并调用`start`方法开始播放。

:::tip
你可以将视频文件放在`res/raw`目录下，并通过`R.raw.sample_video`来引用它。
:::

### 使用MediaPlayer播放视频

如果你需要更多的控制选项，可以使用`MediaPlayer`来实现视频播放。以下是一个简单的示例：

```java
import android.media.MediaPlayer;
import android.net.Uri;
import android.os.Bundle;
import android.widget.VideoView;
import androidx.appcompat.app.AppCompatActivity;

public class MainActivity extends AppCompatActivity {

    private MediaPlayer mediaPlayer;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        mediaPlayer = MediaPlayer.create(this, R.raw.sample_video);
        mediaPlayer.start();
    }

    @Override
    protected void onDestroy() {
        super.onDestroy();
        if (mediaPlayer != null) {
            mediaPlayer.release();
            mediaPlayer = null;
        }
    }
}
```

在这个示例中，我们使用`MediaPlayer.create`方法创建了一个`MediaPlayer`实例，并通过`start`方法开始播放视频。在`onDestroy`方法中，我们释放了`MediaPlayer`资源，以避免内存泄漏。

:::caution
使用`MediaPlayer`时，务必记得在适当的时机释放资源，否则可能会导致内存泄漏。
:::

## 实际案例

假设你正在开发一个视频播放应用，用户可以选择播放本地视频或在线视频。以下是一个简单的实现思路：

1. **本地视频播放**：将视频文件放在`res/raw`目录下，并通过`R.raw.sample_video`来引用。
2. **在线视频播放**：使用`Uri.parse`方法解析在线视频的URL，并通过`VideoView`或`MediaPlayer`播放。

```java
Uri onlineVideoUri = Uri.parse("https://www.example.com/sample_video.mp4");
videoView.setVideoURI(onlineVideoUri);
videoView.start();
```

## 总结

通过本文，你学习了如何在Android应用中实现视频播放功能。我们介绍了`VideoView`和`MediaPlayer`的基本用法，并通过实际案例展示了如何播放本地和在线视频。希望这些内容能帮助你更好地理解Android视频播放的实现。

## 附加资源

- [Android官方文档 - MediaPlayer](https://developer.android.com/reference/android/media/MediaPlayer)
- [Android官方文档 - VideoView](https://developer.android.com/reference/android/widget/VideoView)

## 练习

1. 尝试使用`VideoView`播放一个在线视频。
2. 使用`MediaPlayer`实现一个带有播放、暂停和停止按钮的视频播放器。
3. 探索`MediaPlayer`的其他功能，如音量控制、循环播放等。
