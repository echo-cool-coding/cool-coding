---
title: Android XML 解析
description: 学习如何在 Android 应用中解析 XML 数据，掌握常见的 XML 解析方法及其实际应用场景。
---

# Android XML 解析

在 Android 开发中，XML（可扩展标记语言）是一种常见的数据格式，用于存储和传输结构化数据。无论是从网络请求中获取的 XML 数据，还是本地存储的 XML 文件，解析 XML 都是开发中的一项重要技能。本文将详细介绍 Android 中常见的 XML 解析方法，并通过实际案例帮助你掌握这些技术。

## 什么是 XML 解析？

XML 解析是指从 XML 文档中提取数据并将其转换为程序可以使用的格式的过程。Android 提供了多种解析 XML 的方式，主要包括以下两种：

1. **DOM 解析**：将整个 XML 文档加载到内存中，形成一个树形结构，适合处理较小的 XML 文件。
2. **SAX 解析**：基于事件驱动的解析方式，逐行读取 XML 文件，适合处理较大的 XML 文件。

此外，Android 还支持 **Pull 解析**，它是一种轻量级的解析方式，结合了 DOM 和 SAX 的优点。

## DOM 解析

DOM（Document Object Model）解析将整个 XML 文档加载到内存中，形成一个树形结构。开发者可以通过遍历树节点来获取所需的数据。

### 示例：使用 DOM 解析 XML

假设我们有一个简单的 XML 文件 `books.xml`，内容如下：

```xml
<books>
    <book>
        <title>Android Programming</title>
        <author>John Doe</author>
    </book>
    <book>
        <title>Kotlin for Beginners</title>
        <author>Jane Smith</author>
    </book>
</books>
```

以下是如何使用 DOM 解析该 XML 文件的代码：

```java
import org.w3c.dom.Document;
import org.w3c.dom.Element;
import org.w3c.dom.Node;
import org.w3c.dom.NodeList;
import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;
import java.io.InputStream;

public class DOMParserExample {
    public static void main(String[] args) {
        try {
            InputStream inputStream = getAssets().open("books.xml");
            DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
            DocumentBuilder builder = factory.newDocumentBuilder();
            Document document = builder.parse(inputStream);

            NodeList nodeList = document.getElementsByTagName("book");
            for (int i = 0; i < nodeList.getLength(); i++) {
                Node node = nodeList.item(i);
                if (node.getNodeType() == Node.ELEMENT_NODE) {
                    Element element = (Element) node;
                    String title = element.getElementsByTagName("title").item(0).getTextContent();
                    String author = element.getElementsByTagName("author").item(0).getTextContent();
                    System.out.println("Title: " + title + ", Author: " + author);
                }
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
```

### 输出结果

```
Title: Android Programming, Author: John Doe
Title: Kotlin for Beginners, Author: Jane Smith
```

:::note
DOM 解析适合处理较小的 XML 文件，因为它会将整个文档加载到内存中。对于较大的 XML 文件，建议使用 SAX 或 Pull 解析。
:::

## SAX 解析

SAX（Simple API for XML）解析是一种基于事件驱动的解析方式。它逐行读取 XML 文件，并在遇到特定事件（如开始标签、结束标签）时触发回调方法。

### 示例：使用 SAX 解析 XML

以下是如何使用 SAX 解析 `books.xml` 文件的代码：

```java
import org.xml.sax.Attributes;
import org.xml.sax.SAXException;
import org.xml.sax.helpers.DefaultHandler;
import javax.xml.parsers.SAXParser;
import javax.xml.parsers.SAXParserFactory;
import java.io.InputStream;

public class SAXParserExample {
    public static void main(String[] args) {
        try {
            InputStream inputStream = getAssets().open("books.xml");
            SAXParserFactory factory = SAXParserFactory.newInstance();
            SAXParser saxParser = factory.newSAXParser();

            DefaultHandler handler = new DefaultHandler() {
                boolean isTitle = false;
                boolean isAuthor = false;
                String title = "";
                String author = "";

                @Override
                public void startElement(String uri, String localName, String qName, Attributes attributes) {
                    if (qName.equalsIgnoreCase("title")) {
                        isTitle = true;
                    } else if (qName.equalsIgnoreCase("author")) {
                        isAuthor = true;
                    }
                }

                @Override
                public void characters(char[] ch, int start, int length) {
                    if (isTitle) {
                        title = new String(ch, start, length);
                        isTitle = false;
                    } else if (isAuthor) {
                        author = new String(ch, start, length);
                        isAuthor = false;
                    }
                }

                @Override
                public void endElement(String uri, String localName, String qName) {
                    if (qName.equalsIgnoreCase("book")) {
                        System.out.println("Title: " + title + ", Author: " + author);
                    }
                }
            };

            saxParser.parse(inputStream, handler);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
```

### 输出结果

```
Title: Android Programming, Author: John Doe
Title: Kotlin for Beginners, Author: Jane Smith
```

:::tip
SAX 解析适合处理较大的 XML 文件，因为它不会将整个文档加载到内存中，而是逐行读取并触发事件。
:::

## Pull 解析

Pull 解析是 Android 提供的一种轻量级解析方式，结合了 DOM 和 SAX 的优点。它允许开发者主动控制解析过程，适合处理中等大小的 XML 文件。

### 示例：使用 Pull 解析 XML

以下是如何使用 Pull 解析 `books.xml` 文件的代码：

```java
import org.xmlpull.v1.XmlPullParser;
import org.xmlpull.v1.XmlPullParserFactory;
import java.io.InputStream;

public class PullParserExample {
    public static void main(String[] args) {
        try {
            InputStream inputStream = getAssets().open("books.xml");
            XmlPullParserFactory factory = XmlPullParserFactory.newInstance();
            XmlPullParser parser = factory.newPullParser();
            parser.setInput(inputStream, null);

            int eventType = parser.getEventType();
            String title = "";
            String author = "";

            while (eventType != XmlPullParser.END_DOCUMENT) {
                String tagName = parser.getName();
                switch (eventType) {
                    case XmlPullParser.START_TAG:
                        if (tagName.equalsIgnoreCase("title")) {
                            title = parser.nextText();
                        } else if (tagName.equalsIgnoreCase("author")) {
                            author = parser.nextText();
                        }
                        break;
                    case XmlPullParser.END_TAG:
                        if (tagName.equalsIgnoreCase("book")) {
                            System.out.println("Title: " + title + ", Author: " + author);
                        }
                        break;
                }
                eventType = parser.next();
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
```

### 输出结果

```
Title: Android Programming, Author: John Doe
Title: Kotlin for Beginners, Author: Jane Smith
```

:::caution
Pull 解析适合处理中等大小的 XML 文件，开发者需要手动控制解析过程，因此代码量相对较多。
:::

## 实际应用场景

XML 解析在 Android 开发中有广泛的应用场景，例如：

1. **解析网络请求的响应**：许多 API 返回的数据格式为 XML，开发者需要解析这些数据并在应用中展示。
2. **读取本地配置文件**：Android 应用可能使用 XML 文件存储配置信息，解析这些文件可以动态调整应用行为。
3. **处理 RSS 订阅**：RSS 订阅通常以 XML 格式提供，解析这些数据可以生成新闻列表。

## 总结

本文介绍了 Android 中常见的 XML 解析方法，包括 DOM、SAX 和 Pull 解析。每种方法都有其适用的场景，开发者可以根据实际需求选择合适的解析方式。通过本文的学习，你应该能够掌握基本的 XML 解析技术，并将其应用到实际开发中。

## 附加资源与练习

- **练习**：尝试解析一个更复杂的 XML 文件，例如包含嵌套结构的 XML。
- **资源**：
  - [Android 官方文档：XML 解析](https://developer.android.com/training/basics/network-ops/xml)
  - [DOM 解析教程](https://www.tutorialspoint.com/java_xml/java_dom_parse_document.htm)
  - [SAX 解析教程](https://www.tutorialspoint.com/java_xml/java_sax_parse_document.htm)

通过不断练习和探索，你将能够熟练运用 XML 解析技术，为 Android 应用开发打下坚实的基础。