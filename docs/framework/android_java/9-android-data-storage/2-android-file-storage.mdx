---
title: Android文件存储
description: "了解Android文件存储的基本概念、使用方法和实际应用场景。本文适合初学者，包含代码示例和详细解释。"
---

## 介绍

在Android开发中，文件存储是一种常见的数据持久化方式。它允许应用程序将数据存储在设备的内部或外部存储中，以便在应用关闭或设备重启后仍然可以访问这些数据。文件存储适用于存储非结构化数据，如文本文件、图片、音频等。

本文将详细介绍如何在Android应用中使用文件存储，包括如何读写文件、存储位置的选择以及实际应用场景。

## 文件存储的基本概念

在Android中，文件存储主要分为两种类型：

1. **内部存储**：这是应用程序私有的存储空间，其他应用程序无法直接访问。存储在内部存储中的数据在应用卸载时会被删除。
2. **外部存储**：这是设备上的共享存储空间，可以被其他应用程序访问。外部存储通常用于存储用户生成的内容，如照片、视频等。

### 内部存储

内部存储是应用程序的私有存储空间，通常用于存储应用的敏感数据或临时文件。以下是如何在内部存储中读写文件的示例。

#### 写入文件

```java
String filename = "myfile.txt";
String fileContents = "Hello, World!";

try (FileOutputStream fos = openFileOutput(filename, Context.MODE_PRIVATE)) {
    fos.write(fileContents.getBytes());
} catch (IOException e) {
    e.printStackTrace();
}
```

#### 读取文件

```java
String filename = "myfile.txt";

try (FileInputStream fis = openFileInput(filename)) {
    InputStreamReader inputStreamReader = new InputStreamReader(fis);
    BufferedReader bufferedReader = new BufferedReader(inputStreamReader);
    StringBuilder stringBuilder = new StringBuilder();
    String line;
    while ((line = bufferedReader.readLine()) != null) {
        stringBuilder.append(line);
    }
    String fileContents = stringBuilder.toString();
    Log.d("FileContents", fileContents);
} catch (IOException e) {
    e.printStackTrace();
}
```

### 外部存储

外部存储是设备上的共享存储空间，通常用于存储用户生成的内容。在访问外部存储之前，需要确保应用具有适当的权限。

#### 检查权限

```java
if (ContextCompat.checkSelfPermission(this, Manifest.permission.WRITE_EXTERNAL_STORAGE) != PackageManager.PERMISSION_GRANTED) {
    ActivityCompat.requestPermissions(this, new String[]{Manifest.permission.WRITE_EXTERNAL_STORAGE}, REQUEST_CODE);
}
```

#### 写入文件

```java
String filename = "myfile.txt";
String fileContents = "Hello, World!";

File file = new File(Environment.getExternalStorageDirectory(), filename);
try (FileOutputStream fos = new FileOutputStream(file)) {
    fos.write(fileContents.getBytes());
} catch (IOException e) {
    e.printStackTrace();
}
```

#### 读取文件

```java
String filename = "myfile.txt";

File file = new File(Environment.getExternalStorageDirectory(), filename);
try (FileInputStream fis = new FileInputStream(file)) {
    InputStreamReader inputStreamReader = new InputStreamReader(fis);
    BufferedReader bufferedReader = new BufferedReader(inputStreamReader);
    StringBuilder stringBuilder = new StringBuilder();
    String line;
    while ((line = bufferedReader.readLine()) != null) {
        stringBuilder.append(line);
    }
    String fileContents = stringBuilder.toString();
    Log.d("FileContents", fileContents);
} catch (IOException e) {
    e.printStackTrace();
}
```

## 实际应用场景

### 场景1：保存用户设置

假设你正在开发一个应用，需要保存用户的设置，如主题颜色、字体大小等。你可以将这些设置存储在内部存储的一个配置文件中，以便在应用启动时读取。

### 场景2：保存用户生成的内容

如果你的应用允许用户生成内容，如笔记、图片等，你可以将这些内容存储在外部存储中，以便用户可以随时访问和分享。

## 总结

Android文件存储是一种简单而强大的数据持久化方式，适用于存储非结构化数据。通过内部存储和外部存储，你可以灵活地管理应用的数据存储需求。在实际开发中，选择合适的存储位置和权限管理是确保应用安全和用户体验的关键。

## 附加资源

- [Android官方文档：数据存储](https://developer.android.com/training/data-storage)
- [Android权限管理](https://developer.android.com/training/permissions/requesting)

## 练习

1. 创建一个简单的记事本应用，允许用户在内部存储中保存和读取笔记。
2. 修改记事本应用，使其能够将笔记存储在外部存储中，并确保应用具有适当的权限。
