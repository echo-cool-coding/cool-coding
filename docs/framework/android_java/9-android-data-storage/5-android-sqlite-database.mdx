---
title: Android SQLite数据库
description: 了解如何在Android应用中使用SQLite数据库进行数据存储和管理。本文适合初学者，涵盖基本概念、代码示例和实际应用场景。
---

# Android SQLite数据库

在Android开发中，数据存储是一个非常重要的部分。SQLite是Android平台上内置的轻量级关系型数据库，适用于存储结构化数据。本文将带你了解SQLite的基本概念、使用方法以及如何在Android应用中使用SQLite进行数据存储。

## 什么是SQLite？

SQLite是一个开源的嵌入式关系型数据库，它不需要单独的服务器进程，而是直接读写磁盘文件。SQLite的数据库是一个单一的文件，非常适合移动设备上的应用场景。Android SDK提供了对SQLite的完整支持，开发者可以通过Android的API来操作SQLite数据库。

## SQLite数据库的基本结构

SQLite数据库由表（Table）组成，每个表由行（Row）和列（Column）组成。每一行代表一条记录，每一列代表一个字段。SQLite支持标准的SQL语法，包括`CREATE TABLE`、`INSERT`、`SELECT`、`UPDATE`和`DELETE`等操作。

### 创建表

在SQLite中，使用`CREATE TABLE`语句来创建表。以下是一个简单的例子：

```sql
CREATE TABLE users (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL,
    age INTEGER
);
```

在这个例子中，我们创建了一个名为`users`的表，包含三个字段：`id`、`name`和`age`。`id`是主键，并且会自动递增。

### 插入数据

使用`INSERT INTO`语句可以向表中插入数据：

```sql
INSERT INTO users (name, age) VALUES ('Alice', 25);
INSERT INTO users (name, age) VALUES ('Bob', 30);
```

### 查询数据

使用`SELECT`语句可以从表中查询数据：

```sql
SELECT * FROM users;
```

这条语句会返回`users`表中的所有数据。

### 更新数据

使用`UPDATE`语句可以更新表中的数据：

```sql
UPDATE users SET age = 26 WHERE name = 'Alice';
```

这条语句会将`name`为`Alice`的记录的`age`字段更新为`26`。

### 删除数据

使用`DELETE`语句可以删除表中的数据：

```sql
DELETE FROM users WHERE name = 'Bob';
```

这条语句会删除`name`为`Bob`的记录。

## 在Android中使用SQLite

在Android中，SQLite数据库的操作通常通过`SQLiteOpenHelper`类来实现。`SQLiteOpenHelper`是一个帮助类，用于管理数据库的创建和版本控制。

### 创建数据库

首先，我们需要创建一个继承自`SQLiteOpenHelper`的类，并重写`onCreate`和`onUpgrade`方法：

```java
import android.content.Context;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;

public class DatabaseHelper extends SQLiteOpenHelper {

    private static final String DATABASE_NAME = "my_database.db";
    private static final int DATABASE_VERSION = 1;

    public DatabaseHelper(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        db.execSQL("CREATE TABLE users (id INTEGER PRIMARY KEY AUTOINCREMENT, name TEXT NOT NULL, age INTEGER);");
    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        db.execSQL("DROP TABLE IF EXISTS users");
        onCreate(db);
    }
}
```

在这个例子中，我们创建了一个名为`my_database.db`的数据库，并在`onCreate`方法中创建了一个`users`表。

### 插入数据

要插入数据，我们可以使用`SQLiteDatabase`的`insert`方法：

```java
import android.content.ContentValues;
import android.database.sqlite.SQLiteDatabase;

public void addUser(String name, int age) {
    SQLiteDatabase db = this.getWritableDatabase();
    ContentValues values = new ContentValues();
    values.put("name", name);
    values.put("age", age);
    db.insert("users", null, values);
    db.close();
}
```

### 查询数据

要查询数据，我们可以使用`SQLiteDatabase`的`query`方法：

```java
import android.database.Cursor;
import android.database.sqlite.SQLiteDatabase;

public Cursor getUsers() {
    SQLiteDatabase db = this.getReadableDatabase();
    return db.query("users", null, null, null, null, null, null);
}
```

### 更新数据

要更新数据，我们可以使用`SQLiteDatabase`的`update`方法：

```java
import android.content.ContentValues;
import android.database.sqlite.SQLiteDatabase;

public void updateUserAge(String name, int newAge) {
    SQLiteDatabase db = this.getWritableDatabase();
    ContentValues values = new ContentValues();
    values.put("age", newAge);
    db.update("users", values, "name = ?", new String[]{name});
    db.close();
}
```

### 删除数据

要删除数据，我们可以使用`SQLiteDatabase`的`delete`方法：

```java
import android.database.sqlite.SQLiteDatabase;

public void deleteUser(String name) {
    SQLiteDatabase db = this.getWritableDatabase();
    db.delete("users", "name = ?", new String[]{name});
    db.close();
}
```

## 实际应用场景

假设我们正在开发一个简单的联系人管理应用。我们可以使用SQLite数据库来存储联系人的姓名和电话号码。以下是一个简单的实现：

```java
public class ContactDatabaseHelper extends SQLiteOpenHelper {

    private static final String DATABASE_NAME = "contacts.db";
    private static final int DATABASE_VERSION = 1;

    public ContactDatabaseHelper(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        db.execSQL("CREATE TABLE contacts (id INTEGER PRIMARY KEY AUTOINCREMENT, name TEXT NOT NULL, phone TEXT);");
    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        db.execSQL("DROP TABLE IF EXISTS contacts");
        onCreate(db);
    }

    public void addContact(String name, String phone) {
        SQLiteDatabase db = this.getWritableDatabase();
        ContentValues values = new ContentValues();
        values.put("name", name);
        values.put("phone", phone);
        db.insert("contacts", null, values);
        db.close();
    }

    public Cursor getContacts() {
        SQLiteDatabase db = this.getReadableDatabase();
        return db.query("contacts", null, null, null, null, null, null);
    }
}
```

在这个例子中，我们创建了一个`contacts`表，并实现了添加联系人和查询联系人的功能。

## 总结

SQLite是Android开发中非常重要的数据存储工具。通过本文，你应该已经了解了SQLite的基本概念、如何在Android中使用SQLite进行数据存储，以及如何在实际应用中使用SQLite。希望这些内容能帮助你在Android开发中更好地使用SQLite数据库。

## 附加资源

- [SQLite官方文档](https://www.sqlite.org/docs.html)
- [Android SQLiteDatabase文档](https://developer.android.com/reference/android/database/sqlite/SQLiteDatabase)
- [Android SQLiteOpenHelper文档](https://developer.android.com/reference/android/database/sqlite/SQLiteOpenHelper)

## 练习

1. 创建一个新的Android项目，并实现一个简单的任务管理应用，使用SQLite数据库来存储任务名称和任务状态。
2. 扩展联系人管理应用，添加更新和删除联系人的功能。
3. 尝试使用`SQLiteDatabase`的`rawQuery`方法执行自定义SQL查询。

:::tip
在开发过程中，记得使用`try-catch`块来处理可能的异常，并确保在操作完成后关闭数据库连接。
:::