---
title: Spring 响应状态
description: 了解Spring REST中如何管理和使用HTTP响应状态码，以及如何在实际开发中应用这些状态码。
---

# Spring 响应状态

在构建RESTful API时，HTTP响应状态码是客户端与服务器之间通信的重要组成部分。它们不仅告诉客户端请求是否成功，还提供了关于请求失败原因的详细信息。Spring框架提供了多种方式来管理和返回这些状态码，本文将详细介绍如何在Spring REST中处理响应状态。

## 什么是HTTP响应状态码？

HTTP响应状态码是服务器对客户端请求的响应的一部分。它们由三位数字组成，分为五个类别：

- **1xx（信息性状态码）**：表示请求已被接收，继续处理。
- **2xx（成功状态码）**：表示请求已成功被服务器接收、理解并接受。
- **3xx（重定向状态码）**：表示需要客户端采取进一步的操作才能完成请求。
- **4xx（客户端错误状态码）**：表示客户端可能出错，妨碍了服务器的处理。
- **5xx（服务器错误状态码）**：表示服务器在处理请求时发生了错误。

## Spring 中的响应状态码

在Spring REST中，响应状态码通常由控制器方法返回。Spring提供了多种方式来设置这些状态码，包括使用`@ResponseStatus`注解、`ResponseEntity`类以及异常处理。

### 使用`@ResponseStatus`注解

`@ResponseStatus`注解可以直接应用于控制器方法或异常类上，以指定返回的HTTP状态码。

```java
@RestController
public class MyController {

    @GetMapping("/example")
    @ResponseStatus(HttpStatus.OK)
    public String example() {
        return "This is an example response";
    }
}
```

在上面的例子中，`@ResponseStatus(HttpStatus.OK)`指定了当`example`方法被调用时，返回的HTTP状态码为200（OK）。

### 使用`ResponseEntity`

`ResponseEntity`是一个更灵活的方式，它允许你在返回响应时同时指定状态码和响应体。

```java
@RestController
public class MyController {

    @GetMapping("/example")
    public ResponseEntity<String> example() {
        return new ResponseEntity<>("This is an example response", HttpStatus.OK);
    }
}
```

在这个例子中，`ResponseEntity`不仅返回了响应体，还明确指定了HTTP状态码为200（OK）。

### 异常处理中的状态码

在Spring中，你可以通过`@ExceptionHandler`注解来处理异常，并返回特定的HTTP状态码。

```java
@RestControllerAdvice
public class GlobalExceptionHandler {

    @ExceptionHandler(ResourceNotFoundException.class)
    @ResponseStatus(HttpStatus.NOT_FOUND)
    public String handleResourceNotFoundException(ResourceNotFoundException ex) {
        return ex.getMessage();
    }
}
```

在这个例子中，当`ResourceNotFoundException`被抛出时，Spring将返回404（NOT FOUND）状态码。

## 实际应用场景

假设你正在开发一个用户管理系统，你需要处理以下几种情况：

1. **用户注册成功**：返回201（CREATED）状态码。
2. **用户未找到**：返回404（NOT FOUND）状态码。
3. **请求参数无效**：返回400（BAD REQUEST）状态码。

```java
@RestController
@RequestMapping("/users")
public class UserController {

    @PostMapping
    @ResponseStatus(HttpStatus.CREATED)
    public User createUser(@RequestBody User user) {
        // 保存用户逻辑
        return user;
    }

    @GetMapping("/{id}")
    public ResponseEntity<User> getUser(@PathVariable Long id) {
        User user = userService.findById(id);
        if (user == null) {
            return new ResponseEntity<>(HttpStatus.NOT_FOUND);
        }
        return new ResponseEntity<>(user, HttpStatus.OK);
    }

    @ExceptionHandler(InvalidRequestException.class)
    @ResponseStatus(HttpStatus.BAD_REQUEST)
    public String handleInvalidRequestException(InvalidRequestException ex) {
        return ex.getMessage();
    }
}
```

在这个例子中，`createUser`方法返回201（CREATED）状态码，表示用户注册成功。`getUser`方法在用户未找到时返回404（NOT FOUND）状态码。`handleInvalidRequestException`方法处理无效请求，返回400（BAD REQUEST）状态码。

## 总结

HTTP响应状态码在RESTful API中扮演着至关重要的角色。Spring提供了多种方式来管理和返回这些状态码，包括`@ResponseStatus`注解、`ResponseEntity`类以及异常处理。通过合理使用这些工具，你可以构建出更加健壮和易于理解的API。

## 附加资源与练习

- **练习**：尝试在你的Spring项目中实现一个简单的用户管理系统，并使用不同的HTTP状态码来处理各种情况。
- **资源**：
  - [Spring官方文档 - ResponseEntity](https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/http/ResponseEntity.html)
  - [HTTP状态码详解](https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Status)

通过本文的学习，你应该已经掌握了如何在Spring REST中管理和使用HTTP响应状态码。继续实践和探索，你将能够构建出更加完善的RESTful API。