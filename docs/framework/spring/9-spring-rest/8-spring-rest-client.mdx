---
title: Spring REST 客户端
description: 了解如何使用 Spring REST 客户端与 RESTful Web 服务进行交互。本文适合初学者，包含代码示例、实际案例和详细解释。
---

## 介绍

在现代 Web 开发中，RESTful API 是应用程序之间通信的主要方式之一。Spring 框架提供了强大的工具来简化与 RESTful 服务的交互，其中之一就是 **Spring REST 客户端**。通过 Spring REST 客户端，开发者可以轻松地发送 HTTP 请求并处理响应，而无需手动处理底层的 HTTP 连接。

本文将逐步介绍如何使用 Spring REST 客户端，包括如何配置、发送请求以及处理响应。我们还将通过实际案例展示其应用场景。

## Spring REST 客户端概述

Spring 提供了多种方式来创建 REST 客户端，其中最常用的是 `RestTemplate` 和 `WebClient`。`RestTemplate` 是 Spring 的传统 REST 客户端，而 `WebClient` 是 Spring WebFlux 的一部分，支持响应式编程。

### RestTemplate

`RestTemplate` 是一个同步的 REST 客户端，适用于传统的阻塞式编程模型。它提供了多种方法来发送 HTTP 请求，如 `GET`、`POST`、`PUT`、`DELETE` 等。

### WebClient

`WebClient` 是一个非阻塞的 REST 客户端，适用于响应式编程模型。它支持异步操作，能够更好地处理高并发场景。

## 使用 RestTemplate

### 配置 RestTemplate

首先，我们需要在 Spring 项目中配置 `RestTemplate`。可以通过以下方式将其声明为一个 Bean：

```java
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.client.RestTemplate;

@Configuration
public class AppConfig {

    @Bean
    public RestTemplate restTemplate() {
        return new RestTemplate();
    }
}
```

### 发送 GET 请求

假设我们有一个 RESTful API，返回用户信息。我们可以使用 `RestTemplate` 发送 `GET` 请求并获取响应：

```java
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.web.client.RestTemplate;

@Service
public class UserService {

    @Autowired
    private RestTemplate restTemplate;

    public User getUserById(Long id) {
        String url = "https://api.example.com/users/" + id;
        return restTemplate.getForObject(url, User.class);
    }
}
```

在这个例子中，`getForObject` 方法发送一个 `GET` 请求，并将响应反序列化为 `User` 对象。

### 发送 POST 请求

如果需要发送 `POST` 请求，可以使用 `postForObject` 方法：

```java
public User createUser(User user) {
    String url = "https://api.example.com/users";
    return restTemplate.postForObject(url, user, User.class);
}
```

### 处理响应

`RestTemplate` 提供了多种方法来处理响应，如 `getForObject`、`postForObject`、`exchange` 等。`exchange` 方法提供了更灵活的方式来处理请求和响应：

```java
import org.springframework.http.HttpMethod;
import org.springframework.http.ResponseEntity;

public ResponseEntity<User> getUserById(Long id) {
    String url = "https://api.example.com/users/" + id;
    return restTemplate.exchange(url, HttpMethod.GET, null, User.class);
}
```

## 使用 WebClient

### 配置 WebClient

`WebClient` 是 Spring WebFlux 的一部分，因此需要在项目中引入 `spring-boot-starter-webflux` 依赖：

```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-webflux</artifactId>
</dependency>
```

然后，我们可以通过以下方式配置 `WebClient`：

```java
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.reactive.function.client.WebClient;

@Configuration
public class AppConfig {

    @Bean
    public WebClient webClient() {
        return WebClient.create();
    }
}
```

### 发送 GET 请求

使用 `WebClient` 发送 `GET` 请求的示例如下：

```java
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.web.reactive.function.client.WebClient;
import reactor.core.publisher.Mono;

@Service
public class UserService {

    @Autowired
    private WebClient webClient;

    public Mono<User> getUserById(Long id) {
        return webClient.get()
                        .uri("https://api.example.com/users/{id}", id)
                        .retrieve()
                        .bodyToMono(User.class);
    }
}
```

### 发送 POST 请求

发送 `POST` 请求的示例如下：

```java
public Mono<User> createUser(User user) {
    return webClient.post()
                    .uri("https://api.example.com/users")
                    .body(Mono.just(user), User.class)
                    .retrieve()
                    .bodyToMono(User.class);
}
```

### 处理响应

`WebClient` 提供了 `retrieve` 和 `exchange` 方法来处理响应。`retrieve` 方法更简单，而 `exchange` 方法提供了更细粒度的控制。

## 实际案例

假设我们正在开发一个电商应用，需要从外部 API 获取商品信息。我们可以使用 `RestTemplate` 或 `WebClient` 来实现这一功能。

### 使用 RestTemplate 获取商品信息

```java
public Product getProductById(Long id) {
    String url = "https://api.example.com/products/" + id;
    return restTemplate.getForObject(url, Product.class);
}
```

### 使用 WebClient 获取商品信息

```java
public Mono<Product> getProductById(Long id) {
    return webClient.get()
                    .uri("https://api.example.com/products/{id}", id)
                    .retrieve()
                    .bodyToMono(Product.class);
}
```

## 总结

Spring REST 客户端提供了强大的工具来简化与 RESTful 服务的交互。`RestTemplate` 适用于传统的同步编程模型，而 `WebClient` 则适用于响应式编程模型。通过本文的介绍，你应该能够理解如何使用这些工具来发送 HTTP 请求并处理响应。

## 附加资源

- [Spring RestTemplate 官方文档](https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/client/RestTemplate.html)
- [Spring WebClient 官方文档](https://docs.spring.io/spring-framework/docs/current/reference/html/web-reactive.html#webflux-client)

## 练习

1. 使用 `RestTemplate` 实现一个简单的 HTTP 客户端，发送 `GET` 请求并打印响应。
2. 使用 `WebClient` 实现一个异步的 HTTP 客户端，发送 `POST` 请求并处理响应。
3. 比较 `RestTemplate` 和 `WebClient` 的优缺点，并讨论它们适用的场景。
