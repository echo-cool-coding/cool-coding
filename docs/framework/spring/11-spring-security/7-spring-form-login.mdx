---
title: Spring 表单登录
description: 了解如何在Spring Security中实现表单登录，保护您的Web应用程序。
---

# Spring 表单登录

在构建Web应用程序时，安全性是一个至关重要的方面。Spring Security是Spring生态系统中的一个强大模块，它提供了全面的安全功能，包括身份验证和授权。表单登录是Spring Security中最常用的身份验证机制之一，它允许用户通过表单提交用户名和密码来登录应用程序。

## 什么是表单登录？

表单登录是一种基于Web的身份验证机制，用户通过填写HTML表单（通常包含用户名和密码字段）来提交他们的凭据。Spring Security处理这些凭据，验证用户的身份，并根据验证结果决定是否允许用户访问受保护的资源。

## 配置Spring表单登录

要在Spring Security中启用表单登录，您需要配置一个安全过滤器链。以下是一个基本的配置示例：

```java
@Configuration
@EnableWebSecurity
public class SecurityConfig extends WebSecurityConfigurerAdapter {

    @Override
    protected void configure(HttpSecurity http) throws Exception {
        http
            .authorizeRequests()
                .antMatchers("/public/**").permitAll() // 允许访问公共资源
                .anyRequest().authenticated() // 其他请求需要认证
                .and()
            .formLogin()
                .loginPage("/login") // 自定义登录页面
                .permitAll() // 允许所有用户访问登录页面
                .and()
            .logout()
                .permitAll(); // 允许所有用户注销
    }
}
```

在这个配置中，我们定义了一个安全过滤器链，允许访问`/public/**`路径下的资源，而其他所有请求都需要用户进行身份验证。我们还指定了一个自定义的登录页面`/login`，并允许所有用户访问该页面。

## 创建登录表单

接下来，我们需要创建一个登录表单。以下是一个简单的HTML表单示例：

```html
<form method="POST" action="/login">
    <div>
        <label for="username">用户名:</label>
        <input type="text" id="username" name="username" />
    </div>
    <div>
        <label for="password">密码:</label>
        <input type="password" id="password" name="password" />
    </div>
    <div>
        <button type="submit">登录</button>
    </div>
</form>
```

这个表单包含两个字段：`username`和`password`，以及一个提交按钮。当用户提交表单时，数据将被发送到`/login`端点，Spring Security将处理这些数据并进行身份验证。

## 处理登录请求

Spring Security会自动处理登录请求，并将用户重定向到他们最初尝试访问的页面（如果存在）。如果登录成功，用户将被重定向到目标页面；如果登录失败，用户将被重定向回登录页面，并显示错误消息。

## 实际应用场景

假设您正在构建一个在线商店应用程序。您希望只有注册用户才能访问购物车和结账页面。通过配置Spring表单登录，您可以确保只有经过身份验证的用户才能访问这些受保护的资源。

```java
@Configuration
@EnableWebSecurity
public class SecurityConfig extends WebSecurityConfigurerAdapter {

    @Override
    protected void configure(HttpSecurity http) throws Exception {
        http
            .authorizeRequests()
                .antMatchers("/cart/**", "/checkout/**").authenticated() // 购物车和结账页面需要认证
                .antMatchers("/public/**").permitAll() // 允许访问公共资源
                .and()
            .formLogin()
                .loginPage("/login") // 自定义登录页面
                .permitAll() // 允许所有用户访问登录页面
                .and()
            .logout()
                .permitAll(); // 允许所有用户注销
    }
}
```

在这个配置中，我们保护了`/cart/**`和`/checkout/**`路径下的资源，只有经过身份验证的用户才能访问这些页面。

## 总结

Spring表单登录是保护Web应用程序的一种简单而有效的方法。通过配置Spring Security，您可以轻松地实现用户身份验证，并保护您的应用程序免受未经授权的访问。希望本文能帮助您理解如何在Spring Security中实现表单登录，并为您的应用程序提供强大的安全保障。

## 附加资源

- [Spring Security官方文档](https://docs.spring.io/spring-security/reference/)
- [Spring Security表单登录示例](https://github.com/spring-projects/spring-security-samples)

## 练习

1. 尝试在您的Spring Boot应用程序中配置表单登录。
2. 创建一个自定义登录页面，并确保只有经过身份验证的用户才能访问某些受保护的资源。
3. 探索Spring Security的其他功能，如记住我（Remember-Me）和多因素身份验证。
