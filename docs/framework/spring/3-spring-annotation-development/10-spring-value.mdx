---
title: Spring @Value
description: "了解如何使用 Spring 的 @Value 注解来注入外部配置值到 Spring Bean 中。本文适合初学者，包含代码示例和实际应用场景。"
---

# Spring @Value

在 Spring 框架中，`@Value` 注解用于将外部配置值注入到 Spring Bean 的属性或方法参数中。它可以帮助我们从配置文件、环境变量或其他来源动态地获取值，并将其注入到应用程序中。

## 1. 基本用法

`@Value` 注解可以直接应用于字段、方法或构造函数参数。它的值可以是一个简单的字符串，也可以是一个 SpEL（Spring Expression Language）表达式。

### 1.1 注入简单值

假设我们有一个 `application.properties` 文件，其中包含以下内容：

```properties
app.name=MyApp
app.version=1.0.0
```

我们可以使用 `@Value` 注解将这些值注入到 Spring Bean 中：

```java
import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Component;

@Component
public class AppConfig {

    @Value("${app.name}")
    private String appName;

    @Value("${app.version}")
    private String appVersion;

    public void printAppInfo() {
        System.out.println("App Name: " + appName);
        System.out.println("App Version: " + appVersion);
    }
}
```

在这个例子中，`appName` 和 `appVersion` 字段将被分别注入为 `MyApp` 和 `1.0.0`。

### 1.2 注入默认值

如果配置文件中没有定义某个属性，我们可以为 `@Value` 注解提供一个默认值：

```java
@Value("${app.description:Default Description}")
private String appDescription;
```

如果 `app.description` 没有在配置文件中定义，`appDescription` 将被注入为 `Default Description`。

## 2. 使用 SpEL 表达式

`@Value` 注解还支持 SpEL 表达式，这使得我们可以进行更复杂的值注入。

### 2.1 注入系统属性

我们可以使用 SpEL 表达式来注入系统属性：

```java
@Value("#{systemProperties['user.name']}")
private String userName;
```

在这个例子中，`userName` 将被注入为当前操作系统的用户名。

### 2.2 注入环境变量

我们也可以使用 SpEL 表达式来注入环境变量：

```java
@Value("#{environment['JAVA_HOME']}")
private String javaHome;
```

在这个例子中，`javaHome` 将被注入为 `JAVA_HOME` 环境变量的值。

## 3. 实际应用场景

### 3.1 动态配置数据库连接

假设我们有一个数据库连接的配置文件 `application.properties`：

```properties
db.url=jdbc:mysql://localhost:3306/mydb
db.username=root
db.password=secret
```

我们可以使用 `@Value` 注解将这些配置注入到数据库连接类中：

```java
import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Component;

@Component
public class DatabaseConfig {

    @Value("${db.url}")
    private String dbUrl;

    @Value("${db.username}")
    private String dbUsername;

    @Value("${db.password}")
    private String dbPassword;

    public void printDbConfig() {
        System.out.println("DB URL: " + dbUrl);
        System.out.println("DB Username: " + dbUsername);
        System.out.println("DB Password: " + dbPassword);
    }
}
```

### 3.2 动态调整应用程序行为

我们可以使用 `@Value` 注解来动态调整应用程序的行为。例如，假设我们有一个配置文件 `application.properties`：

```properties
app.feature.enabled=true
```

我们可以使用 `@Value` 注解来控制某个功能是否启用：

```java
import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Component;

@Component
public class FeatureToggle {

    @Value("${app.feature.enabled:false}")
    private boolean featureEnabled;

    public void performAction() {
        if (featureEnabled) {
            System.out.println("Feature is enabled!");
        } else {
            System.out.println("Feature is disabled.");
        }
    }
}
```

## 4. 总结

`@Value` 注解是 Spring 框架中一个非常强大的工具，它允许我们将外部配置值注入到 Spring Bean 中。通过使用 `@Value`，我们可以轻松地从配置文件、环境变量或其他来源获取值，并将其注入到应用程序中。此外，`@Value` 还支持 SpEL 表达式，使得我们可以进行更复杂的值注入。

## 5. 附加资源与练习

- **练习 1**: 创建一个 Spring Boot 项目，并在 `application.properties` 文件中定义一些自定义属性。使用 `@Value` 注解将这些属性注入到 Spring Bean 中，并打印它们的值。
- **练习 2**: 尝试使用 SpEL 表达式注入系统属性和环境变量，并在控制台中打印它们的值。
- **练习 3**: 创建一个功能开关，使用 `@Value` 注解从配置文件中读取开关状态，并根据开关状态执行不同的逻辑。

:::tip
如果你对 SpEL 表达式感兴趣，可以进一步学习 Spring 的 [SpEL 文档](https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#expressions)。
:::