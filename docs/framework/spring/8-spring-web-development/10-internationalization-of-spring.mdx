---
title: Spring 国际化
description: 学习如何在Spring Web应用中实现国际化（i18n），以支持多语言内容。
---

# Spring 国际化

在现代Web应用中，支持多语言内容是一个常见的需求。Spring框架提供了强大的国际化（i18n）支持，使得开发者能够轻松地为应用添加多语言功能。本文将详细介绍如何在Spring Web应用中实现国际化。

## 什么是国际化？

国际化（Internationalization，简称i18n）是指设计和开发应用程序，使其能够支持多种语言和区域设置，而无需对代码进行重大修改。通过国际化，应用程序可以根据用户的语言偏好动态地显示内容。

## Spring 国际化的核心组件

Spring国际化的核心组件包括：

1. **MessageSource**：用于解析消息的接口，通常用于从资源文件中加载消息。
2. **LocaleResolver**：用于确定用户的区域设置（Locale）。
3. **LocaleChangeInterceptor**：用于根据请求参数动态更改用户的区域设置。

## 配置MessageSource

首先，我们需要配置一个`MessageSource` bean来加载多语言资源文件。资源文件通常以`messages.properties`为基准，其他语言的文件则命名为`messages_xx.properties`，其中`xx`是语言代码。

```java
@Configuration
public class AppConfig {

    @Bean
    public MessageSource messageSource() {
        ResourceBundleMessageSource messageSource = new ResourceBundleMessageSource();
        messageSource.setBasename("messages");
        messageSource.setDefaultEncoding("UTF-8");
        return messageSource;
    }
}
```

在这个配置中，`basename`指定了资源文件的基本名称，Spring会自动加载`messages.properties`、`messages_en.properties`、`messages_zh.properties`等文件。

## 配置LocaleResolver

接下来，我们需要配置一个`LocaleResolver`来确定用户的区域设置。Spring提供了几种内置的`LocaleResolver`，最常用的是`CookieLocaleResolver`和`SessionLocaleResolver`。

```java
@Bean
public LocaleResolver localeResolver() {
    CookieLocaleResolver resolver = new CookieLocaleResolver();
    resolver.setDefaultLocale(Locale.ENGLISH);
    return resolver;
}
```

在这个例子中，我们使用`CookieLocaleResolver`，并将默认区域设置为英语。

## 配置LocaleChangeInterceptor

为了允许用户动态更改区域设置，我们可以配置一个`LocaleChangeInterceptor`。这个拦截器会根据请求参数（例如`?lang=en`）来更改用户的区域设置。

```java
@Bean
public LocaleChangeInterceptor localeChangeInterceptor() {
    LocaleChangeInterceptor interceptor = new LocaleChangeInterceptor();
    interceptor.setParamName("lang");
    return interceptor;
}

@Override
public void addInterceptors(InterceptorRegistry registry) {
    registry.addInterceptor(localeChangeInterceptor());
}
```

在这个配置中，`paramName`指定了用于更改区域设置的请求参数名称。

## 使用国际化消息

在控制器或视图中，我们可以使用`MessageSource`来获取国际化消息。例如：

```java
@Autowired
private MessageSource messageSource;

@GetMapping("/greeting")
public String greeting(Locale locale) {
    String greeting = messageSource.getMessage("greeting.message", null, locale);
    return greeting;
}
```

在这个例子中，`getMessage`方法会根据传入的`locale`从资源文件中获取对应的消息。

## 实际案例

假设我们有一个简单的Web应用，需要支持英语和中文。我们可以创建以下资源文件：

- `messages.properties`（默认语言）：
  ```properties
  greeting.message=Hello, World!
  ```

- `messages_zh.properties`（中文）：
  ```properties
  greeting.message=你好，世界！
  ```

当用户访问`/greeting?lang=zh`时，应用会返回“你好，世界！”，而当用户访问`/greeting?lang=en`时，应用会返回“Hello, World!”。

## 总结

通过Spring的国际化支持，我们可以轻松地为Web应用添加多语言功能。关键步骤包括配置`MessageSource`、`LocaleResolver`和`LocaleChangeInterceptor`，并在代码中使用`MessageSource`来获取国际化消息。

## 附加资源与练习

- **练习**：尝试为你的Spring Web应用添加更多语言支持，例如法语、西班牙语等。
- **资源**：
  - [Spring官方文档 - 国际化](https://docs.spring.io/spring-framework/docs/current/reference/html/web.html#mvc-localeresolver)
  - [Java国际化指南](https://docs.oracle.com/javase/tutorial/i18n/)

通过实践和深入学习，你将能够更好地掌握Spring国际化的使用技巧。