---
title: Spring 控制器
description: 了解Spring MVC中的控制器（Controller），掌握如何通过控制器处理HTTP请求并返回响应。
---

# Spring 控制器

在Spring MVC框架中，控制器（Controller）是处理HTTP请求并返回响应的核心组件。它是模型（Model）、视图（View）和控制器（Controller）设计模式中的一部分，负责协调用户请求与应用程序逻辑之间的交互。

## 什么是Spring控制器？

Spring控制器是一个Java类，通常使用`@Controller`注解进行标记。它的主要职责是接收HTTP请求，调用适当的业务逻辑，并返回一个视图或数据作为响应。控制器是Spring MVC框架中的关键组件，它将请求映射到特定的处理方法，并决定如何响应客户端。

### 控制器的工作原理

当客户端发送一个HTTP请求时，Spring的`DispatcherServlet`会根据请求的URL找到对应的控制器方法。控制器方法处理请求后，通常会返回一个视图名称或直接返回数据（如JSON或XML）。Spring MVC框架会根据返回的内容决定如何渲染响应。

## 创建第一个Spring控制器

让我们从一个简单的例子开始，创建一个处理GET请求的控制器。

```java
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;

@Controller
@RequestMapping("/greeting")
public class GreetingController {

    @GetMapping("/hello")
    public String sayHello() {
        return "hello"; // 返回视图名称
    }
}
```

在这个例子中，`GreetingController`类处理`/greeting/hello`路径的GET请求。`@GetMapping`注解用于将HTTP GET请求映射到`sayHello`方法。该方法返回一个字符串`"hello"`，Spring MVC会将其解析为一个视图名称（例如`hello.jsp`或`hello.html`）。

### 输入与输出

- **输入**: 客户端访问`http://localhost:8080/greeting/hello`。
- **输出**: Spring MVC会渲染名为`hello`的视图，并将其返回给客户端。

## 控制器方法的返回值

Spring控制器方法可以返回多种类型的值，具体取决于应用程序的需求。以下是常见的返回值类型：

1. **视图名称**: 返回一个字符串，表示视图的名称。Spring MVC会根据视图解析器（View Resolver）找到对应的视图文件并渲染。
   ```java
   @GetMapping("/home")
   public String home() {
       return "home"; // 返回视图名称
   }
   ```

2. **ModelAndView**: 返回一个包含模型数据和视图名称的对象。
   ```java
   @GetMapping("/user")
   public ModelAndView getUser() {
       ModelAndView modelAndView = new ModelAndView("user");
       modelAndView.addObject("username", "JohnDoe");
       return modelAndView;
   }
   ```

3. **ResponseEntity**: 直接返回HTTP响应，通常用于RESTful API。
   ```java
   @GetMapping("/api/greeting")
   public ResponseEntity<String> getGreeting() {
       return ResponseEntity.ok("Hello, World!");
   }
   ```

4. **@ResponseBody**: 将方法返回值直接写入HTTP响应体，通常用于返回JSON或XML数据。
   ```java
   @GetMapping("/api/user")
   @ResponseBody
   public User getUser() {
       return new User("JohnDoe", "john.doe@example.com");
   }
   ```

## 实际应用场景

### 场景1：用户登录

假设我们正在开发一个用户登录功能。用户通过表单提交用户名和密码，控制器需要验证用户信息并返回相应的视图。

```java
@Controller
@RequestMapping("/auth")
public class AuthController {

    @PostMapping("/login")
    public String login(@RequestParam String username, @RequestParam String password, Model model) {
        if ("admin".equals(username) && "password".equals(password)) {
            model.addAttribute("username", username);
            return "dashboard"; // 登录成功，跳转到仪表盘页面
        } else {
            model.addAttribute("error", "Invalid credentials");
            return "login"; // 登录失败，返回登录页面并显示错误信息
        }
    }
}
```

在这个例子中，控制器处理`/auth/login`路径的POST请求，验证用户名和密码，并根据验证结果返回不同的视图。

### 场景2：RESTful API

假设我们正在开发一个简单的RESTful API，用于管理用户信息。

```java
@RestController
@RequestMapping("/api/users")
public class UserController {

    private List<User> users = new ArrayList<>();

    @GetMapping
    public List<User> getUsers() {
        return users;
    }

    @PostMapping
    public ResponseEntity<User> addUser(@RequestBody User user) {
        users.add(user);
        return ResponseEntity.status(HttpStatus.CREATED).body(user);
    }
}
```

在这个例子中，`UserController`类处理`/api/users`路径的GET和POST请求，分别用于获取用户列表和添加新用户。

## 总结

Spring控制器是Spring MVC框架中的核心组件，负责处理HTTP请求并返回响应。通过`@Controller`和`@RestController`注解，我们可以轻松地创建控制器类，并使用各种注解（如`@GetMapping`、`@PostMapping`等）将请求映射到特定的处理方法。

在实际开发中，控制器可以返回视图名称、模型数据、HTTP响应等多种类型的值，以满足不同的需求。通过合理设计控制器，我们可以构建出功能强大且易于维护的Web应用程序。

## 附加资源与练习

- **练习1**: 创建一个控制器，处理`/products`路径的GET请求，并返回一个包含产品列表的视图。
- **练习2**: 实现一个RESTful API，处理`/api/books`路径的CRUD操作（创建、读取、更新、删除）。
- **资源**: 阅读[Spring官方文档](https://docs.spring.io/spring-framework/docs/current/reference/html/web.html)以深入了解Spring MVC的更多高级特性。

:::tip
在开发过程中，使用Spring Boot可以大大简化Spring MVC的配置和部署过程。尝试将上述示例集成到Spring Boot项目中，体验更高效的开发流程。
:::