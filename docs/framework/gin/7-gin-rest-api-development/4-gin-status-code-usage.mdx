---
title: Gin 状态码使用
description: 了解如何在Gin框架中使用HTTP状态码，确保REST API的正确响应。本文适合初学者，包含代码示例和实际应用场景。
---

# Gin 状态码使用

在开发REST API时，HTTP状态码是客户端与服务器之间通信的重要组成部分。它们帮助客户端理解请求的结果，例如请求是否成功、是否发生了错误，或者是否需要进一步的操作。Gin框架提供了简单而强大的工具来处理和返回这些状态码。

## 什么是HTTP状态码？

HTTP状态码是服务器响应客户端请求时返回的三位数字代码。它们分为五个类别：

1. **1xx（信息性状态码）**：表示请求已被接收，继续处理。
2. **2xx（成功状态码）**：表示请求已成功被服务器接收、理解并接受。
3. **3xx（重定向状态码）**：表示需要客户端采取进一步的操作来完成请求。
4. **4xx（客户端错误状态码）**：表示客户端发送的请求有错误。
5. **5xx（服务器错误状态码）**：表示服务器在处理请求时发生了错误。

## 在Gin中使用状态码

Gin框架提供了多种方法来设置和返回HTTP状态码。以下是一些常见的用法：

### 1. 返回成功状态码

最常见的成功状态码是 `200 OK`，表示请求已成功处理。在Gin中，你可以使用 `c.JSON` 方法来返回JSON响应，并自动设置状态码为200。

```go
package main

import (
    "github.com/gin-gonic/gin"
)

func main() {
    r := gin.Default()

    r.GET("/hello", func(c *gin.Context) {
        c.JSON(200, gin.H{
            "message": "Hello, World!",
        })
    })

    r.Run()
}
```

**输入：** `GET /hello`  
**输出：**  
```json
{
    "message": "Hello, World!"
}
```

### 2. 返回错误状态码

当请求出现问题时，你可以返回相应的错误状态码。例如，`404 Not Found` 表示请求的资源不存在。

```go
r.GET("/not-found", func(c *gin.Context) {
    c.JSON(404, gin.H{
        "error": "Resource not found",
    })
})
```

**输入：** `GET /not-found`  
**输出：**  
```json
{
    "error": "Resource not found"
}
```

### 3. 自定义状态码

你可以根据需要返回任何HTTP状态码。例如，`201 Created` 表示资源已成功创建。

```go
r.POST("/create", func(c *gin.Context) {
    // 假设资源已创建
    c.JSON(201, gin.H{
        "message": "Resource created",
    })
})
```

**输入：** `POST /create`  
**输出：**  
```json
{
    "message": "Resource created"
}
```

## 实际应用场景

### 场景1：用户注册

假设你正在开发一个用户注册API。当用户成功注册时，你可以返回 `201 Created` 状态码，并返回新创建的用户信息。

```go
r.POST("/register", func(c *gin.Context) {
    // 假设用户已成功注册
    c.JSON(201, gin.H{
        "id":   1,
        "name": "John Doe",
    })
})
```

**输入：** `POST /register`  
**输出：**  
```json
{
    "id": 1,
    "name": "John Doe"
}
```

### 场景2：用户登录

当用户登录时，如果提供的凭据无效，你可以返回 `401 Unauthorized` 状态码。

```go
r.POST("/login", func(c *gin.Context) {
    // 假设凭据无效
    c.JSON(401, gin.H{
        "error": "Invalid credentials",
    })
})
```

**输入：** `POST /login`  
**输出：**  
```json
{
    "error": "Invalid credentials"
}
```

## 总结

HTTP状态码是REST API开发中不可或缺的一部分。通过正确使用状态码，你可以确保客户端能够准确理解请求的结果。Gin框架提供了简单而强大的工具来处理这些状态码，使你的API更加健壮和易于理解。

## 附加资源

- [HTTP状态码 - MDN文档](https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Status)
- [Gin框架官方文档](https://gin-gonic.com/docs/)

## 练习

1. 创建一个Gin路由，当用户访问 `/health` 时返回 `200 OK` 状态码和 `{"status": "ok"}` 的JSON响应。
2. 修改用户登录API，当用户成功登录时返回 `200 OK` 状态码和用户信息。
3. 创建一个路由，当用户访问 `/unauthorized` 时返回 `401 Unauthorized` 状态码和错误信息。

通过完成这些练习，你将更好地掌握如何在Gin中使用HTTP状态码。