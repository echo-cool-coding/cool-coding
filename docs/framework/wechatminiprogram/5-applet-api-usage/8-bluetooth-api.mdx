---
title: 蓝牙API
description: 了解如何使用小程序中的蓝牙API，实现设备间的无线通信。本文将从基础概念讲起，逐步深入，并提供代码示例和实际应用场景。
---

## 介绍

蓝牙API是小程序开发中用于实现蓝牙设备间通信的一组接口。通过蓝牙API，小程序可以与附近的蓝牙设备进行连接、数据传输等操作。这对于开发智能家居、健康监测、智能穿戴设备等应用非常有用。

## 基础概念

在开始使用蓝牙API之前，我们需要了解一些基础概念：

- **蓝牙设备**：支持蓝牙通信的设备，如手机、耳机、智能手表等。
- **服务（Service）**：蓝牙设备提供的功能集合，每个服务包含多个特征（Characteristic）。
- **特征（Characteristic）**：服务中的具体功能，如温度、心率等数据。
- **UUID**：唯一标识符，用于标识服务和特征。

## 使用步骤

### 1. 初始化蓝牙模块

在使用蓝牙API之前，需要先初始化蓝牙模块。可以通过 `wx.openBluetoothAdapter` 方法来实现。

```javascript
wx.openBluetoothAdapter({
  success(res) {
    console.log('蓝牙适配器初始化成功', res);
  },
  fail(err) {
    console.error('蓝牙适配器初始化失败', err);
  }
});
```

### 2. 搜索蓝牙设备

初始化成功后，可以开始搜索附近的蓝牙设备。使用 `wx.startBluetoothDevicesDiscovery` 方法。

```javascript
wx.startBluetoothDevicesDiscovery({
  success(res) {
    console.log('开始搜索蓝牙设备', res);
  },
  fail(err) {
    console.error('搜索蓝牙设备失败', err);
  }
});
```

### 3. 获取设备列表

搜索到设备后，可以通过 `wx.getBluetoothDevices` 方法获取设备列表。

```javascript
wx.getBluetoothDevices({
  success(res) {
    console.log('获取到的蓝牙设备列表', res.devices);
  },
  fail(err) {
    console.error('获取蓝牙设备列表失败', err);
  }
});
```

### 4. 连接设备

选择要连接的设备后，使用 `wx.createBLEConnection` 方法进行连接。

```javascript
wx.createBLEConnection({
  deviceId: '设备ID',
  success(res) {
    console.log('连接成功', res);
  },
  fail(err) {
    console.error('连接失败', err);
  }
});
```

### 5. 获取服务

连接成功后，可以通过 `wx.getBLEDeviceServices` 方法获取设备提供的服务。

```javascript
wx.getBLEDeviceServices({
  deviceId: '设备ID',
  success(res) {
    console.log('获取到的服务列表', res.services);
  },
  fail(err) {
    console.error('获取服务列表失败', err);
  }
});
```

### 6. 获取特征

获取到服务后，可以通过 `wx.getBLEDeviceCharacteristics` 方法获取服务的特征。

```javascript
wx.getBLEDeviceCharacteristics({
  deviceId: '设备ID',
  serviceId: '服务ID',
  success(res) {
    console.log('获取到的特征列表', res.characteristics);
  },
  fail(err) {
    console.error('获取特征列表失败', err);
  }
});
```

### 7. 读写数据

获取到特征后，可以通过 `wx.readBLECharacteristicValue` 和 `wx.writeBLECharacteristicValue` 方法进行数据的读写。

```javascript
// 读取数据
wx.readBLECharacteristicValue({
  deviceId: '设备ID',
  serviceId: '服务ID',
  characteristicId: '特征ID',
  success(res) {
    console.log('读取到的数据', res.value);
  },
  fail(err) {
    console.error('读取数据失败', err);
  }
});

// 写入数据
wx.writeBLECharacteristicValue({
  deviceId: '设备ID',
  serviceId: '服务ID',
  characteristicId: '特征ID',
  value: '要写入的数据',
  success(res) {
    console.log('写入数据成功', res);
  },
  fail(err) {
    console.error('写入数据失败', err);
  }
});
```

## 实际应用场景

### 智能家居控制

通过蓝牙API，小程序可以与智能家居设备（如智能灯泡、智能插座）进行通信，实现远程控制。

### 健康监测

小程序可以与健康监测设备（如心率带、血压计）进行连接，实时获取健康数据并进行分析。

### 智能穿戴设备

小程序可以与智能手表、智能手环等设备进行连接，实现数据同步、消息提醒等功能。

## 总结

蓝牙API为小程序开发者提供了强大的蓝牙通信能力，使得小程序可以与各种蓝牙设备进行交互。通过本文的介绍，你应该已经掌握了蓝牙API的基本使用方法。接下来，你可以尝试在实际项目中应用这些知识，开发出更多有趣的功能。

## 附加资源

- [微信官方文档 - 蓝牙API](https://developers.weixin.qq.com/miniprogram/dev/api/device/bluetooth/wx.openBluetoothAdapter.html)
- [蓝牙技术联盟](https://www.bluetooth.com/)

## 练习

1. 尝试使用蓝牙API连接一个蓝牙设备，并读取其数据。
2. 开发一个小程序，实现与智能灯泡的通信，控制灯泡的开关和亮度。
