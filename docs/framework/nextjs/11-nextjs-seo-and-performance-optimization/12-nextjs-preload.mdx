---
title: Next.js 预加载
description: 了解如何在 Next.js 中使用预加载功能来优化页面加载性能，提升用户体验。本文适合初学者，包含代码示例和实际应用场景。
---

# Next.js 预加载

在现代 Web 开发中，页面加载速度是用户体验的关键因素之一。Next.js 提供了强大的预加载功能，帮助开发者优化页面加载性能。本文将详细介绍 Next.js 中的预加载机制，并通过代码示例和实际案例帮助你理解其工作原理和应用场景。

## 什么是预加载？

预加载（Preloading）是一种优化技术，用于提前加载用户可能访问的资源（如页面、脚本或数据），从而减少页面加载时间。Next.js 通过内置的预加载功能，可以在用户点击链接之前，提前加载目标页面的资源，从而加快页面切换速度。

### 为什么需要预加载？

- **提升用户体验**：减少页面加载时间，让用户感觉应用响应更快。
- **优化性能**：通过提前加载资源，减少用户等待时间。
- **提高转化率**：更快的加载速度通常意味着更高的用户留存率和转化率。

## Next.js 中的预加载机制

Next.js 提供了多种预加载方式，主要包括：

1. **自动预加载**：Next.js 会自动预加载视口内链接的目标页面。
2. **手动预加载**：开发者可以通过代码手动触发预加载。

### 自动预加载

Next.js 默认会自动预加载视口内链接的目标页面。例如，当用户将鼠标悬停在链接上时，Next.js 会提前加载目标页面的资源。

```jsx
import Link from 'next/link';

export default function Home() {
  return (
    <div>
      <h1>欢迎来到我的网站</h1>
      <Link href="/about">
        <a>关于我们</a>
      </Link>
    </div>
  );
}
```

在上面的代码中，当用户将鼠标悬停在 "关于我们" 链接上时，Next.js 会自动预加载 `/about` 页面的资源。

### 手动预加载

除了自动预加载，Next.js 还允许开发者手动触发预加载。你可以使用 `next/link` 组件提供的 `prefetch` 属性或 `next/router` 的 `prefetch` 方法来实现。

#### 使用 `prefetch` 属性

```jsx
import Link from 'next/link';

export default function Home() {
  return (
    <div>
      <h1>欢迎来到我的网站</h1>
      <Link href="/about" prefetch={false}>
        <a>关于我们</a>
      </Link>
    </div>
  );
}
```

在上面的代码中，`prefetch={false}` 禁用了自动预加载。你可以根据需要手动控制预加载行为。

#### 使用 `next/router` 的 `prefetch` 方法

```jsx
import { useEffect } from 'react';
import { useRouter } from 'next/router';

export default function Home() {
  const router = useRouter();

  useEffect(() => {
    router.prefetch('/about');
  }, [router]);

  return (
    <div>
      <h1>欢迎来到我的网站</h1>
      <button onClick={() => router.push('/about')}>关于我们</button>
    </div>
  );
}
```

在上面的代码中，`router.prefetch('/about')` 手动预加载了 `/about` 页面的资源。当用户点击按钮时，页面切换速度会更快。

## 实际应用场景

### 场景 1：预加载关键页面

假设你有一个电商网站，用户通常会从首页跳转到商品详情页。为了提高用户体验，你可以在用户浏览首页时，提前预加载商品详情页的资源。

```jsx
import { useEffect } from 'react';
import { useRouter } from 'next/router';

export default function Home() {
  const router = useRouter();

  useEffect(() => {
    router.prefetch('/product/123');
  }, [router]);

  return (
    <div>
      <h1>欢迎来到我们的电商网站</h1>
      <button onClick={() => router.push('/product/123')}>查看商品详情</button>
    </div>
  );
}
```

### 场景 2：预加载动态路由页面

如果你的网站使用了动态路由，你可以根据用户行为预加载相关页面。例如，当用户点击某个分类时，预加载该分类下的商品列表页。

```jsx
import { useEffect } from 'react';
import { useRouter } from 'next/router';

export default function CategoryPage() {
  const router = useRouter();

  useEffect(() => {
    router.prefetch('/category/[id]');
  }, [router]);

  return (
    <div>
      <h1>商品分类</h1>
      <button onClick={() => router.push('/category/123')}>查看分类 123</button>
    </div>
  );
}
```

## 总结

Next.js 的预加载功能是优化页面加载性能的强大工具。通过自动预加载和手动预加载，你可以显著提升用户体验，减少页面加载时间。在实际开发中，合理使用预加载功能，可以让你构建出更高效、更流畅的 Web 应用。

:::tip 提示
- 预加载功能在开发环境中默认是禁用的，你可以在生产环境中测试其效果。
- 预加载的资源会占用带宽，因此请确保只预加载用户可能访问的页面。
:::

## 附加资源与练习

- **练习 1**：在你的 Next.js 项目中，尝试为关键页面添加手动预加载功能。
- **练习 2**：使用 `next/router` 的 `prefetch` 方法，预加载动态路由页面。
- **阅读更多**：[Next.js 官方文档 - 预加载](https://nextjs.org/docs/api-reference/next/link#prefetching-pages)

通过本文的学习，你应该已经掌握了 Next.js 中的预加载功能。继续实践和探索，你将能够更好地优化你的 Next.js 应用性能。