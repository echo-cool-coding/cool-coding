---
title: Next.js AMP 支持
description: "了解如何在 Next.js 中启用和配置 AMP（Accelerated Mobile Pages），以优化移动端页面的加载速度和性能。"
---

## 介绍

AMP（Accelerated Mobile Pages）是一种由 Google 主导的开源框架，旨在通过简化 HTML 和限制 JavaScript 的使用来加速移动端页面的加载速度。Next.js 提供了对 AMP 的原生支持，允许开发者轻松地将页面转换为 AMP 格式，从而提升移动端用户体验。

在本教程中，我们将逐步讲解如何在 Next.js 中启用 AMP 支持，并通过实际案例展示其应用场景。

## 启用 AMP 支持

在 Next.js 中启用 AMP 支持非常简单。你只需要在页面组件中导出一个名为 `amp` 的配置对象，并将其设置为 `true` 即可。

```jsx
// pages/index.js
export const config = { amp: true };

export default function HomePage() {
  return (
    <div>
      <h1>欢迎来到 Next.js AMP 页面</h1>
      <p>这是一个支持 AMP 的页面。</p>
    </div>
  );
}
```

### 混合 AMP 页面

如果你希望页面同时支持 AMP 和非 AMP 版本，可以将 `amp` 配置设置为 `'hybrid'`。这样，Next.js 会为页面生成两个版本：一个标准的 HTML 版本和一个 AMP 版本。

```jsx
// pages/about.js
export const config = { amp: 'hybrid' };

export default function AboutPage() {
  return (
    <div>
      <h1>关于我们</h1>
      <p>这是一个混合 AMP 页面。</p>
    </div>
  );
}
```

## AMP 页面优化

AMP 页面有一些特殊的限制和要求，以确保其快速加载。以下是一些常见的优化技巧：

### 使用 AMP 组件

AMP 提供了一系列内置组件，用于替代标准的 HTML 元素。例如，使用 `<amp-img>` 替代 `<img>` 标签。

```jsx
// pages/gallery.js
export const config = { amp: true };

export default function GalleryPage() {
  return (
    <div>
      <h1>图片画廊</h1>
      <amp-img
        src="/images/example.jpg"
        alt="示例图片"
        width="600"
        height="400"
        layout="responsive"
      />
    </div>
  );
}
```

### 限制 JavaScript 使用

AMP 页面不允许使用自定义 JavaScript。如果你需要动态功能，可以使用 AMP 提供的组件，如 `<amp-bind>` 或 `<amp-script>`。

```jsx
// pages/interactive.js
export const config = { amp: true };

export default function InteractivePage() {
  return (
    <div>
      <h1>交互式 AMP 页面</h1>
      <amp-bind>
        <button on="tap:AMP.setState({ count: count + 1 })">
          点击次数: <span [text]="count">0</span>
        </button>
      </amp-bind>
    </div>
  );
}
```

## 实际案例

假设你正在开发一个新闻网站，并希望为移动用户提供更快的加载速度。你可以使用 Next.js 的 AMP 支持来创建 AMP 版本的新闻页面。

```jsx
// pages/news/[slug].js
export const config = { amp: 'hybrid' };

export default function NewsPage({ post }) {
  return (
    <div>
      <h1>{post.title}</h1>
      <p>{post.content}</p>
      <amp-img
        src={post.image}
        alt={post.title}
        width="600"
        height="400"
        layout="responsive"
      />
    </div>
  );
}

export async function getStaticProps({ params }) {
  const post = await fetchPostBySlug(params.slug);
  return { props: { post } };
}

export async function getStaticPaths() {
  const posts = await fetchAllPosts();
  const paths = posts.map((post) => ({
    params: { slug: post.slug },
  }));
  return { paths, fallback: false };
}
```

在这个案例中，新闻页面同时支持 AMP 和非 AMP 版本，确保所有用户都能获得最佳体验。

## 总结

Next.js 的 AMP 支持为开发者提供了一种简单而强大的方式来优化移动端页面的性能。通过启用 AMP 支持并使用 AMP 组件，你可以显著提升页面的加载速度，从而改善用户体验。

:::tip
如果你对 AMP 的更多高级功能感兴趣，可以访问 [AMP 官方文档](https://amp.dev/documentation/) 了解更多信息。
:::

## 附加资源

- [Next.js AMP 文档](https://nextjs.org/docs/api-reference/next/amp)
- [AMP 官方文档](https://amp.dev/documentation/)
- [AMP 组件库](https://amp.dev/documentation/components/)

## 练习

1. 创建一个支持 AMP 的博客页面，并使用 `<amp-img>` 显示博客封面图片。
2. 尝试在 AMP 页面中使用 `<amp-bind>` 实现一个简单的计数器功能。
3. 将现有的 Next.js 项目中的一个页面转换为混合 AMP 页面，并测试其性能。

通过这些练习，你将更深入地理解 Next.js 的 AMP 支持，并能够在实际项目中应用这些知识。