---
title: Next.js 复合组件
description: 了解如何在 Next.js 中使用复合组件模式来构建灵活且可重用的 UI 组件。
---

## 介绍

在 Next.js 中，**复合组件**是一种设计模式，用于构建灵活且可重用的 UI 组件。通过将多个小组件组合在一起，复合组件允许开发者创建复杂的 UI 结构，同时保持代码的模块化和可维护性。这种模式特别适用于需要高度定制化的组件，例如模态框、选项卡、下拉菜单等。

复合组件的核心思想是将一个组件的逻辑和 UI 拆分为多个小组件，每个小组件负责特定的功能或 UI 部分。通过这种方式，开发者可以更灵活地组合和重用这些小组件，而不必重复编写代码。

## 复合组件的基本结构

让我们从一个简单的例子开始，了解复合组件的基本结构。假设我们要构建一个可定制的模态框（Modal），它包含标题、内容和操作按钮。

```jsx
// Modal.js
import React from 'react';

const Modal = ({ children }) => {
  return <div className="modal">{children}</div>;
};

const ModalHeader = ({ children }) => {
  return <div className="modal-header">{children}</div>;
};

const ModalBody = ({ children }) => {
  return <div className="modal-body">{children}</div>;
};

const ModalFooter = ({ children }) => {
  return <div className="modal-footer">{children}</div>;
};

Modal.Header = ModalHeader;
Modal.Body = ModalBody;
Modal.Footer = ModalFooter;

export default Modal;
```

在这个例子中，我们定义了一个 `Modal` 组件，并将 `ModalHeader`、`ModalBody` 和 `ModalFooter` 作为 `Modal` 的静态属性。这样，我们可以通过 `Modal.Header`、`Modal.Body` 和 `Modal.Footer` 来访问这些小组件。

## 使用复合组件

现在，我们可以使用这个复合组件来构建一个模态框：

```jsx
import React from 'react';
import Modal from './Modal';

const App = () => {
  return (
    <Modal>
      <Modal.Header>这是标题</Modal.Header>
      <Modal.Body>这是内容</Modal.Body>
      <Modal.Footer>
        <button>关闭</button>
        <button>保存</button>
      </Modal.Footer>
    </Modal>
  );
};

export default App;
```

通过这种方式，我们可以轻松地组合和定制模态框的各个部分，而不必修改 `Modal` 组件的内部逻辑。

## 复合组件的优势

1. **模块化**：复合组件将复杂的 UI 拆分为多个小组件，使代码更易于维护和扩展。
2. **灵活性**：开发者可以根据需要自由组合小组件，创建高度定制化的 UI。
3. **可重用性**：小组件可以在不同的上下文中重复使用，减少代码重复。

## 实际案例：选项卡组件

让我们通过一个更复杂的例子来展示复合组件的实际应用。我们将构建一个选项卡组件（Tabs），它包含多个选项卡面板（TabPanel）。

```jsx
// Tabs.js
import React, { useState } from 'react';

const Tabs = ({ children }) => {
  const [activeTab, setActiveTab] = useState(0);

  return (
    <div className="tabs">
      <div className="tabs-header">
        {React.Children.map(children, (child, index) => (
          <button
            key={index}
            className={index === activeTab ? 'active' : ''}
            onClick={() => setActiveTab(index)}
          >
            {child.props.label}
          </button>
        ))}
      </div>
      <div className="tabs-content">
        {React.Children.toArray(children)[activeTab]}
      </div>
    </div>
  );
};

const TabPanel = ({ children }) => {
  return <div className="tab-panel">{children}</div>;
};

Tabs.Panel = TabPanel;

export default Tabs;
```

在这个例子中，`Tabs` 组件管理选项卡的状态，并根据用户的选择显示相应的内容。`TabPanel` 组件用于定义每个选项卡的内容。

我们可以这样使用这个选项卡组件：

```jsx
import React from 'react';
import Tabs from './Tabs';

const App = () => {
  return (
    <Tabs>
      <Tabs.Panel label="选项卡 1">这是选项卡 1 的内容</Tabs.Panel>
      <Tabs.Panel label="选项卡 2">这是选项卡 2 的内容</Tabs.Panel>
      <Tabs.Panel label="选项卡 3">这是选项卡 3 的内容</Tabs.Panel>
    </Tabs>
  );
};

export default App;
```

通过这种方式，我们可以轻松地创建和管理多个选项卡，而不必重复编写代码。

## 总结

复合组件是 Next.js 中一种强大的设计模式，它允许开发者构建灵活且可重用的 UI 组件。通过将复杂的 UI 拆分为多个小组件，复合组件使代码更易于维护和扩展。无论是构建模态框、选项卡还是其他复杂的 UI 结构，复合组件都能帮助你更高效地完成任务。

## 附加资源

- [React 官方文档](https://reactjs.org/docs/composition-vs-inheritance.html)
- [Next.js 官方文档](https://nextjs.org/docs)

## 练习

1. 尝试扩展 `Modal` 组件，添加一个关闭按钮，并实现关闭功能。
2. 修改 `Tabs` 组件，使其支持动态添加和删除选项卡。
3. 创建一个复合组件，用于构建一个可折叠的侧边栏（Sidebar）。

:::tip
在练习过程中，尝试将复合组件与其他 React 特性（如 Context API 或 Hooks）结合使用，以进一步提升组件的功能。
:::