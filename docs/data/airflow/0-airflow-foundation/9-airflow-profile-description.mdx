---
title: Airflow 配置文件说明
description: 了解Airflow配置文件的结构、关键配置项及其作用，掌握如何根据需求调整Airflow的行为。
---

# Airflow 配置文件说明

Apache Airflow 是一个强大的工作流管理工具，广泛用于调度和监控复杂的数据管道。为了确保Airflow能够按照预期运行，我们需要正确配置其核心配置文件 `airflow.cfg`。本文将详细介绍Airflow配置文件的结构、关键配置项及其作用，帮助你更好地理解和调整Airflow的行为。

## 1. 什么是 `airflow.cfg`？

`airflow.cfg` 是Airflow的核心配置文件，它定义了Airflow的运行环境、调度器、执行器、数据库连接等关键参数。默认情况下，`airflow.cfg` 位于Airflow安装目录下的 `~/airflow` 文件夹中。

:::note
如果你尚未初始化Airflow，可以通过运行 `airflow db init` 命令生成默认的 `airflow.cfg` 文件。
:::

## 2. 配置文件结构

`airflow.cfg` 文件采用INI格式，由多个部分组成，每个部分包含一组相关的配置项。以下是一个简化的配置文件结构示例：

```ini
[core]
# Airflow 的核心配置
dags_folder = ~/airflow/dags
load_examples = True

[scheduler]
# 调度器相关配置
scheduler_heartbeat_sec = 60

[webserver]
# Web服务器相关配置
web_server_port = 8080

[database]
# 数据库连接配置
sql_alchemy_conn = sqlite:////home/airflow/airflow.db
```

每个部分以 `[section_name]` 开头，后面跟着该部分的配置项。配置项的格式为 `key = value`。

## 3. 关键配置项说明

### 3.1 [core] 部分

`[core]` 部分包含了Airflow的核心配置，以下是一些重要的配置项：

- **dags_folder**: 指定DAG文件的存储路径。默认值为 `~/airflow/dags`。
- **load_examples**: 是否加载示例DAG。默认值为 `True`，建议在开发环境中设置为 `False` 以避免干扰。
- **executor**: 指定执行器类型，如 `LocalExecutor`、`CeleryExecutor` 或 `KubernetesExecutor`。

### 3.2 [scheduler] 部分

`[scheduler]` 部分用于配置调度器的行为：

- **scheduler_heartbeat_sec**: 调度器的心跳间隔时间（秒）。默认值为 `60`。
- **max_threads**: 调度器使用的最大线程数。默认值为 `2`。

### 3.3 [webserver] 部分

`[webserver]` 部分用于配置Airflow的Web服务器：

- **web_server_port**: Web服务器的监听端口。默认值为 `8080`。
- **base_url**: Web服务器的基本URL。默认值为 `http://localhost:8080`。

### 3.4 [database] 部分

`[database]` 部分用于配置Airflow的数据库连接：

- **sql_alchemy_conn**: 数据库连接字符串。默认使用SQLite数据库，路径为 `~/airflow/airflow.db`。

:::tip
在生产环境中，建议使用更强大的数据库（如PostgreSQL或MySQL）来替代SQLite。
:::

## 4. 实际案例

假设你正在开发一个Airflow项目，并希望将DAG文件存储在一个自定义目录中，同时使用PostgreSQL作为数据库。你可以按以下方式修改 `airflow.cfg`：

```ini
[core]
dags_folder = /path/to/your/dags
load_examples = False

[database]
sql_alchemy_conn = postgresql+psycopg2://user:password@localhost/airflow
```

修改后，Airflow将从 `/path/to/your/dags` 加载DAG文件，并使用PostgreSQL作为数据库。

## 5. 总结

`airflow.cfg` 是Airflow的核心配置文件，通过调整其中的配置项，你可以定制Airflow的行为以满足不同的需求。本文介绍了配置文件的结构、关键配置项及其作用，并通过实际案例展示了如何根据需求调整配置。

## 6. 附加资源与练习

- **练习**: 尝试修改 `airflow.cfg` 中的 `executor` 配置项，将执行器从 `LocalExecutor` 改为 `CeleryExecutor`，并观察Airflow的行为变化。
- **资源**: 阅读 [Airflow官方文档](https://airflow.apache.org/docs/) 以了解更多高级配置选项。

通过掌握 `airflow.cfg` 的配置，你将能够更好地管理和优化Airflow的运行环境。