---
title: YARN调度器类型
description: 了解YARN中的调度器类型，包括FIFO调度器、容量调度器和公平调度器，以及它们的工作原理和应用场景。
---

# YARN调度器类型

YARN（Yet Another Resource Negotiator）是Hadoop生态系统中的资源管理框架，负责集群资源的分配和任务调度。在YARN中，调度器（Scheduler）是一个核心组件，它决定了如何将集群资源分配给不同的应用程序。本文将介绍YARN中的三种主要调度器类型：FIFO调度器、容量调度器和公平调度器。

## 1. FIFO调度器

FIFO（First In First Out）调度器是最简单的调度器类型。它按照应用程序提交的顺序依次分配资源，先提交的应用程序优先获得资源，直到其任务完成或资源不足时，才会为下一个应用程序分配资源。

### 工作原理
- **先进先出**：应用程序按照提交顺序排队，先提交的应用程序优先获得资源。
- **资源独占**：一旦一个应用程序获得资源，它将独占这些资源，直到任务完成或资源释放。

### 适用场景
FIFO调度器适用于资源需求相对稳定且任务执行时间较短的场景。由于它不区分应用程序的优先级，因此在多用户或多任务环境中可能会导致资源分配不公平。

:::caution
FIFO调度器不适合多用户或多任务环境，因为它可能导致资源分配不均衡。
:::

## 2. 容量调度器

容量调度器（Capacity Scheduler）是一种基于队列的调度器，它将集群资源划分为多个队列，每个队列可以配置一定的资源容量。容量调度器允许多个应用程序共享集群资源，同时确保每个队列都能获得其配置的资源容量。

### 工作原理
- **队列划分**：集群资源被划分为多个队列，每个队列可以配置不同的资源容量。
- **资源共享**：多个应用程序可以在同一队列中共享资源，但每个队列的资源使用量不会超过其配置的容量。
- **优先级控制**：可以为队列设置优先级，高优先级队列在资源紧张时优先获得资源。

### 配置示例
以下是一个简单的容量调度器配置示例：

```xml
<configuration>
  <property>
    <name>yarn.scheduler.capacity.root.queues</name>
    <value>queueA,queueB</value>
  </property>
  <property>
    <name>yarn.scheduler.capacity.root.queueA.capacity</name>
    <value>40</value>
  </property>
  <property>
    <name>yarn.scheduler.capacity.root.queueB.capacity</name>
    <value>60</value>
  </property>
</configuration>
```

### 适用场景
容量调度器适用于多用户或多任务环境，特别是当需要为不同用户或部门分配固定资源配额时。

:::tip
容量调度器非常适合需要资源隔离和配额管理的场景，例如企业内部的多部门共享集群。
:::

## 3. 公平调度器

公平调度器（Fair Scheduler）是一种动态资源分配调度器，它旨在确保所有应用程序都能公平地共享集群资源。公平调度器会根据应用程序的资源需求和当前资源使用情况动态调整资源分配。

### 工作原理
- **动态分配**：公平调度器会根据应用程序的资源需求和当前资源使用情况动态调整资源分配。
- **公平共享**：所有应用程序都能公平地共享集群资源，避免某些应用程序长时间占用资源。
- **权重控制**：可以为应用程序设置权重，权重高的应用程序可以获得更多的资源。

### 配置示例
以下是一个简单的公平调度器配置示例：

```xml
<configuration>
  <property>
    <name>yarn.scheduler.fair.allocation.file</name>
    <value>/path/to/fair-scheduler.xml</value>
  </property>
</configuration>
```

### 适用场景
公平调度器适用于多用户或多任务环境，特别是当需要确保所有应用程序都能公平地共享资源时。

:::note
公平调度器非常适合需要动态资源分配和公平共享的场景，例如多用户共享的公共集群。
:::

## 实际案例

假设我们有一个由多个用户共享的Hadoop集群，每个用户提交的任务类型和资源需求不同。我们可以使用容量调度器为每个用户分配固定的资源配额，或者使用公平调度器确保所有用户都能公平地共享资源。

### 场景1：容量调度器
- **用户A**：提交了多个长时间运行的任务，需要固定的资源配额。
- **用户B**：提交了多个短时间运行的任务，需要较少的资源配额。

通过容量调度器，我们可以为每个用户分配固定的资源配额，确保用户A的任务不会占用过多的资源，同时用户B的任务也能及时获得资源。

### 场景2：公平调度器
- **用户A**：提交了多个资源需求较大的任务。
- **用户B**：提交了多个资源需求较小的任务。

通过公平调度器，我们可以确保用户A和用户B的任务都能公平地共享资源，避免用户A的任务长时间占用资源。

## 总结

YARN提供了多种调度器类型，每种调度器都有其特定的应用场景。FIFO调度器适用于简单的任务调度场景，容量调度器适用于需要资源隔离和配额管理的场景，而公平调度器则适用于需要动态资源分配和公平共享的场景。选择合适的调度器类型可以显著提高集群资源的利用率和任务的执行效率。

## 附加资源

- [YARN官方文档](https://hadoop.apache.org/docs/current/hadoop-yarn/hadoop-yarn-site/YARN.html)
- [容量调度器配置指南](https://hadoop.apache.org/docs/current/hadoop-yarn/hadoop-yarn-site/CapacityScheduler.html)
- [公平调度器配置指南](https://hadoop.apache.org/docs/current/hadoop-yarn/hadoop-yarn-site/FairScheduler.html)

## 练习

1. 在一个多用户共享的Hadoop集群中，如何配置容量调度器以确保每个用户都能获得固定的资源配额？
2. 在公平调度器中，如何为不同的应用程序设置权重以控制资源分配？
3. 比较FIFO调度器、容量调度器和公平调度器的优缺点，并说明它们各自适用的场景。