---
title: Pandas 分组计算
description: 学习如何使用Pandas进行分组计算，掌握数据分组、聚合和转换的基本操作。
---

# Pandas 分组计算

在数据分析中，分组计算是一个非常重要的操作。它允许我们根据某些条件将数据分组，然后对每个组进行聚合、转换或其他操作。Pandas库提供了强大的分组功能，使得这些操作变得非常简单和高效。

## 什么是分组计算？

分组计算是指将数据集按照某些条件（通常是某一列或多列的值）进行分组，然后对每个组进行某种计算或操作。常见的分组计算包括求和、平均值、计数、最大值、最小值等。

## 基本分组操作

在Pandas中，我们使用 `groupby()` 方法来进行分组操作。以下是一个简单的例子：

```python
import pandas as pd

# 创建一个简单的DataFrame
data = {
    'Category': ['A', 'B', 'A', 'B', 'A', 'B'],
    'Values': [10, 20, 10, 20, 10, 20]
}
df = pd.DataFrame(data)

# 按照 'Category' 列进行分组，并计算每组的平均值
grouped = df.groupby('Category').mean()
print(grouped)
```

**输出：**

```
          Values
Category       
A            10.0
B            20.0
```

在这个例子中，我们按照 `Category` 列对数据进行分组，然后计算每个组的 `Values` 列的平均值。

## 多列分组

我们也可以按照多列进行分组。例如：

```python
# 创建一个包含多列的DataFrame
data = {
    'Category': ['A', 'B', 'A', 'B', 'A', 'B'],
    'Subcategory': ['X', 'X', 'Y', 'Y', 'X', 'Y'],
    'Values': [10, 20, 10, 20, 10, 20]
}
df = pd.DataFrame(data)

# 按照 'Category' 和 'Subcategory' 列进行分组，并计算每组的平均值
grouped = df.groupby(['Category', 'Subcategory']).mean()
print(grouped)
```

**输出：**

```
                     Values
Category Subcategory       
A        X            10.0
         Y            10.0
B        X            20.0
         Y            20.0
```

在这个例子中，我们按照 `Category` 和 `Subcategory` 两列对数据进行分组，然后计算每个组的 `Values` 列的平均值。

## 聚合操作

除了计算平均值，我们还可以进行其他聚合操作，如求和、计数、最大值、最小值等。以下是一些常见的聚合操作：

```python
# 按照 'Category' 列进行分组，并计算每组的求和、计数、最大值和最小值
grouped = df.groupby('Category').agg({
    'Values': ['sum', 'count', 'max', 'min']
})
print(grouped)
```

**输出：**

```
          Values            
             sum count max min
Category                      
A            30     3  10  10
B            60     3  20  20
```

在这个例子中，我们使用了 `agg()` 方法来进行多种聚合操作。

## 实际应用场景

假设我们有一个销售数据集，包含产品类别、销售日期和销售额。我们想要计算每个产品类别的总销售额和平均销售额。以下是如何使用Pandas进行分组计算的示例：

```python
# 创建一个销售数据集
data = {
    'Product': ['A', 'B', 'A', 'B', 'A', 'B'],
    'Date': ['2023-01-01', '2023-01-01', '2023-01-02', '2023-01-02', '2023-01-03', '2023-01-03'],
    'Sales': [100, 200, 150, 250, 200, 300]
}
df = pd.DataFrame(data)

# 按照 'Product' 列进行分组，并计算每组的销售额总和和平均值
grouped = df.groupby('Product').agg({
    'Sales': ['sum', 'mean']
})
print(grouped)
```

**输出：**

```
         Sales      
           sum  mean
Product              
A          450  150.0
B          750  250.0
```

在这个例子中，我们计算了每个产品类别的总销售额和平均销售额。

## 总结

Pandas的分组计算功能非常强大，能够帮助我们轻松地对数据进行分组和聚合操作。通过 `groupby()` 方法，我们可以按照单列或多列进行分组，并使用 `agg()` 方法进行多种聚合操作。这些操作在数据分析中非常常见，掌握它们将大大提高我们的数据处理能力。

## 附加资源

- [Pandas官方文档 - GroupBy](https://pandas.pydata.org/pandas-docs/stable/reference/groupby.html)
- [Pandas Cookbook - GroupBy](https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#grouping)

## 练习

1. 创建一个包含学生姓名、科目和成绩的DataFrame，按照科目进行分组，并计算每个科目的平均成绩。
2. 在销售数据集中，按照日期进行分组，并计算每天的销售总额。
3. 尝试使用 `groupby()` 和 `agg()` 方法进行多列分组和多种聚合操作。

通过完成这些练习，你将更好地掌握Pandas的分组计算功能。