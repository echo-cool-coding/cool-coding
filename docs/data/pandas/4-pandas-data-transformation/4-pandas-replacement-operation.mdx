---
title: Pandas 替换操作
description: 学习如何使用Pandas进行数据替换操作，包括简单的值替换、条件替换以及正则表达式替换。
---

# Pandas 替换操作

在数据处理过程中，替换操作是一个非常常见的需求。无论是替换缺失值、修正错误数据，还是将某些特定值替换为其他值，Pandas都提供了强大的工具来帮助我们完成这些任务。本文将详细介绍Pandas中的替换操作，并通过实际案例展示其应用场景。

## 1. 简单值替换

最简单的替换操作是将数据框中的某个值替换为另一个值。Pandas提供了`replace()`方法来实现这一功能。

### 示例：替换特定值

假设我们有一个包含学生成绩的数据框，其中有一些成绩为`-1`，表示缺考。我们希望将这些`-1`替换为`NaN`（表示缺失值）。

```python
import pandas as pd
import numpy as np

# 创建示例数据框
data = {'Name': ['Alice', 'Bob', 'Charlie', 'David'],
        'Score': [90, -1, 85, -1]}
df = pd.DataFrame(data)

# 替换-1为NaN
df['Score'] = df['Score'].replace(-1, np.nan)

print(df)
```

**输出：**

```
      Name  Score
0    Alice   90.0
1      Bob    NaN
2  Charlie   85.0
3    David    NaN
```

在这个例子中，我们使用`replace()`方法将`-1`替换为`NaN`。`NaN`是Pandas中表示缺失值的标准方式。

## 2. 条件替换

有时候，我们需要根据某些条件来替换数据。Pandas提供了`where()`和`mask()`方法来实现条件替换。

### 示例：根据条件替换值

假设我们有一个包含学生成绩的数据框，我们希望将低于60分的成绩替换为“不及格”。

```python
# 创建示例数据框
data = {'Name': ['Alice', 'Bob', 'Charlie', 'David'],
        'Score': [90, 45, 85, 55]}
df = pd.DataFrame(data)

# 将低于60分的成绩替换为“不及格”
df['Score'] = df['Score'].where(df['Score'] >= 60, '不及格')

print(df)
```

**输出：**

```
      Name  Score
0    Alice     90
1      Bob  不及格
2  Charlie     85
3    David  不及格
```

在这个例子中，我们使用`where()`方法将低于60分的成绩替换为“不及格”。`where()`方法的第一个参数是条件，第二个参数是替换值。

## 3. 正则表达式替换

Pandas还支持使用正则表达式进行替换操作。这在处理文本数据时非常有用。

### 示例：使用正则表达式替换文本

假设我们有一个包含电子邮件地址的数据框，我们希望将所有以`@example.com`结尾的电子邮件地址替换为`@newexample.com`。

```python
# 创建示例数据框
data = {'Name': ['Alice', 'Bob', 'Charlie', 'David'],
        'Email': ['alice@example.com', 'bob@example.com', 'charlie@example.com', 'david@example.com']}
df = pd.DataFrame(data)

# 使用正则表达式替换电子邮件地址
df['Email'] = df['Email'].replace(r'@example\.com$', '@newexample.com', regex=True)

print(df)
```

**输出：**

```
      Name               Email
0    Alice  alice@newexample.com
1      Bob    bob@newexample.com
2  Charlie  charlie@newexample.com
3    David    david@newexample.com
```

在这个例子中，我们使用`replace()`方法结合正则表达式将所有以`@example.com`结尾的电子邮件地址替换为`@newexample.com`。

## 4. 实际应用场景

### 场景：处理调查问卷数据

假设我们有一份调查问卷数据，其中包含一些多选题的答案。多选题的答案通常以逗号分隔的字符串形式存储。我们希望将这些字符串转换为列表，并将某些特定的选项替换为更易读的文本。

```python
# 创建示例数据框
data = {'Name': ['Alice', 'Bob', 'Charlie', 'David'],
        'Hobbies': ['reading,swimming', 'swimming,traveling', 'reading,traveling', 'swimming']}
df = pd.DataFrame(data)

# 将字符串转换为列表
df['Hobbies'] = df['Hobbies'].str.split(',')

# 替换特定选项
df['Hobbies'] = df['Hobbies'].apply(lambda x: ['Reading' if hobby == 'reading' else hobby for hobby in x])

print(df)
```

**输出：**

```
      Name               Hobbies
0    Alice  [Reading, swimming]
1      Bob  [swimming, traveling]
2  Charlie  [Reading, traveling]
3    David            [swimming]
```

在这个例子中，我们首先将字符串转换为列表，然后使用`apply()`方法将`reading`替换为`Reading`。

## 5. 总结

Pandas提供了多种替换操作的方法，包括简单值替换、条件替换和正则表达式替换。这些方法可以帮助我们轻松地处理数据中的各种替换需求。通过实际案例，我们可以看到这些方法在数据处理中的强大功能。

## 6. 附加资源与练习

- **练习1**：创建一个包含学生成绩的数据框，将成绩分为“优秀”（`>=90`）、“良好”（`>=80`）、“及格”（`>=60`）和“不及格”（`<60`）四个等级，并将成绩替换为相应的等级。
- **练习2**：创建一个包含电话号码的数据框，将所有以`+86`开头的电话号码替换为`+1`开头。

通过练习，你可以更好地掌握Pandas中的替换操作。继续探索Pandas的其他功能，你会发现它在数据处理中的无限潜力。