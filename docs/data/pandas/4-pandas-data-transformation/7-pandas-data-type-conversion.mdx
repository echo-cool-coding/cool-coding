---
title: Pandas 数据类型转换
description: 学习如何在 Pandas 中进行数据类型转换，包括常见的数据类型及其转换方法，以及实际应用场景。
---

## 介绍

在数据分析和处理过程中，数据类型转换是一个常见的任务。Pandas 提供了多种方法来转换数据类型，以便更好地处理和分析数据。本文将详细介绍如何在 Pandas 中进行数据类型转换，并通过实际案例展示其应用。

## 常见的数据类型

在 Pandas 中，常见的数据类型包括：

- `int64`: 64 位整数
- `float64`: 64 位浮点数
- `object`: 字符串或混合类型
- `bool`: 布尔值
- `datetime64`: 日期时间
- `category`: 分类类型

## 数据类型转换方法

### 1. 使用 `astype()` 方法

`astype()` 是 Pandas 中最常用的数据类型转换方法。它可以将 DataFrame 或 Series 中的数据类型转换为指定的类型。

```python
import pandas as pd

# 创建一个 DataFrame
df = pd.DataFrame({
    'A': [1, 2, 3],
    'B': [4.0, 5.0, 6.0],
    'C': ['7', '8', '9']
})

# 将列 'A' 转换为 float 类型
df['A'] = df['A'].astype('float64')

# 将列 'C' 转换为 int 类型
df['C'] = df['C'].astype('int64')

print(df.dtypes)
```

**输出：**
```
A    float64
B    float64
C      int64
dtype: object
```

### 2. 使用 `pd.to_numeric()` 方法

`pd.to_numeric()` 方法可以将数据转换为数值类型。它特别适用于处理包含非数值字符的字符串数据。

```python
# 创建一个包含非数值字符的 Series
s = pd.Series(['1', '2', '3', 'a', '4'])

# 尝试转换为数值类型，错误值转换为 NaN
s = pd.to_numeric(s, errors='coerce')

print(s)
```

**输出：**
```
0    1.0
1    2.0
2    3.0
3    NaN
4    4.0
dtype: float64
```

### 3. 使用 `pd.to_datetime()` 方法

`pd.to_datetime()` 方法可以将数据转换为日期时间类型。

```python
# 创建一个包含日期的 Series
s = pd.Series(['2023-01-01', '2023-02-01', '2023-03-01'])

# 转换为日期时间类型
s = pd.to_datetime(s)

print(s)
```

**输出：**
```
0   2023-01-01
1   2023-02-01
2   2023-03-01
dtype: datetime64[ns]
```

### 4. 使用 `pd.Categorical()` 方法

`pd.Categorical()` 方法可以将数据转换为分类类型，适用于有限数量的离散值。

```python
# 创建一个包含类别的 Series
s = pd.Series(['apple', 'banana', 'apple', 'orange'])

# 转换为分类类型
s = pd.Categorical(s)

print(s)
```

**输出：**
```
['apple', 'banana', 'apple', 'orange']
Categories (3, object): ['apple', 'banana', 'orange']
```

## 实际案例

### 案例 1：处理混合类型数据

假设你有一个包含混合类型数据的 CSV 文件，其中某些列包含数字和字符串。你需要将这些列转换为统一的数值类型以便进行分析。

```python
# 读取 CSV 文件
df = pd.read_csv('mixed_data.csv')

# 将列 'A' 转换为数值类型，错误值转换为 NaN
df['A'] = pd.to_numeric(df['A'], errors='coerce')

print(df.dtypes)
```

### 案例 2：处理日期数据

假设你有一个包含日期的数据集，但这些日期以字符串形式存储。你需要将这些字符串转换为日期时间类型以便进行时间序列分析。

```python
# 读取 CSV 文件
df = pd.read_csv('date_data.csv')

# 将列 'Date' 转换为日期时间类型
df['Date'] = pd.to_datetime(df['Date'])

print(df.dtypes)
```

## 总结

数据类型转换是数据处理中的一个重要步骤。通过使用 Pandas 提供的 `astype()`、`pd.to_numeric()`、`pd.to_datetime()` 和 `pd.Categorical()` 等方法，你可以轻松地将数据转换为所需的类型。掌握这些方法将帮助你更有效地处理和分析数据。

## 附加资源

- [Pandas 官方文档](https://pandas.pydata.org/pandas-docs/stable/)
- [Pandas 数据类型转换教程](https://pandas.pydata.org/pandas-docs/stable/user_guide/basics.html#dtypes)

## 练习

1. 创建一个包含混合类型数据的 DataFrame，并尝试将每一列转换为适当的类型。
2. 读取一个包含日期的 CSV 文件，并将日期列转换为日期时间类型。
3. 使用 `pd.Categorical()` 方法将一个包含类别的列转换为分类类型，并观察其效果。
