---
title: Pandas 文本提取
description: 学习如何使用Pandas进行文本提取，掌握从字符串中提取特定信息的技巧。
---

# Pandas 文本提取

在数据分析和处理中，文本数据是非常常见的。Pandas库提供了强大的工具来处理和提取文本数据。本文将介绍如何使用Pandas进行文本提取，帮助您从字符串中提取出有用的信息。

## 什么是文本提取？

文本提取是指从字符串中提取出特定的部分或模式。例如，从电子邮件地址中提取域名，或从日期字符串中提取年份。Pandas提供了多种方法来实现这些操作，使得文本处理变得简单而高效。

## 基本文本提取方法

Pandas中的`str`访问器提供了许多用于处理字符串的方法。以下是一些常用的文本提取方法：

### 1. 提取子字符串

使用`str.slice()`方法可以从字符串中提取子字符串。例如：

```python
import pandas as pd

data = {'text': ['hello world', 'pandas is great', 'data science']}
df = pd.DataFrame(data)

# 提取前5个字符
df['substring'] = df['text'].str.slice(0, 5)
print(df)
```

**输出：**

```
             text substring
0     hello world     hello
1  pandas is great     panda
2     data science     data
```

### 2. 使用正则表达式提取

正则表达式（Regex）是一种强大的工具，用于匹配和提取字符串中的模式。Pandas的`str.extract()`方法可以使用正则表达式来提取文本。

```python
# 提取第一个单词
df['first_word'] = df['text'].str.extract(r'(\w+)')
print(df)
```

**输出：**

```
             text substring first_word
0     hello world     hello      hello
1  pandas is great     panda     pandas
2     data science     data       data
```

### 3. 提取特定模式

假设我们有一列包含电子邮件地址的数据，我们想从中提取域名部分：

```python
data = {'email': ['user1@example.com', 'user2@domain.com', 'user3@test.com']}
df = pd.DataFrame(data)

# 提取域名
df['domain'] = df['email'].str.extract(r'@(\w+\.\w+)')
print(df)
```

**输出：**

```
               email      domain
0  user1@example.com  example.com
1   user2@domain.com   domain.com
2    user3@test.com    test.com
```

## 实际应用案例

### 案例1：从日志文件中提取时间戳

假设我们有一个日志文件，其中每一行都包含一个时间戳和一条消息。我们可以使用Pandas来提取时间戳：

```python
data = {'log': ['2023-10-01 12:00:00 INFO: System started', '2023-10-01 12:05:00 ERROR: Failed to connect']}
df = pd.DataFrame(data)

# 提取时间戳
df['timestamp'] = df['log'].str.extract(r'(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2})')
print(df)
```

**输出：**

```
                                    log           timestamp
0  2023-10-01 12:00:00 INFO: System started  2023-10-01 12:00:00
1  2023-10-01 12:05:00 ERROR: Failed to connect  2023-10-01 12:05:00
```

### 案例2：从URL中提取协议和域名

假设我们有一列URL，我们想从中提取协议和域名：

```python
data = {'url': ['https://www.example.com', 'http://www.domain.com', 'ftp://files.test.com']}
df = pd.DataFrame(data)

# 提取协议和域名
df['protocol'] = df['url'].str.extract(r'(https?|ftp)://')
df['domain'] = df['url'].str.extract(r'://([\w\.]+)')
print(df)
```

**输出：**

```
                     url protocol          domain
0  https://www.example.com    https  www.example.com
1   http://www.domain.com     http   www.domain.com
2    ftp://files.test.com      ftp   files.test.com
```

## 总结

Pandas提供了强大的文本处理功能，使得从字符串中提取特定信息变得非常简单。通过使用`str`访问器和正则表达式，您可以轻松地处理各种文本数据。本文介绍了一些基本的文本提取方法，并通过实际案例展示了这些方法的应用。

## 附加资源与练习

- **练习1**：尝试从一个包含电话号码的列中提取区号。
- **练习2**：从一个包含日期的列中提取月份和年份。
- **资源**：[Pandas官方文档](https://pandas.pydata.org/pandas-docs/stable/user_guide/text.html) 提供了更多关于文本处理的详细信息。

通过不断练习和探索，您将能够熟练掌握Pandas中的文本提取技巧，并在实际项目中灵活应用。