---
title: Pandas 文本分割
description: 学习如何使用Pandas对文本数据进行分割，掌握split()、extract()等方法的实际应用。
---

# Pandas 文本分割

在数据处理中，文本数据是非常常见的类型之一。Pandas提供了强大的工具来处理和分析文本数据，其中**文本分割**是一个非常重要的操作。通过文本分割，我们可以将字符串拆分为多个部分，或者提取其中的特定内容。本文将详细介绍如何使用Pandas进行文本分割，并通过实际案例帮助你掌握这一技能。

## 什么是文本分割？

文本分割是指将一个字符串按照特定的分隔符或规则拆分成多个部分。例如，将句子拆分为单词，或者将包含多个字段的字符串拆分为单独的列。Pandas提供了多种方法来实现文本分割，其中最常用的是 `str.split()` 和 `str.extract()`。

## 使用 `str.split()` 进行文本分割

`str.split()` 是Pandas中最常用的文本分割方法。它可以根据指定的分隔符将字符串拆分为多个部分，并返回一个包含分割结果的列表。

### 基本用法

假设我们有一个包含姓名和年龄的字符串列，格式为 `姓名-年龄`，我们希望将其拆分为两列：`姓名` 和 `年龄`。

```python
import pandas as pd

# 创建示例数据
data = {'info': ['Alice-25', 'Bob-30', 'Charlie-35']}
df = pd.DataFrame(data)

# 使用 str.split() 进行分割
df[['姓名', '年龄']] = df['info'].str.split('-', expand=True)

print(df)
```

**输出：**

```
       info     姓名 年龄
0  Alice-25   Alice  25
1    Bob-30     Bob  30
2  Charlie-35 Charlie  35
```

在这个例子中，我们使用 `str.split('-', expand=True)` 将 `info` 列按照 `-` 分割，并将结果扩展为两列。

### 限制分割次数

`str.split()` 还允许我们通过 `n` 参数限制分割的次数。例如，如果我们只想分割一次，可以这样做：

```python
df[['姓名', '年龄']] = df['info'].str.split('-', n=1, expand=True)
```

**输出：**

```
       info     姓名 年龄
0  Alice-25   Alice  25
1    Bob-30     Bob  30
2  Charlie-35 Charlie  35
```

在这个例子中，`n=1` 表示只分割一次，即使字符串中有多个 `-`，也只会分割成两部分。

## 使用 `str.extract()` 提取特定内容

`str.extract()` 是另一个强大的文本处理工具，它允许我们使用正则表达式从字符串中提取特定的内容。

### 基本用法

假设我们有一个包含电子邮件地址的列，我们希望从中提取用户名和域名。

```python
# 创建示例数据
data = {'email': ['alice@example.com', 'bob@example.com', 'charlie@example.com']}
df = pd.DataFrame(data)

# 使用 str.extract() 提取用户名和域名
df[['用户名', '域名']] = df['email'].str.extract(r'([^@]+)@(.+)')

print(df)
```

**输出：**

```
                 email   用户名        域名
0    alice@example.com   alice  example.com
1      bob@example.com     bob  example.com
2  charlie@example.com charlie  example.com
```

在这个例子中，我们使用正则表达式 `r'([^@]+)@(.+)'` 来匹配电子邮件地址中的用户名和域名。`[^@]+` 表示匹配 `@` 之前的所有字符，`(.+)` 表示匹配 `@` 之后的所有字符。

## 实际应用案例

### 案例1：处理日志数据

假设我们有一组日志数据，格式为 `[时间] [级别] 消息`，我们希望将其拆分为 `时间`、`级别` 和 `消息` 三列。

```python
# 创建示例数据
data = {'log': ['[2023-10-01 12:00:00] [INFO] 系统启动', '[2023-10-01 12:05:00] [ERROR] 文件未找到']}
df = pd.DataFrame(data)

# 使用 str.extract() 提取时间、级别和消息
df[['时间', '级别', '消息']] = df['log'].str.extract(r'$$(.*?)$$ $$(.*?)$$ (.*)')

print(df)
```

**输出：**

```
                                log                 时间   级别        消息
0       [2023-10-01 12:00:00] [INFO] 系统启动  2023-10-01 12:00:00  INFO  系统启动
1  [2023-10-01 12:05:00] [ERROR] 文件未找到  2023-10-01 12:05:00  ERROR  文件未找到
```

### 案例2：处理CSV格式的字符串

假设我们有一个包含CSV格式的字符串列，我们希望将其拆分为多个列。

```python
# 创建示例数据
data = {'csv': ['Alice,25,Female', 'Bob,30,Male', 'Charlie,35,Male']}
df = pd.DataFrame(data)

# 使用 str.split() 进行分割
df[['姓名', '年龄', '性别']] = df['csv'].str.split(',', expand=True)

print(df)
```

**输出：**

```
              csv     姓名 年龄     性别
0  Alice,25,Female   Alice  25  Female
1      Bob,30,Male     Bob  30    Male
2  Charlie,35,Male Charlie  35    Male
```

## 总结

在本文中，我们学习了如何使用Pandas进行文本分割。我们介绍了 `str.split()` 和 `str.extract()` 的基本用法，并通过实际案例展示了它们的应用场景。文本分割是数据处理中的一个重要操作，掌握这些技巧将帮助你更高效地处理和分析文本数据。

## 附加资源与练习

- **练习1**：尝试使用 `str.split()` 将一个包含多个分隔符的字符串拆分为多个列。
- **练习2**：使用 `str.extract()` 从一个包含电话号码的字符串中提取区号和号码。

通过不断练习，你将更加熟练地掌握Pandas中的文本处理技巧。继续探索Pandas的其他功能，你会发现它在数据处理中的强大之处。