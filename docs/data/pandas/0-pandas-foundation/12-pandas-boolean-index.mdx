---
title: Pandas 布尔索引
description: 学习如何使用Pandas的布尔索引功能来筛选和操作数据框中的数据。
---

# Pandas 布尔索引

在Pandas中，布尔索引是一种强大的工具，允许我们根据条件筛选数据框（DataFrame）中的行或列。通过布尔索引，我们可以轻松地选择满足特定条件的数据，从而进行进一步的分析或操作。

## 什么是布尔索引？

布尔索引是一种通过布尔值（`True`或`False`）来选择数据的方法。具体来说，我们可以创建一个布尔条件，该条件会对数据框中的每一行或每一列进行评估，并返回一个布尔值数组。然后，我们可以使用这个布尔数组来选择满足条件的行或列。

### 基本语法

布尔索引的基本语法如下：

```python
df[condition]
```

其中，`df`是数据框，`condition`是一个布尔条件，返回一个布尔数组。

## 示例：筛选数据

让我们通过一个简单的示例来理解布尔索引的工作原理。

```python
import pandas as pd

# 创建一个示例数据框
data = {
    'Name': ['Alice', 'Bob', 'Charlie', 'David'],
    'Age': [25, 30, 35, 40],
    'City': ['New York', 'Los Angeles', 'Chicago', 'Houston']
}

df = pd.DataFrame(data)

# 使用布尔索引筛选年龄大于30的行
filtered_df = df[df['Age'] > 30]

print(filtered_df)
```

**输出：**

```
      Name  Age      City
2  Charlie   35   Chicago
3    David   40   Houston
```

在这个示例中，`df['Age'] > 30`返回一个布尔数组`[False, False, True, True]`，然后我们使用这个数组来选择数据框中年龄大于30的行。

## 多条件筛选

我们还可以使用多个条件进行筛选。在Pandas中，可以使用`&`（与）、`|`（或）和`~`（非）来组合多个条件。

### 示例：多条件筛选

```python
# 筛选年龄大于30且城市为Chicago的行
filtered_df = df[(df['Age'] > 30) & (df['City'] == 'Chicago')]

print(filtered_df)
```

**输出：**

```
      Name  Age     City
2  Charlie   35  Chicago
```

在这个示例中，我们使用了两个条件：`df['Age'] > 30`和`df['City'] == 'Chicago'`，并通过`&`运算符将它们组合在一起。

:::tip
在使用多条件筛选时，务必用括号将每个条件括起来，以避免运算符优先级问题。
:::

## 实际应用场景

布尔索引在实际数据分析中非常有用。以下是一些常见的应用场景：

1. **数据清洗**：筛选出缺失值或异常值。
2. **数据分组**：根据某些条件将数据分组。
3. **特征工程**：根据条件创建新的特征。

### 示例：数据清洗

假设我们有一个包含缺失值的数据框：

```python
import numpy as np

# 创建一个包含缺失值的数据框
data = {
    'Name': ['Alice', 'Bob', 'Charlie', 'David'],
    'Age': [25, np.nan, 35, 40],
    'City': ['New York', 'Los Angeles', np.nan, 'Houston']
}

df = pd.DataFrame(data)

# 筛选出年龄不为空的行
filtered_df = df[df['Age'].notna()]

print(filtered_df)
```

**输出：**

```
      Name   Age      City
0    Alice  25.0  New York
2  Charlie  35.0       NaN
3    David  40.0   Houston
```

在这个示例中，我们使用`df['Age'].notna()`来筛选出年龄不为空的行。

## 总结

布尔索引是Pandas中一个非常强大的功能，允许我们根据条件筛选数据框中的行或列。通过布尔索引，我们可以轻松地进行数据清洗、数据分组和特征工程等操作。

:::note
**附加资源：**
- [Pandas官方文档](https://pandas.pydata.org/pandas-docs/stable/index.html)
- [Pandas布尔索引教程](https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#boolean-indexing)
:::

:::tip
**练习：**
1. 创建一个包含多个条件的数据框，并使用布尔索引筛选出满足条件的行。
2. 尝试使用布尔索引筛选出包含特定字符串的行。
:::

通过本文的学习，你应该已经掌握了Pandas布尔索引的基本用法。继续练习和探索，你将能够更熟练地使用这一功能来处理和分析数据。