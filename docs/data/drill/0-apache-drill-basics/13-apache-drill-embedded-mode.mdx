---
title: Apache Drill 嵌入式模式
description: 了解如何在本地环境中使用Apache Drill的嵌入式模式，无需分布式集群即可进行数据查询。
---

## 介绍

Apache Drill 是一个开源的分布式 SQL 查询引擎，专为大规模数据分析而设计。它支持多种数据源，包括文件系统（如 HDFS、S3）、NoSQL 数据库（如 MongoDB）以及关系型数据库。Drill 的一个强大特性是它的**嵌入式模式**，允许你在本地环境中运行 Drill，而无需配置分布式集群。这对于开发、测试和学习来说非常方便。

在嵌入式模式下，Drill 作为一个独立的 Java 应用程序运行，所有组件（如 Zookeeper 和 Drillbit）都在同一个 JVM 进程中运行。这使得你可以快速启动并开始查询数据，而无需复杂的配置。

## 嵌入式模式的优点

- **快速启动**：无需配置分布式集群，只需启动一个 JVM 进程即可。
- **轻量级**：适合在本地开发环境中使用，资源占用较少。
- **易于调试**：所有组件都在同一个进程中运行，便于调试和排查问题。
- **学习友好**：初学者可以快速上手，专注于学习 SQL 查询和数据探索。

## 如何启动嵌入式模式

要启动 Apache Drill 的嵌入式模式，你需要下载 Drill 的发行版并解压。然后，通过命令行启动 Drill 的嵌入式模式。

### 步骤 1：下载并解压 Apache Drill

从 [Apache Drill 官方网站](https://drill.apache.org/download/) 下载最新的发行版，并解压到本地目录。

```bash
tar -xzf apache-drill-<version>.tar.gz
cd apache-drill-<version>
```

### 步骤 2：启动嵌入式模式

在解压后的目录中，运行以下命令启动嵌入式模式：

```bash
bin/drill-embedded
```

启动后，你会看到类似以下的输出：

```
Apache Drill 1.20.0
"Drill, drill, drill!"
```

### 步骤 3：访问 Drill Web 控制台

嵌入式模式启动后，Drill 会自动启动一个 Web 控制台，默认地址为 `http://localhost:8047`。你可以通过浏览器访问该地址，查看 Drill 的状态和执行查询。

## 嵌入式模式下的查询示例

在嵌入式模式下，你可以直接使用 Drill 的 SQL 查询功能。以下是一个简单的示例，查询一个 CSV 文件中的数据。

### 示例：查询 CSV 文件

假设你有一个名为 `employees.csv` 的文件，内容如下：

```csv
id,name,department,salary
1,Alice,Engineering,80000
2,Bob,Marketing,75000
3,Charlie,Sales,70000
```

你可以通过以下 SQL 查询该文件：

```sql
SELECT * FROM dfs.`/path/to/employees.csv`;
```

查询结果如下：

| id  | name    | department   | salary |
|-----|---------|--------------|--------|
| 1   | Alice   | Engineering  | 80000  |
| 2   | Bob     | Marketing    | 75000  |
| 3   | Charlie | Sales        | 70000  |

:::tip
在嵌入式模式下，Drill 默认使用 `dfs` 插件来访问本地文件系统。你可以通过 Web 控制台或 SQL 查询来配置和管理插件。
:::

## 实际应用场景

嵌入式模式非常适合以下场景：

1. **本地开发与测试**：在开发过程中，你可以使用嵌入式模式快速测试 SQL 查询，而无需依赖分布式集群。
2. **数据探索**：如果你需要快速探索本地数据文件（如 CSV、JSON、Parquet 等），嵌入式模式提供了便捷的查询方式。
3. **教育与学习**：对于初学者来说，嵌入式模式是一个理想的学习工具，因为它简化了 Drill 的配置和启动过程。

## 总结

Apache Drill 的嵌入式模式为开发者和初学者提供了一个轻量级、易于使用的查询环境。通过嵌入式模式，你可以快速启动 Drill 并开始查询数据，而无需复杂的配置。无论是本地开发、数据探索还是学习，嵌入式模式都是一个强大的工具。

## 附加资源

- [Apache Drill 官方文档](https://drill.apache.org/docs/)
- [Drill 嵌入式模式配置指南](https://drill.apache.org/docs/starting-drill-on-linux-and-mac-os-x/)
- [Drill SQL 参考手册](https://drill.apache.org/docs/sql-reference/)

## 练习

1. 下载并启动 Apache Drill 的嵌入式模式。
2. 使用嵌入式模式查询一个本地的 CSV 文件，并尝试使用不同的 SQL 语句（如 `WHERE`、`GROUP BY` 等）。
3. 探索 Drill 的 Web 控制台，了解如何配置和管理插件。

通过以上练习，你将更好地掌握 Apache Drill 嵌入式模式的使用方法。