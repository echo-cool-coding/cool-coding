---
title: Apache Drill 数据来源
description: 了解 Apache Drill 如何连接和查询多种数据来源，包括文件系统、数据库和云存储。
---

## 介绍

Apache Drill 是一个分布式 SQL 查询引擎，能够直接查询多种数据来源，而无需预先定义模式或进行数据迁移。它支持从文件系统、数据库、NoSQL 存储和云存储中查询数据。本文将详细介绍 Apache Drill 支持的数据来源类型，并通过示例展示如何配置和查询这些数据来源。

## 支持的数据来源

Apache Drill 支持多种数据来源，包括但不限于：

- **文件系统**：如 HDFS、S3、本地文件系统等。
- **数据库**：如 MySQL、PostgreSQL、MongoDB 等。
- **NoSQL 存储**：如 HBase、Cassandra 等。
- **云存储**：如 Amazon S3、Google Cloud Storage 等。

## 配置数据来源

在 Apache Drill 中，数据来源通过存储插件（Storage Plugin）进行配置。每个存储插件对应一个数据来源，并定义了如何连接和查询该数据来源。

### 示例：配置本地文件系统

以下是一个配置本地文件系统存储插件的示例：

```json
{
  "type": "file",
  "enabled": true,
  "connection": "file:///",
  "workspaces": {
    "root": {
      "location": "/path/to/your/data",
      "writable": false,
      "defaultInputFormat": null
    }
  },
  "formats": {
    "json": {
      "type": "json"
    },
    "csv": {
      "type": "text",
      "extensions": [
        "csv"
      ],
      "delimiter": ","
    }
  }
}
```

在这个配置中，我们定义了一个名为 `root` 的工作空间，指向本地文件系统中的 `/path/to/your/data` 目录。我们还定义了两种文件格式：`json` 和 `csv`。

### 示例：查询本地文件系统

假设我们在 `/path/to/your/data` 目录下有一个 `data.csv` 文件，内容如下：

```csv
id,name,age
1,Alice,30
2,Bob,25
3,Charlie,35
```

我们可以使用以下 SQL 查询来读取这个文件：

```sql
SELECT * FROM dfs.root.`data.csv`;
```

查询结果将返回：

| id | name    | age |
|----|---------|-----|
| 1  | Alice   | 30  |
| 2  | Bob     | 25  |
| 3  | Charlie | 35  |

## 实际应用场景

### 场景 1：查询分布式文件系统（HDFS）

假设你有一个存储在 HDFS 上的大型数据集，你可以通过配置 HDFS 存储插件来查询这些数据。以下是一个简单的查询示例：

```sql
SELECT * FROM hdfs.`/path/to/hdfs/data.csv`;
```

### 场景 2：查询 MongoDB

如果你有一个 MongoDB 数据库，你可以通过配置 MongoDB 存储插件来查询文档数据。以下是一个查询示例：

```sql
SELECT * FROM mongo.`database.collection` WHERE age > 30;
```

## 总结

Apache Drill 提供了强大的功能，能够直接查询多种数据来源，而无需进行复杂的数据迁移或模式定义。通过配置存储插件，你可以轻松地连接到文件系统、数据库、NoSQL 存储和云存储，并使用 SQL 进行查询。

## 附加资源

- [Apache Drill 官方文档](https://drill.apache.org/docs/)
- [Apache Drill 存储插件配置指南](https://drill.apache.org/docs/plugin-configuration/)

## 练习

1. 配置一个本地文件系统存储插件，并查询一个 CSV 文件。
2. 尝试配置一个 MongoDB 存储插件，并查询一个集合中的数据。
3. 探索如何配置和查询 Amazon S3 中的数据。

通过完成这些练习，你将更深入地理解 Apache Drill 的数据来源功能，并能够在实际项目中应用这些知识。