---
title: Apache Drill SELECT语句
description: "学习如何使用Apache Drill中的SELECT语句进行数据查询。本文将从基础语法开始，逐步深入，并通过实际案例帮助初学者掌握SELECT语句的使用。"
---

## 介绍

Apache Drill 是一个分布式SQL查询引擎，支持对多种数据源（如HDFS、JSON、Parquet、CSV等）进行查询。`SELECT`语句是SQL中最常用的语句之一，用于从数据源中检索数据。本文将详细介绍如何在Apache Drill中使用`SELECT`语句，并通过示例帮助您理解其用法。

## SELECT语句基础

`SELECT`语句的基本语法如下：

```sql
SELECT column1, column2, ...
FROM table_name;
```

- `column1, column2, ...`：要检索的列名。可以使用`*`选择所有列。
- `table_name`：要查询的表名或数据源。

### 示例1：选择所有列

假设我们有一个名为`employees`的表，包含以下数据：

| id  | name   | department | salary |
|-----|--------|------------|--------|
| 1   | Alice  | HR         | 50000  |
| 2   | Bob    | IT         | 60000  |
| 3   | Charlie| Finance    | 55000  |

要检索所有列的数据，可以使用以下查询：

```sql
SELECT * FROM employees;
```

**输出：**

| id  | name   | department | salary |
|-----|--------|------------|--------|
| 1   | Alice  | HR         | 50000  |
| 2   | Bob    | IT         | 60000  |
| 3   | Charlie| Finance    | 55000  |

### 示例2：选择特定列

如果只想检索`name`和`salary`列，可以使用以下查询：

```sql
SELECT name, salary FROM employees;
```

**输出：**

| name   | salary |
|--------|--------|
| Alice  | 50000  |
| Bob    | 60000  |
| Charlie| 55000  |

## 使用WHERE子句过滤数据

`WHERE`子句用于过滤满足特定条件的记录。语法如下：

```sql
SELECT column1, column2, ...
FROM table_name
WHERE condition;
```

### 示例3：过滤特定部门的员工

假设我们只想检索`IT`部门的员工，可以使用以下查询：

```sql
SELECT * FROM employees
WHERE department = 'IT';
```

**输出：**

| id  | name | department | salary |
|-----|------|------------|--------|
| 2   | Bob  | IT         | 60000  |

## 使用ORDER BY排序结果

`ORDER BY`子句用于对结果集进行排序。默认情况下，排序是升序（`ASC`），但也可以指定降序（`DESC`）。

### 示例4：按工资降序排序

```sql
SELECT * FROM employees
ORDER BY salary DESC;
```

**输出：**

| id  | name   | department | salary |
|-----|--------|------------|--------|
| 2   | Bob    | IT         | 60000  |
| 3   | Charlie| Finance    | 55000  |
| 1   | Alice  | HR         | 50000  |

## 使用LIMIT限制返回的行数

`LIMIT`子句用于限制查询返回的行数。

### 示例5：限制返回的行数

```sql
SELECT * FROM employees
LIMIT 2;
```

**输出：**

| id  | name  | department | salary |
|-----|-------|------------|--------|
| 1   | Alice | HR         | 50000  |
| 2   | Bob   | IT         | 60000  |

## 实际案例：查询嵌套JSON数据

Apache Drill 支持查询嵌套的JSON数据。假设我们有一个包含嵌套结构的JSON文件`employees.json`，内容如下：

```json
[
  {
    "id": 1,
    "name": "Alice",
    "department": "HR",
    "salary": 50000,
    "address": {
      "city": "New York",
      "zip": "10001"
    }
  },
  {
    "id": 2,
    "name": "Bob",
    "department": "IT",
    "salary": 60000,
    "address": {
      "city": "San Francisco",
      "zip": "94105"
    }
  }
]
```

我们可以使用以下查询来检索员工的姓名和所在城市：

```sql
SELECT name, address.city FROM dfs.`/path/to/employees.json`;
```

**输出：**

| name  | city          |
|-------|---------------|
| Alice | New York      |
| Bob   | San Francisco |

:::tip
在查询嵌套JSON数据时，使用`.`符号来访问嵌套字段。
:::

## 总结

通过本文，您已经学习了如何在Apache Drill中使用`SELECT`语句进行数据查询。我们从基础语法开始，逐步介绍了`WHERE`、`ORDER BY`和`LIMIT`等子句的使用方法，并通过实际案例展示了如何查询嵌套的JSON数据。

## 附加资源与练习

1. **练习1**：尝试在Apache Drill中创建一个包含多个列的CSV文件，并使用`SELECT`语句查询特定列。
2. **练习2**：使用`WHERE`子句过滤出工资高于某个特定值的员工。
3. **练习3**：查询一个嵌套的JSON文件，并尝试使用`ORDER BY`对结果进行排序。

通过不断练习，您将更加熟练地掌握Apache Drill中的`SELECT`语句，并能够灵活应用于各种数据查询场景。