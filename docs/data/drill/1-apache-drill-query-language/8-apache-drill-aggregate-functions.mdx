---
title: Apache Drill 聚合函数
description: 了解 Apache Drill 中的聚合函数，掌握如何使用它们对数据进行汇总和分析。本文适合初学者，包含详细的解释、代码示例和实际应用场景。
---

# Apache Drill 聚合函数

在数据分析中，聚合函数是用于对一组值进行计算并返回单个值的函数。Apache Drill 提供了多种聚合函数，帮助用户对数据进行汇总、统计和分析。本文将详细介绍 Apache Drill 中的常用聚合函数，并通过示例展示如何使用它们。

## 什么是聚合函数？

聚合函数是对一组值执行计算并返回单个值的函数。常见的聚合函数包括 `SUM`、`AVG`、`COUNT`、`MIN` 和 `MAX`。这些函数通常用于对数据进行汇总和统计分析。

在 Apache Drill 中，聚合函数可以应用于查询中的列，以便对数据进行分组、过滤和排序。

## 常用聚合函数

以下是 Apache Drill 中常用的聚合函数：

1. **SUM**: 计算一组值的总和。
2. **AVG**: 计算一组值的平均值。
3. **COUNT**: 计算一组值的数量。
4. **MIN**: 返回一组值中的最小值。
5. **MAX**: 返回一组值中的最大值。

### 示例数据

为了更好地理解这些函数，我们使用以下示例数据：

```sql
SELECT * FROM sales;
```

| id  | product | quantity | price |
|-----|---------|----------|-------|
| 1   | A       | 10       | 100   |
| 2   | B       | 5        | 200   |
| 3   | A       | 8        | 150   |
| 4   | C       | 12       | 80    |
| 5   | B       | 7        | 220   |
```

### 1. SUM 函数

`SUM` 函数用于计算一组值的总和。例如，计算所有产品的总销售额：

```sql
SELECT SUM(quantity * price) AS total_sales FROM sales;
```

**输出：**

| total_sales |
|-------------|
| 5540        |

### 2. AVG 函数

`AVG` 函数用于计算一组值的平均值。例如，计算所有产品的平均价格：

```sql
SELECT AVG(price) AS average_price FROM sales;
```

**输出：**

| average_price |
|---------------|
| 150           |

### 3. COUNT 函数

`COUNT` 函数用于计算一组值的数量。例如，计算销售记录的总数：

```sql
SELECT COUNT(*) AS total_records FROM sales;
```

**输出：**

| total_records |
|---------------|
| 5             |

### 4. MIN 函数

`MIN` 函数用于返回一组值中的最小值。例如，查找最低价格：

```sql
SELECT MIN(price) AS min_price FROM sales;
```

**输出：**

| min_price |
|-----------|
| 80        |

### 5. MAX 函数

`MAX` 函数用于返回一组值中的最大值。例如，查找最高价格：

```sql
SELECT MAX(price) AS max_price FROM sales;
```

**输出：**

| max_price |
|-----------|
| 220       |

## 实际应用场景

假设我们需要分析销售数据，找出每种产品的总销售额和平均销售额。可以使用 `GROUP BY` 子句结合聚合函数来实现：

```sql
SELECT product, SUM(quantity * price) AS total_sales, AVG(quantity * price) AS average_sales
FROM sales
GROUP BY product;
```

**输出：**

| product | total_sales | average_sales |
|---------|-------------|---------------|
| A       | 2300        | 1150          |
| B       | 2340        | 1170          |
| C       | 960         | 960           |

## 总结

Apache Drill 提供了强大的聚合函数，帮助用户对数据进行汇总和分析。通过 `SUM`、`AVG`、`COUNT`、`MIN` 和 `MAX` 等函数，可以轻松计算数据的总和、平均值、数量、最小值和最大值。结合 `GROUP BY` 子句，可以进一步对数据进行分组分析。

## 附加资源

- [Apache Drill 官方文档](https://drill.apache.org/docs/)
- [SQL 聚合函数教程](https://www.w3schools.com/sql/sql_aggregate_functions.asp)

## 练习

1. 使用 `SUM` 函数计算每种产品的总销售额。
2. 使用 `AVG` 函数计算每种产品的平均销售额。
3. 使用 `COUNT` 函数计算每种产品的销售记录数量。
4. 使用 `MIN` 和 `MAX` 函数找出每种产品的最低和最高价格。

通过练习，您将更好地掌握 Apache Drill 中的聚合函数，并能够灵活应用于实际数据分析中。